var $A=Object.defineProperty;var BA=(e,t,r)=>t in e?$A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var gr=(e,t,r)=>(BA(e,typeof t!="symbol"?t+"":t,r),r);function UA(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function qA(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var B3={exports:{}},Pp={},U3={exports:{}},Kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ef=Symbol.for("react.element"),VA=Symbol.for("react.portal"),WA=Symbol.for("react.fragment"),HA=Symbol.for("react.strict_mode"),GA=Symbol.for("react.profiler"),KA=Symbol.for("react.provider"),YA=Symbol.for("react.context"),ZA=Symbol.for("react.forward_ref"),JA=Symbol.for("react.suspense"),XA=Symbol.for("react.memo"),QA=Symbol.for("react.lazy"),Fw=Symbol.iterator;function eL(e){return e===null||typeof e!="object"?null:(e=Fw&&e[Fw]||e["@@iterator"],typeof e=="function"?e:null)}var z3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q3=Object.assign,V3={};function dd(e,t,r){this.props=e,this.context=t,this.refs=V3,this.updater=r||z3}dd.prototype.isReactComponent={};dd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};dd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function W3(){}W3.prototype=dd.prototype;function Mv(e,t,r){this.props=e,this.context=t,this.refs=V3,this.updater=r||z3}var Ov=Mv.prototype=new W3;Ov.constructor=Mv;q3(Ov,dd.prototype);Ov.isPureReactComponent=!0;var Dw=Array.isArray,H3=Object.prototype.hasOwnProperty,Rv={current:null},G3={key:!0,ref:!0,__self:!0,__source:!0};function K3(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)H3.call(t,n)&&!G3.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Ef,type:e,key:i,ref:o,props:s,_owner:Rv.current}}function tL(e,t){return{$$typeof:Ef,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fv(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ef}function rL(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $w=/\/+/g;function Gg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?rL(""+e.key):t.toString(36)}function c0(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ef:case VA:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+Gg(o,0):n,Dw(s)?(r="",e!=null&&(r=e.replace($w,"$&/")+"/"),c0(s,t,r,"",function(u){return u})):s!=null&&(Fv(s)&&(s=tL(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace($w,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Dw(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Gg(i,l);o+=c0(i,t,r,c,s)}else if(c=eL(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Gg(i,l++),o+=c0(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Nm(e,t,r){if(e==null)return e;var n=[],s=0;return c0(e,n,"","",function(i){return t.call(r,i,s++)}),n}function nL(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ss={current:null},u0={transition:null},sL={ReactCurrentDispatcher:Ss,ReactCurrentBatchConfig:u0,ReactCurrentOwner:Rv};function Y3(){throw Error("act(...) is not supported in production builds of React.")}Kt.Children={map:Nm,forEach:function(e,t,r){Nm(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Nm(e,function(){t++}),t},toArray:function(e){return Nm(e,function(t){return t})||[]},only:function(e){if(!Fv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Kt.Component=dd;Kt.Fragment=WA;Kt.Profiler=GA;Kt.PureComponent=Mv;Kt.StrictMode=HA;Kt.Suspense=JA;Kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sL;Kt.act=Y3;Kt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=q3({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Rv.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)H3.call(t,c)&&!G3.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Ef,type:e.type,key:s,ref:i,props:n,_owner:o}};Kt.createContext=function(e){return e={$$typeof:YA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:KA,_context:e},e.Consumer=e};Kt.createElement=K3;Kt.createFactory=function(e){var t=K3.bind(null,e);return t.type=e,t};Kt.createRef=function(){return{current:null}};Kt.forwardRef=function(e){return{$$typeof:ZA,render:e}};Kt.isValidElement=Fv;Kt.lazy=function(e){return{$$typeof:QA,_payload:{_status:-1,_result:e},_init:nL}};Kt.memo=function(e,t){return{$$typeof:XA,type:e,compare:t===void 0?null:t}};Kt.startTransition=function(e){var t=u0.transition;u0.transition={};try{e()}finally{u0.transition=t}};Kt.unstable_act=Y3;Kt.useCallback=function(e,t){return Ss.current.useCallback(e,t)};Kt.useContext=function(e){return Ss.current.useContext(e)};Kt.useDebugValue=function(){};Kt.useDeferredValue=function(e){return Ss.current.useDeferredValue(e)};Kt.useEffect=function(e,t){return Ss.current.useEffect(e,t)};Kt.useId=function(){return Ss.current.useId()};Kt.useImperativeHandle=function(e,t,r){return Ss.current.useImperativeHandle(e,t,r)};Kt.useInsertionEffect=function(e,t){return Ss.current.useInsertionEffect(e,t)};Kt.useLayoutEffect=function(e,t){return Ss.current.useLayoutEffect(e,t)};Kt.useMemo=function(e,t){return Ss.current.useMemo(e,t)};Kt.useReducer=function(e,t,r){return Ss.current.useReducer(e,t,r)};Kt.useRef=function(e){return Ss.current.useRef(e)};Kt.useState=function(e){return Ss.current.useState(e)};Kt.useSyncExternalStore=function(e,t,r){return Ss.current.useSyncExternalStore(e,t,r)};Kt.useTransition=function(){return Ss.current.useTransition()};Kt.version="18.3.1";U3.exports=Kt;var g=U3.exports;const st=zA(g),Ix=UA({__proto__:null,default:st},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iL=g,aL=Symbol.for("react.element"),oL=Symbol.for("react.fragment"),lL=Object.prototype.hasOwnProperty,cL=iL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uL={key:!0,ref:!0,__self:!0,__source:!0};function Z3(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)lL.call(t,n)&&!uL.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:aL,type:e,key:i,ref:o,props:s,_owner:cL.current}}Pp.Fragment=oL;Pp.jsx=Z3;Pp.jsxs=Z3;B3.exports=Pp;var a=B3.exports,Mx={},J3={exports:{}},ci={},X3={exports:{}},Q3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,G){var ce=M.length;M.push(G);e:for(;0<ce;){var ue=ce-1>>>1,O=M[ue];if(0<s(O,G))M[ue]=G,M[ce]=O,ce=ue;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var G=M[0],ce=M.pop();if(ce!==G){M[0]=ce;e:for(var ue=0,O=M.length,Z=O>>>1;ue<Z;){var B=2*(ue+1)-1,ee=M[B],X=B+1,ne=M[X];if(0>s(ee,ce))X<O&&0>s(ne,ee)?(M[ue]=ne,M[X]=ce,ue=X):(M[ue]=ee,M[B]=ce,ue=B);else if(X<O&&0>s(ne,ce))M[ue]=ne,M[X]=ce,ue=X;else break e}}return G}function s(M,G){var ce=M.sortIndex-G.sortIndex;return ce!==0?ce:M.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,f=3,h=!1,x=!1,b=!1,j=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(M){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=M)n(u),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(u)}}function S(M){if(b=!1,w(M),!x)if(r(c)!==null)x=!0,H(E);else{var G=r(u);G!==null&&W(S,G.startTime-M)}}function E(M,G){x=!1,b&&(b=!1,y(I),I=-1),h=!0;var ce=f;try{for(w(G),m=r(c);m!==null&&(!(m.expirationTime>G)||M&&!C());){var ue=m.callback;if(typeof ue=="function"){m.callback=null,f=m.priorityLevel;var O=ue(m.expirationTime<=G);G=e.unstable_now(),typeof O=="function"?m.callback=O:m===r(c)&&n(c),w(G)}else n(c);m=r(c)}if(m!==null)var Z=!0;else{var B=r(u);B!==null&&W(S,B.startTime-G),Z=!1}return Z}finally{m=null,f=ce,h=!1}}var $=!1,U=null,I=-1,T=5,D=-1;function C(){return!(e.unstable_now()-D<T)}function P(){if(U!==null){var M=e.unstable_now();D=M;var G=!0;try{G=U(!0,M)}finally{G?F():($=!1,U=null)}}else $=!1}var F;if(typeof _=="function")F=function(){_(P)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,R=A.port2;A.port1.onmessage=P,F=function(){R.postMessage(null)}}else F=function(){j(P,0)};function H(M){U=M,$||($=!0,F())}function W(M,G){I=j(function(){M(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,H(E))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var G=3;break;default:G=f}var ce=f;f=G;try{return M()}finally{f=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,G){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var ce=f;f=M;try{return G()}finally{f=ce}},e.unstable_scheduleCallback=function(M,G,ce){var ue=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ue+ce:ue):ce=ue,M){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ce+O,M={id:d++,callback:G,priorityLevel:M,startTime:ce,expirationTime:O,sortIndex:-1},ce>ue?(M.sortIndex=ce,t(u,M),r(c)===null&&M===r(u)&&(b?(y(I),I=-1):b=!0,W(S,ce-ue))):(M.sortIndex=O,t(c,M),x||h||(x=!0,H(E))),M},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(M){var G=f;return function(){var ce=f;f=G;try{return M.apply(this,arguments)}finally{f=ce}}}})(Q3);X3.exports=Q3;var dL=X3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hL=g,oi=dL;function tt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eN=new Set,Hh={};function Dc(e,t){Zu(e,t),Zu(e+"Capture",t)}function Zu(e,t){for(Hh[e]=t,e=0;e<t.length;e++)eN.add(t[e])}var fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ox=Object.prototype.hasOwnProperty,fL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bw={},Uw={};function mL(e){return Ox.call(Uw,e)?!0:Ox.call(Bw,e)?!1:fL.test(e)?Uw[e]=!0:(Bw[e]=!0,!1)}function pL(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function gL(e,t,r,n){if(t===null||typeof t>"u"||pL(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ks(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Yn[e]=new ks(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Yn[t]=new ks(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Yn[e]=new ks(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Yn[e]=new ks(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Yn[e]=new ks(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Yn[e]=new ks(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Yn[e]=new ks(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Yn[e]=new ks(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Yn[e]=new ks(e,5,!1,e.toLowerCase(),null,!1,!1)});var Dv=/[\-:]([a-z])/g;function $v(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Dv,$v);Yn[t]=new ks(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Dv,$v);Yn[t]=new ks(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Dv,$v);Yn[t]=new ks(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Yn[e]=new ks(e,1,!1,e.toLowerCase(),null,!1,!1)});Yn.xlinkHref=new ks("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Yn[e]=new ks(e,1,!1,e.toLowerCase(),null,!0,!0)});function Bv(e,t,r,n){var s=Yn.hasOwnProperty(t)?Yn[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(gL(t,r,s,n)&&(r=null),n||s===null?mL(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var bo=hL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sm=Symbol.for("react.element"),xu=Symbol.for("react.portal"),vu=Symbol.for("react.fragment"),Uv=Symbol.for("react.strict_mode"),Rx=Symbol.for("react.profiler"),tN=Symbol.for("react.provider"),rN=Symbol.for("react.context"),zv=Symbol.for("react.forward_ref"),Fx=Symbol.for("react.suspense"),Dx=Symbol.for("react.suspense_list"),qv=Symbol.for("react.memo"),Ko=Symbol.for("react.lazy"),nN=Symbol.for("react.offscreen"),zw=Symbol.iterator;function Jd(e){return e===null||typeof e!="object"?null:(e=zw&&e[zw]||e["@@iterator"],typeof e=="function"?e:null)}var Kr=Object.assign,Kg;function hh(e){if(Kg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Kg=t&&t[1]||""}return`
`+Kg+e}var Yg=!1;function Zg(e,t){if(!e||Yg)return"";Yg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Yg=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?hh(e):""}function xL(e){switch(e.tag){case 5:return hh(e.type);case 16:return hh("Lazy");case 13:return hh("Suspense");case 19:return hh("SuspenseList");case 0:case 2:case 15:return e=Zg(e.type,!1),e;case 11:return e=Zg(e.type.render,!1),e;case 1:return e=Zg(e.type,!0),e;default:return""}}function $x(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vu:return"Fragment";case xu:return"Portal";case Rx:return"Profiler";case Uv:return"StrictMode";case Fx:return"Suspense";case Dx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case rN:return(e.displayName||"Context")+".Consumer";case tN:return(e._context.displayName||"Context")+".Provider";case zv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qv:return t=e.displayName||null,t!==null?t:$x(e.type)||"Memo";case Ko:t=e._payload,e=e._init;try{return $x(e(t))}catch{}}return null}function vL(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $x(t);case 8:return t===Uv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function wl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function yL(e){var t=sN(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function km(e){e._valueTracker||(e._valueTracker=yL(e))}function iN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=sN(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function R0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bx(e,t){var r=t.checked;return Kr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function qw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=wl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function aN(e,t){t=t.checked,t!=null&&Bv(e,"checked",t,!1)}function Ux(e,t){aN(e,t);var r=wl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zx(e,t.type,r):t.hasOwnProperty("defaultValue")&&zx(e,t.type,wl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Vw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function zx(e,t,r){(t!=="number"||R0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fh=Array.isArray;function Ru(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+wl(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function qx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(tt(91));return Kr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ww(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(tt(92));if(fh(r)){if(1<r.length)throw Error(tt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:wl(r)}}function oN(e,t){var r=wl(t.value),n=wl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Hw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lN(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lN(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Cm,cN=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Cm=Cm||document.createElement("div"),Cm.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Cm.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Gh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var jh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bL=["Webkit","ms","Moz","O"];Object.keys(jh).forEach(function(e){bL.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),jh[t]=jh[e]})});function uN(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||jh.hasOwnProperty(e)&&jh[e]?(""+t).trim():t+"px"}function dN(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=uN(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var wL=Kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wx(e,t){if(t){if(wL[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(tt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(tt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(tt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(tt(62))}}function Hx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gx=null;function Vv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kx=null,Fu=null,Du=null;function Gw(e){if(e=Pf(e)){if(typeof Kx!="function")throw Error(tt(280));var t=e.stateNode;t&&(t=Rp(t),Kx(e.stateNode,e.type,t))}}function hN(e){Fu?Du?Du.push(e):Du=[e]:Fu=e}function fN(){if(Fu){var e=Fu,t=Du;if(Du=Fu=null,Gw(e),t)for(e=0;e<t.length;e++)Gw(t[e])}}function mN(e,t){return e(t)}function pN(){}var Jg=!1;function gN(e,t,r){if(Jg)return e(t,r);Jg=!0;try{return mN(e,t,r)}finally{Jg=!1,(Fu!==null||Du!==null)&&(pN(),fN())}}function Kh(e,t){var r=e.stateNode;if(r===null)return null;var n=Rp(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(tt(231,t,typeof r));return r}var Yx=!1;if(fo)try{var Xd={};Object.defineProperty(Xd,"passive",{get:function(){Yx=!0}}),window.addEventListener("test",Xd,Xd),window.removeEventListener("test",Xd,Xd)}catch{Yx=!1}function _L(e,t,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Nh=!1,F0=null,D0=!1,Zx=null,jL={onError:function(e){Nh=!0,F0=e}};function NL(e,t,r,n,s,i,o,l,c){Nh=!1,F0=null,_L.apply(jL,arguments)}function SL(e,t,r,n,s,i,o,l,c){if(NL.apply(this,arguments),Nh){if(Nh){var u=F0;Nh=!1,F0=null}else throw Error(tt(198));D0||(D0=!0,Zx=u)}}function $c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function xN(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Kw(e){if($c(e)!==e)throw Error(tt(188))}function kL(e){var t=e.alternate;if(!t){if(t=$c(e),t===null)throw Error(tt(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Kw(s),e;if(i===n)return Kw(s),t;i=i.sibling}throw Error(tt(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(tt(189))}}if(r.alternate!==n)throw Error(tt(190))}if(r.tag!==3)throw Error(tt(188));return r.stateNode.current===r?e:t}function vN(e){return e=kL(e),e!==null?yN(e):null}function yN(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yN(e);if(t!==null)return t;e=e.sibling}return null}var bN=oi.unstable_scheduleCallback,Yw=oi.unstable_cancelCallback,CL=oi.unstable_shouldYield,EL=oi.unstable_requestPaint,un=oi.unstable_now,AL=oi.unstable_getCurrentPriorityLevel,Wv=oi.unstable_ImmediatePriority,wN=oi.unstable_UserBlockingPriority,$0=oi.unstable_NormalPriority,LL=oi.unstable_LowPriority,_N=oi.unstable_IdlePriority,Tp=null,Na=null;function PL(e){if(Na&&typeof Na.onCommitFiberRoot=="function")try{Na.onCommitFiberRoot(Tp,e,void 0,(e.current.flags&128)===128)}catch{}}var Yi=Math.clz32?Math.clz32:ML,TL=Math.log,IL=Math.LN2;function ML(e){return e>>>=0,e===0?32:31-(TL(e)/IL|0)|0}var Em=64,Am=4194304;function mh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function B0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=mh(l):(i&=o,i!==0&&(n=mh(i)))}else o=r&~s,o!==0?n=mh(o):i!==0&&(n=mh(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yi(t),s=1<<r,n|=e[r],t&=~s;return n}function OL(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RL(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Yi(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=OL(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Jx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function jN(){var e=Em;return Em<<=1,!(Em&4194240)&&(Em=64),e}function Xg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Af(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yi(t),e[t]=r}function FL(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Yi(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function Hv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yi(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var vr=0;function NN(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var SN,Gv,kN,CN,EN,Xx=!1,Lm=[],ol=null,ll=null,cl=null,Yh=new Map,Zh=new Map,Xo=[],DL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zw(e,t){switch(e){case"focusin":case"focusout":ol=null;break;case"dragenter":case"dragleave":ll=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":Yh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zh.delete(t.pointerId)}}function Qd(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Pf(t),t!==null&&Gv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function $L(e,t,r,n,s){switch(t){case"focusin":return ol=Qd(ol,e,t,r,n,s),!0;case"dragenter":return ll=Qd(ll,e,t,r,n,s),!0;case"mouseover":return cl=Qd(cl,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Yh.set(i,Qd(Yh.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Zh.set(i,Qd(Zh.get(i)||null,e,t,r,n,s)),!0}return!1}function AN(e){var t=pc(e.target);if(t!==null){var r=$c(t);if(r!==null){if(t=r.tag,t===13){if(t=xN(r),t!==null){e.blockedOn=t,EN(e.priority,function(){kN(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function d0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Qx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Gx=n,r.target.dispatchEvent(n),Gx=null}else return t=Pf(r),t!==null&&Gv(t),e.blockedOn=r,!1;t.shift()}return!0}function Jw(e,t,r){d0(e)&&r.delete(t)}function BL(){Xx=!1,ol!==null&&d0(ol)&&(ol=null),ll!==null&&d0(ll)&&(ll=null),cl!==null&&d0(cl)&&(cl=null),Yh.forEach(Jw),Zh.forEach(Jw)}function eh(e,t){e.blockedOn===t&&(e.blockedOn=null,Xx||(Xx=!0,oi.unstable_scheduleCallback(oi.unstable_NormalPriority,BL)))}function Jh(e){function t(s){return eh(s,e)}if(0<Lm.length){eh(Lm[0],e);for(var r=1;r<Lm.length;r++){var n=Lm[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ol!==null&&eh(ol,e),ll!==null&&eh(ll,e),cl!==null&&eh(cl,e),Yh.forEach(t),Zh.forEach(t),r=0;r<Xo.length;r++)n=Xo[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Xo.length&&(r=Xo[0],r.blockedOn===null);)AN(r),r.blockedOn===null&&Xo.shift()}var $u=bo.ReactCurrentBatchConfig,U0=!0;function UL(e,t,r,n){var s=vr,i=$u.transition;$u.transition=null;try{vr=1,Kv(e,t,r,n)}finally{vr=s,$u.transition=i}}function zL(e,t,r,n){var s=vr,i=$u.transition;$u.transition=null;try{vr=4,Kv(e,t,r,n)}finally{vr=s,$u.transition=i}}function Kv(e,t,r,n){if(U0){var s=Qx(e,t,r,n);if(s===null)l1(e,t,n,z0,r),Zw(e,n);else if($L(s,e,t,r,n))n.stopPropagation();else if(Zw(e,n),t&4&&-1<DL.indexOf(e)){for(;s!==null;){var i=Pf(s);if(i!==null&&SN(i),i=Qx(e,t,r,n),i===null&&l1(e,t,n,z0,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else l1(e,t,n,null,r)}}var z0=null;function Qx(e,t,r,n){if(z0=null,e=Vv(n),e=pc(e),e!==null)if(t=$c(e),t===null)e=null;else if(r=t.tag,r===13){if(e=xN(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return z0=e,null}function LN(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AL()){case Wv:return 1;case wN:return 4;case $0:case LL:return 16;case _N:return 536870912;default:return 16}default:return 16}}var rl=null,Yv=null,h0=null;function PN(){if(h0)return h0;var e,t=Yv,r=t.length,n,s="value"in rl?rl.value:rl.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return h0=s.slice(e,1<n?1-n:void 0)}function f0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Pm(){return!0}function Xw(){return!1}function ui(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Pm:Xw,this.isPropagationStopped=Xw,this}return Kr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Pm)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Pm)},persist:function(){},isPersistent:Pm}),t}var hd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zv=ui(hd),Lf=Kr({},hd,{view:0,detail:0}),qL=ui(Lf),Qg,e1,th,Ip=Kr({},Lf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==th&&(th&&e.type==="mousemove"?(Qg=e.screenX-th.screenX,e1=e.screenY-th.screenY):e1=Qg=0,th=e),Qg)},movementY:function(e){return"movementY"in e?e.movementY:e1}}),Qw=ui(Ip),VL=Kr({},Ip,{dataTransfer:0}),WL=ui(VL),HL=Kr({},Lf,{relatedTarget:0}),t1=ui(HL),GL=Kr({},hd,{animationName:0,elapsedTime:0,pseudoElement:0}),KL=ui(GL),YL=Kr({},hd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ZL=ui(YL),JL=Kr({},hd,{data:0}),e5=ui(JL),XL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},e7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function t7(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=e7[e])?!!t[e]:!1}function Jv(){return t7}var r7=Kr({},Lf,{key:function(e){if(e.key){var t=XL[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=f0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?QL[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jv,charCode:function(e){return e.type==="keypress"?f0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?f0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),n7=ui(r7),s7=Kr({},Ip,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t5=ui(s7),i7=Kr({},Lf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jv}),a7=ui(i7),o7=Kr({},hd,{propertyName:0,elapsedTime:0,pseudoElement:0}),l7=ui(o7),c7=Kr({},Ip,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),u7=ui(c7),d7=[9,13,27,32],Xv=fo&&"CompositionEvent"in window,Sh=null;fo&&"documentMode"in document&&(Sh=document.documentMode);var h7=fo&&"TextEvent"in window&&!Sh,TN=fo&&(!Xv||Sh&&8<Sh&&11>=Sh),r5=String.fromCharCode(32),n5=!1;function IN(e,t){switch(e){case"keyup":return d7.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MN(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yu=!1;function f7(e,t){switch(e){case"compositionend":return MN(t);case"keypress":return t.which!==32?null:(n5=!0,r5);case"textInput":return e=t.data,e===r5&&n5?null:e;default:return null}}function m7(e,t){if(yu)return e==="compositionend"||!Xv&&IN(e,t)?(e=PN(),h0=Yv=rl=null,yu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return TN&&t.locale!=="ko"?null:t.data;default:return null}}var p7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!p7[e.type]:t==="textarea"}function ON(e,t,r,n){hN(n),t=q0(t,"onChange"),0<t.length&&(r=new Zv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var kh=null,Xh=null;function g7(e){HN(e,0)}function Mp(e){var t=_u(e);if(iN(t))return e}function x7(e,t){if(e==="change")return t}var RN=!1;if(fo){var r1;if(fo){var n1="oninput"in document;if(!n1){var i5=document.createElement("div");i5.setAttribute("oninput","return;"),n1=typeof i5.oninput=="function"}r1=n1}else r1=!1;RN=r1&&(!document.documentMode||9<document.documentMode)}function a5(){kh&&(kh.detachEvent("onpropertychange",FN),Xh=kh=null)}function FN(e){if(e.propertyName==="value"&&Mp(Xh)){var t=[];ON(t,Xh,e,Vv(e)),gN(g7,t)}}function v7(e,t,r){e==="focusin"?(a5(),kh=t,Xh=r,kh.attachEvent("onpropertychange",FN)):e==="focusout"&&a5()}function y7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mp(Xh)}function b7(e,t){if(e==="click")return Mp(t)}function w7(e,t){if(e==="input"||e==="change")return Mp(t)}function _7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ji=typeof Object.is=="function"?Object.is:_7;function Qh(e,t){if(Ji(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Ox.call(t,s)||!Ji(e[s],t[s]))return!1}return!0}function o5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function l5(e,t){var r=o5(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=o5(r)}}function DN(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?DN(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $N(){for(var e=window,t=R0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=R0(e.document)}return t}function Qv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function j7(e){var t=$N(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&DN(r.ownerDocument.documentElement,r)){if(n!==null&&Qv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=l5(r,i);var o=l5(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var N7=fo&&"documentMode"in document&&11>=document.documentMode,bu=null,e2=null,Ch=null,t2=!1;function c5(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;t2||bu==null||bu!==R0(n)||(n=bu,"selectionStart"in n&&Qv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ch&&Qh(Ch,n)||(Ch=n,n=q0(e2,"onSelect"),0<n.length&&(t=new Zv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=bu)))}function Tm(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wu={animationend:Tm("Animation","AnimationEnd"),animationiteration:Tm("Animation","AnimationIteration"),animationstart:Tm("Animation","AnimationStart"),transitionend:Tm("Transition","TransitionEnd")},s1={},BN={};fo&&(BN=document.createElement("div").style,"AnimationEvent"in window||(delete wu.animationend.animation,delete wu.animationiteration.animation,delete wu.animationstart.animation),"TransitionEvent"in window||delete wu.transitionend.transition);function Op(e){if(s1[e])return s1[e];if(!wu[e])return e;var t=wu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in BN)return s1[e]=t[r];return e}var UN=Op("animationend"),zN=Op("animationiteration"),qN=Op("animationstart"),VN=Op("transitionend"),WN=new Map,u5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Al(e,t){WN.set(e,t),Dc(t,[e])}for(var i1=0;i1<u5.length;i1++){var a1=u5[i1],S7=a1.toLowerCase(),k7=a1[0].toUpperCase()+a1.slice(1);Al(S7,"on"+k7)}Al(UN,"onAnimationEnd");Al(zN,"onAnimationIteration");Al(qN,"onAnimationStart");Al("dblclick","onDoubleClick");Al("focusin","onFocus");Al("focusout","onBlur");Al(VN,"onTransitionEnd");Zu("onMouseEnter",["mouseout","mouseover"]);Zu("onMouseLeave",["mouseout","mouseover"]);Zu("onPointerEnter",["pointerout","pointerover"]);Zu("onPointerLeave",["pointerout","pointerover"]);Dc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ph="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),C7=new Set("cancel close invalid load scroll toggle".split(" ").concat(ph));function d5(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,SL(n,t,void 0,e),e.currentTarget=null}function HN(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;d5(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;d5(s,l,u),i=c}}}if(D0)throw e=Zx,D0=!1,Zx=null,e}function Ir(e,t){var r=t[a2];r===void 0&&(r=t[a2]=new Set);var n=e+"__bubble";r.has(n)||(GN(t,e,2,!1),r.add(n))}function o1(e,t,r){var n=0;t&&(n|=4),GN(r,e,n,t)}var Im="_reactListening"+Math.random().toString(36).slice(2);function ef(e){if(!e[Im]){e[Im]=!0,eN.forEach(function(r){r!=="selectionchange"&&(C7.has(r)||o1(r,!1,e),o1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Im]||(t[Im]=!0,o1("selectionchange",!1,t))}}function GN(e,t,r,n){switch(LN(t)){case 1:var s=UL;break;case 4:s=zL;break;default:s=Kv}r=s.bind(null,t,r,e),s=void 0,!Yx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function l1(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=pc(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}gN(function(){var u=i,d=Vv(r),m=[];e:{var f=WN.get(e);if(f!==void 0){var h=Zv,x=e;switch(e){case"keypress":if(f0(r)===0)break e;case"keydown":case"keyup":h=n7;break;case"focusin":x="focus",h=t1;break;case"focusout":x="blur",h=t1;break;case"beforeblur":case"afterblur":h=t1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Qw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=WL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=a7;break;case UN:case zN:case qN:h=KL;break;case VN:h=l7;break;case"scroll":h=qL;break;case"wheel":h=u7;break;case"copy":case"cut":case"paste":h=ZL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=t5}var b=(t&4)!==0,j=!b&&e==="scroll",y=b?f!==null?f+"Capture":null:f;b=[];for(var _=u,w;_!==null;){w=_;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,y!==null&&(S=Kh(_,y),S!=null&&b.push(tf(_,S,w)))),j)break;_=_.return}0<b.length&&(f=new h(f,x,null,r,d),m.push({event:f,listeners:b}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&r!==Gx&&(x=r.relatedTarget||r.fromElement)&&(pc(x)||x[mo]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(x=r.relatedTarget||r.toElement,h=u,x=x?pc(x):null,x!==null&&(j=$c(x),x!==j||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=u),h!==x)){if(b=Qw,S="onMouseLeave",y="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(b=t5,S="onPointerLeave",y="onPointerEnter",_="pointer"),j=h==null?f:_u(h),w=x==null?f:_u(x),f=new b(S,_+"leave",h,r,d),f.target=j,f.relatedTarget=w,S=null,pc(d)===u&&(b=new b(y,_+"enter",x,r,d),b.target=w,b.relatedTarget=j,S=b),j=S,h&&x)t:{for(b=h,y=x,_=0,w=b;w;w=ru(w))_++;for(w=0,S=y;S;S=ru(S))w++;for(;0<_-w;)b=ru(b),_--;for(;0<w-_;)y=ru(y),w--;for(;_--;){if(b===y||y!==null&&b===y.alternate)break t;b=ru(b),y=ru(y)}b=null}else b=null;h!==null&&h5(m,f,h,b,!1),x!==null&&j!==null&&h5(m,j,x,b,!0)}}e:{if(f=u?_u(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var E=x7;else if(s5(f))if(RN)E=w7;else{E=y7;var $=v7}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=b7);if(E&&(E=E(e,u))){ON(m,E,r,d);break e}$&&$(e,f,u),e==="focusout"&&($=f._wrapperState)&&$.controlled&&f.type==="number"&&zx(f,"number",f.value)}switch($=u?_u(u):window,e){case"focusin":(s5($)||$.contentEditable==="true")&&(bu=$,e2=u,Ch=null);break;case"focusout":Ch=e2=bu=null;break;case"mousedown":t2=!0;break;case"contextmenu":case"mouseup":case"dragend":t2=!1,c5(m,r,d);break;case"selectionchange":if(N7)break;case"keydown":case"keyup":c5(m,r,d)}var U;if(Xv)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else yu?IN(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(TN&&r.locale!=="ko"&&(yu||I!=="onCompositionStart"?I==="onCompositionEnd"&&yu&&(U=PN()):(rl=d,Yv="value"in rl?rl.value:rl.textContent,yu=!0)),$=q0(u,I),0<$.length&&(I=new e5(I,e,null,r,d),m.push({event:I,listeners:$}),U?I.data=U:(U=MN(r),U!==null&&(I.data=U)))),(U=h7?f7(e,r):m7(e,r))&&(u=q0(u,"onBeforeInput"),0<u.length&&(d=new e5("onBeforeInput","beforeinput",null,r,d),m.push({event:d,listeners:u}),d.data=U))}HN(m,t)})}function tf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function q0(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Kh(e,r),i!=null&&n.unshift(tf(e,i,s)),i=Kh(e,t),i!=null&&n.push(tf(e,i,s))),e=e.return}return n}function ru(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function h5(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Kh(r,i),c!=null&&o.unshift(tf(r,c,l))):s||(c=Kh(r,i),c!=null&&o.push(tf(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var E7=/\r\n?/g,A7=/\u0000|\uFFFD/g;function f5(e){return(typeof e=="string"?e:""+e).replace(E7,`
`).replace(A7,"")}function Mm(e,t,r){if(t=f5(t),f5(e)!==t&&r)throw Error(tt(425))}function V0(){}var r2=null,n2=null;function s2(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var i2=typeof setTimeout=="function"?setTimeout:void 0,L7=typeof clearTimeout=="function"?clearTimeout:void 0,m5=typeof Promise=="function"?Promise:void 0,P7=typeof queueMicrotask=="function"?queueMicrotask:typeof m5<"u"?function(e){return m5.resolve(null).then(e).catch(T7)}:i2;function T7(e){setTimeout(function(){throw e})}function c1(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Jh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Jh(t)}function ul(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function p5(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var fd=Math.random().toString(36).slice(2),ya="__reactFiber$"+fd,rf="__reactProps$"+fd,mo="__reactContainer$"+fd,a2="__reactEvents$"+fd,I7="__reactListeners$"+fd,M7="__reactHandles$"+fd;function pc(e){var t=e[ya];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mo]||r[ya]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=p5(e);e!==null;){if(r=e[ya])return r;e=p5(e)}return t}e=r,r=e.parentNode}return null}function Pf(e){return e=e[ya]||e[mo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _u(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(tt(33))}function Rp(e){return e[rf]||null}var o2=[],ju=-1;function Ll(e){return{current:e}}function Or(e){0>ju||(e.current=o2[ju],o2[ju]=null,ju--)}function Ar(e,t){ju++,o2[ju]=e.current,e.current=t}var _l={},ds=Ll(_l),Fs=Ll(!1),Cc=_l;function Ju(e,t){var r=e.type.contextTypes;if(!r)return _l;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ds(e){return e=e.childContextTypes,e!=null}function W0(){Or(Fs),Or(ds)}function g5(e,t,r){if(ds.current!==_l)throw Error(tt(168));Ar(ds,t),Ar(Fs,r)}function KN(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(tt(108,vL(e)||"Unknown",s));return Kr({},r,n)}function H0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_l,Cc=ds.current,Ar(ds,e),Ar(Fs,Fs.current),!0}function x5(e,t,r){var n=e.stateNode;if(!n)throw Error(tt(169));r?(e=KN(e,t,Cc),n.__reactInternalMemoizedMergedChildContext=e,Or(Fs),Or(ds),Ar(ds,e)):Or(Fs),Ar(Fs,r)}var Za=null,Fp=!1,u1=!1;function YN(e){Za===null?Za=[e]:Za.push(e)}function O7(e){Fp=!0,YN(e)}function Pl(){if(!u1&&Za!==null){u1=!0;var e=0,t=vr;try{var r=Za;for(vr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Za=null,Fp=!1}catch(s){throw Za!==null&&(Za=Za.slice(e+1)),bN(Wv,Pl),s}finally{vr=t,u1=!1}}return null}var Nu=[],Su=0,G0=null,K0=0,_i=[],ji=0,Ec=null,eo=1,to="";function ic(e,t){Nu[Su++]=K0,Nu[Su++]=G0,G0=e,K0=t}function ZN(e,t,r){_i[ji++]=eo,_i[ji++]=to,_i[ji++]=Ec,Ec=e;var n=eo;e=to;var s=32-Yi(n)-1;n&=~(1<<s),r+=1;var i=32-Yi(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,eo=1<<32-Yi(t)+s|r<<s|n,to=i+e}else eo=1<<i|r<<s|n,to=e}function ey(e){e.return!==null&&(ic(e,1),ZN(e,1,0))}function ty(e){for(;e===G0;)G0=Nu[--Su],Nu[Su]=null,K0=Nu[--Su],Nu[Su]=null;for(;e===Ec;)Ec=_i[--ji],_i[ji]=null,to=_i[--ji],_i[ji]=null,eo=_i[--ji],_i[ji]=null}var ii=null,ri=null,Br=!1,Gi=null;function JN(e,t){var r=Si(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function v5(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ii=e,ri=ul(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ii=e,ri=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ec!==null?{id:eo,overflow:to}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Si(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ii=e,ri=null,!0):!1;default:return!1}}function l2(e){return(e.mode&1)!==0&&(e.flags&128)===0}function c2(e){if(Br){var t=ri;if(t){var r=t;if(!v5(e,t)){if(l2(e))throw Error(tt(418));t=ul(r.nextSibling);var n=ii;t&&v5(e,t)?JN(n,r):(e.flags=e.flags&-4097|2,Br=!1,ii=e)}}else{if(l2(e))throw Error(tt(418));e.flags=e.flags&-4097|2,Br=!1,ii=e}}}function y5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ii=e}function Om(e){if(e!==ii)return!1;if(!Br)return y5(e),Br=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!s2(e.type,e.memoizedProps)),t&&(t=ri)){if(l2(e))throw XN(),Error(tt(418));for(;t;)JN(e,t),t=ul(t.nextSibling)}if(y5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(tt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ri=ul(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ri=null}}else ri=ii?ul(e.stateNode.nextSibling):null;return!0}function XN(){for(var e=ri;e;)e=ul(e.nextSibling)}function Xu(){ri=ii=null,Br=!1}function ry(e){Gi===null?Gi=[e]:Gi.push(e)}var R7=bo.ReactCurrentBatchConfig;function rh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(tt(309));var n=r.stateNode}if(!n)throw Error(tt(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(tt(284));if(!r._owner)throw Error(tt(290,e))}return e}function Rm(e,t){throw e=Object.prototype.toString.call(t),Error(tt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function b5(e){var t=e._init;return t(e._payload)}function QN(e){function t(y,_){if(e){var w=y.deletions;w===null?(y.deletions=[_],y.flags|=16):w.push(_)}}function r(y,_){if(!e)return null;for(;_!==null;)t(y,_),_=_.sibling;return null}function n(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function s(y,_){return y=ml(y,_),y.index=0,y.sibling=null,y}function i(y,_,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<_?(y.flags|=2,_):w):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,_,w,S){return _===null||_.tag!==6?(_=x1(w,y.mode,S),_.return=y,_):(_=s(_,w),_.return=y,_)}function c(y,_,w,S){var E=w.type;return E===vu?d(y,_,w.props.children,S,w.key):_!==null&&(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ko&&b5(E)===_.type)?(S=s(_,w.props),S.ref=rh(y,_,w),S.return=y,S):(S=b0(w.type,w.key,w.props,null,y.mode,S),S.ref=rh(y,_,w),S.return=y,S)}function u(y,_,w,S){return _===null||_.tag!==4||_.stateNode.containerInfo!==w.containerInfo||_.stateNode.implementation!==w.implementation?(_=v1(w,y.mode,S),_.return=y,_):(_=s(_,w.children||[]),_.return=y,_)}function d(y,_,w,S,E){return _===null||_.tag!==7?(_=Sc(w,y.mode,S,E),_.return=y,_):(_=s(_,w),_.return=y,_)}function m(y,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return _=x1(""+_,y.mode,w),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Sm:return w=b0(_.type,_.key,_.props,null,y.mode,w),w.ref=rh(y,null,_),w.return=y,w;case xu:return _=v1(_,y.mode,w),_.return=y,_;case Ko:var S=_._init;return m(y,S(_._payload),w)}if(fh(_)||Jd(_))return _=Sc(_,y.mode,w,null),_.return=y,_;Rm(y,_)}return null}function f(y,_,w,S){var E=_!==null?_.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:l(y,_,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Sm:return w.key===E?c(y,_,w,S):null;case xu:return w.key===E?u(y,_,w,S):null;case Ko:return E=w._init,f(y,_,E(w._payload),S)}if(fh(w)||Jd(w))return E!==null?null:d(y,_,w,S,null);Rm(y,w)}return null}function h(y,_,w,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(w)||null,l(_,y,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Sm:return y=y.get(S.key===null?w:S.key)||null,c(_,y,S,E);case xu:return y=y.get(S.key===null?w:S.key)||null,u(_,y,S,E);case Ko:var $=S._init;return h(y,_,w,$(S._payload),E)}if(fh(S)||Jd(S))return y=y.get(w)||null,d(_,y,S,E,null);Rm(_,S)}return null}function x(y,_,w,S){for(var E=null,$=null,U=_,I=_=0,T=null;U!==null&&I<w.length;I++){U.index>I?(T=U,U=null):T=U.sibling;var D=f(y,U,w[I],S);if(D===null){U===null&&(U=T);break}e&&U&&D.alternate===null&&t(y,U),_=i(D,_,I),$===null?E=D:$.sibling=D,$=D,U=T}if(I===w.length)return r(y,U),Br&&ic(y,I),E;if(U===null){for(;I<w.length;I++)U=m(y,w[I],S),U!==null&&(_=i(U,_,I),$===null?E=U:$.sibling=U,$=U);return Br&&ic(y,I),E}for(U=n(y,U);I<w.length;I++)T=h(U,y,I,w[I],S),T!==null&&(e&&T.alternate!==null&&U.delete(T.key===null?I:T.key),_=i(T,_,I),$===null?E=T:$.sibling=T,$=T);return e&&U.forEach(function(C){return t(y,C)}),Br&&ic(y,I),E}function b(y,_,w,S){var E=Jd(w);if(typeof E!="function")throw Error(tt(150));if(w=E.call(w),w==null)throw Error(tt(151));for(var $=E=null,U=_,I=_=0,T=null,D=w.next();U!==null&&!D.done;I++,D=w.next()){U.index>I?(T=U,U=null):T=U.sibling;var C=f(y,U,D.value,S);if(C===null){U===null&&(U=T);break}e&&U&&C.alternate===null&&t(y,U),_=i(C,_,I),$===null?E=C:$.sibling=C,$=C,U=T}if(D.done)return r(y,U),Br&&ic(y,I),E;if(U===null){for(;!D.done;I++,D=w.next())D=m(y,D.value,S),D!==null&&(_=i(D,_,I),$===null?E=D:$.sibling=D,$=D);return Br&&ic(y,I),E}for(U=n(y,U);!D.done;I++,D=w.next())D=h(U,y,I,D.value,S),D!==null&&(e&&D.alternate!==null&&U.delete(D.key===null?I:D.key),_=i(D,_,I),$===null?E=D:$.sibling=D,$=D);return e&&U.forEach(function(P){return t(y,P)}),Br&&ic(y,I),E}function j(y,_,w,S){if(typeof w=="object"&&w!==null&&w.type===vu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Sm:e:{for(var E=w.key,$=_;$!==null;){if($.key===E){if(E=w.type,E===vu){if($.tag===7){r(y,$.sibling),_=s($,w.props.children),_.return=y,y=_;break e}}else if($.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ko&&b5(E)===$.type){r(y,$.sibling),_=s($,w.props),_.ref=rh(y,$,w),_.return=y,y=_;break e}r(y,$);break}else t(y,$);$=$.sibling}w.type===vu?(_=Sc(w.props.children,y.mode,S,w.key),_.return=y,y=_):(S=b0(w.type,w.key,w.props,null,y.mode,S),S.ref=rh(y,_,w),S.return=y,y=S)}return o(y);case xu:e:{for($=w.key;_!==null;){if(_.key===$)if(_.tag===4&&_.stateNode.containerInfo===w.containerInfo&&_.stateNode.implementation===w.implementation){r(y,_.sibling),_=s(_,w.children||[]),_.return=y,y=_;break e}else{r(y,_);break}else t(y,_);_=_.sibling}_=v1(w,y.mode,S),_.return=y,y=_}return o(y);case Ko:return $=w._init,j(y,_,$(w._payload),S)}if(fh(w))return x(y,_,w,S);if(Jd(w))return b(y,_,w,S);Rm(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,_!==null&&_.tag===6?(r(y,_.sibling),_=s(_,w),_.return=y,y=_):(r(y,_),_=x1(w,y.mode,S),_.return=y,y=_),o(y)):r(y,_)}return j}var Qu=QN(!0),e6=QN(!1),Y0=Ll(null),Z0=null,ku=null,ny=null;function sy(){ny=ku=Z0=null}function iy(e){var t=Y0.current;Or(Y0),e._currentValue=t}function u2(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Bu(e,t){Z0=e,ny=ku=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Os=!0),e.firstContext=null)}function Ei(e){var t=e._currentValue;if(ny!==e)if(e={context:e,memoizedValue:t,next:null},ku===null){if(Z0===null)throw Error(tt(308));ku=e,Z0.dependencies={lanes:0,firstContext:e}}else ku=ku.next=e;return t}var gc=null;function ay(e){gc===null?gc=[e]:gc.push(e)}function t6(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,ay(t)):(r.next=s.next,s.next=r),t.interleaved=r,po(e,n)}function po(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Yo=!1;function oy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function r6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function io(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function dl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,rr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,po(e,r)}return s=n.interleaved,s===null?(t.next=t,ay(n)):(t.next=s.next,s.next=t),n.interleaved=t,po(e,r)}function m0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Hv(e,r)}}function w5(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function J0(e,t,r,n){var s=e.updateQueue;Yo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,h=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,b=l;switch(f=t,h=r,b.tag){case 1:if(x=b.payload,typeof x=="function"){m=x.call(h,m,f);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,f=typeof x=="function"?x.call(h,m,f):x,f==null)break e;m=Kr({},m,f);break e;case 2:Yo=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=m):d=d.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Lc|=o,e.lanes=o,e.memoizedState=m}}function _5(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(tt(191,s));s.call(n)}}}var Tf={},Sa=Ll(Tf),nf=Ll(Tf),sf=Ll(Tf);function xc(e){if(e===Tf)throw Error(tt(174));return e}function ly(e,t){switch(Ar(sf,t),Ar(nf,e),Ar(Sa,Tf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vx(t,e)}Or(Sa),Ar(Sa,t)}function ed(){Or(Sa),Or(nf),Or(sf)}function n6(e){xc(sf.current);var t=xc(Sa.current),r=Vx(t,e.type);t!==r&&(Ar(nf,e),Ar(Sa,r))}function cy(e){nf.current===e&&(Or(Sa),Or(nf))}var Wr=Ll(0);function X0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var d1=[];function uy(){for(var e=0;e<d1.length;e++)d1[e]._workInProgressVersionPrimary=null;d1.length=0}var p0=bo.ReactCurrentDispatcher,h1=bo.ReactCurrentBatchConfig,Ac=0,Gr=null,An=null,On=null,Q0=!1,Eh=!1,af=0,F7=0;function es(){throw Error(tt(321))}function dy(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ji(e[r],t[r]))return!1;return!0}function hy(e,t,r,n,s,i){if(Ac=i,Gr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,p0.current=e===null||e.memoizedState===null?U7:z7,e=r(n,s),Eh){i=0;do{if(Eh=!1,af=0,25<=i)throw Error(tt(301));i+=1,On=An=null,t.updateQueue=null,p0.current=q7,e=r(n,s)}while(Eh)}if(p0.current=ep,t=An!==null&&An.next!==null,Ac=0,On=An=Gr=null,Q0=!1,t)throw Error(tt(300));return e}function fy(){var e=af!==0;return af=0,e}function xa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?Gr.memoizedState=On=e:On=On.next=e,On}function Ai(){if(An===null){var e=Gr.alternate;e=e!==null?e.memoizedState:null}else e=An.next;var t=On===null?Gr.memoizedState:On.next;if(t!==null)On=t,An=e;else{if(e===null)throw Error(tt(310));An=e,e={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},On===null?Gr.memoizedState=On=e:On=On.next=e}return On}function of(e,t){return typeof t=="function"?t(e):t}function f1(e){var t=Ai(),r=t.queue;if(r===null)throw Error(tt(311));r.lastRenderedReducer=e;var n=An,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Ac&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=n):c=c.next=m,Gr.lanes|=d,Lc|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,Ji(n,t.memoizedState)||(Os=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Gr.lanes|=i,Lc|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function m1(e){var t=Ai(),r=t.queue;if(r===null)throw Error(tt(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Ji(i,t.memoizedState)||(Os=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function s6(){}function i6(e,t){var r=Gr,n=Ai(),s=t(),i=!Ji(n.memoizedState,s);if(i&&(n.memoizedState=s,Os=!0),n=n.queue,my(l6.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||On!==null&&On.memoizedState.tag&1){if(r.flags|=2048,lf(9,o6.bind(null,r,n,s,t),void 0,null),Dn===null)throw Error(tt(349));Ac&30||a6(r,t,s)}return s}function a6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Gr.updateQueue,t===null?(t={lastEffect:null,stores:null},Gr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function o6(e,t,r,n){t.value=r,t.getSnapshot=n,c6(t)&&u6(e)}function l6(e,t,r){return r(function(){c6(t)&&u6(e)})}function c6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ji(e,r)}catch{return!0}}function u6(e){var t=po(e,1);t!==null&&Zi(t,e,1,-1)}function j5(e){var t=xa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:of,lastRenderedState:e},t.queue=e,e=e.dispatch=B7.bind(null,Gr,e),[t.memoizedState,e]}function lf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Gr.updateQueue,t===null?(t={lastEffect:null,stores:null},Gr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function d6(){return Ai().memoizedState}function g0(e,t,r,n){var s=xa();Gr.flags|=e,s.memoizedState=lf(1|t,r,void 0,n===void 0?null:n)}function Dp(e,t,r,n){var s=Ai();n=n===void 0?null:n;var i=void 0;if(An!==null){var o=An.memoizedState;if(i=o.destroy,n!==null&&dy(n,o.deps)){s.memoizedState=lf(t,r,i,n);return}}Gr.flags|=e,s.memoizedState=lf(1|t,r,i,n)}function N5(e,t){return g0(8390656,8,e,t)}function my(e,t){return Dp(2048,8,e,t)}function h6(e,t){return Dp(4,2,e,t)}function f6(e,t){return Dp(4,4,e,t)}function m6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function p6(e,t,r){return r=r!=null?r.concat([e]):null,Dp(4,4,m6.bind(null,t,e),r)}function py(){}function g6(e,t){var r=Ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&dy(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function x6(e,t){var r=Ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&dy(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function v6(e,t,r){return Ac&21?(Ji(r,t)||(r=jN(),Gr.lanes|=r,Lc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Os=!0),e.memoizedState=r)}function D7(e,t){var r=vr;vr=r!==0&&4>r?r:4,e(!0);var n=h1.transition;h1.transition={};try{e(!1),t()}finally{vr=r,h1.transition=n}}function y6(){return Ai().memoizedState}function $7(e,t,r){var n=fl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},b6(e))w6(t,r);else if(r=t6(e,t,r,n),r!==null){var s=Ns();Zi(r,e,n,s),_6(r,t,n)}}function B7(e,t,r){var n=fl(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(b6(e))w6(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,Ji(l,o)){var c=t.interleaved;c===null?(s.next=s,ay(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=t6(e,t,s,n),r!==null&&(s=Ns(),Zi(r,e,n,s),_6(r,t,n))}}function b6(e){var t=e.alternate;return e===Gr||t!==null&&t===Gr}function w6(e,t){Eh=Q0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Hv(e,r)}}var ep={readContext:Ei,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},U7={readContext:Ei,useCallback:function(e,t){return xa().memoizedState=[e,t===void 0?null:t],e},useContext:Ei,useEffect:N5,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,g0(4194308,4,m6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return g0(4194308,4,e,t)},useInsertionEffect:function(e,t){return g0(4,2,e,t)},useMemo:function(e,t){var r=xa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=$7.bind(null,Gr,e),[n.memoizedState,e]},useRef:function(e){var t=xa();return e={current:e},t.memoizedState=e},useState:j5,useDebugValue:py,useDeferredValue:function(e){return xa().memoizedState=e},useTransition:function(){var e=j5(!1),t=e[0];return e=D7.bind(null,e[1]),xa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Gr,s=xa();if(Br){if(r===void 0)throw Error(tt(407));r=r()}else{if(r=t(),Dn===null)throw Error(tt(349));Ac&30||a6(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,N5(l6.bind(null,n,i,e),[e]),n.flags|=2048,lf(9,o6.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=xa(),t=Dn.identifierPrefix;if(Br){var r=to,n=eo;r=(n&~(1<<32-Yi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=af++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=F7++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},z7={readContext:Ei,useCallback:g6,useContext:Ei,useEffect:my,useImperativeHandle:p6,useInsertionEffect:h6,useLayoutEffect:f6,useMemo:x6,useReducer:f1,useRef:d6,useState:function(){return f1(of)},useDebugValue:py,useDeferredValue:function(e){var t=Ai();return v6(t,An.memoizedState,e)},useTransition:function(){var e=f1(of)[0],t=Ai().memoizedState;return[e,t]},useMutableSource:s6,useSyncExternalStore:i6,useId:y6,unstable_isNewReconciler:!1},q7={readContext:Ei,useCallback:g6,useContext:Ei,useEffect:my,useImperativeHandle:p6,useInsertionEffect:h6,useLayoutEffect:f6,useMemo:x6,useReducer:m1,useRef:d6,useState:function(){return m1(of)},useDebugValue:py,useDeferredValue:function(e){var t=Ai();return An===null?t.memoizedState=e:v6(t,An.memoizedState,e)},useTransition:function(){var e=m1(of)[0],t=Ai().memoizedState;return[e,t]},useMutableSource:s6,useSyncExternalStore:i6,useId:y6,unstable_isNewReconciler:!1};function Vi(e,t){if(e&&e.defaultProps){t=Kr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function d2(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Kr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var $p={isMounted:function(e){return(e=e._reactInternals)?$c(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ns(),s=fl(e),i=io(n,s);i.payload=t,r!=null&&(i.callback=r),t=dl(e,i,s),t!==null&&(Zi(t,e,s,n),m0(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ns(),s=fl(e),i=io(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=dl(e,i,s),t!==null&&(Zi(t,e,s,n),m0(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ns(),n=fl(e),s=io(r,n);s.tag=2,t!=null&&(s.callback=t),t=dl(e,s,n),t!==null&&(Zi(t,e,n,r),m0(t,e,n))}};function S5(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Qh(r,n)||!Qh(s,i):!0}function j6(e,t,r){var n=!1,s=_l,i=t.contextType;return typeof i=="object"&&i!==null?i=Ei(i):(s=Ds(t)?Cc:ds.current,n=t.contextTypes,i=(n=n!=null)?Ju(e,s):_l),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$p,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function k5(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&$p.enqueueReplaceState(t,t.state,null)}function h2(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},oy(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Ei(i):(i=Ds(t)?Cc:ds.current,s.context=Ju(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(d2(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&$p.enqueueReplaceState(s,s.state,null),J0(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function td(e,t){try{var r="",n=t;do r+=xL(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function p1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function f2(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var V7=typeof WeakMap=="function"?WeakMap:Map;function N6(e,t,r){r=io(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){rp||(rp=!0,j2=n),f2(e,t)},r}function S6(e,t,r){r=io(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){f2(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){f2(e,t),typeof n!="function"&&(hl===null?hl=new Set([this]):hl.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function C5(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new V7;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=sP.bind(null,e,t,r),t.then(e,e))}function E5(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function A5(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=io(-1,1),t.tag=2,dl(r,t,1))),r.lanes|=1),e)}var W7=bo.ReactCurrentOwner,Os=!1;function ws(e,t,r,n){t.child=e===null?e6(t,null,r,n):Qu(t,e.child,r,n)}function L5(e,t,r,n,s){r=r.render;var i=t.ref;return Bu(t,s),n=hy(e,t,r,n,i,s),r=fy(),e!==null&&!Os?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,go(e,t,s)):(Br&&r&&ey(t),t.flags|=1,ws(e,t,n,s),t.child)}function P5(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!jy(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,k6(e,t,i,n,s)):(e=b0(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Qh,r(o,n)&&e.ref===t.ref)return go(e,t,s)}return t.flags|=1,e=ml(i,n),e.ref=t.ref,e.return=t,t.child=e}function k6(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Qh(i,n)&&e.ref===t.ref)if(Os=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Os=!0);else return t.lanes=e.lanes,go(e,t,s)}return m2(e,t,r,n,s)}function C6(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ar(Eu,ei),ei|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ar(Eu,ei),ei|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ar(Eu,ei),ei|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Ar(Eu,ei),ei|=n;return ws(e,t,s,r),t.child}function E6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function m2(e,t,r,n,s){var i=Ds(r)?Cc:ds.current;return i=Ju(t,i),Bu(t,s),r=hy(e,t,r,n,i,s),n=fy(),e!==null&&!Os?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,go(e,t,s)):(Br&&n&&ey(t),t.flags|=1,ws(e,t,r,s),t.child)}function T5(e,t,r,n,s){if(Ds(r)){var i=!0;H0(t)}else i=!1;if(Bu(t,s),t.stateNode===null)x0(e,t),j6(t,r,n),h2(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ei(u):(u=Ds(r)?Cc:ds.current,u=Ju(t,u));var d=r.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&k5(t,o,n,u),Yo=!1;var f=t.memoizedState;o.state=f,J0(t,n,o,s),c=t.memoizedState,l!==n||f!==c||Fs.current||Yo?(typeof d=="function"&&(d2(t,r,d,n),c=t.memoizedState),(l=Yo||S5(t,r,l,n,f,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,r6(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Vi(t.type,l),o.props=u,m=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ei(c):(c=Ds(r)?Cc:ds.current,c=Ju(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||f!==c)&&k5(t,o,n,c),Yo=!1,f=t.memoizedState,o.state=f,J0(t,n,o,s);var x=t.memoizedState;l!==m||f!==x||Fs.current||Yo?(typeof h=="function"&&(d2(t,r,h,n),x=t.memoizedState),(u=Yo||S5(t,r,u,n,f,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return p2(e,t,r,n,i,s)}function p2(e,t,r,n,s,i){E6(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&x5(t,r,!1),go(e,t,i);n=t.stateNode,W7.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Qu(t,e.child,null,i),t.child=Qu(t,null,l,i)):ws(e,t,l,i),t.memoizedState=n.state,s&&x5(t,r,!0),t.child}function A6(e){var t=e.stateNode;t.pendingContext?g5(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g5(e,t.context,!1),ly(e,t.containerInfo)}function I5(e,t,r,n,s){return Xu(),ry(s),t.flags|=256,ws(e,t,r,n),t.child}var g2={dehydrated:null,treeContext:null,retryLane:0};function x2(e){return{baseLanes:e,cachePool:null,transitions:null}}function L6(e,t,r){var n=t.pendingProps,s=Wr.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ar(Wr,s&1),e===null)return c2(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=zp(o,n,0,null),e=Sc(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=x2(r),t.memoizedState=g2,e):gy(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return H7(e,t,o,n,l,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ml(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=ml(l,i):(i=Sc(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?x2(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=g2,n}return i=e.child,e=i.sibling,n=ml(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function gy(e,t){return t=zp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Fm(e,t,r,n){return n!==null&&ry(n),Qu(t,e.child,null,r),e=gy(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function H7(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=p1(Error(tt(422))),Fm(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=zp({mode:"visible",children:n.children},s,0,null),i=Sc(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Qu(t,e.child,null,o),t.child.memoizedState=x2(o),t.memoizedState=g2,i);if(!(t.mode&1))return Fm(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(tt(419)),n=p1(i,n,void 0),Fm(e,t,o,n)}if(l=(o&e.childLanes)!==0,Os||l){if(n=Dn,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,po(e,s),Zi(n,e,s,-1))}return _y(),n=p1(Error(tt(421))),Fm(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=iP.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ri=ul(s.nextSibling),ii=t,Br=!0,Gi=null,e!==null&&(_i[ji++]=eo,_i[ji++]=to,_i[ji++]=Ec,eo=e.id,to=e.overflow,Ec=t),t=gy(t,n.children),t.flags|=4096,t)}function M5(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),u2(e.return,t,r)}function g1(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function P6(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(ws(e,t,n.children,r),n=Wr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&M5(e,r,t);else if(e.tag===19)M5(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ar(Wr,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&X0(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),g1(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&X0(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}g1(t,!0,r,null,i);break;case"together":g1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function x0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function go(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Lc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(tt(153));if(t.child!==null){for(e=t.child,r=ml(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ml(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function G7(e,t,r){switch(t.tag){case 3:A6(t),Xu();break;case 5:n6(t);break;case 1:Ds(t.type)&&H0(t);break;case 4:ly(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ar(Y0,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ar(Wr,Wr.current&1),t.flags|=128,null):r&t.child.childLanes?L6(e,t,r):(Ar(Wr,Wr.current&1),e=go(e,t,r),e!==null?e.sibling:null);Ar(Wr,Wr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return P6(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ar(Wr,Wr.current),n)break;return null;case 22:case 23:return t.lanes=0,C6(e,t,r)}return go(e,t,r)}var T6,v2,I6,M6;T6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};v2=function(){};I6=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,xc(Sa.current);var i=null;switch(r){case"input":s=Bx(e,s),n=Bx(e,n),i=[];break;case"select":s=Kr({},s,{value:void 0}),n=Kr({},n,{value:void 0}),i=[];break;case"textarea":s=qx(e,s),n=qx(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=V0)}Wx(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Hh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Hh.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ir("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};M6=function(e,t,r,n){r!==n&&(t.flags|=4)};function nh(e,t){if(!Br)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ts(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function K7(e,t,r){var n=t.pendingProps;switch(ty(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(t),null;case 1:return Ds(t.type)&&W0(),ts(t),null;case 3:return n=t.stateNode,ed(),Or(Fs),Or(ds),uy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Om(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gi!==null&&(k2(Gi),Gi=null))),v2(e,t),ts(t),null;case 5:cy(t);var s=xc(sf.current);if(r=t.type,e!==null&&t.stateNode!=null)I6(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(tt(166));return ts(t),null}if(e=xc(Sa.current),Om(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ya]=t,n[rf]=i,e=(t.mode&1)!==0,r){case"dialog":Ir("cancel",n),Ir("close",n);break;case"iframe":case"object":case"embed":Ir("load",n);break;case"video":case"audio":for(s=0;s<ph.length;s++)Ir(ph[s],n);break;case"source":Ir("error",n);break;case"img":case"image":case"link":Ir("error",n),Ir("load",n);break;case"details":Ir("toggle",n);break;case"input":qw(n,i),Ir("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ir("invalid",n);break;case"textarea":Ww(n,i),Ir("invalid",n)}Wx(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Mm(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Mm(n.textContent,l,e),s=["children",""+l]):Hh.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ir("scroll",n)}switch(r){case"input":km(n),Vw(n,i,!0);break;case"textarea":km(n),Hw(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=V0)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lN(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ya]=t,e[rf]=n,T6(e,t,!1,!1),t.stateNode=e;e:{switch(o=Hx(r,n),r){case"dialog":Ir("cancel",e),Ir("close",e),s=n;break;case"iframe":case"object":case"embed":Ir("load",e),s=n;break;case"video":case"audio":for(s=0;s<ph.length;s++)Ir(ph[s],e);s=n;break;case"source":Ir("error",e),s=n;break;case"img":case"image":case"link":Ir("error",e),Ir("load",e),s=n;break;case"details":Ir("toggle",e),s=n;break;case"input":qw(e,n),s=Bx(e,n),Ir("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Kr({},n,{value:void 0}),Ir("invalid",e);break;case"textarea":Ww(e,n),s=qx(e,n),Ir("invalid",e);break;default:s=n}Wx(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?dN(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&cN(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Gh(e,c):typeof c=="number"&&Gh(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Hh.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ir("scroll",e):c!=null&&Bv(e,i,c,o))}switch(r){case"input":km(e),Vw(e,n,!1);break;case"textarea":km(e),Hw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+wl(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ru(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ru(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=V0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ts(t),null;case 6:if(e&&t.stateNode!=null)M6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(tt(166));if(r=xc(sf.current),xc(Sa.current),Om(t)){if(n=t.stateNode,r=t.memoizedProps,n[ya]=t,(i=n.nodeValue!==r)&&(e=ii,e!==null))switch(e.tag){case 3:Mm(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Mm(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ya]=t,t.stateNode=n}return ts(t),null;case 13:if(Or(Wr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Br&&ri!==null&&t.mode&1&&!(t.flags&128))XN(),Xu(),t.flags|=98560,i=!1;else if(i=Om(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(tt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(tt(317));i[ya]=t}else Xu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ts(t),i=!1}else Gi!==null&&(k2(Gi),Gi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Wr.current&1?Ln===0&&(Ln=3):_y())),t.updateQueue!==null&&(t.flags|=4),ts(t),null);case 4:return ed(),v2(e,t),e===null&&ef(t.stateNode.containerInfo),ts(t),null;case 10:return iy(t.type._context),ts(t),null;case 17:return Ds(t.type)&&W0(),ts(t),null;case 19:if(Or(Wr),i=t.memoizedState,i===null)return ts(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)nh(i,!1);else{if(Ln!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=X0(e),o!==null){for(t.flags|=128,nh(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ar(Wr,Wr.current&1|2),t.child}e=e.sibling}i.tail!==null&&un()>rd&&(t.flags|=128,n=!0,nh(i,!1),t.lanes=4194304)}else{if(!n)if(e=X0(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),nh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Br)return ts(t),null}else 2*un()-i.renderingStartTime>rd&&r!==1073741824&&(t.flags|=128,n=!0,nh(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=un(),t.sibling=null,r=Wr.current,Ar(Wr,n?r&1|2:r&1),t):(ts(t),null);case 22:case 23:return wy(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ei&1073741824&&(ts(t),t.subtreeFlags&6&&(t.flags|=8192)):ts(t),null;case 24:return null;case 25:return null}throw Error(tt(156,t.tag))}function Y7(e,t){switch(ty(t),t.tag){case 1:return Ds(t.type)&&W0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ed(),Or(Fs),Or(ds),uy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return cy(t),null;case 13:if(Or(Wr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(tt(340));Xu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Or(Wr),null;case 4:return ed(),null;case 10:return iy(t.type._context),null;case 22:case 23:return wy(),null;case 24:return null;default:return null}}var Dm=!1,cs=!1,Z7=typeof WeakSet=="function"?WeakSet:Set,gt=null;function Cu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rn(e,t,n)}else r.current=null}function y2(e,t,r){try{r()}catch(n){rn(e,t,n)}}var O5=!1;function J7(e,t){if(r2=U0,e=$N(),Qv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=e,f=null;t:for(;;){for(var h;m!==r||s!==0&&m.nodeType!==3||(l=o+s),m!==i||n!==0&&m.nodeType!==3||(c=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(h=m.firstChild)!==null;)f=m,m=h;for(;;){if(m===e)break t;if(f===r&&++u===s&&(l=o),f===i&&++d===n&&(c=o),(h=m.nextSibling)!==null)break;m=f,f=m.parentNode}m=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(n2={focusedElem:e,selectionRange:r},U0=!1,gt=t;gt!==null;)if(t=gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,gt=e;else for(;gt!==null;){t=gt;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,j=x.memoizedState,y=t.stateNode,_=y.getSnapshotBeforeUpdate(t.elementType===t.type?b:Vi(t.type,b),j);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(tt(163))}}catch(S){rn(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,gt=e;break}gt=t.return}return x=O5,O5=!1,x}function Ah(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&y2(t,r,i)}s=s.next}while(s!==n)}}function Bp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function b2(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function O6(e){var t=e.alternate;t!==null&&(e.alternate=null,O6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ya],delete t[rf],delete t[a2],delete t[I7],delete t[M7])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function R6(e){return e.tag===5||e.tag===3||e.tag===4}function R5(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||R6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function w2(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=V0));else if(n!==4&&(e=e.child,e!==null))for(w2(e,t,r),e=e.sibling;e!==null;)w2(e,t,r),e=e.sibling}function _2(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(_2(e,t,r),e=e.sibling;e!==null;)_2(e,t,r),e=e.sibling}var Wn=null,Wi=!1;function Uo(e,t,r){for(r=r.child;r!==null;)F6(e,t,r),r=r.sibling}function F6(e,t,r){if(Na&&typeof Na.onCommitFiberUnmount=="function")try{Na.onCommitFiberUnmount(Tp,r)}catch{}switch(r.tag){case 5:cs||Cu(r,t);case 6:var n=Wn,s=Wi;Wn=null,Uo(e,t,r),Wn=n,Wi=s,Wn!==null&&(Wi?(e=Wn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Wn.removeChild(r.stateNode));break;case 18:Wn!==null&&(Wi?(e=Wn,r=r.stateNode,e.nodeType===8?c1(e.parentNode,r):e.nodeType===1&&c1(e,r),Jh(e)):c1(Wn,r.stateNode));break;case 4:n=Wn,s=Wi,Wn=r.stateNode.containerInfo,Wi=!0,Uo(e,t,r),Wn=n,Wi=s;break;case 0:case 11:case 14:case 15:if(!cs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&y2(r,t,o),s=s.next}while(s!==n)}Uo(e,t,r);break;case 1:if(!cs&&(Cu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){rn(r,t,l)}Uo(e,t,r);break;case 21:Uo(e,t,r);break;case 22:r.mode&1?(cs=(n=cs)||r.memoizedState!==null,Uo(e,t,r),cs=n):Uo(e,t,r);break;default:Uo(e,t,r)}}function F5(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Z7),t.forEach(function(n){var s=aP.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ui(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Wn=l.stateNode,Wi=!1;break e;case 3:Wn=l.stateNode.containerInfo,Wi=!0;break e;case 4:Wn=l.stateNode.containerInfo,Wi=!0;break e}l=l.return}if(Wn===null)throw Error(tt(160));F6(i,o,s),Wn=null,Wi=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){rn(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)D6(t,e),t=t.sibling}function D6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ui(t,e),ha(e),n&4){try{Ah(3,e,e.return),Bp(3,e)}catch(b){rn(e,e.return,b)}try{Ah(5,e,e.return)}catch(b){rn(e,e.return,b)}}break;case 1:Ui(t,e),ha(e),n&512&&r!==null&&Cu(r,r.return);break;case 5:if(Ui(t,e),ha(e),n&512&&r!==null&&Cu(r,r.return),e.flags&32){var s=e.stateNode;try{Gh(s,"")}catch(b){rn(e,e.return,b)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&aN(s,i),Hx(l,o);var u=Hx(l,i);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?dN(s,m):d==="dangerouslySetInnerHTML"?cN(s,m):d==="children"?Gh(s,m):Bv(s,d,m,u)}switch(l){case"input":Ux(s,i);break;case"textarea":oN(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Ru(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ru(s,!!i.multiple,i.defaultValue,!0):Ru(s,!!i.multiple,i.multiple?[]:"",!1))}s[rf]=i}catch(b){rn(e,e.return,b)}}break;case 6:if(Ui(t,e),ha(e),n&4){if(e.stateNode===null)throw Error(tt(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){rn(e,e.return,b)}}break;case 3:if(Ui(t,e),ha(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Jh(t.containerInfo)}catch(b){rn(e,e.return,b)}break;case 4:Ui(t,e),ha(e);break;case 13:Ui(t,e),ha(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(yy=un())),n&4&&F5(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(cs=(u=cs)||d,Ui(t,e),cs=u):Ui(t,e),ha(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(gt=e,d=e.child;d!==null;){for(m=gt=d;gt!==null;){switch(f=gt,h=f.child,f.tag){case 0:case 11:case 14:case 15:Ah(4,f,f.return);break;case 1:Cu(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(b){rn(n,r,b)}}break;case 5:Cu(f,f.return);break;case 22:if(f.memoizedState!==null){$5(m);continue}}h!==null?(h.return=f,gt=h):$5(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=uN("display",o))}catch(b){rn(e,e.return,b)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(b){rn(e,e.return,b)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Ui(t,e),ha(e),n&4&&F5(e);break;case 21:break;default:Ui(t,e),ha(e)}}function ha(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(R6(r)){var n=r;break e}r=r.return}throw Error(tt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Gh(s,""),n.flags&=-33);var i=R5(e);_2(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=R5(e);w2(e,l,o);break;default:throw Error(tt(161))}}catch(c){rn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function X7(e,t,r){gt=e,$6(e)}function $6(e,t,r){for(var n=(e.mode&1)!==0;gt!==null;){var s=gt,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Dm;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||cs;l=Dm;var u=cs;if(Dm=o,(cs=c)&&!u)for(gt=s;gt!==null;)o=gt,c=o.child,o.tag===22&&o.memoizedState!==null?B5(s):c!==null?(c.return=o,gt=c):B5(s);for(;i!==null;)gt=i,$6(i),i=i.sibling;gt=s,Dm=l,cs=u}D5(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,gt=i):D5(e)}}function D5(e){for(;gt!==null;){var t=gt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:cs||Bp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!cs)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Vi(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&_5(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}_5(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Jh(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(tt(163))}cs||t.flags&512&&b2(t)}catch(f){rn(t,t.return,f)}}if(t===e){gt=null;break}if(r=t.sibling,r!==null){r.return=t.return,gt=r;break}gt=t.return}}function $5(e){for(;gt!==null;){var t=gt;if(t===e){gt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,gt=r;break}gt=t.return}}function B5(e){for(;gt!==null;){var t=gt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Bp(4,t)}catch(c){rn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){rn(t,s,c)}}var i=t.return;try{b2(t)}catch(c){rn(t,i,c)}break;case 5:var o=t.return;try{b2(t)}catch(c){rn(t,o,c)}}}catch(c){rn(t,t.return,c)}if(t===e){gt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,gt=l;break}gt=t.return}}var Q7=Math.ceil,tp=bo.ReactCurrentDispatcher,xy=bo.ReactCurrentOwner,ki=bo.ReactCurrentBatchConfig,rr=0,Dn=null,yn=null,Kn=0,ei=0,Eu=Ll(0),Ln=0,cf=null,Lc=0,Up=0,vy=0,Lh=null,Is=null,yy=0,rd=1/0,Ka=null,rp=!1,j2=null,hl=null,$m=!1,nl=null,np=0,Ph=0,N2=null,v0=-1,y0=0;function Ns(){return rr&6?un():v0!==-1?v0:v0=un()}function fl(e){return e.mode&1?rr&2&&Kn!==0?Kn&-Kn:R7.transition!==null?(y0===0&&(y0=jN()),y0):(e=vr,e!==0||(e=window.event,e=e===void 0?16:LN(e.type)),e):1}function Zi(e,t,r,n){if(50<Ph)throw Ph=0,N2=null,Error(tt(185));Af(e,r,n),(!(rr&2)||e!==Dn)&&(e===Dn&&(!(rr&2)&&(Up|=r),Ln===4&&Qo(e,Kn)),$s(e,n),r===1&&rr===0&&!(t.mode&1)&&(rd=un()+500,Fp&&Pl()))}function $s(e,t){var r=e.callbackNode;RL(e,t);var n=B0(e,e===Dn?Kn:0);if(n===0)r!==null&&Yw(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Yw(r),t===1)e.tag===0?O7(U5.bind(null,e)):YN(U5.bind(null,e)),P7(function(){!(rr&6)&&Pl()}),r=null;else{switch(NN(n)){case 1:r=Wv;break;case 4:r=wN;break;case 16:r=$0;break;case 536870912:r=_N;break;default:r=$0}r=G6(r,B6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function B6(e,t){if(v0=-1,y0=0,rr&6)throw Error(tt(327));var r=e.callbackNode;if(Uu()&&e.callbackNode!==r)return null;var n=B0(e,e===Dn?Kn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=sp(e,n);else{t=n;var s=rr;rr|=2;var i=z6();(Dn!==e||Kn!==t)&&(Ka=null,rd=un()+500,Nc(e,t));do try{rP();break}catch(l){U6(e,l)}while(1);sy(),tp.current=i,rr=s,yn!==null?t=0:(Dn=null,Kn=0,t=Ln)}if(t!==0){if(t===2&&(s=Jx(e),s!==0&&(n=s,t=S2(e,s))),t===1)throw r=cf,Nc(e,0),Qo(e,n),$s(e,un()),r;if(t===6)Qo(e,n);else{if(s=e.current.alternate,!(n&30)&&!eP(s)&&(t=sp(e,n),t===2&&(i=Jx(e),i!==0&&(n=i,t=S2(e,i))),t===1))throw r=cf,Nc(e,0),Qo(e,n),$s(e,un()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(tt(345));case 2:ac(e,Is,Ka);break;case 3:if(Qo(e,n),(n&130023424)===n&&(t=yy+500-un(),10<t)){if(B0(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ns(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=i2(ac.bind(null,e,Is,Ka),t);break}ac(e,Is,Ka);break;case 4:if(Qo(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Yi(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=un()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Q7(n/1960))-n,10<n){e.timeoutHandle=i2(ac.bind(null,e,Is,Ka),n);break}ac(e,Is,Ka);break;case 5:ac(e,Is,Ka);break;default:throw Error(tt(329))}}}return $s(e,un()),e.callbackNode===r?B6.bind(null,e):null}function S2(e,t){var r=Lh;return e.current.memoizedState.isDehydrated&&(Nc(e,t).flags|=256),e=sp(e,t),e!==2&&(t=Is,Is=r,t!==null&&k2(t)),e}function k2(e){Is===null?Is=e:Is.push.apply(Is,e)}function eP(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ji(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qo(e,t){for(t&=~vy,t&=~Up,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yi(t),n=1<<r;e[r]=-1,t&=~n}}function U5(e){if(rr&6)throw Error(tt(327));Uu();var t=B0(e,0);if(!(t&1))return $s(e,un()),null;var r=sp(e,t);if(e.tag!==0&&r===2){var n=Jx(e);n!==0&&(t=n,r=S2(e,n))}if(r===1)throw r=cf,Nc(e,0),Qo(e,t),$s(e,un()),r;if(r===6)throw Error(tt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ac(e,Is,Ka),$s(e,un()),null}function by(e,t){var r=rr;rr|=1;try{return e(t)}finally{rr=r,rr===0&&(rd=un()+500,Fp&&Pl())}}function Pc(e){nl!==null&&nl.tag===0&&!(rr&6)&&Uu();var t=rr;rr|=1;var r=ki.transition,n=vr;try{if(ki.transition=null,vr=1,e)return e()}finally{vr=n,ki.transition=r,rr=t,!(rr&6)&&Pl()}}function wy(){ei=Eu.current,Or(Eu)}function Nc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,L7(r)),yn!==null)for(r=yn.return;r!==null;){var n=r;switch(ty(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&W0();break;case 3:ed(),Or(Fs),Or(ds),uy();break;case 5:cy(n);break;case 4:ed();break;case 13:Or(Wr);break;case 19:Or(Wr);break;case 10:iy(n.type._context);break;case 22:case 23:wy()}r=r.return}if(Dn=e,yn=e=ml(e.current,null),Kn=ei=t,Ln=0,cf=null,vy=Up=Lc=0,Is=Lh=null,gc!==null){for(t=0;t<gc.length;t++)if(r=gc[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}gc=null}return e}function U6(e,t){do{var r=yn;try{if(sy(),p0.current=ep,Q0){for(var n=Gr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Q0=!1}if(Ac=0,On=An=Gr=null,Eh=!1,af=0,xy.current=null,r===null||r.return===null){Ln=1,cf=t,yn=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Kn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=E5(o);if(h!==null){h.flags&=-257,A5(h,o,l,i,t),h.mode&1&&C5(i,u,t),t=h,c=u;var x=t.updateQueue;if(x===null){var b=new Set;b.add(c),t.updateQueue=b}else x.add(c);break e}else{if(!(t&1)){C5(i,u,t),_y();break e}c=Error(tt(426))}}else if(Br&&l.mode&1){var j=E5(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),A5(j,o,l,i,t),ry(td(c,l));break e}}i=c=td(c,l),Ln!==4&&(Ln=2),Lh===null?Lh=[i]:Lh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=N6(i,c,t);w5(i,y);break e;case 1:l=c;var _=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(hl===null||!hl.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=S6(i,l,t);w5(i,S);break e}}i=i.return}while(i!==null)}V6(r)}catch(E){t=E,yn===r&&r!==null&&(yn=r=r.return);continue}break}while(1)}function z6(){var e=tp.current;return tp.current=ep,e===null?ep:e}function _y(){(Ln===0||Ln===3||Ln===2)&&(Ln=4),Dn===null||!(Lc&268435455)&&!(Up&268435455)||Qo(Dn,Kn)}function sp(e,t){var r=rr;rr|=2;var n=z6();(Dn!==e||Kn!==t)&&(Ka=null,Nc(e,t));do try{tP();break}catch(s){U6(e,s)}while(1);if(sy(),rr=r,tp.current=n,yn!==null)throw Error(tt(261));return Dn=null,Kn=0,Ln}function tP(){for(;yn!==null;)q6(yn)}function rP(){for(;yn!==null&&!CL();)q6(yn)}function q6(e){var t=H6(e.alternate,e,ei);e.memoizedProps=e.pendingProps,t===null?V6(e):yn=t,xy.current=null}function V6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Y7(r,t),r!==null){r.flags&=32767,yn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ln=6,yn=null;return}}else if(r=K7(r,t,ei),r!==null){yn=r;return}if(t=t.sibling,t!==null){yn=t;return}yn=t=e}while(t!==null);Ln===0&&(Ln=5)}function ac(e,t,r){var n=vr,s=ki.transition;try{ki.transition=null,vr=1,nP(e,t,r,n)}finally{ki.transition=s,vr=n}return null}function nP(e,t,r,n){do Uu();while(nl!==null);if(rr&6)throw Error(tt(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(tt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(FL(e,i),e===Dn&&(yn=Dn=null,Kn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$m||($m=!0,G6($0,function(){return Uu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ki.transition,ki.transition=null;var o=vr;vr=1;var l=rr;rr|=4,xy.current=null,J7(e,r),D6(r,e),j7(n2),U0=!!r2,n2=r2=null,e.current=r,X7(r),EL(),rr=l,vr=o,ki.transition=i}else e.current=r;if($m&&($m=!1,nl=e,np=s),i=e.pendingLanes,i===0&&(hl=null),PL(r.stateNode),$s(e,un()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(rp)throw rp=!1,e=j2,j2=null,e;return np&1&&e.tag!==0&&Uu(),i=e.pendingLanes,i&1?e===N2?Ph++:(Ph=0,N2=e):Ph=0,Pl(),null}function Uu(){if(nl!==null){var e=NN(np),t=ki.transition,r=vr;try{if(ki.transition=null,vr=16>e?16:e,nl===null)var n=!1;else{if(e=nl,nl=null,np=0,rr&6)throw Error(tt(331));var s=rr;for(rr|=4,gt=e.current;gt!==null;){var i=gt,o=i.child;if(gt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(gt=u;gt!==null;){var d=gt;switch(d.tag){case 0:case 11:case 15:Ah(8,d,i)}var m=d.child;if(m!==null)m.return=d,gt=m;else for(;gt!==null;){d=gt;var f=d.sibling,h=d.return;if(O6(d),d===u){gt=null;break}if(f!==null){f.return=h,gt=f;break}gt=h}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var j=b.sibling;b.sibling=null,b=j}while(b!==null)}}gt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,gt=o;else e:for(;gt!==null;){if(i=gt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ah(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,gt=y;break e}gt=i.return}}var _=e.current;for(gt=_;gt!==null;){o=gt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,gt=w;else e:for(o=_;gt!==null;){if(l=gt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Bp(9,l)}}catch(E){rn(l,l.return,E)}if(l===o){gt=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,gt=S;break e}gt=l.return}}if(rr=s,Pl(),Na&&typeof Na.onPostCommitFiberRoot=="function")try{Na.onPostCommitFiberRoot(Tp,e)}catch{}n=!0}return n}finally{vr=r,ki.transition=t}}return!1}function z5(e,t,r){t=td(r,t),t=N6(e,t,1),e=dl(e,t,1),t=Ns(),e!==null&&(Af(e,1,t),$s(e,t))}function rn(e,t,r){if(e.tag===3)z5(e,e,r);else for(;t!==null;){if(t.tag===3){z5(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(hl===null||!hl.has(n))){e=td(r,e),e=S6(t,e,1),t=dl(t,e,1),e=Ns(),t!==null&&(Af(t,1,e),$s(t,e));break}}t=t.return}}function sP(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ns(),e.pingedLanes|=e.suspendedLanes&r,Dn===e&&(Kn&r)===r&&(Ln===4||Ln===3&&(Kn&130023424)===Kn&&500>un()-yy?Nc(e,0):vy|=r),$s(e,t)}function W6(e,t){t===0&&(e.mode&1?(t=Am,Am<<=1,!(Am&130023424)&&(Am=4194304)):t=1);var r=Ns();e=po(e,t),e!==null&&(Af(e,t,r),$s(e,r))}function iP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),W6(e,r)}function aP(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(tt(314))}n!==null&&n.delete(t),W6(e,r)}var H6;H6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Fs.current)Os=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Os=!1,G7(e,t,r);Os=!!(e.flags&131072)}else Os=!1,Br&&t.flags&1048576&&ZN(t,K0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;x0(e,t),e=t.pendingProps;var s=Ju(t,ds.current);Bu(t,r),s=hy(null,t,n,e,s,r);var i=fy();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ds(n)?(i=!0,H0(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,oy(t),s.updater=$p,t.stateNode=s,s._reactInternals=t,h2(t,n,e,r),t=p2(null,t,n,!0,i,r)):(t.tag=0,Br&&i&&ey(t),ws(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(x0(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=lP(n),e=Vi(n,e),s){case 0:t=m2(null,t,n,e,r);break e;case 1:t=T5(null,t,n,e,r);break e;case 11:t=L5(null,t,n,e,r);break e;case 14:t=P5(null,t,n,Vi(n.type,e),r);break e}throw Error(tt(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),m2(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),T5(e,t,n,s,r);case 3:e:{if(A6(t),e===null)throw Error(tt(387));n=t.pendingProps,i=t.memoizedState,s=i.element,r6(e,t),J0(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=td(Error(tt(423)),t),t=I5(e,t,n,r,s);break e}else if(n!==s){s=td(Error(tt(424)),t),t=I5(e,t,n,r,s);break e}else for(ri=ul(t.stateNode.containerInfo.firstChild),ii=t,Br=!0,Gi=null,r=e6(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xu(),n===s){t=go(e,t,r);break e}ws(e,t,n,r)}t=t.child}return t;case 5:return n6(t),e===null&&c2(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,s2(n,s)?o=null:i!==null&&s2(n,i)&&(t.flags|=32),E6(e,t),ws(e,t,o,r),t.child;case 6:return e===null&&c2(t),null;case 13:return L6(e,t,r);case 4:return ly(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Qu(t,null,n,r):ws(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),L5(e,t,n,s,r);case 7:return ws(e,t,t.pendingProps,r),t.child;case 8:return ws(e,t,t.pendingProps.children,r),t.child;case 12:return ws(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Ar(Y0,n._currentValue),n._currentValue=o,i!==null)if(Ji(i.value,o)){if(i.children===s.children&&!Fs.current){t=go(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=io(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),u2(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(tt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),u2(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ws(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Bu(t,r),s=Ei(s),n=n(s),t.flags|=1,ws(e,t,n,r),t.child;case 14:return n=t.type,s=Vi(n,t.pendingProps),s=Vi(n.type,s),P5(e,t,n,s,r);case 15:return k6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),x0(e,t),t.tag=1,Ds(n)?(e=!0,H0(t)):e=!1,Bu(t,r),j6(t,n,s),h2(t,n,s,r),p2(null,t,n,!0,e,r);case 19:return P6(e,t,r);case 22:return C6(e,t,r)}throw Error(tt(156,t.tag))};function G6(e,t){return bN(e,t)}function oP(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(e,t,r,n){return new oP(e,t,r,n)}function jy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function lP(e){if(typeof e=="function")return jy(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zv)return 11;if(e===qv)return 14}return 2}function ml(e,t){var r=e.alternate;return r===null?(r=Si(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function b0(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")jy(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case vu:return Sc(r.children,s,i,t);case Uv:o=8,s|=8;break;case Rx:return e=Si(12,r,t,s|2),e.elementType=Rx,e.lanes=i,e;case Fx:return e=Si(13,r,t,s),e.elementType=Fx,e.lanes=i,e;case Dx:return e=Si(19,r,t,s),e.elementType=Dx,e.lanes=i,e;case nN:return zp(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tN:o=10;break e;case rN:o=9;break e;case zv:o=11;break e;case qv:o=14;break e;case Ko:o=16,n=null;break e}throw Error(tt(130,e==null?e:typeof e,""))}return t=Si(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Sc(e,t,r,n){return e=Si(7,e,n,t),e.lanes=r,e}function zp(e,t,r,n){return e=Si(22,e,n,t),e.elementType=nN,e.lanes=r,e.stateNode={isHidden:!1},e}function x1(e,t,r){return e=Si(6,e,null,t),e.lanes=r,e}function v1(e,t,r){return t=Si(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function cP(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xg(0),this.expirationTimes=Xg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xg(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ny(e,t,r,n,s,i,o,l,c){return e=new cP(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Si(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},oy(i),e}function uP(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function K6(e){if(!e)return _l;e=e._reactInternals;e:{if($c(e)!==e||e.tag!==1)throw Error(tt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ds(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(tt(171))}if(e.tag===1){var r=e.type;if(Ds(r))return KN(e,r,t)}return t}function Y6(e,t,r,n,s,i,o,l,c){return e=Ny(r,n,!0,e,s,i,o,l,c),e.context=K6(null),r=e.current,n=Ns(),s=fl(r),i=io(n,s),i.callback=t??null,dl(r,i,s),e.current.lanes=s,Af(e,s,n),$s(e,n),e}function qp(e,t,r,n){var s=t.current,i=Ns(),o=fl(s);return r=K6(r),t.context===null?t.context=r:t.pendingContext=r,t=io(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=dl(s,t,o),e!==null&&(Zi(e,s,o,i),m0(e,s,o)),o}function ip(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function q5(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Sy(e,t){q5(e,t),(e=e.alternate)&&q5(e,t)}function dP(){return null}var Z6=typeof reportError=="function"?reportError:function(e){console.error(e)};function ky(e){this._internalRoot=e}Vp.prototype.render=ky.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(tt(409));qp(e,t,null,null)};Vp.prototype.unmount=ky.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Pc(function(){qp(null,e,null,null)}),t[mo]=null}};function Vp(e){this._internalRoot=e}Vp.prototype.unstable_scheduleHydration=function(e){if(e){var t=CN();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Xo.length&&t!==0&&t<Xo[r].priority;r++);Xo.splice(r,0,e),r===0&&AN(e)}};function Cy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function V5(){}function hP(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=ip(o);i.call(u)}}var o=Y6(t,n,e,0,null,!1,!1,"",V5);return e._reactRootContainer=o,e[mo]=o.current,ef(e.nodeType===8?e.parentNode:e),Pc(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=ip(c);l.call(u)}}var c=Ny(e,0,!1,null,null,!1,!1,"",V5);return e._reactRootContainer=c,e[mo]=c.current,ef(e.nodeType===8?e.parentNode:e),Pc(function(){qp(t,c,r,n)}),c}function Hp(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=ip(o);l.call(c)}}qp(t,o,e,s)}else o=hP(r,t,e,s,n);return ip(o)}SN=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=mh(t.pendingLanes);r!==0&&(Hv(t,r|1),$s(t,un()),!(rr&6)&&(rd=un()+500,Pl()))}break;case 13:Pc(function(){var n=po(e,1);if(n!==null){var s=Ns();Zi(n,e,1,s)}}),Sy(e,1)}};Gv=function(e){if(e.tag===13){var t=po(e,134217728);if(t!==null){var r=Ns();Zi(t,e,134217728,r)}Sy(e,134217728)}};kN=function(e){if(e.tag===13){var t=fl(e),r=po(e,t);if(r!==null){var n=Ns();Zi(r,e,t,n)}Sy(e,t)}};CN=function(){return vr};EN=function(e,t){var r=vr;try{return vr=e,t()}finally{vr=r}};Kx=function(e,t,r){switch(t){case"input":if(Ux(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Rp(n);if(!s)throw Error(tt(90));iN(n),Ux(n,s)}}}break;case"textarea":oN(e,r);break;case"select":t=r.value,t!=null&&Ru(e,!!r.multiple,t,!1)}};mN=by;pN=Pc;var fP={usingClientEntryPoint:!1,Events:[Pf,_u,Rp,hN,fN,by]},sh={findFiberByHostInstance:pc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mP={bundleType:sh.bundleType,version:sh.version,rendererPackageName:sh.rendererPackageName,rendererConfig:sh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vN(e),e===null?null:e.stateNode},findFiberByHostInstance:sh.findFiberByHostInstance||dP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bm.isDisabled&&Bm.supportsFiber)try{Tp=Bm.inject(mP),Na=Bm}catch{}}ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fP;ci.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cy(t))throw Error(tt(200));return uP(e,t,null,r)};ci.createRoot=function(e,t){if(!Cy(e))throw Error(tt(299));var r=!1,n="",s=Z6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ny(e,1,!1,null,null,r,!1,n,s),e[mo]=t.current,ef(e.nodeType===8?e.parentNode:e),new ky(t)};ci.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(tt(188)):(e=Object.keys(e).join(","),Error(tt(268,e)));return e=vN(t),e=e===null?null:e.stateNode,e};ci.flushSync=function(e){return Pc(e)};ci.hydrate=function(e,t,r){if(!Wp(t))throw Error(tt(200));return Hp(null,e,t,!0,r)};ci.hydrateRoot=function(e,t,r){if(!Cy(e))throw Error(tt(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=Z6;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Y6(t,null,e,1,r??null,s,!1,i,o),e[mo]=t.current,ef(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Vp(t)};ci.render=function(e,t,r){if(!Wp(t))throw Error(tt(200));return Hp(null,e,t,!1,r)};ci.unmountComponentAtNode=function(e){if(!Wp(e))throw Error(tt(40));return e._reactRootContainer?(Pc(function(){Hp(null,null,e,!1,function(){e._reactRootContainer=null,e[mo]=null})}),!0):!1};ci.unstable_batchedUpdates=by;ci.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Wp(r))throw Error(tt(200));if(e==null||e._reactInternals===void 0)throw Error(tt(38));return Hp(e,t,r,!1,n)};ci.version="18.3.1-next-f1338f8080-20240426";function J6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J6)}catch(e){console.error(e)}}J6(),J3.exports=ci;var Fn=J3.exports,W5=Fn;Mx.createRoot=W5.createRoot,Mx.hydrateRoot=W5.hydrateRoot;const pP="modulepreload",gP=function(e){return"/"+e},H5={},ao=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=gP(i),i in H5)return;H5[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const m=s[d];if(m.href===i&&(!o||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":pP,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,m)=>{u.addEventListener("load",d),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};var G5="popstate";function xP(e={}){function t(n,s){let{pathname:i,search:o,hash:l}=n.location;return C2("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:uf(s)}return yP(t,r,null,e)}function Ur(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Li(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function vP(){return Math.random().toString(36).substring(2,10)}function K5(e,t){return{usr:e.state,key:e.key,idx:t}}function C2(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?md(t):t,state:r,key:t&&t.key||n||vP()}}function uf({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function md(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function yP(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function m(){l="POP";let j=d(),y=j==null?null:j-u;u=j,c&&c({action:l,location:b.location,delta:y})}function f(j,y){l="PUSH";let _=C2(b.location,j,y);r&&r(_,j),u=d()+1;let w=K5(_,u),S=b.createHref(_);try{o.pushState(w,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(S)}i&&c&&c({action:l,location:b.location,delta:1})}function h(j,y){l="REPLACE";let _=C2(b.location,j,y);r&&r(_,j),u=d();let w=K5(_,u),S=b.createHref(_);o.replaceState(w,"",S),i&&c&&c({action:l,location:b.location,delta:0})}function x(j){return bP(j)}let b={get action(){return l},get location(){return e(s,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(G5,m),c=j,()=>{s.removeEventListener(G5,m),c=null}},createHref(j){return t(s,j)},createURL:x,encodeLocation(j){let y=x(j);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:h,go(j){return o.go(j)}};return b}function bP(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Ur(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:uf(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function X6(e,t,r="/"){return wP(e,t,r,!1)}function wP(e,t,r,n){let s=typeof t=="string"?md(t):t,i=xo(s.pathname||"/",r);if(i==null)return null;let o=Q6(e);_P(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=IP(i);l=PP(o[c],u,n)}return l}function Q6(e,t=[],r=[],n="",s=!1){let i=(o,l,c=s,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;Ur(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let m=oo([n,d.relativePath]),f=r.concat(d);o.children&&o.children.length>0&&(Ur(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Q6(o.children,t,f,m,c)),!(o.path==null&&!o.index)&&t.push({path:m,score:AP(m,o.index),routesMeta:f})};return e.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))i(o,l);else for(let u of eS(o.path))i(o,l,!0,u)}),t}function eS(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=eS(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function _P(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:LP(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var jP=/^:[\w-]+$/,NP=3,SP=2,kP=1,CP=10,EP=-2,Y5=e=>e==="*";function AP(e,t){let r=e.split("/"),n=r.length;return r.some(Y5)&&(n+=EP),t&&(n+=SP),r.filter(s=>!Y5(s)).reduce((s,i)=>s+(jP.test(i)?NP:i===""?kP:CP),n)}function LP(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function PP(e,t,r=!1){let{routesMeta:n}=e,s={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",m=ap({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!m&&u&&r&&!n[n.length-1].route.index&&(m=ap({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:oo([i,m.pathname]),pathnameBase:FP(oo([i,m.pathnameBase])),route:f}),m.pathnameBase!=="/"&&(i=oo([i,m.pathnameBase]))}return o}function ap(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=TP(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:m},f)=>{if(d==="*"){let x=l[f]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const h=l[f];return m&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function TP(e,t=!1,r=!0){Li(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function IP(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Li(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function xo(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function MP(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?md(e):e;return{pathname:r?r.startsWith("/")?r:OP(r,t):t,search:DP(n),hash:$P(s)}}function OP(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function y1(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function RP(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Ey(e){let t=RP(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Ay(e,t,r,n=!1){let s;typeof e=="string"?s=md(e):(s={...e},Ur(!s.pathname||!s.pathname.includes("?"),y1("?","pathname","search",s)),Ur(!s.pathname||!s.pathname.includes("#"),y1("#","pathname","hash",s)),Ur(!s.search||!s.search.includes("#"),y1("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),m-=1;s.pathname=f.join("/")}l=m>=0?t[m]:"/"}let c=MP(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var oo=e=>e.join("/").replace(/\/\/+/g,"/"),FP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),DP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,$P=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function BP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var tS=["POST","PUT","PATCH","DELETE"];new Set(tS);var UP=["GET",...tS];new Set(UP);var pd=g.createContext(null);pd.displayName="DataRouter";var Gp=g.createContext(null);Gp.displayName="DataRouterState";g.createContext(!1);var rS=g.createContext({isTransitioning:!1});rS.displayName="ViewTransition";var zP=g.createContext(new Map);zP.displayName="Fetchers";var qP=g.createContext(null);qP.displayName="Await";var ea=g.createContext(null);ea.displayName="Navigation";var If=g.createContext(null);If.displayName="Location";var Ti=g.createContext({outlet:null,matches:[],isDataRoute:!1});Ti.displayName="Route";var Ly=g.createContext(null);Ly.displayName="RouteError";function VP(e,{relative:t}={}){Ur(gd(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(ea),{hash:s,pathname:i,search:o}=Mf(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:oo([r,i])),n.createHref({pathname:l,search:o,hash:s})}function gd(){return g.useContext(If)!=null}function ta(){return Ur(gd(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(If).location}var nS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sS(e){g.useContext(ea).static||g.useLayoutEffect(e)}function ra(){let{isDataRoute:e}=g.useContext(Ti);return e?aT():WP()}function WP(){Ur(gd(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(pd),{basename:t,navigator:r}=g.useContext(ea),{matches:n}=g.useContext(Ti),{pathname:s}=ta(),i=JSON.stringify(Ey(n)),o=g.useRef(!1);return sS(()=>{o.current=!0}),g.useCallback((c,u={})=>{if(Li(o.current,nS),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=Ay(c,JSON.parse(i),s,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:oo([t,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[t,r,i,s,e])}var HP=g.createContext(null);function GP(e){let t=g.useContext(Ti).outlet;return t&&g.createElement(HP.Provider,{value:e},t)}function KP(){let{matches:e}=g.useContext(Ti),t=e[e.length-1];return t?t.params:{}}function Mf(e,{relative:t}={}){let{matches:r}=g.useContext(Ti),{pathname:n}=ta(),s=JSON.stringify(Ey(r));return g.useMemo(()=>Ay(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function YP(e,t){return iS(e,t)}function iS(e,t,r,n,s){var _;Ur(gd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=g.useContext(ea),{matches:o}=g.useContext(Ti),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";aS(u,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let f=ta(),h;if(t){let w=typeof t=="string"?md(t):t;Ur(d==="/"||((_=w.pathname)==null?void 0:_.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),h=w}else h=f;let x=h.pathname||"/",b=x;if(d!=="/"){let w=d.replace(/^\//,"").split("/");b="/"+x.replace(/^\//,"").split("/").slice(w.length).join("/")}let j=X6(e,{pathname:b});Li(m||j!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),Li(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=eT(j&&j.map(w=>Object.assign({},w,{params:Object.assign({},c,w.params),pathname:oo([d,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:oo([d,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n,s);return t&&y?g.createElement(If.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},y):y}function ZP(){let e=iT(),t=BP(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:i},"ErrorBoundary")," or"," ",g.createElement("code",{style:i},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),r?g.createElement("pre",{style:s},r):null,o)}var JP=g.createElement(ZP,null),XP=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?g.createElement(Ti.Provider,{value:this.props.routeContext},g.createElement(Ly.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function QP({routeContext:e,match:t,children:r}){let n=g.useContext(pd);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(Ti.Provider,{value:e},r)}function eT(e,t=[],r=null,n=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=r==null?void 0:r.errors;if(o!=null){let u=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);Ur(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(r)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:m,errors:f}=r,h=d.route.loader&&!m.hasOwnProperty(d.route.id)&&(!f||f[d.route.id]===void 0);if(d.route.lazy||h){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,m)=>{let f,h=!1,x=null,b=null;r&&(f=o&&d.route.id?o[d.route.id]:void 0,x=d.route.errorElement||JP,l&&(c<0&&m===0?(aS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,b=null):c===m&&(h=!0,b=d.route.hydrateFallbackElement||null)));let j=t.concat(i.slice(0,m+1)),y=()=>{let _;return f?_=x:h?_=b:d.route.Component?_=g.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=u,g.createElement(QP,{match:d,routeContext:{outlet:u,matches:j,isDataRoute:r!=null},children:_})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?g.createElement(XP,{location:r.location,revalidation:r.revalidation,component:x,error:f,children:y(),routeContext:{outlet:null,matches:j,isDataRoute:!0},unstable_onError:n}):y()},null)}function Py(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tT(e){let t=g.useContext(pd);return Ur(t,Py(e)),t}function rT(e){let t=g.useContext(Gp);return Ur(t,Py(e)),t}function nT(e){let t=g.useContext(Ti);return Ur(t,Py(e)),t}function Ty(e){let t=nT(e),r=t.matches[t.matches.length-1];return Ur(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function sT(){return Ty("useRouteId")}function iT(){var n;let e=g.useContext(Ly),t=rT("useRouteError"),r=Ty("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function aT(){let{router:e}=tT("useNavigate"),t=Ty("useNavigate"),r=g.useRef(!1);return sS(()=>{r.current=!0}),g.useCallback(async(s,i={})=>{Li(r.current,nS),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...i}))},[e,t])}var Z5={};function aS(e,t,r){!t&&!Z5[e]&&(Z5[e]=!0,Li(!1,r))}g.memo(oT);function oT({routes:e,future:t,state:r,unstable_onError:n}){return iS(e,void 0,r,n,t)}function lT({to:e,replace:t,state:r,relative:n}){Ur(gd(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=g.useContext(ea);Li(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=g.useContext(Ti),{pathname:o}=ta(),l=ra(),c=Ay(e,Ey(i),o,n==="path"),u=JSON.stringify(c);return g.useEffect(()=>{l(JSON.parse(u),{replace:t,state:r,relative:n})},[l,u,n,t,r]),null}function cT(e){return GP(e.context)}function vn(e){Ur(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function uT({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:i=!1}){Ur(!gd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof r=="string"&&(r=md(r));let{pathname:c="/",search:u="",hash:d="",state:m=null,key:f="default"}=r,h=g.useMemo(()=>{let x=xo(c,o);return x==null?null:{location:{pathname:x,search:u,hash:d,state:m,key:f},navigationType:n}},[o,c,u,d,m,f,n]);return Li(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(ea.Provider,{value:l},g.createElement(If.Provider,{children:t,value:h}))}function oS({children:e,location:t}){return YP(E2(e),t)}function E2(e,t=[]){let r=[];return g.Children.forEach(e,(n,s)=>{if(!g.isValidElement(n))return;let i=[...t,s];if(n.type===g.Fragment){r.push.apply(r,E2(n.props.children,i));return}Ur(n.type===vn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ur(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=E2(n.props.children,i)),r.push(o)}),r}var w0="get",_0="application/x-www-form-urlencoded";function Kp(e){return e!=null&&typeof e.tagName=="string"}function dT(e){return Kp(e)&&e.tagName.toLowerCase()==="button"}function hT(e){return Kp(e)&&e.tagName.toLowerCase()==="form"}function fT(e){return Kp(e)&&e.tagName.toLowerCase()==="input"}function mT(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function pT(e,t){return e.button===0&&(!t||t==="_self")&&!mT(e)}function A2(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function gT(e,t){let r=A2(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(i=>{r.append(s,i)})}),r}var Um=null;function xT(){if(Um===null)try{new FormData(document.createElement("form"),0),Um=!1}catch{Um=!0}return Um}var vT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function b1(e){return e!=null&&!vT.has(e)?(Li(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_0}"`),null):e}function yT(e,t){let r,n,s,i,o;if(hT(e)){let l=e.getAttribute("action");n=l?xo(l,t):null,r=e.getAttribute("method")||w0,s=b1(e.getAttribute("enctype"))||_0,i=new FormData(e)}else if(dT(e)||fT(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(n=c?xo(c,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||w0,s=b1(e.getAttribute("formenctype"))||b1(l.getAttribute("enctype"))||_0,i=new FormData(l,e),!xT()){let{name:u,type:d,value:m}=e;if(d==="image"){let f=u?`${u}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else u&&i.append(u,m)}}else{if(Kp(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=w0,n=null,s=_0,o=e}return i&&s==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Iy(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function bT(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&xo(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function wT(e,t){if(e.id in t)return t[e.id];try{let r=await ao(()=>import(e.module),[]);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _T(e){return e!=null&&typeof e.page=="string"}function jT(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function NT(e,t,r){let n=await Promise.all(e.map(async s=>{let i=t.routes[s.route.id];if(i){let o=await wT(i,r);return o.links?o.links():[]}return[]}));return ET(n.flat(1).filter(jT).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function J5(e,t,r,n,s,i){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,u)=>o(c,u)||l(c,u)):i==="data"?t.filter((c,u)=>{var m;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function ST(e,t,{includeHydrateFallback:r}={}){return kT(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function kT(e){return[...new Set(e)]}function CT(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function ET(e,t){let r=new Set,n=new Set(t);return e.reduce((s,i)=>{if(t&&!_T(i)&&i.as==="script"&&i.href&&n.has(i.href))return s;let l=JSON.stringify(CT(i));return r.has(l)||(r.add(l),s.push({key:l,link:i})),s},[])}function lS(){let e=g.useContext(pd);return Iy(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function AT(){let e=g.useContext(Gp);return Iy(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var My=g.createContext(void 0);My.displayName="FrameworkContext";function cS(){let e=g.useContext(My);return Iy(e,"You must render this element inside a <HydratedRouter> element"),e}function LT(e,t){let r=g.useContext(My),[n,s]=g.useState(!1),[i,o]=g.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:m}=t,f=g.useRef(null);g.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=y=>{y.forEach(_=>{o(_.isIntersecting)})},j=new IntersectionObserver(b,{threshold:.5});return f.current&&j.observe(f.current),()=>{j.disconnect()}}},[e]),g.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let h=()=>{s(!0)},x=()=>{s(!1),o(!1)};return r?e!=="intent"?[i,f,{}]:[i,f,{onFocus:ih(l,h),onBlur:ih(c,x),onMouseEnter:ih(u,h),onMouseLeave:ih(d,x),onTouchStart:ih(m,h)}]:[!1,f,{}]}function ih(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function PT({page:e,...t}){let{router:r}=lS(),n=g.useMemo(()=>X6(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?g.createElement(IT,{page:e,matches:n,...t}):null}function TT(e){let{manifest:t,routeModules:r}=cS(),[n,s]=g.useState([]);return g.useEffect(()=>{let i=!1;return NT(e,t,r).then(o=>{i||s(o)}),()=>{i=!0}},[e,t,r]),n}function IT({page:e,matches:t,...r}){let n=ta(),{manifest:s,routeModules:i}=cS(),{basename:o}=lS(),{loaderData:l,matches:c}=AT(),u=g.useMemo(()=>J5(e,t,c,s,n,"data"),[e,t,c,s,n]),d=g.useMemo(()=>J5(e,t,c,s,n,"assets"),[e,t,c,s,n]),m=g.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let x=new Set,b=!1;if(t.forEach(y=>{var w;let _=s.routes[y.route.id];!_||!_.hasLoader||(!u.some(S=>S.route.id===y.route.id)&&y.route.id in l&&((w=i[y.route.id])!=null&&w.shouldRevalidate)||_.hasClientLoader?b=!0:x.add(y.route.id))}),x.size===0)return[];let j=bT(e,o,"data");return b&&x.size>0&&j.searchParams.set("_routes",t.filter(y=>x.has(y.route.id)).map(y=>y.route.id).join(",")),[j.pathname+j.search]},[o,l,n,s,u,t,e,i]),f=g.useMemo(()=>ST(d,s),[d,s]),h=TT(d);return g.createElement(g.Fragment,null,m.map(x=>g.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...r})),f.map(x=>g.createElement("link",{key:x,rel:"modulepreload",href:x,...r})),h.map(({key:x,link:b})=>g.createElement("link",{key:x,nonce:r.nonce,...b})))}function MT(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var uS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uS&&(window.__reactRouterVersion="7.9.1")}catch{}function OT({basename:e,children:t,window:r}){let n=g.useRef();n.current==null&&(n.current=xP({window:r,v5Compat:!0}));let s=n.current,[i,o]=g.useState({action:s.action,location:s.location}),l=g.useCallback(c=>{g.startTransition(()=>o(c))},[o]);return g.useLayoutEffect(()=>s.listen(l),[s,l]),g.createElement(uT,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:s})}var dS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wi=g.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:m,...f},h){let{basename:x}=g.useContext(ea),b=typeof u=="string"&&dS.test(u),j,y=!1;if(typeof u=="string"&&b&&(j=u,uS))try{let T=new URL(window.location.href),D=u.startsWith("//")?new URL(T.protocol+u):new URL(u),C=xo(D.pathname,x);D.origin===T.origin&&C!=null?u=C+D.search+D.hash:y=!0}catch{Li(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=VP(u,{relative:s}),[w,S,E]=LT(n,f),$=$T(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:m});function U(T){t&&t(T),T.defaultPrevented||$(T)}let I=g.createElement("a",{...f,...E,href:j||_,onClick:y||i?t:U,ref:MT(h,S),target:c,"data-discover":!b&&r==="render"?"true":void 0});return w&&!b?g.createElement(g.Fragment,null,I,g.createElement(PT,{page:_})):I});wi.displayName="Link";var RT=g.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:l,children:c,...u},d){let m=Mf(o,{relative:u.relative}),f=ta(),h=g.useContext(Gp),{navigator:x,basename:b}=g.useContext(ea),j=h!=null&&WT(m)&&l===!0,y=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,_=f.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(_=_.toLowerCase(),w=w?w.toLowerCase():null,y=y.toLowerCase()),w&&b&&(w=xo(w,b)||w);const S=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let E=_===y||!s&&_.startsWith(y)&&_.charAt(S)==="/",$=w!=null&&(w===y||!s&&w.startsWith(y)&&w.charAt(y.length)==="/"),U={isActive:E,isPending:$,isTransitioning:j},I=E?t:void 0,T;typeof n=="function"?T=n(U):T=[n,E?"active":null,$?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let D=typeof i=="function"?i(U):i;return g.createElement(wi,{...u,"aria-current":I,className:T,ref:d,style:D,to:o,viewTransition:l},typeof c=="function"?c(U):c)});RT.displayName="NavLink";var FT=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:i,method:o=w0,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:m,...f},h)=>{let x=qT(),b=VT(l,{relative:u}),j=o.toLowerCase()==="get"?"get":"post",y=typeof l=="string"&&dS.test(l),_=w=>{if(c&&c(w),w.defaultPrevented)return;w.preventDefault();let S=w.nativeEvent.submitter,E=(S==null?void 0:S.getAttribute("formmethod"))||o;x(S||w.currentTarget,{fetcherKey:t,method:E,navigate:r,replace:s,state:i,relative:u,preventScrollReset:d,viewTransition:m})};return g.createElement("form",{ref:h,method:j,action:b,onSubmit:n?c:_,...f,"data-discover":!y&&e==="render"?"true":void 0})});FT.displayName="Form";function DT(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hS(e){let t=g.useContext(pd);return Ur(t,DT(e)),t}function $T(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=ra(),c=ta(),u=Mf(e,{relative:i});return g.useCallback(d=>{if(pT(d,t)){d.preventDefault();let m=r!==void 0?r:uf(c)===uf(u);l(e,{replace:m,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,u,r,n,t,e,s,i,o])}function BT(e){Li(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=g.useRef(A2(e)),r=g.useRef(!1),n=ta(),s=g.useMemo(()=>gT(n.search,r.current?null:t.current),[n.search]),i=ra(),o=g.useCallback((l,c)=>{const u=A2(typeof l=="function"?l(new URLSearchParams(s)):l);r.current=!0,i("?"+u,c)},[i,s]);return[s,o]}var UT=0,zT=()=>`__${String(++UT)}__`;function qT(){let{router:e}=hS("useSubmit"),{basename:t}=g.useContext(ea),r=sT();return g.useCallback(async(n,s={})=>{let{action:i,method:o,encType:l,formData:c,body:u}=yT(n,t);if(s.navigate===!1){let d=s.fetcherKey||zT();await e.fetch(d,r,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await e.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function VT(e,{relative:t}={}){let{basename:r}=g.useContext(ea),n=g.useContext(Ti);Ur(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...Mf(e||".",{relative:t})},o=ta();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(m=>m).forEach(m=>l.append("index",m));let d=l.toString();i.search=d?`?${d}`:""}}return(!e||e===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:oo([r,i.pathname])),uf(i)}function WT(e,{relative:t}={}){let r=g.useContext(rS);Ur(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=hS("useViewTransitionState"),s=Mf(e,{relative:t});if(!r.isTransitioning)return!1;let i=xo(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=xo(r.nextLocation.pathname,n)||r.nextLocation.pathname;return ap(s.pathname,o)!=null||ap(s.pathname,i)!=null}const HT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ao(()=>Promise.resolve().then(()=>xd),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Oy extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class GT extends Oy{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class X5 extends Oy{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Q5 extends Oy{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var L2;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(L2||(L2={}));var KT=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class YT{constructor(t,{headers:r={},customFetch:n,region:s=L2.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=HT(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return KT(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const m=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(b=>{throw new GT(b)}),f=m.headers.get("x-relay-error");if(f&&f==="true")throw new X5(m);if(!m.ok)throw new Q5(m);let h=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return h==="application/json"?x=yield m.json():h==="application/octet-stream"?x=yield m.blob():h==="text/event-stream"?x=m:h==="multipart/form-data"?x=yield m.formData():x=yield m.text(),{data:x,error:null,response:m}}catch(s){return{data:null,error:s,response:s instanceof Q5||s instanceof X5?s.context:void 0}}})}}var Ms={},Ry={},Yp={},Of={},Zp={},Jp={},ZT=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},nd=ZT();const JT=nd.fetch,fS=nd.fetch.bind(nd),mS=nd.Headers,XT=nd.Request,QT=nd.Response,xd=Object.freeze(Object.defineProperty({__proto__:null,Headers:mS,Request:XT,Response:QT,default:fS,fetch:JT},Symbol.toStringTag,{value:"Module"})),eI=qA(xd);var Xp={};Object.defineProperty(Xp,"__esModule",{value:!0});let tI=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Xp.default=tI;var pS=Ci&&Ci.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jp,"__esModule",{value:!0});const rI=pS(eI),nI=pS(Xp);let sI=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=rI.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c,u;let d=null,m=null,f=null,h=i.status,x=i.statusText;if(i.ok){if(this.method!=="HEAD"){const _=await i.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?m=_:m=JSON.parse(_))}const j=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");j&&y&&y.length>1&&(f=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(d={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,f=null,h=406,x="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const j=await i.text();try{d=JSON.parse(j),Array.isArray(d)&&i.status===404&&(m=[],d=null,h=200,x="OK")}catch{i.status===404&&j===""?(h=204,x="No Content"):d={message:j}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,h=200,x="OK"),d&&this.shouldThrowOnError)throw new nI.default(d)}return{error:d,data:m,count:f,status:h,statusText:x}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Jp.default=sI;var iI=Ci&&Ci.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zp,"__esModule",{value:!0});const aI=iI(Jp);let oI=class extends aI.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Zp.default=oI;var lI=Ci&&Ci.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Of,"__esModule",{value:!0});const cI=lI(Zp);let uI=class extends cI.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Of.default=uI;var dI=Ci&&Ci.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yp,"__esModule",{value:!0});const ah=dI(Of);let hI=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new ah.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ah.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ah.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new ah.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new ah.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Yp.default=hI;var gS=Ci&&Ci.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ry,"__esModule",{value:!0});const fI=gS(Yp),mI=gS(Of);let pI=class xS{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new fI.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new xS(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(l="POST",u=r);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new mI.default({method:l,url:c,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Ry.default=pI;var vd=Ci&&Ci.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.PostgrestError=Ms.PostgrestBuilder=Ms.PostgrestTransformBuilder=Ms.PostgrestFilterBuilder=Ms.PostgrestQueryBuilder=Ms.PostgrestClient=void 0;const vS=vd(Ry);Ms.PostgrestClient=vS.default;const yS=vd(Yp);Ms.PostgrestQueryBuilder=yS.default;const bS=vd(Of);Ms.PostgrestFilterBuilder=bS.default;const wS=vd(Zp);Ms.PostgrestTransformBuilder=wS.default;const _S=vd(Jp);Ms.PostgrestBuilder=_S.default;const jS=vd(Xp);Ms.PostgrestError=jS.default;var gI=Ms.default={PostgrestClient:vS.default,PostgrestQueryBuilder:yS.default,PostgrestFilterBuilder:bS.default,PostgrestTransformBuilder:wS.default,PostgrestBuilder:_S.default,PostgrestError:jS.default};const{PostgrestClient:xI,PostgrestQueryBuilder:RZ,PostgrestFilterBuilder:FZ,PostgrestTransformBuilder:DZ,PostgrestBuilder:$Z,PostgrestError:BZ}=gI;class vI{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const yI="2.15.5",bI=`realtime-js/${yI}`,wI="1.0.0",P2=1e4,_I=1e3,jI=100;var Th;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Th||(Th={}));var Cn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Cn||(Cn={}));var Hi;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Hi||(Hi={}));var T2;(function(e){e.websocket="websocket"})(T2||(T2={}));var hc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(hc||(hc={}));class NI{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+s));o=o+s;const c=n.decode(t.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class NS{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Er;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Er||(Er={}));const e_=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,o)=>(i[o]=SI(o,e,t,s),i),{})},SI=(e,t,r,n)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=r[e];return i&&!n.includes(i)?SS(i,o):I2(o)},SS=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return AI(t,r)}switch(e){case Er.bool:return kI(t);case Er.float4:case Er.float8:case Er.int2:case Er.int4:case Er.int8:case Er.numeric:case Er.oid:return CI(t);case Er.json:case Er.jsonb:return EI(t);case Er.timestamp:return LI(t);case Er.abstime:case Er.date:case Er.daterange:case Er.int4range:case Er.int8range:case Er.money:case Er.reltime:case Er.text:case Er.time:case Er.timestamptz:case Er.timetz:case Er.tsrange:case Er.tstzrange:return I2(t);default:return I2(t)}},I2=e=>e,kI=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},CI=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},EI=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},AI=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>SS(t,l))}return e},LI=e=>typeof e=="string"?e.replace(" ","T"):e,kS=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class w1{constructor(t,r,n={},s=P2){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var t_;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(t_||(t_={}));class Ih{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ih.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Ih.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ih.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const m=i[u];if(m){const f=d.map(j=>j.presence_ref),h=m.map(j=>j.presence_ref),x=d.filter(j=>h.indexOf(j.presence_ref)<0),b=m.filter(j=>f.indexOf(j.presence_ref)<0);x.length>0&&(l[u]=x),b.length>0&&(c[u]=b)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const m=t[l].map(h=>h.presence_ref),f=d.filter(h=>m.indexOf(h.presence_ref)<0);t[l].unshift(...f)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(m=>m.presence_ref);u=u.filter(m=>d.indexOf(m.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var r_;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(r_||(r_={}));var Mh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Mh||(Mh={}));var Ya;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ya||(Ya={}));class Fy{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Cn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new w1(this,Hi.join,this.params,this.timeout),this.rejoinTimer=new NS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Cn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Cn.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Cn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Cn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Cn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Hi.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ih(this),this.broadcastEndpointURL=kS(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Cn.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[Mh.PRESENCE]&&this.bindings[Mh.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(Ya.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(Ya.CLOSED)),this.updateJoinPayload(Object.assign({config:f},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var x;if(this.socket.setAuth(),h===void 0){t==null||t(Ya.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,j=(x=b==null?void 0:b.length)!==null&&x!==void 0?x:0,y=[];for(let _=0;_<j;_++){const w=b[_],{filter:{event:S,schema:E,table:$,filter:U}}=w,I=h&&h[_];if(I&&I.event===S&&I.schema===E&&I.table===$&&I.filter===U)y.push(Object.assign(Object.assign({},w),{id:I.id}));else{this.unsubscribe(),this.state=Cn.errored,t==null||t(Ya.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(Ya.SUBSCRIBED);return}}).receive("error",h=>{this.state=Cn.errored,t==null||t(Ya.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ya.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Cn.joined&&t===Mh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Cn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Hi.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new w1(this,Hi.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Cn.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new w1(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>jI){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Hi;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var x,b,j;return((x=h.filter)===null||x===void 0?void 0:x.event)==="*"||((j=(b=h.filter)===null||b===void 0?void 0:b.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(h=>h.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var x,b,j,y,_,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const S=h.id,E=(x=h.filter)===null||x===void 0?void 0:x.event;return S&&((b=r.ids)===null||b===void 0?void 0:b.includes(S))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((j=r.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const S=(_=(y=h==null?void 0:h.filter)===null||y===void 0?void 0:y.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return S==="*"||S===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:b,table:j,commit_timestamp:y,type:_,errors:w}=x;f=Object.assign(Object.assign({},{schema:b,table:j,commit_timestamp:y,eventType:_,new:{},old:{},errors:w}),this._getPayloadRecords(x))}h.callback(f,n)})}_isClosed(){return this.state===Cn.closed}_isJoined(){return this.state===Cn.joined}_isJoining(){return this.state===Cn.joining}_isLeaving(){return this.state===Cn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Fy.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Hi.close,{},t)}_onError(t){this._on(Hi.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Cn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=e_(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=e_(t.columns,t.old_record)),r}}const _1=()=>{},zm={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},PI=[1e3,2e3,5e3,1e4],TI=1e4,II=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class MI{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=P2,this.transport=null,this.heartbeatIntervalMs=zm.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=_1,this.ref=0,this.reconnectTimer=null,this.logger=_1,this.conn=null,this.sendBuffer=[],this.serializer=new NI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>ao(()=>Promise.resolve().then(()=>xd),void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${T2.websocket}`,this.httpEndpoint=kS(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vI.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wI}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Th.connecting:return hc.Connecting;case Th.open:return hc.Open;case Th.closing:return hc.Closing;default:return hc.Closed}}isConnected(){return this.connectionState()===hc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Fy(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(_I,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},zm.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Hi.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([II],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:bI};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Hi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new NS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},zm.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,o,l,c,u,d;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:P2,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:zm.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:_1,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:m=>PI[m-1]||TI,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(m,f)=>f(JSON.stringify(m)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Dy extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function En(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class OI extends Dy{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class M2 extends Dy{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var RI=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const CS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ao(()=>Promise.resolve().then(()=>xd),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},FI=()=>RI(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ao(()=>Promise.resolve().then(()=>xd),void 0)).Response:Response}),O2=e=>{if(Array.isArray(e))return e.map(r=>O2(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=O2(n)}),t},DI=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Bc=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const j1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),$I=(e,t,r)=>Bc(void 0,void 0,void 0,function*(){const n=yield FI();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,o=(s==null?void 0:s.statusCode)||i+"";t(new OI(j1(s),i,o))}).catch(s=>{t(new M2(j1(s),s))}):t(new M2(j1(e),e))}),BI=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(DI(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function Rf(e,t,r,n,s,i){return Bc(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,BI(t,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>$I(c,l,n))})})}function op(e,t,r,n){return Bc(this,void 0,void 0,function*(){return Rf(e,"GET",t,r,n)})}function va(e,t,r,n,s){return Bc(this,void 0,void 0,function*(){return Rf(e,"POST",t,n,s,r)})}function R2(e,t,r,n,s){return Bc(this,void 0,void 0,function*(){return Rf(e,"PUT",t,n,s,r)})}function UI(e,t,r,n){return Bc(this,void 0,void 0,function*(){return Rf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function ES(e,t,r,n,s){return Bc(this,void 0,void 0,function*(){return Rf(e,"DELETE",t,n,s,r)})}var ys=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const zI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},n_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class qI{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=CS(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return ys(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},n_),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),m=yield(t=="PUT"?R2:va)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:m.Id,fullPath:m.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(En(i))return{data:null,error:i};throw i}})}upload(t,r,n){return ys(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return ys(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:n_.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const m=yield R2(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:m.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(En(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return ys(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield va(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Dy("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(En(n))return{data:null,error:n};throw n}})}update(t,r,n){return ys(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ys(this,void 0,void 0,function*(){try{return{data:yield va(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(En(s))return{data:null,error:s};throw s}})}copy(t,r,n){return ys(this,void 0,void 0,function*(){try{return{data:{path:(yield va(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(En(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return ys(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield va(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(En(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return ys(this,void 0,void 0,function*(){try{const s=yield va(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(En(s))return{data:null,error:s};throw s}})}download(t,r){return ys(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield op(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(En(l))return{data:null,error:l};throw l}})}info(t){return ys(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield op(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:O2(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(En(n))return{data:null,error:n};throw n}})}exists(t){return ys(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield UI(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(En(n)&&n instanceof M2){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return ys(this,void 0,void 0,function*(){try{return{data:yield ES(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(En(r))return{data:null,error:r};throw r}})}list(t,r,n){return ys(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},zI),r),{prefix:t||""});return{data:yield va(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(En(s))return{data:null,error:s};throw s}})}listV2(t,r){return ys(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield va(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(En(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const VI="2.12.1",WI={"X-Client-Info":`storage-js/${VI}`};var nu=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class HI{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},WI),r),this.fetch=CS(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return nu(this,void 0,void 0,function*(){try{return{data:yield op(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(En(t))return{data:null,error:t};throw t}})}getBucket(t){return nu(this,void 0,void 0,function*(){try{return{data:yield op(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(En(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return nu(this,void 0,void 0,function*(){try{return{data:yield va(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(En(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return nu(this,void 0,void 0,function*(){try{return{data:yield R2(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(En(n))return{data:null,error:n};throw n}})}emptyBucket(t){return nu(this,void 0,void 0,function*(){try{return{data:yield va(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(En(r))return{data:null,error:r};throw r}})}deleteBucket(t){return nu(this,void 0,void 0,function*(){try{return{data:yield ES(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(En(r))return{data:null,error:r};throw r}})}}class GI extends HI{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new qI(this.url,this.headers,t,this.fetch)}}const KI="2.57.4";let gh="";typeof Deno<"u"?gh="deno":typeof document<"u"?gh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?gh="react-native":gh="node";const YI={"X-Client-Info":`supabase-js-${gh}/${KI}`},ZI={headers:YI},JI={schema:"public"},XI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},QI={};var e9=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const t9=e=>{let t;return e?t=e:typeof fetch>"u"?t=fS:t=fetch,(...r)=>t(...r)},r9=()=>typeof Headers>"u"?mS:Headers,n9=(e,t,r)=>{const n=t9(r),s=r9();return(i,o)=>e9(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:u}))})};var s9=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};function i9(e){return e.endsWith("/")?e:e+"/"}function a9(e,t){var r,n;const{db:s,auth:i,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:m}=t,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>s9(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function o9(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(i9(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const AS="2.71.1",fu=30*1e3,F2=3,N1=F2*fu,l9="http://localhost:9999",c9="supabase.auth.token",u9={"X-Client-Info":`gotrue-js/${AS}`},D2="X-Supabase-Api-Version",LS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},d9=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,h9=10*60*1e3;class $y extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function zt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class f9 extends $y{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function m9(e){return zt(e)&&e.name==="AuthApiError"}class PS extends $y{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Tl extends $y{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Ho extends Tl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function p9(e){return zt(e)&&e.name==="AuthSessionMissingError"}class qm extends Tl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vm extends Tl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wm extends Tl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function g9(e){return zt(e)&&e.name==="AuthImplicitGrantRedirectError"}class s_ extends Tl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $2 extends Tl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function S1(e){return zt(e)&&e.name==="AuthRetryableFetchError"}class i_ extends Tl{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class B2 extends Tl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const lp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),a_=` 	
\r=`.split(""),x9=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<a_.length;t+=1)e[a_[t].charCodeAt(0)]=-2;for(let t=0;t<lp.length;t+=1)e[lp[t].charCodeAt(0)]=t;return e})();function o_(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(lp[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(lp[n]),t.queuedBits-=6}}function TS(e,t,r){const n=x9[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function l_(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{b9(o,n,r)};for(let o=0;o<e.length;o+=1)TS(e.charCodeAt(o),s,i);return t.join("")}function v9(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function y9(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}v9(n,t)}}function b9(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function w9(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)TS(e.charCodeAt(s),r,n);return new Uint8Array(t)}function _9(e){const t=[];return y9(e,r=>t.push(r)),new Uint8Array(t)}function j9(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>o_(s,r,n)),o_(null,r,n),t.join("")}function N9(e){return Math.round(Date.now()/1e3)+e}function S9(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const qi=()=>typeof window<"u"&&typeof document<"u",tc={tested:!1,writable:!1},IS=()=>{if(!qi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(tc.tested)return tc.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),tc.tested=!0,tc.writable=!0}catch{tc.tested=!0,tc.writable=!1}return tc.writable};function k9(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const MS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ao(()=>Promise.resolve().then(()=>xd),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},C9=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",mu=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},rc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},zo=async(e,t)=>{await e.removeItem(t)};class Qp{constructor(){this.promise=new Qp.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Qp.promiseConstructor=Promise;function k1(e){const t=e.split(".");if(t.length!==3)throw new B2("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!d9.test(t[n]))throw new B2("JWT not in base64url format");return{header:JSON.parse(l_(t[0])),payload:JSON.parse(l_(t[1])),signature:w9(t[2]),raw:{header:t[0],payload:t[1]}}}async function E9(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function A9(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function L9(e){return("0"+e.toString(16)).substr(-2)}function P9(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,L9).join("")}async function T9(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function I9(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await T9(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function su(e,t,r=!1){const n=P9();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await mu(e,`${t}-code-verifier`,s);const i=await I9(n);return[i,n===i?"plain":"s256"]}const M9=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function O9(e){const t=e.headers.get(D2);if(!t||!t.match(M9))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function R9(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function F9(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const D9=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function iu(e){if(!D9.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function C1(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function c_(e){return JSON.parse(JSON.stringify(e))}var $9=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const oc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),B9=[502,503,504];async function u_(e){var t;if(!C9(e))throw new $2(oc(e),0);if(B9.includes(e.status))throw new $2(oc(e),e.status);let r;try{r=await e.json()}catch(i){throw new PS(oc(i),i)}let n;const s=O9(e);if(s&&s.getTime()>=LS["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new i_(oc(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ho}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new i_(oc(r),e.status,r.weak_password.reasons);throw new f9(oc(r),e.status||500,n)}const U9=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ht(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[D2]||(i[D2]=LS["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await z9(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function z9(e,t,r,n,s,i){const o=U9(t,n,s,i);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new $2(oc(c),0)}if(l.ok||await u_(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await u_(c)}}function Ga(e){var t;let r=null;H9(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=N9(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function d_(e){const t=Ga(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function el(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function q9(e){return{data:e,error:null}}function V9(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,o=$9(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function W9(e){return e}function H9(e){return e.access_token&&e.refresh_token&&e.expires_in}const E1=["global","local","others"];var G9=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class K9{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=MS(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=E1[0]){if(E1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${E1.join(", ")}`);try{return await Ht(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(zt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ht(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:el})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=G9(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Ht(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:V9,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(zt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ht(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:el})}catch(r){if(zt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Ht(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:W9});if(d.error)throw d.error;const m=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(x=>{const b=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(x.split(";")[1].split("=")[1]);u[`${j}Page`]=b}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(zt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){iu(t);try{return await Ht(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:el})}catch(r){if(zt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){iu(t);try{return await Ht(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:el})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){iu(t);try{return await Ht(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:el})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){iu(t.userId);try{const{data:r,error:n}=await Ht(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){iu(t.userId),iu(t.id);try{return{data:await Ht(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(zt(r))return{data:null,error:r};throw r}}}function h_(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Y9(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const au={debug:!!(globalThis&&IS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class OS extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Z9 extends OS{}async function J9(e,t,r){au.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),au.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){au.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{au.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw au.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Z9(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(au.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Y9();const X9={url:l9,storageKey:c9,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:u9,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function f_(e,t,r){return await r()}const ou={};class df{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=df.nextInstanceID,df.nextInstanceID+=1,this.instanceID>0&&qi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},X9),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new K9({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=MS(s.fetch),this.lock=s.lock||f_,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:qi()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=J9:this.lock=f_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:IS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=h_(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=h_(this.memoryStorage)),qi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ou[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ou[this.storageKey]=Object.assign(Object.assign({},ou[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ou[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ou[this.storageKey]=Object.assign(Object.assign({},ou[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${AS}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=k9(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),qi()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),g9(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return zt(r)?{error:r}:{error:new PS("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ga}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(zt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:m,options:f}=t;let h=null,x=null;this.flowType==="pkce"&&([h,x]=await su(this.storage,this.storageKey)),i=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:m,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:x},xform:Ga})}else if("phone"in t){const{phone:d,password:m,options:f}=t;i=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:m,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ga})}else throw new Vm("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(zt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:d_})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:d_})}else throw new Vm("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new qm}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,i,o,l,c,u,d,m,f,h;let x,b;if("message"in t)x=t.message,b=t.signature;else{const{chain:j,wallet:y,statement:_,options:w}=t;let S;if(qi())if(typeof y=="object")S=y;else{const $=window;if("solana"in $&&typeof $.solana=="object"&&("signIn"in $.solana&&typeof $.solana.signIn=="function"||"signMessage"in $.solana&&typeof $.solana.signMessage=="function"))S=$.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=y}const E=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const $=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),_?{statement:_}:null));let U;if(Array.isArray($)&&$[0]&&typeof $[0]=="object")U=$[0];else if($&&typeof $=="object"&&"signedMessage"in $&&"signature"in $)U=$;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)x=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),b=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${E.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(s=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((m=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||m===void 0)&&m.length?["Resources",...w.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const $=await S.signMessage(new TextEncoder().encode(x),"utf8");if(!$||!($ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=$}}try{const{data:j,error:y}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:j9(b)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ga});if(y)throw y;return!j||!j.session||!j.user?{data:{user:null,session:null},error:new qm}:(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),{data:Object.assign({},j),error:y})}catch(j){if(zt(j))return{data:{user:null,session:null},error:j};throw j}}async _exchangeCodeForSession(t){const r=await rc(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ga});if(await zo(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new qm}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(zt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=t,l=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ga}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new qm}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await su(this.storage,this.storageKey));const{error:m}=await Ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await Ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Vm("You must provide either an email or phone number.")}catch(l){if(zt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await Ht(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Ga});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(zt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await su(this.storage,this.storageKey)),await Ht(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:q9})}catch(i){if(zt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ho;const{error:s}=await Ht(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(zt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:o}=await Ht(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:o,error:l}=await Ht(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Vm("You must provide either an email or phone number and a type")}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await rc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<N1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await rc(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=C1()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:el}):await this._useSession(async r=>{var n,s,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ho}:await Ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:el})})}catch(r){if(zt(r))return p9(r)&&(await this._removeSession(),await zo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Ho;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await su(this.storage,this.storageKey));const{data:u,error:d}=await Ht(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:el});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ho;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=k1(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(zt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ho;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!qi())throw new Wm("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wm(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new s_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wm("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new s_("No code detected.");const{data:_,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new Wm("No session defined in URL");const d=Math.round(Date.now()/1e3),m=parseInt(l);let f=d+m;c&&(f=parseInt(c));const h=f-d;h*1e3<=fu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${m}s`);const x=f-m;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,d);const{data:b,error:j}=await this._getUser(i);if(j)throw j;const y={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:m,expires_at:f,refresh_token:o,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(zt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await rc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(m9(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await zo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=S9(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await su(this.storage,this.storageKey,!0));try{return await Ht(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(zt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(zt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,l,c,u,d;const{data:m,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ht(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return qi()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(zt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await Ht(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await A9(async s=>(s>0&&await E9(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ht(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ga})),(s,i)=>{const o=200*Math.pow(2,s);return i&&S1(i)&&Date.now()+o-n<fu})}catch(n){if(this._debug(r,"error",n),zt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),qi()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await rc(this.storage,this.storageKey);if(s&&this.userStorage){let o=await rc(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await mu(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:C1()}else if(s&&!s.user&&!s.user){const o=await rc(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await zo(this.storage,this.storageKey+"-user"),await mu(this.storage,this.storageKey,s)):s.user=C1()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<N1;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${N1}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),S1(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ho;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Qp;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Ho;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),zt(i)){const o={session:null,error:i};return S1(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await mu(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=c_(s);await mu(this.storage,this.storageKey,i)}else{const s=c_(r);await mu(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await zo(this.storage,this.storageKey),await zo(this.storage,this.storageKey+"-code-verifier"),await zo(this.storage,this.storageKey+"-user"),this.userStorage&&await zo(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),fu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/fu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${fu}ms, refresh threshold is ${F2} ticks`),s<=F2&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof OS)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await su(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ht(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Ht(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:l}=await Ht(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(zt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ht(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(zt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=k1(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+h9>s)return n;const{data:i,error:o}=await Ht(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:x}=await this.getSession();if(x||!h.session)return{data:null,error:x};n=h.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=k1(n);r!=null&&r.allowExpired||R9(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:s,signature:o},error:null}}const d=F9(s.alg),m=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,m,o,_9(`${l}.${c}`)))throw new B2("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(zt(n))return{data:null,error:n};throw n}}}df.nextInstanceID=0;const Q9=df;class eM extends Q9{constructor(t){super(t)}}var tM=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(m){o(m)}}function c(d){try{u(n.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class rM{constructor(t,r,n){var s,i,o;this.supabaseUrl=t,this.supabaseKey=r;const l=o9(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:JI,realtime:QI,auth:Object.assign(Object.assign({},XI),{storageKey:c}),global:ZI},d=a9(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=n9(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new xI(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new GI(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new YT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return tM(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:o,flowType:l,lock:c,debug:u},d,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new eM({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:l,lock:c,debug:u,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new MI(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ff=(e,t,r)=>new rM(e,t,r);function nM(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}nM()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const sM=()=>{const e=[{title:"Unified Inbox",description:"Manage all WhatsApp conversations from a single, intuitive interface with real-time notifications.",icon:"",color:"emerald"},{title:"Agent Management",description:"Admins can easily add, monitor, and manage agents with role-based permissions and activity tracking.",icon:"",color:"blue"},{title:"Automations & Chatbots",description:"Set up intelligent automated responses, chatbots, and workflows to handle common queries 24/7.",icon:"",color:"purple"},{title:"Advanced Analytics",description:"Track performance metrics, conversation insights, and agent activity with detailed reporting dashboards.",icon:"",color:"indigo"},{title:"Seamless Integration",description:"Official WhatsApp Business API integration with webhook support and real-time message delivery.",icon:"",color:"cyan"}];return a.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-br from-emerald-50 via-white to-cyan-50",children:[a.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:[a.jsx("div",{className:"absolute top-20 left-20 w-4 h-4 bg-emerald-300 rounded-full animate-bounce",style:{animationDelay:"0s"}}),a.jsx("div",{className:"absolute top-80 right-20 w-6 h-6 bg-cyan-300 rounded-full animate-bounce",style:{animationDelay:"1s"}}),a.jsx("div",{className:"absolute bottom-20 left-80 w-3 h-3 bg-emerald-200 rounded-full animate-bounce",style:{animationDelay:"2s"}})]}),a.jsx("header",{className:"backdrop-blur-md bg-white/95 border-b border-white/30 sticky top-0 z-50 shadow-lg",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center py-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-500 to-cyan-600 rounded-2xl flex items-center justify-center shadow-lg mr-3",children:a.jsx("span",{className:"text-2xl",children:""})}),a.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-emerald-700 bg-clip-text text-transparent",children:"WhatsApp CRM"})]}),a.jsxs("nav",{className:"hidden md:flex space-x-8",children:[a.jsxs(wi,{to:"#features",className:"text-gray-700 hover:text-emerald-600 font-medium transition-colors relative group",children:["Features",a.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-emerald-500 group-hover:w-full transition-all duration-300"})]}),a.jsxs(wi,{to:"#how-it-works",className:"text-gray-700 hover:text-emerald-600 font-medium transition-colors relative group",children:["How It Works",a.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-emerald-500 group-hover:w-full transition-all duration-300"})]}),a.jsxs(wi,{to:"#pricing",className:"text-gray-700 hover:text-emerald-600 font-medium transition-colors relative group",children:["Pricing",a.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-emerald-500 group-hover:w-full transition-all duration-300"})]}),a.jsxs(wi,{to:"#contact",className:"text-gray-700 hover:text-emerald-600 font-medium transition-colors relative group",children:["Contact",a.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-emerald-500 group-hover:w-full transition-all duration-300"})]})]}),a.jsx(wi,{to:"/login",className:"bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-700 hover:to-cyan-700 text-white px-6 py-3 rounded-2xl font-semibold shadow-lg hover:shadow-emerald-500/25 transform hover:scale-105 transition-all duration-300",children:"Admin Portal"}),a.jsx("button",{className:"md:hidden text-gray-700 hover:text-emerald-600 p-2 rounded-xl transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})})}),a.jsxs("section",{className:"py-20 relative",children:[a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:a.jsxs("div",{className:"backdrop-blur-xl bg-white/90 border border-white/30 rounded-3xl p-8 sm:p-12 shadow-2xl max-w-5xl mx-auto",children:[a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-emerald-500 to-cyan-600 rounded-2xl mb-6 shadow-xl",children:a.jsx("span",{className:"text-3xl",children:""})})}),a.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-bold bg-gradient-to-r from-gray-900 via-gray-800 to-emerald-700 bg-clip-text text-transparent mb-6",children:"Transform Your WhatsApp Business"}),a.jsx("p",{className:"text-xl sm:text-2xl text-gray-600 max-w-3xl mx-auto mb-10 leading-relaxed",children:"Streamline customer conversations, automate responses, and unlock powerful insights with our modern WhatsApp CRM platform. Built for teams that demand efficiency and results."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[a.jsx(wi,{to:"/login",className:"bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-700 hover:to-cyan-700 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl hover:shadow-emerald-500/25 transform hover:scale-105 transition-all duration-300",children:"Start Admin Portal"}),a.jsx(wi,{to:"#features",className:"border-2 border-gray-300 hover:border-emerald-300 text-gray-700 hover:text-emerald-600 px-8 py-4 rounded-2xl font-semibold text-lg hover:bg-gray-50 transform hover:scale-105 transition-all duration-300",children:"Explore Features"})]})]})}),a.jsx("div",{className:"absolute top-1/4 right-10 w-64 h-64 bg-gradient-to-r from-emerald-400/10 to-cyan-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-1/4 left-10 w-80 h-80 bg-gradient-to-r from-cyan-400/10 to-emerald-500/10 rounded-full blur-3xl"})]}),a.jsxs("section",{id:"features",className:"py-20 relative",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("div",{className:"text-center mb-16",children:a.jsxs("div",{className:"backdrop-blur-xl bg-white/90 border border-white/30 rounded-3xl p-8 shadow-xl inline-block",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-emerald-500 to-cyan-600 rounded-2xl mb-6 shadow-lg",children:a.jsx("span",{className:"text-2xl",children:""})}),a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-gray-900 to-emerald-700 bg-clip-text text-transparent mb-4",children:"Powerful Features for Modern Teams"}),a.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Everything you need to manage WhatsApp conversations at scale with cutting-edge tools and seamless integrations."})]})}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((t,r)=>a.jsxs("div",{className:"backdrop-blur-xl bg-white/90 border border-white/30 rounded-2xl p-6 sm:p-8 shadow-lg hover:shadow-emerald-500/10 hover:scale-105 transition-all duration-300 cursor-pointer group relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/3 to-cyan-500/3 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-${t.color}-500 to-${t.color}-600 rounded-xl mb-6 shadow-lg group-hover:scale-110 transition-transform duration-300 mx-auto`,children:a.jsx("span",{className:"text-2xl",children:t.icon})}),a.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-4 text-center group-hover:text-emerald-700 transition-colors duration-200",children:t.title}),a.jsx("p",{className:"text-gray-600 text-center leading-relaxed",children:t.description}),a.jsx("div",{className:`mt-6 h-1 w-20 bg-gradient-to-r from-${t.color}-500 to-${t.color}-600 rounded-full mx-auto opacity-0 group-hover:opacity-100 transition-opacity duration-300`})]})]},r))})]}),a.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-r from-emerald-400/5 to-cyan-500/5 rounded-full blur-3xl"})]}),a.jsx("section",{className:"py-20 relative bg-gradient-to-b from-white to-emerald-50/30",children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:a.jsxs("div",{className:"backdrop-blur-xl bg-white/90 border border-white/30 rounded-3xl p-8 sm:p-12 shadow-xl",children:[a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-emerald-500 to-cyan-600 rounded-2xl mb-6 shadow-lg mx-auto",children:a.jsx("span",{className:"text-2xl",children:""})})}),a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-gray-900 to-emerald-700 bg-clip-text text-transparent mb-6",children:"Ready to Transform Your Business?"}),a.jsx("p",{className:"text-xl text-gray-600 mb-10 max-w-2xl mx-auto",children:"Join thousands of businesses revolutionizing their customer communication with our powerful WhatsApp CRM platform."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(wi,{to:"/login",className:"bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-700 hover:to-cyan-700 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl hover:shadow-emerald-500/25 transform hover:scale-105 transition-all duration-300",children:"Get Started Today"}),a.jsx(wi,{to:"#features",className:"border-2 border-gray-300 hover:border-emerald-300 text-gray-700 hover:text-emerald-600 px-8 py-4 rounded-2xl font-semibold text-lg hover:bg-gray-50 transform hover:scale-105 transition-all duration-300",children:"See All Features"})]})]})})})]})},iM="https://itvaqysqzdmwhucllktz.supabase.co",fa=Ff(iM,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0dmFxeXNxemRtd2h1Y2xsa3R6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1ODI1MDAsImV4cCI6MjA3MzE1ODUwMH0.5uYF5Xm1Og-QkgdQdT_BrejxlIFMm1xYrPn7pXqtEpQ"),aM=()=>{const e=ra(),[t,r]=g.useState(""),[n,s]=g.useState(""),[i,o]=g.useState(""),[l,c]=g.useState(""),[u,d]=g.useState(!1),[m,f]=g.useState(null),h=g.useCallback(j=>{e(j==="agent"?"/agent/dashboard":"/admin/dashboard")},[e]),x=j=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(j),b=async j=>{if(j.preventDefault(),o(""),!t||!n){o("Email and password are required");return}if(!x(t)){o("Please enter a valid email address");return}d(!0);try{const{data:y,error:_}=await fa.auth.signInWithPassword({email:t,password:n});if(_){o("Invalid email or password"),d(!1);return}if(!y.user||!y.session){o("Authentication failed"),d(!1);return}const{data:w,error:S}=await fa.from("users").select("role").eq("email",t).single();if(S){o("Failed to verify user role"),d(!1);return}const E=w==null?void 0:w.role;if(E==="admin"||E==="agent"){f(y.session),h(E);return}o("Access denied. Valid role required."),await fa.auth.signOut(),d(!1);return}catch(y){o("An unexpected error occurred"),console.error("Login error:",y)}finally{d(!1)}};return g.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("error");if(y){switch(y){case"no-session":c("Session expired. Please log in again.");break;case"unauthorized":c("Access denied. Valid role required.");break;case"user-not-found":c("User account not found. Please contact support.");break;case"admin-not-found":c("Admin account not found. Please contact administrator.");break;default:c("Authentication failed. Please try again.")}window.history.replaceState({},document.title,window.location.pathname)}fa.auth.getSession().then(({data:{session:w}})=>{var S;f(w),w&&fa.from("users").select("role").eq("email",((S=w.user)==null?void 0:S.email)||"").single().then(({data:E,error:$})=>{const U=E==null?void 0:E.role;$||!E||U!=="admin"&&U!=="agent"?(fa.auth.signOut(),f(null),e("/login?error=unauthorized")):h(U)})});const{data:{subscription:_}}=fa.auth.onAuthStateChange((w,S)=>{var E;f(S),w==="SIGNED_IN"&&S?fa.from("users").select("role").eq("email",((E=S.user)==null?void 0:E.email)||"").single().then(({data:$,error:U})=>{const I=$==null?void 0:$.role;U||!$||I!=="admin"&&I!=="agent"?(fa.auth.signOut(),f(null),o("Access denied. Valid role required."),e("/login?error=unauthorized")):h(I)}):w==="SIGNED_OUT"&&(f(null),e("/login"))});return()=>_.unsubscribe()},[e,fa]),m?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-50 via-white to-cyan-50",children:a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-emerald-100 text-emerald-800 mb-4 animate-pulse",children:"Redirecting to dashboard..."})})}):a.jsxs("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden bg-gradient-to-br from-emerald-50 via-white to-cyan-50",children:[a.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[a.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-emerald-300 rounded-full opacity-20 animate-bounce",style:{animationDelay:"0s"}}),a.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-cyan-300 rounded-full opacity-20 animate-bounce",style:{animationDelay:"1s"}}),a.jsx("div",{className:"absolute bottom-1/4 left-3/4 w-1.5 h-1.5 bg-emerald-200 rounded-full opacity-20 animate-bounce",style:{animationDelay:"2s"}}),a.jsx("div",{className:"absolute top-1/2 left-1/2 w-4 h-4 bg-cyan-200 rounded-full opacity-10 animate-ping",style:{animationDelay:"0.5s"}})]}),a.jsx("div",{className:"absolute inset-0 opacity-20",children:a.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width=%2260%22 height=%2260%22 viewBox=%220 0 60 60%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cg fill=%22none%22 fill-rule=%22evenodd%22%3E%3Cg fill=%22%23e5fffa%22 fill-opacity=%220.1%22%3E%3Ccircle cx=%2230%22 cy=%2230%22 r=%222%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')]"})}),a.jsxs("div",{className:"relative z-10 w-full max-w-md mx-4",children:[a.jsx("div",{className:"absolute -top-20 -right-20 w-48 h-48 bg-gradient-to-r from-emerald-400/10 to-cyan-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute -bottom-20 -left-20 w-40 h-40 bg-gradient-to-r from-cyan-400/10 to-emerald-500/10 rounded-full blur-3xl"}),a.jsxs("div",{className:"backdrop-blur-xl bg-white/95 border border-white/30 shadow-2xl rounded-3xl p-6 sm:p-8 relative overflow-hidden transform transition-all duration-500 hover:scale-[1.02] animate-pulse-slow",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/5 via-transparent to-cyan-500/5 rounded-3xl"}),a.jsxs("div",{className:"text-center relative z-10 mb-6 sm:mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-emerald-500 to-cyan-600 rounded-2xl mb-4 sm:mb-6 shadow-xl border border-white/20 mx-auto",children:a.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})})}),a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-gray-900 via-gray-800 to-emerald-700 bg-clip-text text-transparent mb-2 sm:mb-3",children:"WhatsApp CRM Portal"}),a.jsx("p",{className:"text-gray-600 font-medium text-sm sm:text-base",children:"Secure access to WhatsApp CRM"})]}),a.jsxs("form",{className:"space-y-4 sm:space-y-6 relative z-10",onSubmit:b,children:[a.jsxs("div",{className:"relative group",children:[a.jsx("input",{id:"email",name:"email",type:"email",className:`peer w-full px-3 sm:px-4 py-4 sm:py-5 bg-white/70 backdrop-blur-sm border-2 border-gray-200/40 rounded-2xl focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/20 transition-all duration-300 text-gray-900 placeholder-transparent pr-10 sm:pr-12 shadow-sm ${i?"border-red-400 ring-red-400/20":""} ${t?"ring-1 ring-emerald-500/20":""}`,placeholder:" ",value:t,onChange:j=>r(j.target.value),disabled:u,required:!0}),a.jsx("label",{htmlFor:"email",className:`absolute left-3 sm:left-4 top-4 text-gray-500 transition-all duration-300 ease-in-out text-sm font-medium peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-focus:-top-2 sm:peer-focus:-top-3 peer-focus:text-xs peer-focus:text-emerald-600 peer-valid:-top-2 sm:peer-valid:-top-3 peer-valid:text-xs peer-valid:text-emerald-600 peer-disabled:opacity-50 ${i?"text-red-500":""} ${t?"-top-2 sm:-top-3 text-xs text-emerald-600":""}`,children:"Email Address"}),a.jsx("div",{className:`absolute right-3 sm:right-4 top-4 transition-colors duration-200 ${i?"text-red-500":t?"text-emerald-500":"text-gray-400"}`,children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),a.jsxs("div",{className:"relative group",children:[a.jsx("input",{id:"password",name:"password",type:"password",className:`peer w-full px-3 sm:px-4 py-4 sm:py-5 bg-white/70 backdrop-blur-sm border-2 border-gray-200/40 rounded-2xl focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/20 transition-all duration-300 text-gray-900 placeholder-transparent pr-10 sm:pr-12 shadow-sm ${i?"border-red-400 ring-red-400/20":""} ${n?"ring-1 ring-emerald-500/20":""}`,placeholder:" ",value:n,onChange:j=>s(j.target.value),disabled:u,required:!0}),a.jsx("label",{htmlFor:"password",className:`absolute left-3 sm:left-4 top-4 text-gray-500 transition-all duration-300 ease-in-out text-sm font-medium peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-focus:-top-2 sm:peer-focus:-top-3 peer-focus:text-xs peer-focus:text-emerald-600 peer-valid:-top-2 sm:peer-valid:-top-3 peer-valid:text-xs peer-valid:text-emerald-600 peer-disabled:opacity-50 ${i?"text-red-500":""} ${n?"-top-2 sm:-top-3 text-xs text-emerald-600":""}`,children:"Password"}),a.jsx("div",{className:`absolute right-3 sm:right-4 top-4 transition-colors duration-200 ${i?"text-red-500":n?"text-emerald-500":"text-gray-400"}`,children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),(i||l)&&a.jsxs("div",{className:"bg-gradient-to-r from-red-50/95 to-red-100/95 border border-red-200/50 backdrop-blur-sm rounded-2xl p-3 sm:p-4 relative shadow-lg overflow-hidden animate-bounce",role:"alert",children:[a.jsx("div",{className:"absolute left-0 top-0 h-full w-1 bg-gradient-to-b from-red-400 to-red-600 rounded-l-2xl"}),a.jsxs("div",{className:"relative flex items-start",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsx("div",{className:"ml-2 sm:ml-3 flex-1",children:a.jsx("p",{className:"text-sm text-red-800 font-medium",children:i||l})})]})]}),a.jsx("div",{className:"relative group",children:a.jsxs("button",{type:"submit",disabled:u||!t||!n,className:`relative w-full flex justify-center items-center py-3 sm:py-4 px-6 font-semibold rounded-2xl transition-all duration-300 overflow-hidden ${u||!t||!n?"bg-gray-200 text-gray-500 cursor-not-allowed shadow-none":"bg-gradient-to-r from-emerald-600 via-emerald-500 to-cyan-600 text-white shadow-lg hover:shadow-emerald-500/25 hover:from-emerald-700 hover:to-cyan-700 active:scale-95 focus:outline-none focus:ring-4 focus:ring-emerald-500/30"}`,children:[a.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-emerald-500/20 to-cyan-500/20 rounded-2xl blur opacity-0 group-hover:opacity-100 transition-opacity duration-300 ${u||!t||!n?"opacity-0":""}`}),a.jsx("span",{className:"relative z-10 flex items-center",children:u?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 sm:h-5 sm:w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:`mr-2 h-4 w-4 sm:h-5 sm:w-5 transition-transform duration-300 ${t&&n?"group-hover:translate-x-1":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),a.jsx("span",{className:"text-sm sm:text-base",children:"Enter Portal"})]})})]})}),a.jsxs("div",{className:"text-center pt-4 sm:pt-6 border-t border-gray-200/20",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[a.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 font-medium",children:"Secure Admin Access"}),a.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-cyan-500 rounded-full animate-pulse",style:{animationDelay:"0.5s"}})]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Contact support for account creation"})]})]}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 sm:h-2 bg-gradient-to-r from-emerald-500/10 via-transparent to-cyan-500/10 rounded-b-3xl"})]}),a.jsx("div",{className:"mt-4 sm:mt-6 text-center",children:a.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-2 sm:p-3 border border-white/30 shadow-sm",children:a.jsx("p",{className:"text-xs text-gray-600 font-medium",children:" WhatsApp CRM Admin Portal v1.0"})})})]})]})},RS=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),eg=g.createContext({}),tg=g.createContext(null),rg=typeof document<"u",By=rg?g.useLayoutEffect:g.useEffect,FS=g.createContext({strict:!1}),Uy=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),oM="framerAppearId",DS="data-"+Uy(oM);function lM(e,t,r,n){const{visualElement:s}=g.useContext(eg),i=g.useContext(FS),o=g.useContext(tg),l=g.useContext(RS).reducedMotion,c=g.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;g.useInsertionEffect(()=>{u&&u.update(r,o)});const d=g.useRef(!!(r[DS]&&!window.HandoffComplete));return By(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),g.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function Au(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function cM(e,t,r){return g.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Au(r)&&(r.current=n))},[t])}function hf(e){return typeof e=="string"||Array.isArray(e)}function ng(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const zy=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],qy=["initial",...zy];function sg(e){return ng(e.animate)||qy.some(t=>hf(e[t]))}function $S(e){return!!(sg(e)||e.variants)}function uM(e,t){if(sg(e)){const{initial:r,animate:n}=e;return{initial:r===!1||hf(r)?r:void 0,animate:hf(n)?n:void 0}}return e.inherit!==!1?t:{}}function dM(e){const{initial:t,animate:r}=uM(e,g.useContext(eg));return g.useMemo(()=>({initial:t,animate:r}),[m_(t),m_(r)])}function m_(e){return Array.isArray(e)?e.join(" "):e}const p_={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ff={};for(const e in p_)ff[e]={isEnabled:t=>p_[e].some(r=>!!t[r])};function hM(e){for(const t in e)ff[t]={...ff[t],...e[t]}}const Vy=g.createContext({}),BS=g.createContext({}),fM=Symbol.for("motionComponentSymbol");function mM({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&hM(e);function i(l,c){let u;const d={...g.useContext(RS),...l,layoutId:pM(l)},{isStatic:m}=d,f=dM(l),h=n(l,m);if(!m&&rg){f.visualElement=lM(s,h,d,t);const x=g.useContext(BS),b=g.useContext(FS).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,b,e,x))}return g.createElement(eg.Provider,{value:f},u&&f.visualElement?g.createElement(u,{visualElement:f.visualElement,...d}):null,r(s,l,cM(h,f.visualElement,c),h,m,f.visualElement))}const o=g.forwardRef(i);return o[fM]=s,o}function pM({layoutId:e}){const t=g.useContext(Vy).id;return t&&e!==void 0?t+"-"+e:e}function gM(e){function t(n,s={}){return mM(e(n,s))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,s)=>(r.has(s)||r.set(s,t(s)),r.get(s))})}const xM=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Wy(e){return typeof e!="string"||e.includes("-")?!1:!!(xM.indexOf(e)>-1||/[A-Z]/.test(e))}const cp={};function vM(e){Object.assign(cp,e)}const Df=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Uc=new Set(Df);function US(e,{layout:t,layoutId:r}){return Uc.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!cp[e]||e==="opacity")}const Bs=e=>!!(e&&e.getVelocity),yM={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},bM=Df.length;function wM(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,s){let i="";for(let o=0;o<bM;o++){const l=Df[o];if(e[l]!==void 0){const c=yM[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(e,n?"":i):r&&n&&(i="none"),i}const zS=e=>t=>typeof t=="string"&&t.startsWith(e),qS=zS("--"),U2=zS("var(--"),_M=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,jM=(e,t)=>t&&typeof e=="number"?t.transform(e):e,jl=(e,t,r)=>Math.min(Math.max(r,e),t),zc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Oh={...zc,transform:e=>jl(0,1,e)},Hm={...zc,default:1},Rh=e=>Math.round(e*1e5)/1e5,ig=/(-)?([\d]*\.?[\d])+/g,VS=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,NM=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function $f(e){return typeof e=="string"}const Bf=e=>({test:t=>$f(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Go=Bf("deg"),ka=Bf("%"),Tt=Bf("px"),SM=Bf("vh"),kM=Bf("vw"),g_={...ka,parse:e=>ka.parse(e)/100,transform:e=>ka.transform(e*100)},x_={...zc,transform:Math.round},WS={borderWidth:Tt,borderTopWidth:Tt,borderRightWidth:Tt,borderBottomWidth:Tt,borderLeftWidth:Tt,borderRadius:Tt,radius:Tt,borderTopLeftRadius:Tt,borderTopRightRadius:Tt,borderBottomRightRadius:Tt,borderBottomLeftRadius:Tt,width:Tt,maxWidth:Tt,height:Tt,maxHeight:Tt,size:Tt,top:Tt,right:Tt,bottom:Tt,left:Tt,padding:Tt,paddingTop:Tt,paddingRight:Tt,paddingBottom:Tt,paddingLeft:Tt,margin:Tt,marginTop:Tt,marginRight:Tt,marginBottom:Tt,marginLeft:Tt,rotate:Go,rotateX:Go,rotateY:Go,rotateZ:Go,scale:Hm,scaleX:Hm,scaleY:Hm,scaleZ:Hm,skew:Go,skewX:Go,skewY:Go,distance:Tt,translateX:Tt,translateY:Tt,translateZ:Tt,x:Tt,y:Tt,z:Tt,perspective:Tt,transformPerspective:Tt,opacity:Oh,originX:g_,originY:g_,originZ:Tt,zIndex:x_,fillOpacity:Oh,strokeOpacity:Oh,numOctaves:x_};function Hy(e,t,r,n){const{style:s,vars:i,transform:o,transformOrigin:l}=e;let c=!1,u=!1,d=!0;for(const m in t){const f=t[m];if(qS(m)){i[m]=f;continue}const h=WS[m],x=jM(f,h);if(Uc.has(m)){if(c=!0,o[m]=x,!d)continue;f!==(h.default||0)&&(d=!1)}else m.startsWith("origin")?(u=!0,l[m]=x):s[m]=x}if(t.transform||(c||n?s.transform=wM(e.transform,r,d,n):s.transform&&(s.transform="none")),u){const{originX:m="50%",originY:f="50%",originZ:h=0}=l;s.transformOrigin=`${m} ${f} ${h}`}}const Gy=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function HS(e,t,r){for(const n in t)!Bs(t[n])&&!US(n,r)&&(e[n]=t[n])}function CM({transformTemplate:e},t,r){return g.useMemo(()=>{const n=Gy();return Hy(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function EM(e,t,r){const n=e.style||{},s={};return HS(s,n,e),Object.assign(s,CM(e,t,r)),e.transformValues?e.transformValues(s):s}function AM(e,t,r){const n={},s=EM(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const LM=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function up(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||LM.has(e)}let GS=e=>!up(e);function PM(e){e&&(GS=t=>t.startsWith("on")?!up(t):e(t))}try{PM(require("@emotion/is-prop-valid").default)}catch{}function TM(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(GS(s)||r===!0&&up(s)||!t&&!up(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function v_(e,t,r){return typeof e=="string"?e:Tt.transform(t+r*e)}function IM(e,t,r){const n=v_(t,e.x,e.width),s=v_(r,e.y,e.height);return`${n} ${s}`}const MM={offset:"stroke-dashoffset",array:"stroke-dasharray"},OM={offset:"strokeDashoffset",array:"strokeDasharray"};function RM(e,t,r=1,n=0,s=!0){e.pathLength=1;const i=s?MM:OM;e[i.offset]=Tt.transform(-n);const o=Tt.transform(t),l=Tt.transform(r);e[i.array]=`${o} ${l}`}function Ky(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,m,f){if(Hy(e,u,d,f),m){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:x,dimensions:b}=e;h.transform&&(b&&(x.transform=h.transform),delete h.transform),b&&(s!==void 0||i!==void 0||x.transform)&&(x.transformOrigin=IM(b,s!==void 0?s:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),o!==void 0&&RM(h,o,l,c,!1)}const KS=()=>({...Gy(),attrs:{}}),Yy=e=>typeof e=="string"&&e.toLowerCase()==="svg";function FM(e,t,r,n){const s=g.useMemo(()=>{const i=KS();return Ky(i,t,{enableHardwareAcceleration:!1},Yy(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};HS(i,e.style,e),s.style={...i,...s.style}}return s}function DM(e=!1){return(r,n,s,{latestValues:i},o)=>{const c=(Wy(r)?FM:AM)(n,i,o,r),d={...TM(n,typeof r=="string",e),...c,ref:s},{children:m}=n,f=g.useMemo(()=>Bs(m)?m.get():m,[m]);return g.createElement(r,{...d,children:f})}}function YS(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const i in r)e.style.setProperty(i,r[i])}const ZS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function JS(e,t,r,n){YS(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(ZS.has(s)?s:Uy(s),t.attrs[s])}function Zy(e,t){const{style:r}=e,n={};for(const s in r)(Bs(r[s])||t.style&&Bs(t.style[s])||US(s,e))&&(n[s]=r[s]);return n}function XS(e,t){const r=Zy(e,t);for(const n in e)if(Bs(e[n])||Bs(t[n])){const s=Df.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function Jy(e,t,r,n={},s={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),t}function QS(e){const t=g.useRef(null);return t.current===null&&(t.current=e()),t.current}const dp=e=>Array.isArray(e),$M=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),BM=e=>dp(e)?e[e.length-1]||0:e;function j0(e){const t=Bs(e)?e.get():e;return $M(t)?t.toValue():t}function UM({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,s,i){const o={latestValues:zM(n,s,i,e),renderState:t()};return r&&(o.mount=l=>r(n,l,o)),o}const ek=e=>(t,r)=>{const n=g.useContext(eg),s=g.useContext(tg),i=()=>UM(e,t,n,s);return r?i():QS(i)};function zM(e,t,r,n){const s={},i=n(e,{});for(const f in i)s[f]=j0(i[f]);let{initial:o,animate:l}=e;const c=sg(e),u=$S(e);t&&u&&!c&&e.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let d=r?r.initial===!1:!1;d=d||o===!1;const m=d?l:o;return m&&typeof m!="boolean"&&!ng(m)&&(Array.isArray(m)?m:[m]).forEach(h=>{const x=Jy(e,h);if(!x)return;const{transitionEnd:b,transition:j,...y}=x;for(const _ in y){let w=y[_];if(Array.isArray(w)){const S=d?w.length-1:0;w=w[S]}w!==null&&(s[_]=w)}for(const _ in b)s[_]=b[_]}),s}const nn=e=>e;class y_{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function qM(e){let t=new y_,r=new y_,n=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const m=d&&s,f=m?t:r;return u&&o.add(c),f.add(c)&&m&&s&&(n=t.order.length),c},cancel:c=>{r.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let u=0;u<n;u++){const d=t.order[u];d(c),o.has(d)&&(l.schedule(d),e())}s=!1,i&&(i=!1,l.process(c))}};return l}const Gm=["prepare","read","update","preRender","render","postRender"],VM=40;function WM(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=Gm.reduce((m,f)=>(m[f]=qM(()=>r=!0),m),{}),o=m=>i[m].process(s),l=()=>{const m=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(m-s.timestamp,VM),1),s.timestamp=m,s.isProcessing=!0,Gm.forEach(o),s.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,s.isProcessing||e(l)};return{schedule:Gm.reduce((m,f)=>{const h=i[f];return m[f]=(x,b=!1,j=!1)=>(r||c(),h.schedule(x,b,j)),m},{}),cancel:m=>Gm.forEach(f=>i[f].cancel(m)),state:s,steps:i}}const{schedule:Lr,cancel:vo,state:os,steps:A1}=WM(typeof requestAnimationFrame<"u"?requestAnimationFrame:nn,!0),HM={useVisualState:ek({scrapeMotionValuesFromProps:XS,createRenderState:KS,onMount:(e,t,{renderState:r,latestValues:n})=>{Lr.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Lr.render(()=>{Ky(r,n,{enableHardwareAcceleration:!1},Yy(t.tagName),e.transformTemplate),JS(t,r)})}})},GM={useVisualState:ek({scrapeMotionValuesFromProps:Zy,createRenderState:Gy})};function KM(e,{forwardMotionProps:t=!1},r,n){return{...Wy(e)?HM:GM,preloadedFeatures:r,useRender:DM(t),createVisualElement:n,Component:e}}function ro(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const tk=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function ag(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const YM=e=>t=>tk(t)&&e(t,ag(t));function lo(e,t,r,n){return ro(e,t,YM(r),n)}const ZM=(e,t)=>r=>t(e(r)),pl=(...e)=>e.reduce(ZM);function rk(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const b_=rk("dragHorizontal"),w_=rk("dragVertical");function nk(e){let t=!1;if(e==="y")t=w_();else if(e==="x")t=b_();else{const r=b_(),n=w_();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function sk(){const e=nk(!0);return e?(e(),!1):!0}class Il{constructor(t){this.isMounted=!1,this.node=t}update(){}}function __(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||sk())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&Lr.update(()=>l[n](i,o))};return lo(e.current,r,s,{passive:!e.getProps()[n]})}class JM extends Il{mount(){this.unmount=pl(__(this.node,!0),__(this.node,!1))}unmount(){}}class XM extends Il{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pl(ro(this.node.current,"focus",()=>this.onFocus()),ro(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const ik=(e,t)=>t?e===t?!0:ik(e,t.parentElement):!1;function L1(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,ag(r))}class QM extends Il{constructor(){super(...arguments),this.removeStartListeners=nn,this.removeEndListeners=nn,this.removeAccessibleListeners=nn,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=lo(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:m}=this.node.getProps();Lr.update(()=>{!m&&!ik(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),o=lo(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=pl(i,o),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||L1("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&Lr.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=ro(this.node.current,"keyup",o),L1("down",(l,c)=>{this.startPress(l,c)})},r=ro(this.node.current,"keydown",t),n=()=>{this.isPressing&&L1("cancel",(i,o)=>this.cancelPress(i,o))},s=ro(this.node.current,"blur",n);this.removeAccessibleListeners=pl(r,s)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Lr.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!sk()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Lr.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=lo(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=ro(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pl(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const z2=new WeakMap,P1=new WeakMap,eO=e=>{const t=z2.get(e.target);t&&t(e)},tO=e=>{e.forEach(eO)};function rO({root:e,...t}){const r=e||document;P1.has(r)||P1.set(r,{});const n=P1.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(tO,{root:e,...t})),n[s]}function nO(e,t,r){const n=rO(t);return z2.set(e,r),n.observe(e),()=>{z2.delete(e),n.unobserve(e)}}const sO={some:0,all:1};class iO extends Il{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=t,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:sO[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:m}=this.node.getProps(),f=u?d:m;f&&f(c)};return nO(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(aO(t,r))&&this.startObserver()}unmount(){}}function aO({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const oO={inView:{Feature:iO},tap:{Feature:QM},focus:{Feature:XM},hover:{Feature:JM}};function ak(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function lO(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function cO(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function og(e,t,r){const n=e.getProps();return Jy(n,t,r!==void 0?r:n.custom,lO(e),cO(e))}let uO=nn,Xy=nn;const gl=e=>e*1e3,co=e=>e/1e3,dO={current:!1},ok=e=>Array.isArray(e)&&typeof e[0]=="number";function lk(e){return!!(!e||typeof e=="string"&&ck[e]||ok(e)||Array.isArray(e)&&e.every(lk))}const xh=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,ck={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:xh([0,.65,.55,1]),circOut:xh([.55,0,1,.45]),backIn:xh([.31,.01,.66,-.59]),backOut:xh([.33,1.53,.69,.99])};function uk(e){if(e)return ok(e)?xh(e):Array.isArray(e)?e.map(uk):ck[e]}function hO(e,t,r,{delay:n=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[t]:r};c&&(u.offset=c);const d=uk(l);return Array.isArray(d)&&(u.easing=d),e.animate(u,{delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function fO(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const dk=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,mO=1e-7,pO=12;function gO(e,t,r,n,s){let i,o,l=0;do o=t+(r-t)/2,i=dk(o,n,s)-e,i>0?r=o:t=o;while(Math.abs(i)>mO&&++l<pO);return o}function Uf(e,t,r,n){if(e===t&&r===n)return nn;const s=i=>gO(i,0,1,e,r);return i=>i===0||i===1?i:dk(s(i),t,n)}const xO=Uf(.42,0,1,1),vO=Uf(0,0,.58,1),hk=Uf(.42,0,.58,1),yO=e=>Array.isArray(e)&&typeof e[0]!="number",fk=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,mk=e=>t=>1-e(1-t),Qy=e=>1-Math.sin(Math.acos(e)),pk=mk(Qy),bO=fk(Qy),gk=Uf(.33,1.53,.69,.99),eb=mk(gk),wO=fk(eb),_O=e=>(e*=2)<1?.5*eb(e):.5*(2-Math.pow(2,-10*(e-1))),jO={linear:nn,easeIn:xO,easeInOut:hk,easeOut:vO,circIn:Qy,circInOut:bO,circOut:pk,backIn:eb,backInOut:wO,backOut:gk,anticipate:_O},j_=e=>{if(Array.isArray(e)){Xy(e.length===4);const[t,r,n,s]=e;return Uf(t,r,n,s)}else if(typeof e=="string")return jO[e];return e},tb=(e,t)=>r=>!!($f(r)&&NM.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),xk=(e,t,r)=>n=>{if(!$f(n))return n;const[s,i,o,l]=n.match(ig);return{[e]:parseFloat(s),[t]:parseFloat(i),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},NO=e=>jl(0,255,e),T1={...zc,transform:e=>Math.round(NO(e))},vc={test:tb("rgb","red"),parse:xk("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+T1.transform(e)+", "+T1.transform(t)+", "+T1.transform(r)+", "+Rh(Oh.transform(n))+")"};function SO(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const q2={test:tb("#"),parse:SO,transform:vc.transform},Lu={test:tb("hsl","hue"),parse:xk("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+ka.transform(Rh(t))+", "+ka.transform(Rh(r))+", "+Rh(Oh.transform(n))+")"},bs={test:e=>vc.test(e)||q2.test(e)||Lu.test(e),parse:e=>vc.test(e)?vc.parse(e):Lu.test(e)?Lu.parse(e):q2.parse(e),transform:e=>$f(e)?e:e.hasOwnProperty("red")?vc.transform(e):Lu.transform(e)},Hr=(e,t,r)=>-r*e+r*t+e;function I1(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function kO({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,i=0,o=0;if(!t)s=i=o=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=I1(c,l,e+1/3),i=I1(c,l,e),o=I1(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}const M1=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},CO=[q2,vc,Lu],EO=e=>CO.find(t=>t.test(e));function N_(e){const t=EO(e);let r=t.parse(e);return t===Lu&&(r=kO(r)),r}const vk=(e,t)=>{const r=N_(e),n=N_(t),s={...r};return i=>(s.red=M1(r.red,n.red,i),s.green=M1(r.green,n.green,i),s.blue=M1(r.blue,n.blue,i),s.alpha=Hr(r.alpha,n.alpha,i),vc.transform(s))};function AO(e){var t,r;return isNaN(e)&&$f(e)&&(((t=e.match(ig))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(VS))===null||r===void 0?void 0:r.length)||0)>0}const yk={regex:_M,countKey:"Vars",token:"${v}",parse:nn},bk={regex:VS,countKey:"Colors",token:"${c}",parse:bs.parse},wk={regex:ig,countKey:"Numbers",token:"${n}",parse:zc.parse};function O1(e,{regex:t,countKey:r,token:n,parse:s}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(s)))}function hp(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&O1(r,yk),O1(r,bk),O1(r,wk),r}function _k(e){return hp(e).values}function jk(e){const{values:t,numColors:r,numVars:n,tokenised:s}=hp(e),i=t.length;return o=>{let l=s;for(let c=0;c<i;c++)c<n?l=l.replace(yk.token,o[c]):c<n+r?l=l.replace(bk.token,bs.transform(o[c])):l=l.replace(wk.token,Rh(o[c]));return l}}const LO=e=>typeof e=="number"?0:e;function PO(e){const t=_k(e);return jk(e)(t.map(LO))}const Nl={test:AO,parse:_k,createTransformer:jk,getAnimatableNone:PO},Nk=(e,t)=>r=>`${r>0?t:e}`;function Sk(e,t){return typeof e=="number"?r=>Hr(e,t,r):bs.test(e)?vk(e,t):e.startsWith("var(")?Nk(e,t):Ck(e,t)}const kk=(e,t)=>{const r=[...e],n=r.length,s=e.map((i,o)=>Sk(i,t[o]));return i=>{for(let o=0;o<n;o++)r[o]=s[o](i);return r}},TO=(e,t)=>{const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=Sk(e[s],t[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}},Ck=(e,t)=>{const r=Nl.createTransformer(t),n=hp(e),s=hp(t);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?pl(kk(n.values,s.values),r):Nk(e,t)},mf=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},S_=(e,t)=>r=>Hr(e,t,r);function IO(e){return typeof e=="number"?S_:typeof e=="string"?bs.test(e)?vk:Ck:Array.isArray(e)?kk:typeof e=="object"?TO:S_}function MO(e,t,r){const n=[],s=r||IO(e[0]),i=e.length-1;for(let o=0;o<i;o++){let l=s(e[o],e[o+1]);if(t){const c=Array.isArray(t)?t[o]||nn:t;l=pl(c,l)}n.push(l)}return n}function Ek(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const i=e.length;if(Xy(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=MO(t,n,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const m=mf(e[d],e[d+1],u);return o[d](m)};return r?u=>c(jl(e[0],e[i-1],u)):c}function OO(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=mf(0,t,n);e.push(Hr(r,1,s))}}function RO(e){const t=[0];return OO(t,e.length-1),t}function FO(e,t){return e.map(r=>r*t)}function DO(e,t){return e.map(()=>t||hk).splice(0,e.length-1)}function fp({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=yO(n)?n.map(j_):j_(n),i={done:!1,value:t[0]},o=FO(r&&r.length===t.length?r:RO(t),e),l=Ek(o,t,{ease:Array.isArray(s)?s:DO(t,s)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function Ak(e,t){return t?e*(1e3/t):0}const $O=5;function Lk(e,t,r){const n=Math.max(t-$O,0);return Ak(r-e(n),t-n)}const R1=.001,BO=.01,k_=10,UO=.05,zO=1;function qO({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let s,i;uO(e<=gl(k_));let o=1-t;o=jl(UO,zO,o),e=jl(BO,k_,co(e)),o<1?(s=u=>{const d=u*o,m=d*e,f=d-r,h=V2(u,o),x=Math.exp(-m);return R1-f/h*x},i=u=>{const m=u*o*e,f=m*r+r,h=Math.pow(o,2)*Math.pow(u,2)*e,x=Math.exp(-m),b=V2(Math.pow(u,2),o);return(-s(u)+R1>0?-1:1)*((f-h)*x)/b}):(s=u=>{const d=Math.exp(-u*e),m=(u-r)*e+1;return-R1+d*m},i=u=>{const d=Math.exp(-u*e),m=(r-u)*(e*e);return d*m});const l=5/e,c=WO(s,i,l);if(e=gl(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:e}}}const VO=12;function WO(e,t,r){let n=r;for(let s=1;s<VO;s++)n=n-e(n)/t(n);return n}function V2(e,t){return e*Math.sqrt(1-t*t)}const HO=["duration","bounce"],GO=["stiffness","damping","mass"];function C_(e,t){return t.some(r=>e[r]!==void 0)}function KO(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!C_(e,GO)&&C_(e,HO)){const r=qO(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function Pk({keyframes:e,restDelta:t,restSpeed:r,...n}){const s=e[0],i=e[e.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:m,isResolvedFromDuration:f}=KO({...n,velocity:-co(n.velocity||0)}),h=m||0,x=c/(2*Math.sqrt(l*u)),b=i-s,j=co(Math.sqrt(l/u)),y=Math.abs(b)<5;r||(r=y?.01:2),t||(t=y?.005:.5);let _;if(x<1){const w=V2(j,x);_=S=>{const E=Math.exp(-x*j*S);return i-E*((h+x*j*b)/w*Math.sin(w*S)+b*Math.cos(w*S))}}else if(x===1)_=w=>i-Math.exp(-j*w)*(b+(h+j*b)*w);else{const w=j*Math.sqrt(x*x-1);_=S=>{const E=Math.exp(-x*j*S),$=Math.min(w*S,300);return i-E*((h+x*j*b)*Math.sinh($)+w*b*Math.cosh($))/w}}return{calculatedDuration:f&&d||null,next:w=>{const S=_(w);if(f)o.done=w>=d;else{let E=h;w!==0&&(x<1?E=Lk(_,w,S):E=0);const $=Math.abs(E)<=r,U=Math.abs(i-S)<=t;o.done=$&&U}return o.value=o.done?i:S,o}}}function E_({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const m=e[0],f={done:!1,value:m},h=I=>l!==void 0&&I<l||c!==void 0&&I>c,x=I=>l===void 0?c:c===void 0||Math.abs(l-I)<Math.abs(c-I)?l:c;let b=r*t;const j=m+b,y=o===void 0?j:o(j);y!==j&&(b=y-m);const _=I=>-b*Math.exp(-I/n),w=I=>y+_(I),S=I=>{const T=_(I),D=w(I);f.done=Math.abs(T)<=u,f.value=f.done?y:D};let E,$;const U=I=>{h(f.value)&&(E=I,$=Pk({keyframes:[f.value,x(f.value)],velocity:Lk(w,I,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return U(0),{calculatedDuration:null,next:I=>{let T=!1;return!$&&E===void 0&&(T=!0,S(I),U(I)),E!==void 0&&I>E?$.next(I-E):(!T&&S(I),f)}}}const YO=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Lr.update(t,!0),stop:()=>vo(t),now:()=>os.isProcessing?os.timestamp:performance.now()}},A_=2e4;function L_(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<A_;)t+=r,n=e.next(t);return t>=A_?1/0:t}const ZO={decay:E_,inertia:E_,tween:fp,keyframes:fp,spring:Pk};function mp({autoplay:e=!0,delay:t=0,driver:r=YO,keyframes:n,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:m,...f}){let h=1,x=!1,b,j;const y=()=>{j=new Promise(ue=>{b=ue})};y();let _;const w=ZO[s]||fp;let S;w!==fp&&typeof n[0]!="number"&&(S=Ek([0,100],n,{clamp:!1}),n=[0,100]);const E=w({...f,keyframes:n});let $;l==="mirror"&&($=w({...f,keyframes:[...n].reverse(),velocity:-(f.velocity||0)}));let U="idle",I=null,T=null,D=null;E.calculatedDuration===null&&i&&(E.calculatedDuration=L_(E));const{calculatedDuration:C}=E;let P=1/0,F=1/0;C!==null&&(P=C+o,F=P*(i+1)-o);let A=0;const R=ue=>{if(T===null)return;h>0&&(T=Math.min(T,ue)),h<0&&(T=Math.min(ue-F/h,T)),I!==null?A=I:A=Math.round(ue-T)*h;const O=A-t*(h>=0?1:-1),Z=h>=0?O<0:O>F;A=Math.max(O,0),U==="finished"&&I===null&&(A=F);let B=A,ee=E;if(i){const de=Math.min(A,F)/P;let je=Math.floor(de),me=de%1;!me&&de>=1&&(me=1),me===1&&je--,je=Math.min(je,i+1),!!(je%2)&&(l==="reverse"?(me=1-me,o&&(me-=o/P)):l==="mirror"&&(ee=$)),B=jl(0,1,me)*P}const X=Z?{done:!1,value:n[0]}:ee.next(B);S&&(X.value=S(X.value));let{done:ne}=X;!Z&&C!==null&&(ne=h>=0?A>=F:A<=0);const le=I===null&&(U==="finished"||U==="running"&&ne);return m&&m(X.value),le&&M(),X},H=()=>{_&&_.stop(),_=void 0},W=()=>{U="idle",H(),b(),y(),T=D=null},M=()=>{U="finished",d&&d(),H(),b()},G=()=>{if(x)return;_||(_=r(R));const ue=_.now();c&&c(),I!==null?T=ue-I:(!T||U==="finished")&&(T=ue),U==="finished"&&y(),D=T,I=null,U="running",_.start()};e&&G();const ce={then(ue,O){return j.then(ue,O)},get time(){return co(A)},set time(ue){ue=gl(ue),A=ue,I!==null||!_||h===0?I=ue:T=_.now()-ue/h},get duration(){const ue=E.calculatedDuration===null?L_(E):E.calculatedDuration;return co(ue)},get speed(){return h},set speed(ue){ue===h||!_||(h=ue,ce.time=co(A))},get state(){return U},play:G,pause:()=>{U="paused",I=A},stop:()=>{x=!0,U!=="idle"&&(U="idle",u&&u(),W())},cancel:()=>{D!==null&&R(D),W()},complete:()=>{U="finished"},sample:ue=>(T=0,R(ue))};return ce}function JO(e){let t;return()=>(t===void 0&&(t=e()),t)}const XO=JO(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),QO=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Km=10,eR=2e4,tR=(e,t)=>t.type==="spring"||e==="backgroundColor"||!lk(t.ease);function rR(e,t,{onUpdate:r,onComplete:n,...s}){if(!(XO()&&QO.has(t)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(w=>{l=w})};d();let{keyframes:m,duration:f=300,ease:h,times:x}=s;if(tR(t,s)){const w=mp({...s,repeat:0,delay:0});let S={done:!1,value:m[0]};const E=[];let $=0;for(;!S.done&&$<eR;)S=w.sample($),E.push(S.value),$+=Km;x=void 0,m=E,f=$-Km,h="linear"}const b=hO(e.owner.current,t,m,{...s,duration:f,ease:h,times:x}),j=()=>{u=!1,b.cancel()},y=()=>{u=!0,Lr.update(j),l(),d()};return b.onfinish=()=>{u||(e.set(fO(m,s)),n&&n(),y())},{then(w,S){return c.then(w,S)},attachTimeline(w){return b.timeline=w,b.onfinish=null,nn},get time(){return co(b.currentTime||0)},set time(w){b.currentTime=gl(w)},get speed(){return b.playbackRate},set speed(w){b.playbackRate=w},get duration(){return co(f)},play:()=>{o||(b.play(),vo(j))},pause:()=>b.pause(),stop:()=>{if(o=!0,b.playState==="idle")return;const{currentTime:w}=b;if(w){const S=mp({...s,autoplay:!1});e.setWithVelocity(S.sample(w-Km).value,S.sample(w).value,Km)}y()},complete:()=>{u||b.finish()},cancel:y}}function nR({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const s=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:nn,pause:nn,stop:nn,then:i=>(i(),Promise.resolve()),cancel:nn,complete:nn});return t?mp({keyframes:[0,1],duration:0,delay:t,onComplete:s}):s()}const sR={type:"spring",stiffness:500,damping:25,restSpeed:10},iR=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),aR={type:"keyframes",duration:.8},oR={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lR=(e,{keyframes:t})=>t.length>2?aR:Uc.has(e)?e.startsWith("scale")?iR(t[1]):sR:oR,W2=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Nl.test(t)||t==="0")&&!t.startsWith("url(")),cR=new Set(["brightness","contrast","saturate","opacity"]);function uR(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(ig)||[];if(!n)return e;const s=r.replace(n,"");let i=cR.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+s+")"}const dR=/([a-z-]*)\(.*?\)/g,H2={...Nl,getAnimatableNone:e=>{const t=e.match(dR);return t?t.map(uR).join(" "):e}},hR={...WS,color:bs,backgroundColor:bs,outlineColor:bs,fill:bs,stroke:bs,borderColor:bs,borderTopColor:bs,borderRightColor:bs,borderBottomColor:bs,borderLeftColor:bs,filter:H2,WebkitFilter:H2},rb=e=>hR[e];function Tk(e,t){let r=rb(e);return r!==H2&&(r=Nl),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const Ik=e=>/^0[^.\s]+$/.test(e);function fR(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Ik(e)}function mR(e,t,r,n){const s=W2(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const o=n.from!==void 0?n.from:e.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),fR(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=Tk(t,l)}return i}function pR({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function nb(e,t){return e[t]||e.default||e}const gR={skipAnimations:!1},sb=(e,t,r,n={})=>s=>{const i=nb(n,e)||{},o=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-gl(o);const c=mR(t,e,r,i),u=c[0],d=c[c.length-1],m=W2(e,u),f=W2(e,d);let h={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:x=>{t.set(x),i.onUpdate&&i.onUpdate(x)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(pR(i)||(h={...h,...lR(e,h)}),h.duration&&(h.duration=gl(h.duration)),h.repeatDelay&&(h.repeatDelay=gl(h.repeatDelay)),!m||!f||dO.current||i.type===!1||gR.skipAnimations)return nR(h);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const x=rR(t,e,h);if(x)return x}return mp(h)};function pp(e){return!!(Bs(e)&&e.add)}const Mk=e=>/^\-?\d*\.?\d+$/.test(e);function ib(e,t){e.indexOf(t)===-1&&e.push(t)}function ab(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class ob{constructor(){this.subscriptions=[]}add(t){return ib(this.subscriptions,t),()=>ab(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const xR=e=>!isNaN(parseFloat(e));class vR{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:o}=os;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,Lr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Lr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=xR(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new ob);const n=this.events[t].add(r);return t==="change"?()=>{n(),Lr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Ak(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sd(e,t){return new vR(e,t)}const Ok=e=>t=>t.test(e),yR={test:e=>e==="auto",parse:e=>e},Rk=[zc,Tt,ka,Go,kM,SM,yR],oh=e=>Rk.find(Ok(e)),bR=[...Rk,bs,Nl],wR=e=>bR.find(Ok(e));function _R(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,sd(r))}function jR(e,t){const r=og(e,t);let{transitionEnd:n={},transition:s={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const o in i){const l=BM(i[o]);_R(e,o,l)}}function NR(e,t,r){var n,s;const i=Object.keys(t).filter(l=>!e.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=t[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&s!==void 0?s:t[c]),d!=null&&(typeof d=="string"&&(Mk(d)||Ik(d))?d=parseFloat(d):!wR(d)&&Nl.test(u)&&(d=Tk(c,u)),e.addValue(c,sd(d,{owner:e})),r[c]===void 0&&(r[c]=d),d!==null&&e.setBaseTarget(c,d))}}function SR(e,t){return t?(t[e]||t.default||t).from:void 0}function kR(e,t,r){const n={};for(const s in e){const i=SR(s,t);if(i!==void 0)n[s]=i;else{const o=r.getValue(s);o&&(n[s]=o.get())}}return n}function CR({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function ER(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function Fk(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:o,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const u=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const m in l){const f=e.getValue(m),h=l[m];if(!f||h===void 0||d&&CR(d,m))continue;const x={delay:r,elapsed:0,...nb(i||{},m)};if(window.HandoffAppearAnimations){const y=e.getProps()[DS];if(y){const _=window.HandoffAppearAnimations(y,m,f,Lr);_!==null&&(x.elapsed=_,x.isHandoff=!0)}}let b=!x.isHandoff&&!ER(f,h);if(x.type==="spring"&&(f.getVelocity()||x.velocity)&&(b=!1),f.animation&&(b=!1),b)continue;f.start(sb(m,f,h,e.shouldReduceMotion&&Uc.has(m)?{type:!1}:x));const j=f.animation;pp(c)&&(c.add(m),j.then(()=>c.remove(m))),u.push(j)}return o&&Promise.all(u).then(()=>{o&&jR(e,o)}),u}function G2(e,t,r={}){const n=og(e,t,r.custom);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const i=n?()=>Promise.all(Fk(e,n,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:m}=s;return AR(e,t,u+c,d,m,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(r.delay)])}function AR(e,t,r=0,n=0,s=1,i){const o=[],l=(e.variantChildren.size-1)*n,c=s===1?(u=0)=>u*n:(u=0)=>l-u*n;return Array.from(e.variantChildren).sort(LR).forEach((u,d)=>{u.notify("AnimationStart",t),o.push(G2(u,t,{...i,delay:r+c(d)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(o)}function LR(e,t){return e.sortNodePosition(t)}function PR(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(i=>G2(e,i,r));n=Promise.all(s)}else if(typeof t=="string")n=G2(e,t,r);else{const s=typeof t=="function"?og(e,t,r.custom):t;n=Promise.all(Fk(e,s,r))}return n.then(()=>e.notify("AnimationComplete",t))}const TR=[...zy].reverse(),IR=zy.length;function MR(e){return t=>Promise.all(t.map(({animation:r,options:n})=>PR(e,r,n)))}function OR(e){let t=MR(e);const r=FR();let n=!0;const s=(c,u)=>{const d=og(e,u);if(d){const{transition:m,transitionEnd:f,...h}=d;c={...c,...h,...f}}return c};function i(c){t=c(e)}function o(c,u){const d=e.getProps(),m=e.getVariantContext(!0)||{},f=[],h=new Set;let x={},b=1/0;for(let y=0;y<IR;y++){const _=TR[y],w=r[_],S=d[_]!==void 0?d[_]:m[_],E=hf(S),$=_===u?w.isActive:null;$===!1&&(b=y);let U=S===m[_]&&S!==d[_]&&E;if(U&&n&&e.manuallyAnimateOnMount&&(U=!1),w.protectedKeys={...x},!w.isActive&&$===null||!S&&!w.prevProp||ng(S)||typeof S=="boolean")continue;let T=RR(w.prevProp,S)||_===u&&w.isActive&&!U&&E||y>b&&E,D=!1;const C=Array.isArray(S)?S:[S];let P=C.reduce(s,{});$===!1&&(P={});const{prevResolvedValues:F={}}=w,A={...F,...P},R=H=>{T=!0,h.has(H)&&(D=!0,h.delete(H)),w.needsAnimating[H]=!0};for(const H in A){const W=P[H],M=F[H];if(x.hasOwnProperty(H))continue;let G=!1;dp(W)&&dp(M)?G=!ak(W,M):G=W!==M,G?W!==void 0?R(H):h.add(H):W!==void 0&&h.has(H)?R(H):w.protectedKeys[H]=!0}w.prevProp=S,w.prevResolvedValues=P,w.isActive&&(x={...x,...P}),n&&e.blockInitialAnimation&&(T=!1),T&&(!U||D)&&f.push(...C.map(H=>({animation:H,options:{type:_,...c}})))}if(h.size){const y={};h.forEach(_=>{const w=e.getBaseTarget(_);w!==void 0&&(y[_]=w)}),f.push({animation:y})}let j=!!f.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(j=!1),n=!1,j?t(f):Promise.resolve()}function l(c,u,d){var m;if(r[c].isActive===u)return Promise.resolve();(m=e.variantChildren)===null||m===void 0||m.forEach(h=>{var x;return(x=h.animationState)===null||x===void 0?void 0:x.setActive(c,u)}),r[c].isActive=u;const f=o(d,c);for(const h in r)r[h].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>r}}function RR(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!ak(t,e):!1}function nc(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function FR(){return{animate:nc(!0),whileInView:nc(),whileHover:nc(),whileTap:nc(),whileDrag:nc(),whileFocus:nc(),exit:nc()}}class DR extends Il{constructor(t){super(t),t.animationState||(t.animationState=OR(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),ng(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let $R=0;class BR extends Il{constructor(){super(...arguments),this.id=$R++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const UR={animation:{Feature:DR},exit:{Feature:BR}},P_=(e,t)=>Math.abs(e-t);function zR(e,t){const r=P_(e.x,t.x),n=P_(e.y,t.y);return Math.sqrt(r**2+n**2)}class Dk{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=D1(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,h=zR(m.offset,{x:0,y:0})>=3;if(!f&&!h)return;const{point:x}=m,{timestamp:b}=os;this.history.push({...x,timestamp:b});const{onStart:j,onMove:y}=this.handlers;f||(j&&j(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,m)},this.handlePointerMove=(m,f)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=F1(f,this.transformPagePoint),Lr.update(this.updatePoint,!0)},this.handlePointerUp=(m,f)=>{this.end();const{onEnd:h,onSessionEnd:x,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=D1(m.type==="pointercancel"?this.lastMoveEventInfo:F1(f,this.transformPagePoint),this.history);this.startEvent&&h&&h(m,j),x&&x(m,j)},!tk(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=ag(t),l=F1(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=os;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,D1(l,this.history)),this.removeListeners=pl(lo(this.contextWindow,"pointermove",this.handlePointerMove),lo(this.contextWindow,"pointerup",this.handlePointerUp),lo(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),vo(this.updatePoint)}}function F1(e,t){return t?{point:t(e.point)}:e}function T_(e,t){return{x:e.x-t.x,y:e.y-t.y}}function D1({point:e},t){return{point:e,delta:T_(e,$k(t)),offset:T_(e,qR(t)),velocity:VR(t,.1)}}function qR(e){return e[0]}function $k(e){return e[e.length-1]}function VR(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=$k(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>gl(t)));)r--;if(!n)return{x:0,y:0};const i=co(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function li(e){return e.max-e.min}function K2(e,t=0,r=.01){return Math.abs(e-t)<=r}function I_(e,t,r,n=.5){e.origin=n,e.originPoint=Hr(t.min,t.max,e.origin),e.scale=li(r)/li(t),(K2(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Hr(r.min,r.max,e.origin)-e.originPoint,(K2(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Fh(e,t,r,n){I_(e.x,t.x,r.x,n?n.originX:void 0),I_(e.y,t.y,r.y,n?n.originY:void 0)}function M_(e,t,r){e.min=r.min+t.min,e.max=e.min+li(t)}function WR(e,t,r){M_(e.x,t.x,r.x),M_(e.y,t.y,r.y)}function O_(e,t,r){e.min=t.min-r.min,e.max=e.min+li(t)}function Dh(e,t,r){O_(e.x,t.x,r.x),O_(e.y,t.y,r.y)}function HR(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Hr(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Hr(r,e,n.max):Math.min(e,r)),e}function R_(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function GR(e,{top:t,left:r,bottom:n,right:s}){return{x:R_(e.x,r,s),y:R_(e.y,t,n)}}function F_(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function KR(e,t){return{x:F_(e.x,t.x),y:F_(e.y,t.y)}}function YR(e,t){let r=.5;const n=li(e),s=li(t);return s>n?r=mf(t.min,t.max-n,e.min):n>s&&(r=mf(e.min,e.max-s,t.min)),jl(0,1,r)}function ZR(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Y2=.35;function JR(e=Y2){return e===!1?e=0:e===!0&&(e=Y2),{x:D_(e,"left","right"),y:D_(e,"top","bottom")}}function D_(e,t,r){return{min:$_(e,t),max:$_(e,r)}}function $_(e,t){return typeof e=="number"?e:e[t]||0}const B_=()=>({translate:0,scale:1,origin:0,originPoint:0}),Pu=()=>({x:B_(),y:B_()}),U_=()=>({min:0,max:0}),xn=()=>({x:U_(),y:U_()});function bi(e){return[e("x"),e("y")]}function Bk({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function XR({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function QR(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function $1(e){return e===void 0||e===1}function Z2({scale:e,scaleX:t,scaleY:r}){return!$1(e)||!$1(t)||!$1(r)}function lc(e){return Z2(e)||Uk(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Uk(e){return z_(e.x)||z_(e.y)}function z_(e){return e&&e!=="0%"}function gp(e,t,r){const n=e-r,s=t*n;return r+s}function q_(e,t,r,n,s){return s!==void 0&&(e=gp(e,s,n)),gp(e,r,n)+t}function J2(e,t=0,r=1,n,s){e.min=q_(e.min,t,r,n,s),e.max=q_(e.max,t,r,n,s)}function zk(e,{x:t,y:r}){J2(e.x,t.translate,t.scale,t.originPoint),J2(e.y,r.translate,r.scale,r.originPoint)}function eF(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let i,o;for(let l=0;l<s;l++){i=r[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Tu(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,zk(e,o)),n&&lc(i.latestValues)&&Tu(e,i.latestValues))}t.x=V_(t.x),t.y=V_(t.y)}function V_(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Zo(e,t){e.min=e.min+t,e.max=e.max+t}function W_(e,t,[r,n,s]){const i=t[s]!==void 0?t[s]:.5,o=Hr(e.min,e.max,i);J2(e,t[r],t[n],o,t.scale)}const tF=["x","scaleX","originX"],rF=["y","scaleY","originY"];function Tu(e,t){W_(e.x,t,tF),W_(e.y,t,rF)}function qk(e,t){return Bk(QR(e.getBoundingClientRect(),t))}function nF(e,t,r){const n=qk(e,r),{scroll:s}=t;return s&&(Zo(n.x,s.offset.x),Zo(n.y,s.offset.y)),n}const Vk=({current:e})=>e?e.ownerDocument.defaultView:null,sF=new WeakMap;class iF{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=xn(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(ag(d,"page").point)},i=(d,m)=>{const{drag:f,dragPropagation:h,onDragStart:x}=this.getProps();if(f&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=nk(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),bi(j=>{let y=this.getAxisMotionValue(j).get()||0;if(ka.test(y)){const{projection:_}=this.visualElement;if(_&&_.layout){const w=_.layout.layoutBox[j];w&&(y=li(w)*(parseFloat(y)/100))}}this.originPoint[j]=y}),x&&Lr.update(()=>x(d,m),!1,!0);const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},o=(d,m)=>{const{dragPropagation:f,dragDirectionLock:h,onDirectionLock:x,onDrag:b}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:j}=m;if(h&&this.currentDirection===null){this.currentDirection=aF(j),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",m.point,j),this.updateAxis("y",m.point,j),this.visualElement.render(),b&&b(d,m)},l=(d,m)=>this.stop(d,m),c=()=>bi(d=>{var m;return this.getAnimationState(d)==="paused"&&((m=this.getAxisMotionValue(d).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Dk(t,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:Vk(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&Lr.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!Ym(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=HR(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&Au(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=GR(s.layoutBox,r):this.constraints=!1,this.elastic=JR(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&bi(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=ZR(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Au(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=nF(n,s.root,this.visualElement.getTransformPagePoint());let o=KR(s.layout.layoutBox,i);if(r){const l=r(XR(o));this.hasMutatedConstraints=!!l,l&&(o=Bk(l))}return o}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=bi(d=>{if(!Ym(d,r,this.currentDirection))return;let m=c&&c[d]||{};o&&(m={min:0,max:0});const f=s?200:1e6,h=s?40:1e7,x={type:"inertia",velocity:n?t[d]:0,bounceStiffness:f,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...m};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(sb(t,n,0,r))}stopAnimation(){bi(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){bi(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){bi(r=>{const{drag:n}=this.getProps();if(!Ym(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[r];i.set(t[r]-Hr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Au(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};bi(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=YR({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),bi(o=>{if(!Ym(o,t,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(Hr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;sF.set(this.visualElement,this);const t=this.visualElement.current,r=lo(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Au(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const o=ro(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(bi(d=>{const m=this.getAxisMotionValue(d);m&&(this.originPoint[d]+=c[d].translate,m.set(m.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=Y2,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Ym(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function aF(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class oF extends Il{constructor(t){super(t),this.removeGroupControls=nn,this.removeListeners=nn,this.controls=new iF(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||nn}unmount(){this.removeGroupControls(),this.removeListeners()}}const H_=e=>(t,r)=>{e&&Lr.update(()=>e(t,r))};class lF extends Il{constructor(){super(...arguments),this.removePointerDownListener=nn}onPointerDown(t){this.session=new Dk(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Vk(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:H_(t),onStart:H_(r),onMove:n,onEnd:(i,o)=>{delete this.session,s&&Lr.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=lo(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function cF(){const e=g.useContext(tg);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,s=g.useId();return g.useEffect(()=>n(s),[]),!t&&r?[!1,()=>r&&r(s)]:[!0]}const N0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function G_(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const lh={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Tt.test(e))e=parseFloat(e);else return e;const r=G_(e,t.target.x),n=G_(e,t.target.y);return`${r}% ${n}%`}},uF={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Nl.parse(e);if(s.length>5)return n;const i=Nl.createTransformer(e),o=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+o]/=l,s[1+o]/=c;const u=Hr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class dF extends st.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=t;vM(hF),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),N0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,o=n.projection;return o&&(o.isPresent=i,s||t.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||Lr.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Wk(e){const[t,r]=cF(),n=g.useContext(Vy);return st.createElement(dF,{...e,layoutGroup:n,switchLayoutGroup:g.useContext(BS),isPresent:t,safeToRemove:r})}const hF={borderRadius:{...lh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:lh,borderTopRightRadius:lh,borderBottomLeftRadius:lh,borderBottomRightRadius:lh,boxShadow:uF},Hk=["TopLeft","TopRight","BottomLeft","BottomRight"],fF=Hk.length,K_=e=>typeof e=="string"?parseFloat(e):e,Y_=e=>typeof e=="number"||Tt.test(e);function mF(e,t,r,n,s,i){s?(e.opacity=Hr(0,r.opacity!==void 0?r.opacity:1,pF(n)),e.opacityExit=Hr(t.opacity!==void 0?t.opacity:1,0,gF(n))):i&&(e.opacity=Hr(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<fF;o++){const l=`border${Hk[o]}Radius`;let c=Z_(t,l),u=Z_(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||Y_(c)===Y_(u)?(e[l]=Math.max(Hr(K_(c),K_(u),n),0),(ka.test(u)||ka.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=Hr(t.rotate||0,r.rotate||0,n))}function Z_(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const pF=Gk(0,.5,pk),gF=Gk(.5,.95,nn);function Gk(e,t,r){return n=>n<e?0:n>t?1:r(mf(e,t,n))}function J_(e,t){e.min=t.min,e.max=t.max}function vi(e,t){J_(e.x,t.x),J_(e.y,t.y)}function X_(e,t,r,n,s){return e-=t,e=gp(e,1/r,n),s!==void 0&&(e=gp(e,1/s,n)),e}function xF(e,t=0,r=1,n=.5,s,i=e,o=e){if(ka.test(t)&&(t=parseFloat(t),t=Hr(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=Hr(i.min,i.max,n);e===i&&(l-=t),e.min=X_(e.min,t,r,l,s),e.max=X_(e.max,t,r,l,s)}function Q_(e,t,[r,n,s],i,o){xF(e,t[r],t[n],t[s],t.scale,i,o)}const vF=["x","scaleX","originX"],yF=["y","scaleY","originY"];function e4(e,t,r,n){Q_(e.x,t,vF,r?r.x:void 0,n?n.x:void 0),Q_(e.y,t,yF,r?r.y:void 0,n?n.y:void 0)}function t4(e){return e.translate===0&&e.scale===1}function Kk(e){return t4(e.x)&&t4(e.y)}function bF(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function Yk(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function r4(e){return li(e.x)/li(e.y)}class wF{constructor(){this.members=[]}add(t){ib(this.members,t),t.scheduleRender()}remove(t){if(ab(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function n4(e,t,r){let n="";const s=e.x.translate/t.x,i=e.y.translate/t.y;if((s||i)&&(n=`translate3d(${s}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:u,rotateY:d}=r;c&&(n+=`rotate(${c}deg) `),u&&(n+=`rotateX(${u}deg) `),d&&(n+=`rotateY(${d}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const _F=(e,t)=>e.depth-t.depth;class jF{constructor(){this.children=[],this.isDirty=!1}add(t){ib(this.children,t),this.isDirty=!0}remove(t){ab(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(_F),this.isDirty=!1,this.children.forEach(t)}}function NF(e,t){const r=performance.now(),n=({timestamp:s})=>{const i=s-r;i>=t&&(vo(n),e(i-t))};return Lr.read(n,!0),()=>vo(n)}function SF(e){window.MotionDebug&&window.MotionDebug.record(e)}function kF(e){return e instanceof SVGElement&&e.tagName!=="svg"}function CF(e,t,r){const n=Bs(e)?e:sd(e);return n.start(sb("",n,t,r)),n.animation}const s4=["","X","Y","Z"],EF={visibility:"hidden"},i4=1e3;let AF=0;const cc={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Zk({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=t==null?void 0:t()){this.id=AF++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,cc.totalNodes=cc.resolvedTargetDeltas=cc.recalculatedProjection=0,this.nodes.forEach(TF),this.nodes.forEach(FF),this.nodes.forEach(DF),this.nodes.forEach(IF),SF(cc)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new jF)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new ob),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=kF(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),e){let m;const f=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=NF(f,250),N0.hasAnimatedSinceResize&&(N0.hasAnimatedSinceResize=!1,this.nodes.forEach(o4))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:f,hasRelativeTargetChanged:h,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||d.getDefaultTransition()||qF,{onLayoutAnimationStart:j,onLayoutAnimationComplete:y}=d.getProps(),_=!this.targetLayout||!Yk(this.targetLayout,x)||h,w=!f&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,w);const S={...nb(b,"layout"),onPlay:j,onComplete:y};(d.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else f||o4(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,vo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach($F),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const m=this.path[d];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(a4);return}this.isUpdating||this.nodes.forEach(OF),this.isUpdating=!1,this.nodes.forEach(RF),this.nodes.forEach(LF),this.nodes.forEach(PF),this.clearAllSnapshots();const l=performance.now();os.delta=jl(0,1e3/60,l-os.timestamp),os.timestamp=l,os.isProcessing=!0,A1.update.process(os),A1.preRender.process(os),A1.render.process(os),os.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(MF),this.sharedNodes.forEach(BF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Lr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Lr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=xn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Kk(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||lc(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),VF(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return xn();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(Zo(l.x,c.offset.x),Zo(l.y,c.offset.y)),l}removeElementScroll(o){const l=xn();vi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:m}=u;if(u!==this.root&&d&&m.layoutScroll){if(d.isRoot){vi(l,o);const{scroll:f}=this.root;f&&(Zo(l.x,-f.offset.x),Zo(l.y,-f.offset.y))}Zo(l.x,d.offset.x),Zo(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=xn();vi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Tu(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),lc(d.latestValues)&&Tu(c,d.latestValues)}return lc(this.latestValues)&&Tu(c,this.latestValues),c}removeTransform(o){const l=xn();vi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!lc(u.latestValues))continue;Z2(u.latestValues)&&u.updateSnapshot();const d=xn(),m=u.measurePageBox();vi(d,m),e4(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return lc(this.latestValues)&&e4(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==os.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:m,layoutId:f}=this.options;if(!(!this.layout||!(m||f))){if(this.resolvedRelativeTargetAt=os.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xn(),this.relativeTargetOrigin=xn(),Dh(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=xn(),this.targetWithTransforms=xn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),WR(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):vi(this.target,this.layout.layoutBox),zk(this.target,this.targetDelta)):vi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xn(),this.relativeTargetOrigin=xn(),Dh(this.relativeTargetOrigin,this.target,h.target),vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}cc.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Z2(this.parent.latestValues)||Uk(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===os.timestamp&&(u=!1),u)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;vi(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;eF(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:x}=l;if(!x){this.projectionTransform&&(this.projectionDelta=Pu(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Pu(),this.projectionDeltaWithTransform=Pu());const b=this.projectionTransform;Fh(this.projectionDelta,this.layoutCorrected,x,this.latestValues),this.projectionTransform=n4(this.projectionDelta,this.treeScale),(this.projectionTransform!==b||this.treeScale.x!==f||this.treeScale.y!==h)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),cc.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},m=Pu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=xn(),h=c?c.source:void 0,x=this.layout?this.layout.source:void 0,b=h!==x,j=this.getStack(),y=!j||j.members.length<=1,_=!!(b&&!y&&this.options.crossfade===!0&&!this.path.some(zF));this.animationProgress=0;let w;this.mixTargetDelta=S=>{const E=S/1e3;l4(m.x,o.x,E),l4(m.y,o.y,E),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Dh(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),UF(this.relativeTarget,this.relativeTargetOrigin,f,E),w&&bF(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=xn()),vi(w,this.relativeTarget)),b&&(this.animationValues=d,mF(d,u,this.latestValues,E,_,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(vo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Lr.update(()=>{N0.hasAnimatedSinceResize=!0,this.currentAnimation=CF(0,i4,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(i4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&Jk(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||xn();const m=li(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+m;const f=li(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}vi(l,c),Tu(l,d),Fh(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new wF),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<s4.length;d++){const m="rotate"+s4[d];c[m]&&(u[m]=c[m],o.setStaticValue(m,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return EF;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=j0(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=j0(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!lc(this.latestValues)&&(b.transform=d?d({},""):"none",this.hasProjected=!1),b}const f=m.animationValues||m.latestValues;this.applyTransformsToTarget(),u.transform=n4(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:h,y:x}=this.projectionDelta;u.transformOrigin=`${h.origin*100}% ${x.origin*100}% 0`,m.animationValues?u.opacity=m===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=m===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const b in cp){if(f[b]===void 0)continue;const{correct:j,applyTo:y}=cp[b],_=u.transform==="none"?f[b]:j(f[b],m);if(y){const w=y.length;for(let S=0;S<w;S++)u[y[S]]=_}else u[b]=_}return this.options.layoutId&&(u.pointerEvents=m===this?j0(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(a4),this.root.sharedNodes.clear()}}}function LF(e){e.updateLayout()}function PF(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:i}=e.options,o=r.source!==e.layout.source;i==="size"?bi(m=>{const f=o?r.measuredBox[m]:r.layoutBox[m],h=li(f);f.min=n[m].min,f.max=f.min+h}):Jk(i,r.layoutBox,n)&&bi(m=>{const f=o?r.measuredBox[m]:r.layoutBox[m],h=li(n[m]);f.max=f.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[m].max=e.relativeTarget[m].min+h)});const l=Pu();Fh(l,n,r.layoutBox);const c=Pu();o?Fh(c,e.applyTransform(s,!0),r.measuredBox):Fh(c,n,r.layoutBox);const u=!Kk(l);let d=!1;if(!e.resumeFrom){const m=e.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:f,layout:h}=m;if(f&&h){const x=xn();Dh(x,r.layoutBox,f.layoutBox);const b=xn();Dh(b,n,h.layoutBox),Yk(x,b)||(d=!0),m.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=x,e.relativeParent=m)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function TF(e){cc.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function IF(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function MF(e){e.clearSnapshot()}function a4(e){e.clearMeasurements()}function OF(e){e.isLayoutDirty=!1}function RF(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function o4(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function FF(e){e.resolveTargetDelta()}function DF(e){e.calcProjection()}function $F(e){e.resetRotation()}function BF(e){e.removeLeadSnapshot()}function l4(e,t,r){e.translate=Hr(t.translate,0,r),e.scale=Hr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function c4(e,t,r,n){e.min=Hr(t.min,r.min,n),e.max=Hr(t.max,r.max,n)}function UF(e,t,r,n){c4(e.x,t.x,r.x,n),c4(e.y,t.y,r.y,n)}function zF(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const qF={duration:.45,ease:[.4,0,.1,1]},u4=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),d4=u4("applewebkit/")&&!u4("chrome/")?Math.round:nn;function h4(e){e.min=d4(e.min),e.max=d4(e.max)}function VF(e){h4(e.x),h4(e.y)}function Jk(e,t,r){return e==="position"||e==="preserve-aspect"&&!K2(r4(t),r4(r),.2)}const WF=Zk({attachResizeListener:(e,t)=>ro(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),B1={current:void 0},Xk=Zk({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!B1.current){const e=new WF({});e.mount(window),e.setOptions({layoutScroll:!0}),B1.current=e}return B1.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),HF={pan:{Feature:lF},drag:{Feature:oF,ProjectionNode:Xk,MeasureLayout:Wk}},GF=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function KF(e){const t=GF.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function X2(e,t,r=1){const[n,s]=KF(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const o=i.trim();return Mk(o)?parseFloat(o):o}else return U2(s)?X2(s,t,r+1):s}function YF(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(s=>{const i=s.get();if(!U2(i))return;const o=X2(i,n);o&&s.set(o)});for(const s in t){const i=t[s];if(!U2(i))continue;const o=X2(i,n);o&&(t[s]=o,r||(r={}),r[s]===void 0&&(r[s]=i))}return{target:t,transitionEnd:r}}const ZF=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Qk=e=>ZF.has(e),JF=e=>Object.keys(e).some(Qk),f4=e=>e===zc||e===Tt,m4=(e,t)=>parseFloat(e.split(", ")[t]),p4=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return m4(s[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?m4(i[1],e):0}},XF=new Set(["x","y","z"]),QF=Df.filter(e=>!XF.has(e));function eD(e){const t=[];return QF.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const id={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:p4(4,13),y:p4(5,14)};id.translateX=id.x;id.translateY=id.y;const tD=(e,t,r)=>{const n=t.measureViewportBox(),s=t.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(u=>{l[u]=id[u](n,i)}),t.render();const c=t.measureViewportBox();return r.forEach(u=>{const d=t.getValue(u);d&&d.jump(l[u]),e[u]=id[u](c,i)}),e},rD=(e,t,r={},n={})=>{t={...t},n={...n};const s=Object.keys(t).filter(Qk);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=e.getValue(c);if(!e.hasValue(c))return;let d=r[c],m=oh(d);const f=t[c];let h;if(dp(f)){const x=f.length,b=f[0]===null?1:0;d=f[b],m=oh(d);for(let j=b;j<x&&f[j]!==null;j++)h?Xy(oh(f[j])===h):h=oh(f[j])}else h=oh(f);if(m!==h)if(f4(m)&&f4(h)){const x=u.get();typeof x=="string"&&u.set(parseFloat(x)),typeof f=="string"?t[c]=parseFloat(f):Array.isArray(f)&&h===Tt&&(t[c]=f.map(parseFloat))}else m!=null&&m.transform&&(h!=null&&h.transform)&&(d===0||f===0)?d===0?u.set(h.transform(d)):t[c]=m.transform(f):(o||(i=eD(e),o=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=tD(t,e,l);return i.length&&i.forEach(([d,m])=>{e.getValue(d).set(m)}),e.render(),rg&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:n}}else return{target:t,transitionEnd:n}};function nD(e,t,r,n){return JF(t)?rD(e,t,r,n):{target:t,transitionEnd:n}}const sD=(e,t,r,n)=>{const s=YF(e,t,n);return t=s.target,n=s.transitionEnd,nD(e,t,r,n)},Q2={current:null},eC={current:!1};function iD(){if(eC.current=!0,!!rg)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Q2.current=e.matches;e.addListener(t),t()}else Q2.current=!1}function aD(e,t,r){const{willChange:n}=t;for(const s in t){const i=t[s],o=r[s];if(Bs(i))e.addValue(s,i),pp(n)&&n.add(s);else if(Bs(o))e.addValue(s,sd(i,{owner:e})),pp(n)&&n.remove(s);else if(o!==i)if(e.hasValue(s)){const l=e.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(s);e.addValue(s,sd(l!==void 0?l:i,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const g4=new WeakMap,tC=Object.keys(ff),oD=tC.length,x4=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],lD=qy.length;class cD{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Lr.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=sg(r),this.isVariantNode=$S(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{});for(const m in d){const f=d[m];l[m]!==void 0&&Bs(f)&&(f.set(l[m],!1),pp(u)&&u.add(m))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,g4.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),eC.current||iD(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Q2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){g4.delete(this.current),this.projection&&this.projection.unmount(),vo(this.notifyUpdate),vo(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=Uc.has(t),s=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Lr.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{s(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,s,i){let o,l;for(let c=0;c<oD;c++){const u=tC[c],{isEnabled:d,Feature:m,ProjectionNode:f,MeasureLayout:h}=ff[u];f&&(o=f),d(r)&&(!this.features[u]&&m&&(this.features[u]=new m(this)),h&&(l=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:m,layoutScroll:f,layoutRoot:h}=r;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||m&&Au(m),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:h})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):xn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<x4.length;n++){const s=x4[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=t["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=aD(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<lD;n++){const s=qy[n],i=this.props[s];(hf(i)||i===!1)&&(r[s]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=sd(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=Jy(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!Bs(i)?i:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new ob),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class rC extends cD{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:s},i){let o=kR(n,t||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),o&&(o=s(o))),i){NR(this,n,o);const l=sD(this,n,o,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function uD(e){return window.getComputedStyle(e)}class dD extends rC{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(Uc.has(r)){const n=rb(r);return n&&n.default||0}else{const n=uD(t),s=(qS(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return qk(t,r)}build(t,r,n,s){Hy(t,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,r){return Zy(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Bs(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,s){YS(t,r,n,s)}}class hD extends rC{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Uc.has(r)){const n=rb(r);return n&&n.default||0}return r=ZS.has(r)?r:Uy(r),t.getAttribute(r)}measureInstanceViewportBox(){return xn()}scrapeMotionValuesFromProps(t,r){return XS(t,r)}build(t,r,n,s){Ky(t,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,r,n,s){JS(t,r,n,s)}mount(t){this.isSVGTag=Yy(t.tagName),super.mount(t)}}const fD=(e,t)=>Wy(e)?new hD(t,{enableHardwareAcceleration:!1}):new dD(t,{enableHardwareAcceleration:!0}),mD={layout:{ProjectionNode:Xk,MeasureLayout:Wk}},pD={...UR,...oO,...HF,...mD},Qe=gM((e,t)=>KM(e,t,pD,fD));function nC(){const e=g.useRef(!1);return By(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function gD(){const e=nC(),[t,r]=g.useState(0),n=g.useCallback(()=>{e.current&&r(t+1)},[t]);return[g.useCallback(()=>Lr.postRender(n),[n]),t]}class xD extends g.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function vD({children:e,isPresent:t}){const r=g.useId(),n=g.useRef(null),s=g.useRef({width:0,height:0,top:0,left:0});return g.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(t||!n.current||!i||!o)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),g.createElement(xD,{isPresent:t,childRef:n,sizeRef:s},g.cloneElement(e,{ref:n}))}const U1=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=QS(yD),c=g.useId(),u=g.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:d=>{l.set(d,!0);for(const m of l.values())if(!m)return;n&&n()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[r]);return g.useMemo(()=>{l.forEach((d,m)=>l.set(m,!1))},[r]),g.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(e=g.createElement(vD,{isPresent:r},e)),g.createElement(tg.Provider,{value:u},e)};function yD(){return new Map}function bD(e){return g.useEffect(()=>()=>e(),[])}const uc=e=>e.key||"";function wD(e,t){e.forEach(r=>{const n=uc(r);t.set(n,r)})}function _D(e){const t=[];return g.Children.forEach(e,r=>{g.isValidElement(r)&&t.push(r)}),t}const z1=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=g.useContext(Vy).forceRender||gD()[0],c=nC(),u=_D(e);let d=u;const m=g.useRef(new Map).current,f=g.useRef(d),h=g.useRef(new Map).current,x=g.useRef(!0);if(By(()=>{x.current=!1,wD(u,h),f.current=d}),bD(()=>{x.current=!0,h.clear(),m.clear()}),x.current)return g.createElement(g.Fragment,null,d.map(_=>g.createElement(U1,{key:uc(_),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:o},_)));d=[...d];const b=f.current.map(uc),j=u.map(uc),y=b.length;for(let _=0;_<y;_++){const w=b[_];j.indexOf(w)===-1&&!m.has(w)&&m.set(w,void 0)}return o==="wait"&&m.size&&(d=[]),m.forEach((_,w)=>{if(j.indexOf(w)!==-1)return;const S=h.get(w);if(!S)return;const E=b.indexOf(w);let $=_;if(!$){const U=()=>{m.delete(w);const I=Array.from(h.keys()).filter(T=>!j.includes(T));if(I.forEach(T=>h.delete(T)),f.current=u.filter(T=>{const D=uc(T);return D===w||I.includes(D)}),!m.size){if(c.current===!1)return;l(),n&&n()}};$=g.createElement(U1,{key:uc(S),isPresent:!1,onExitComplete:U,custom:t,presenceAffectsLayout:i,mode:o},S),m.set(w,$)}d.splice(E,0,$)}),d=d.map(_=>{const w=_.key;return m.has(w)?_:g.createElement(U1,{key:uc(_),isPresent:!0,presenceAffectsLayout:i,mode:o},_)}),g.createElement(g.Fragment,null,m.size?d:d.map(_=>g.cloneElement(_)))},jD="https://itvaqysqzdmwhucllktz.supabase.co",ND="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0dmFxeXNxemRtd2h1Y2xsa3R6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1ODI1MDAsImV4cCI6MjA3MzE1ODUwMH0.5uYF5Xm1Og-QkgdQdT_BrejxlIFMm1xYrPn7pXqtEpQ",ge=Ff(jD,ND,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),lb=async()=>{var e,t;try{const{data:{session:r}}=await ge.auth.getSession();if(!(r!=null&&r.user))return null;const{data:n,error:s}=await ge.from("agents").select(`
        *,
        users (
          name,
          email
        )
      `).eq("user_id",r.user.id).single();return s?null:{...n,name:((e=n.users)==null?void 0:e.name)||"Unknown Agent",email:((t=n.users)==null?void 0:t.email)||"No email",users:void 0,credits:n.credits||0}}catch{return null}},sC=(e,t="An error occurred")=>e.message||t,lg=async(e,t)=>{try{const{data:{session:r},error:n}=await ge.auth.refreshSession();n&&await ge.auth.getSession();const{data:{session:s}}=await ge.auth.getSession(),i=s!=null&&s.expires_at?new Date(s.expires_at*1e3).toISOString():"N/A",o=s!=null&&s.access_token?`${s.access_token.substring(0,20)}...`:"MISSING";if(s&&s.expires_at&&s.expires_at*1e3<Date.now())throw await ge.auth.signOut(),new Error("Session expired. Please log in again to continue.");const l=await ge.functions.invoke("manage-services",{body:{operation:e,...t}});console.log("[DEBUG] supabase.functions.invoke response:",{data:l.data,error:l.error?{message:l.error.message,status:l.error.status}:null});const{data:c,error:u}=l;if(u)throw console.error("[DEBUG] Invoke error details:",u),u;return console.log("[DEBUG] Successful invoke result:",c?{data:c.data}:"No result"),{data:c.data,error:null}}catch(r){return{data:null,error:sC(r,"Failed to manage service")}}},SD=async(e,t,r)=>{try{const{data:{session:n}}=await ge.auth.getSession();if(!n)throw new Error("No active session");const s=await ge.functions.invoke("upload-service-images",{body:{agentId:e,serviceId:t,images:r},headers:{Authorization:`Bearer ${n.access_token}`}});if(s.error)throw s.error;return{data:s.data,error:null}}catch(n){return{data:null,error:sC(n,"Failed to upload images")}}},kD=async e=>lg("create",e),CD=async e=>lg("get",e||{}),ED=async(e,t,r)=>lg("update",{type:e,id:t,updates:r}),AD=async e=>lg("delete",{id:e,hard_delete:!0}),LD=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,PD=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$/,TD=({isOpen:e,onClose:t,onSuccess:r,isEdit:n=!1,agentId:s,initialData:i={},supabaseUrl:o="https://itvaqysqzdmwhucllktz.supabase.co",createdByUserId:l})=>{const[c,u]=g.useState({agent_name:i.agent_name||"",email:i.email||"",business_type:i.business_type||"product",temp_password:i.temp_password||""}),[d,m]=g.useState(!1),[f,h]=g.useState(""),[x,b]=g.useState(!1),[j,y]=g.useState(""),[_,w]=g.useState(""),S=()=>{const T=Math.floor(Math.random()*5)+8,D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@$!%*?&";return Array.from({length:T},()=>D.charAt(Math.floor(Math.random()*D.length))).join("")},E=T=>{const{name:D,value:C}=T.target;u(P=>({...P,[D]:C}))},$=(T,D)=>{const C=[];return T.agent_name.trim()||C.push("Agent Name is required"),T.email.trim()?LD.test(T.email)||C.push("Invalid email format"):C.push("Email is required"),T.business_type||C.push("Business type is required"),!D&&!T.temp_password?C.push("Password is required for new agents"):T.temp_password&&!PD.test(T.temp_password)&&C.push("Password must be at least 8 chars, with uppercase, lowercase, and number"),C},U=async T=>{if(T.preventDefault(),h(""),b(!1),!l){h("Admin user ID not available. Please refresh and try again.");return}const D={agent_name:c.agent_name,email:c.email,business_type:c.business_type,temp_password:c.temp_password};if(n)s&&(D.agent_id=s),D.temp_password.trim()||delete D.temp_password;else if(D.createdBy=l,!D.temp_password.trim()){const P=S();D.temp_password=P,w(P)}const C=$(D,n);if(C.length>0){h(C.join(", "));return}m(!0);try{const{data:{session:P}}=await ge.auth.getSession();if(!(P!=null&&P.access_token)){h("Please log in to continue"),m(!1);return}const F=n?"update-agent":"add-agent",A=n?"PATCH":"POST",R=await fetch(`${o}/functions/v1/${F}`,{method:A,headers:{Authorization:`Bearer ${P.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(D)}),H=await R.json();R.ok&&H.success?(y(n?"Agent updated successfully!":"Agent added successfully!"),!n&&H.whatsapp_config&&H.whatsapp_config.info&&y(`${j}

${H.whatsapp_config.info}`),u(n?{agent_name:(i==null?void 0:i.agent_name)||"",email:(i==null?void 0:i.email)||"",business_type:(i==null?void 0:i.business_type)||"product",temp_password:""}:{agent_name:"",email:"",business_type:"product",temp_password:""}),b(!0),r&&r(),setTimeout(()=>{b(!1),t()},3e3)):(h(H.message||`Failed to ${n?"update":"add"} agent`),console.error("Edge function failed:",H))}catch(P){console.error(`${n?"Update":"Add"} agent error:`,P),h("Network error. Please try again.")}finally{m(!1)}},I=()=>{!d&&!x&&(h(""),u(n?{agent_name:(i==null?void 0:i.agent_name)||"",email:(i==null?void 0:i.email)||"",business_type:(i==null?void 0:i.business_type)||"product",temp_password:""}:{agent_name:"",email:"",business_type:"product",temp_password:""}),w(""),b(!1),t())};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:x?a.jsxs("div",{className:"p-6 text-center",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:j}),_&&a.jsxs("div",{className:"bg-gray-50 p-3 rounded-md mt-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Generated Password:"}),a.jsx("p",{className:"text-lg font-mono text-gray-900 bg-white px-2 py-1 rounded border",children:_}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Share this with the agent securely"})]}),!n&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 mt-3 text-sm",children:a.jsxs("p",{className:"text-blue-800 mb-1",children:[a.jsx("strong",{children:"WhatsApp Setup:"})," Agent created successfully! WhatsApp configuration can be set up separately from the agent dashboard."]})})]}),a.jsx("div",{className:"text-sm text-gray-500 mb-6",children:"You will be redirected to the agents list shortly..."}),a.jsx("div",{className:"flex justify-center space-x-3",children:a.jsx("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Close"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Agent":"Add New Agent"}),!n&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create agent account. WhatsApp configuration can be set up separately later."})]}),a.jsxs("form",{onSubmit:U,className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3 border-b border-gray-200 pb-2",children:"Agent Information"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agent Name *"}),a.jsx("input",{type:"text",name:"agent_name",value:c.agent_name,onChange:E,placeholder:"Enter agent full name",disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),a.jsx("input",{type:"email",name:"email",value:c.email,onChange:E,placeholder:"agent@example.com",disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Type *"}),a.jsxs("select",{name:"business_type",value:c.business_type,onChange:E,disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[a.jsx("option",{value:"service",children:"Service"}),a.jsx("option",{value:"product",children:"Product"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the type of business this agent will manage"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n?"New Password (Optional)":"Temporary Password *"}),a.jsx("input",{type:"password",name:"temp_password",value:c.temp_password,onChange:E,placeholder:n?"Leave empty to keep current password":"Leave empty to auto-generate secure password",disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!n}),!n&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to automatically generate a secure password"})]})]}),f&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-800",children:f}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50",disabled:d,children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d,className:`px-4 py-2 text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${d?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500"}`,children:d?n?"Updating...":"Creating...":n?"Update Agent":"Create Agent"})]}),!n&&a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500 text-center",children:a.jsx("p",{children:"WhatsApp configuration can be set up separately after agent creation from the agent management dashboard."})})]})]})})}):null},ID=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,MD=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$/,OD=({isOpen:e,onClose:t,onSuccess:r,agentId:n,initialData:s,supabaseUrl:i="https://itvaqysqzdmwhucllktz.supabase.co",createdByUserId:o})=>{const[l,c]=g.useState({agent_name:s.agent_name,email:s.email,business_type:s.business_type||"product",temp_password:""}),[u,d]=g.useState(!1),[m,f]=g.useState(""),[h,x]=g.useState(!1),[b,j]=g.useState("");g.useEffect(()=>{e&&s&&(c({agent_name:s.agent_name,email:s.email,business_type:s.business_type||"product",temp_password:""}),f(""))},[e,s]);const y=E=>{const{name:$,value:U}=E.target;c(I=>({...I,[$]:U}))},_=E=>{const $=[];return E.agent_name.trim()||$.push("Agent Name is required"),E.email.trim()?ID.test(E.email)||$.push("Invalid email format"):$.push("Email is required"),E.business_type||$.push("Business type is required"),E.temp_password&&!MD.test(E.temp_password)&&$.push("Password must be at least 8 chars, with uppercase, lowercase, and number"),$},w=async E=>{if(E.preventDefault(),f(""),x(!1),!o){f("Admin user ID not available. Please refresh and try again.");return}const $={agent_name:l.agent_name,email:l.email,business_type:l.business_type,agent_id:n,updated_by:o};l.temp_password&&l.temp_password.trim()&&($.temp_password=l.temp_password);const U=_($);if(U.length>0){f(U.join(", "));return}d(!0);try{const{data:{session:I},error:T}=await ge.auth.getSession();if(T||!I){f("User not authenticated. Please log in again."),d(!1);return}const D=await fetch(`${i}/functions/v1/update-agent`,{method:"PATCH",headers:{Authorization:`Bearer ${I.access_token}`,"Content-Type":"application/json"},body:JSON.stringify($)}),C=await D.json();D.ok&&C.success?(j("Agent updated successfully!"),x(!0),r&&r(),setTimeout(()=>{x(!1),t()},2e3)):(f(C.message||"Failed to update agent"),console.error("Edge function failed:",C))}catch(I){console.error("Update agent error:",I),f("Network error. Please try again.")}finally{d(!1)}},S=()=>{!u&&!h&&(f(""),c({agent_name:s.agent_name,email:s.email,business_type:s.business_type||"product",temp_password:""}),x(!1),t())};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:h?a.jsxs("div",{className:"p-6 text-center",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:b})]}),a.jsx("div",{className:"text-sm text-gray-500 mb-6",children:"You will be redirected to the agents list shortly..."}),a.jsx("div",{className:"flex justify-center space-x-3",children:a.jsx("button",{onClick:S,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Close"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Agent"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Update agent basic information. WhatsApp configuration managed separately."})]}),a.jsxs("form",{onSubmit:w,className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3 border-b border-gray-200 pb-2",children:"Agent Information"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agent Name *"}),a.jsx("input",{type:"text",name:"agent_name",value:l.agent_name,onChange:y,placeholder:"Enter agent full name",disabled:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),a.jsx("input",{type:"email",name:"email",value:l.email,onChange:y,placeholder:"agent@example.com",disabled:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Type *"}),a.jsxs("select",{name:"business_type",value:l.business_type,onChange:y,disabled:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[a.jsx("option",{value:"service",children:"Service"}),a.jsx("option",{value:"product",children:"Product"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the type of business this agent manages"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password (Optional)"}),a.jsx("input",{type:"password",name:"temp_password",value:l.temp_password,onChange:y,placeholder:"Leave empty to keep current password",disabled:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password to reset the agent's password. Leave empty to keep current password."})]})]}),m&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-800",children:m}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",disabled:u,className:`px-4 py-2 text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${u?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500"}`,children:u?"Updating...":"Update Agent"})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500 text-center",children:a.jsx("p",{children:"WhatsApp configuration is managed separately from agent basic information."})})]})]})})}):null},RD="https://itvaqysqzdmwhucllktz.supabase.co",FD="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0dmFxeXNxemRtd2h1Y2xsa3R6Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NzU4MjUwMCwiZXhwIjoyMDczMTU4NTAwfQ.qBcZ8uxVX7pNrLz0HEbvf7GdWOR05t1BszPCRoyfDII",DD=Ff(RD,FD),$D=({isOpen:e,onClose:t,onSuccess:r,selectedAgent:n,initialConfig:s})=>{const[i,o]=g.useState({whatsapp_number:"",webhook_url:"",api_key:"",business_account_id:"",phone_number_id:""}),[l,c]=g.useState(!1),[u,d]=g.useState(null),[m,f]=g.useState(null);st.useEffect(()=>{o(s?{whatsapp_number:s.whatsapp_number||"",webhook_url:s.webhook_url||"",api_key:s.api_key||"",business_account_id:s.business_account_id||"",phone_number_id:s.phone_number_id||""}:{whatsapp_number:"",webhook_url:"",api_key:"",business_account_id:"",phone_number_id:""})},[s]);const h=y=>{const{name:_,value:w}=y.target;o(S=>({...S,[_]:w})),u&&d(null)},x=()=>{if(!i.whatsapp_number.trim())return d("WhatsApp number is required"),!1;if(!i.webhook_url.trim())return d("Webhook URL is required"),!1;try{new URL(i.webhook_url)}catch{return d("Please enter a valid webhook URL"),!1}return/^\+?[1-9]\d{1,14}$/.test(i.whatsapp_number.replace(/\D/g,""))?!0:(d("Please enter a valid WhatsApp number (international format)"),!1)},b=async y=>{var _,w,S;if(y.preventDefault(),d(null),f(null),!!x()){if(!n){d("No agent selected for WhatsApp setup");return}c(!0);try{const E={user_id:n.user_id,whatsapp_number:i.whatsapp_number.trim(),webhook_url:i.webhook_url.trim(),api_key:((_=i.api_key)==null?void 0:_.trim())||null,business_account_id:((w=i.business_account_id)==null?void 0:w.trim())||null,phone_number_id:((S=i.phone_number_id)==null?void 0:S.trim())||null},{data:$,error:U}=await DD.functions.invoke("setup-whatsapp-config",{body:E});if(U)throw new Error(`Failed to setup WhatsApp: ${U.message}`);if(!$.success)throw new Error($.message||"Failed to setup WhatsApp configuration");f("WhatsApp configuration set up successfully!"),r(),o({whatsapp_number:(s==null?void 0:s.whatsapp_number)||"",webhook_url:(s==null?void 0:s.webhook_url)||"",api_key:(s==null?void 0:s.api_key)||"",business_account_id:(s==null?void 0:s.business_account_id)||"",phone_number_id:(s==null?void 0:s.phone_number_id)||""}),setTimeout(()=>{t()},2e3)}catch(E){console.error("WhatsApp setup error:",E),d(E.message||"Failed to setup WhatsApp configuration")}finally{c(!1)}}},j=()=>{d(null),f(null),o({whatsapp_number:(s==null?void 0:s.whatsapp_number)||"",webhook_url:(s==null?void 0:s.webhook_url)||"",api_key:(s==null?void 0:s.api_key)||"",business_account_id:(s==null?void 0:s.business_account_id)||"",phone_number_id:(s==null?void 0:s.phone_number_id)||""}),t()};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?`Setup WhatsApp for ${n.user_name}`:"Setup WhatsApp"}),a.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6",children:[n&&a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Selected Agent"}),a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Name:"})," ",n.user_name]}),a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Email:"})," ",n.user_email]})]}),a.jsxs("form",{onSubmit:b,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"whatsapp_number",className:"block text-sm font-medium text-gray-700 mb-2",children:["WhatsApp Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"tel",id:"whatsapp_number",name:"whatsapp_number",value:i.whatsapp_number,onChange:h,placeholder:"+1234567890",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the international phone number (e.g., +1 234 567 8900)"})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"webhook_url",className:"block text-sm font-medium text-gray-700 mb-2",children:["Webhook URL ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"url",id:"webhook_url",name:"webhook_url",value:i.webhook_url,onChange:h,placeholder:"https://yourdomain.com/webhook/whatsapp",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your webhook endpoint to receive WhatsApp messages"})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"WhatsApp Business API Credentials (Optional)"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"These will be stored securely and used for sending messages. You can add them later if needed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"api_key",className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),a.jsx("input",{type:"password",id:"api_key",name:"api_key",value:i.api_key,onChange:h,placeholder:"Your WhatsApp Business API key",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"business_account_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Account ID"}),a.jsx("input",{type:"text",id:"business_account_id",name:"business_account_id",value:i.business_account_id,onChange:h,placeholder:"Your WhatsApp Business Account ID",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{htmlFor:"phone_number_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number ID"}),a.jsx("input",{type:"text",id:"phone_number_id",name:"phone_number_id",value:i.phone_number_id,onChange:h,placeholder:"Your WhatsApp Phone Number ID",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),u&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:u}),m&&a.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:m})]})]}),a.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:j,disabled:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"button",onClick:b,disabled:l||!n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Setting up...":"Setup WhatsApp"})]})]})}):null},BD="https://itvaqysqzdmwhucllktz.supabase.co",UD="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0dmFxeXNxemRtd2h1Y2xsa3R6Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NzU4MjUwMCwiZXhwIjoyMDczMTU4NTAwfQ.qBcZ8uxVX7pNrLz0HEbvf7GdWOR05t1BszPCRoyfDII",rs=Ff(BD,UD),zD=()=>{const[e,t]=g.useState("dashboard"),[r,n]=g.useState([]),[s,i]=g.useState(!0),[o,l]=g.useState(null),[c,u]=g.useState(!1),[d,m]=g.useState(!1),[f,h]=g.useState(null),[x,b]=g.useState(!1),[j,y]=g.useState(null),[_,w]=g.useState(null),[S,E]=g.useState({total_agents:0,total_messages:0}),$=ra(),[U,I]=g.useState(null),[T,D]=g.useState(null),[C,P]=g.useState(null);g.useEffect(()=>{(async()=>{const{data:{session:Le}}=await rs.auth.getSession();if(!Le){$("/login?error=no-session");return}I(Le.user);const{data:ve,error:he}=await rs.from("users").select("role").eq("email",Le.user.email).single();if(he||!ve||ve.role!=="admin"){console.error("Admin role verification failed:",he),await rs.auth.signOut(),$("/login?error=unauthorized");return}let V=null;try{const{data:Re,error:xe}=await rs.from("users").select("id").eq("email",Le.user.email).single();if(xe){console.error("User ID query failed:",xe),l("Failed to retrieve admin user ID. Please check your account setup."),await rs.auth.signOut(),$("/login?error=user-not-found");return}V=Re}catch(Re){console.error("Unexpected error getting user ID:",Re),l("Database connection error during authentication."),await rs.auth.signOut(),$("/login");return}if(!V){console.error("No user data found:",V),l("Admin user not found in database. Please check your account setup."),await rs.auth.signOut(),$("/login?error=admin-not-found");return}D(V.id),P({id:V.id,name:Le.user.email||"Admin",email:Le.user.email||"",role:"admin",created_at:new Date().toISOString()})})()},[$]),g.useEffect(()=>{U&&T&&(F(),A())},[U,T]);const F=async()=>{if(!U||!T){l("Invalid admin authentication - user ID not available"),i(!1);return}i(!0),l(null);try{const{count:me,error:Le}=await rs.from("agents").select("*",{count:"exact",head:!0});if(Le){n([]),l(`Database access issue: ${Le.message}`);return}if(me===0){n([]);return}const{data:ve,error:he}=await rs.from("agents").select(`
          *,
          users!user_id (id, name, email)
        `).order("created_at",{ascending:!1});if(he){n([]),l(`Failed to fetch agents: ${he.message}`);return}if(ve&&ve.length>0){const V=await Promise.all(ve.map(async Re=>{var We,Oe,nt;const xe={id:Re.id.toString(),user_id:Re.user_id,created_by:Re.created_by||T,agent_prefix:Re.agent_prefix||"",business_type:Re.business_type||"product",created_at:Re.created_at||new Date().toISOString(),user_name:((We=Re.users)==null?void 0:We.name)||"Unnamed Agent",user_email:((Oe=Re.users)==null?void 0:Oe.email)||""};let Ce=null;try{const{data:K,error:be}=await rs.functions.invoke("get-whatsapp-config",{body:{user_id:Re.user_id}});if(be)Ce=null;else if(K){const _e=K.whatsapp_config;let re=null;if(Array.isArray(_e)&&_e.length>0){const De=_e[0];re=De.config||De}else _e&&typeof _e=="object"&&(re=_e.config||_e);re&&typeof re=="object"?Ce={whatsapp_number:re.whatsapp_number||"",webhook_url:re.webhook_url||"",api_key:re.api_key||void 0,business_account_id:re.business_account_id||void 0,phone_number_id:re.phone_number_id||void 0,is_active:!!re.is_active}:Ce=null}else Ce=null}catch{Ce=null}let fe=!1;try{const{data:K}=await rs.auth.admin.getUserById(Re.user_id);fe=((nt=K==null?void 0:K.user)==null?void 0:nt.email_confirmed_at)!==null}catch(K){console.warn("Failed to fetch auth user email status:",K),fe=!1}return{...xe,is_email_verified:fe,whatsapp_config:Ce}}));n(V)}else n([]);l(null)}catch(me){n([]),l(`Failed to load agents: ${me.message||"Unknown error"}`)}finally{i(!1)}},A=async()=>{if(!U||!T){E({total_agents:0,total_messages:0});return}try{const{count:me,error:Le}=await rs.from("agents").select("*",{count:"exact",head:!0});if(Le)throw Le;E({total_agents:me||0,total_messages:0})}catch{E({total_agents:0,total_messages:0})}},R=me=>{const Le={agent_name:me.user_name,email:me.user_email,business_type:me.business_type};h({...me,...Le}),m(!0)},H=async me=>{if(confirm("Are you sure you want to delete this agent? This will also delete all associated customer data, messages, and the agent's authentication account.")){if(!T||!C){l("User not authenticated");return}try{i(!0);const{data:Le,error:ve}=await rs.functions.invoke("delete-agent",{body:{agent_id:me}});if(ve)throw new Error(`Failed to delete agent: ${ve.message}`);if(!Le.success)throw new Error(Le.message||"Failed to delete agent");F(),A(),l(null)}catch(Le){console.error("Delete agent error:",Le),l(`Failed to delete agent: ${Le.message||"Unknown error"}`)}finally{i(!1)}}},W=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"WhatsApp Configuration Management"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Configure WhatsApp integration for individual agents. Each agent can have their own WhatsApp Business API setup."}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Setup New Config"}),a.jsx("p",{className:"text-sm text-blue-800",children:"Use the dedicated WhatsApp setup for agents without configuration"})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-green-900 mb-2",children:"Agent Dashboard Integration"}),a.jsx("p",{className:"text-sm text-green-800",children:"Agents can manage their own WhatsApp settings from their dashboard"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Agent WhatsApp Status"})}),s?a.jsx("div",{className:"p-6 text-center",children:"Loading..."}):r.length===0?a.jsx("div",{className:"p-6 text-center text-gray-500",children:"No agents to display"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Agent"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"WhatsApp Number"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Webhook"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(me=>{var Le,ve,he,V;return a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:me.user_name}),a.jsx("div",{className:"text-sm text-gray-500",children:me.user_email})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((Le=me.whatsapp_config)==null?void 0:Le.whatsapp_number)||"Not configured"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(ve=me.whatsapp_config)!=null&&ve.is_active?"bg-green-100 text-green-800":me.whatsapp_config?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:(he=me.whatsapp_config)!=null&&he.is_active?"Active":me.whatsapp_config?"Inactive":"Not Set"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 truncate max-w-xs",children:(V=me.whatsapp_config)!=null&&V.webhook_url?a.jsx("a",{href:me.whatsapp_config.webhook_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View Webhook"}):"Not configured"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:me.whatsapp_config?a.jsx("button",{onClick:()=>le(me),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Configure"}):a.jsx("button",{onClick:()=>ne(me),className:"text-green-600 hover:text-green-900",children:"Setup WhatsApp"})})]},me.id)})})]})})]})]}),M=()=>a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[a.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Total Agents"}),a.jsx("p",{className:"text-3xl font-bold text-blue-600",children:S.total_agents}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[r.filter(me=>{var Le;return(Le=me.whatsapp_config)==null?void 0:Le.is_active}).length," with active WhatsApp"]})]}),a.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Total Messages"}),a.jsx("p",{className:"text-3xl font-bold text-purple-600",children:S.total_messages}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Messages processed via WhatsApp"})]})]}),G=()=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Agents Management"}),a.jsx("button",{onClick:()=>{h(null),u(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:!T||!C,children:T&&C?"Add Agent":"Loading Admin..."})]}),s?a.jsx("div",{className:"p-6 text-center",children:"Loading..."}):o?a.jsxs("div",{className:"p-6 text-red-500",children:["Error: ",o]}):r.length===0?a.jsxs("div",{className:"p-6 text-center text-gray-500",children:[a.jsx("p",{className:"text-lg",children:"No agents found"}),a.jsx("p",{className:"mt-2",children:"Get started by creating your first agent."})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Agent Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Business Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prefix"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"WhatsApp Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(me=>{var Le;return a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:me.user_name})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:me.user_email}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${me.business_type==="product"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:me.business_type})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-600",children:me.agent_prefix}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(Le=me.whatsapp_config)!=null&&Le.is_active?"bg-green-100 text-green-800":me.whatsapp_config?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:me.whatsapp_config?me.whatsapp_config.is_active?"Active":"Inactive":"Not Configured"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(me.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:me.is_email_verified?a.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full",children:"Verified"}):a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold bg-red-100 text-red-800 rounded-full",children:"Unverified"}),a.jsx("button",{onClick:()=>ee(me.user_id),className:"px-3 py-1 text-xs bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Confirm"})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[a.jsx("button",{onClick:()=>R(me),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),a.jsx("button",{onClick:()=>H(me.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},me.id)})})]})})]}),ce=()=>{u(!1),l(null)},ue=()=>{m(!1),h(null),l(null)},O=()=>{t("agents"),F(),A(),u(!1),h(null),l(null)},Z=()=>{t("agents"),F(),A(),m(!1),h(null),l(null)},B=()=>{t("whatsapp"),n([]),F(),A(),b(!1),y(null),w(null),l(null)},ee=async me=>{if(confirm("Are you sure you want to confirm this agent's email? This will mark their email as verified."))try{i(!0);const{error:Le}=await rs.auth.admin.updateUserById(me,{email_confirm:!0});if(Le)throw new Error(`Failed to confirm email: ${Le.message}`);await F(),l(null)}catch(Le){console.error("Email confirmation error:",Le),l(`Failed to confirm email: ${Le.message||"Unknown error"}`)}finally{i(!1)}},X=async me=>{if(!me)return null;try{const{data:Le,error:ve}=await rs.functions.invoke("get-whatsapp-config",{body:{user_id:me}});if(ve)return console.warn("Failed to fetch WhatsApp config:",ve),null;if(Le&&Le.success){const he=Le.whatsapp_config;let V=null;if(Array.isArray(he)&&he.length>0){const Re=he[0];V=Re.config||Re}else he&&typeof he=="object"&&(V=he.config||he);return V&&typeof V=="object"?{whatsapp_number:V.whatsapp_number||"",webhook_url:V.webhook_url||"",api_key:V.api_key||"",business_account_id:V.business_account_id||"",phone_number_id:V.phone_number_id||"",is_active:!!V.is_active}:null}return null}catch(Le){return console.error("Error fetching WhatsApp config:",Le),null}},ne=async me=>{y(me);const Le=await X(me.user_id);w(Le),b(!0)},le=async me=>{y(me);const Le=await X(me.user_id);w(Le),b(!0)},de=[{id:"dashboard",label:"Dashboard"},{id:"agents",label:"Agents"},{id:"whatsapp",label:"WhatsApp Config"},{id:"analytics",label:"Analytics"},{id:"settings",label:"Settings"},{id:"logout",label:"Logout",onClick:()=>rs.auth.signOut().then(()=>$("/login"))}],je=()=>{switch(e){case"dashboard":return a.jsx("div",{children:a.jsx(M,{})});case"agents":return a.jsx(G,{});case"whatsapp":return a.jsx(W,{});case"analytics":return a.jsx(M,{});case"settings":return a.jsx("div",{className:"p-6",children:a.jsx("h2",{className:"text-2xl font-bold",children:"Settings"})});default:return null}};return a.jsxs("div",{className:"flex h-screen bg-gray-100",children:[a.jsxs(Qe.aside,{initial:{x:-250},animate:{x:0},className:"w-64 bg-white shadow-lg flex flex-col",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"WhatsApp CRM Admin"})}),a.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1",children:de.map(me=>a.jsx("button",{onClick:()=>me.onClick?me.onClick():t(me.id),className:`w-full flex items-center px-4 py-2 text-sm font-medium rounded-md ${e===me.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx("span",{className:"ml-3",children:me.label})},me.id))})]}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx("header",{className:"bg-white shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:a.jsx("h2",{className:"text-2xl font-semibold text-gray-900 capitalize",children:e})})}),a.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:je()})]}),a.jsx("button",{className:"md:hidden fixed top-4 left-4 z-50 bg-white p-2 rounded-md shadow-lg",children:"Menu"}),a.jsx(TD,{isOpen:c,onClose:ce,onSuccess:O,createdByUserId:T??void 0}),a.jsx(OD,{isOpen:d,onClose:ue,onSuccess:Z,agentId:(f==null?void 0:f.id)||"",initialData:f?{agent_name:f.user_name,email:f.user_email}:{agent_name:"",email:""},createdByUserId:T??void 0}),a.jsx($D,{isOpen:x,onClose:()=>{b(!1),y(null),w(null)},onSuccess:B,selectedAgent:j,initialConfig:_})]})};function qD({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const VD=g.forwardRef(qD),WD=VD;function HD({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const GD=g.forwardRef(HD),v4=GD;function KD({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const YD=g.forwardRef(KD),ZD=YD;function JD({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const XD=g.forwardRef(JD),y4=XD;function QD({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 19.5 15-15m0 0H8.25m11.25 0v11.25"}))}const e$=g.forwardRef(QD),iC=e$;function t$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const r$=g.forwardRef(t$),aC=r$;function n$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const s$=g.forwardRef(n$),b4=s$;function i$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"}))}const a$=g.forwardRef(i$),o$=a$;function l$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const c$=g.forwardRef(l$),u$=c$;function d$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const h$=g.forwardRef(d$),ev=h$;function f$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const m$=g.forwardRef(f$),S0=m$;function p$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const g$=g.forwardRef(p$),oC=g$;function x$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const v$=g.forwardRef(x$),y$=v$;function b$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const w$=g.forwardRef(b$),_$=w$;function j$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const N$=g.forwardRef(j$),lC=N$;function S$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const k$=g.forwardRef(S$),w4=k$;function C$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))}const E$=g.forwardRef(C$),cC=E$;function A$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const L$=g.forwardRef(A$),P$=L$;function T$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}const I$=g.forwardRef(T$),M$=I$;function O$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const R$=g.forwardRef(O$),F$=R$;function D$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const $$=g.forwardRef(D$),B$=$$;function U$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const z$=g.forwardRef(U$),uC=z$;function q$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const V$=g.forwardRef(q$),W$=V$;function H$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const G$=g.forwardRef(H$),K$=G$;function Y$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Z$=g.forwardRef(Y$),J$=Z$;function X$({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const Q$=g.forwardRef(X$),dC=Q$;function eB({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const tB=g.forwardRef(eB),hC=tB;function rB({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const nB=g.forwardRef(rB),k0=nB;function sB({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const iB=g.forwardRef(sB),aB=iB;function oB({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const lB=g.forwardRef(oB),cB=lB;function uB({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const dB=g.forwardRef(uB),C0=dB;function hB({title:e,titleId:t,...r},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const fB=g.forwardRef(hB),xp=fB,mB=({agent:e,unreadCount:t=0,isOpen:r=!0,open:n=!0,collapsed:s=!0,onCollapseToggle:i,onClose:o})=>{const l=n||r||!0,[c,u]=g.useState(!1),d=ta(),f=[{name:"Dashboard",href:"/agent",icon:W$},{name:"Conversations",href:"/agent/conversations",icon:S0},{name:"Customers",href:"/agent/customers",icon:C0},{name:"Orders",href:"/agent/orders",icon:k0},{name:"Invoices",href:"/agent/invoices",icon:F$},{name:"Inventory",href:"/agent/inventory",icon:WD},{name:"Services",href:"/agent/services",icon:o$},{name:"Appointments",href:"/agent/appointments",icon:u$},{name:"Templates",href:"/agent/templates",icon:M$},{name:"Analytics",href:"/agent/analytics",icon:ev},{name:"Settings",href:"/agent/settings",icon:cC}].filter(b=>(e==null?void 0:e.business_type)==="service"?b.name!=="Inventory":b.name!=="Services"),h=b=>({Dashboard:"Dashboard Overview",Conversations:"Manage Conversations",Customers:"Customer Directory",Orders:"Order Management",Appointments:"Manage Appointments",Templates:"WhatsApp Templates",Analytics:"Performance Analytics",Settings:"Account Settings",Inventory:"Manage Products",Services:"Manage Services"})[b]||b,x=()=>{u(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden",children:a.jsx("button",{onClick:()=>u(!c),className:"p-4 text-gray-300 hover:text-white fixed top-4 left-4 z-50 bg-gray-900/80 backdrop-blur-sm rounded-lg",children:c?a.jsx(xp,{className:"h-6 w-6"}):a.jsx(aC,{className:"h-6 w-6"})})}),a.jsx("div",{className:`
          fixed inset-y-0 left-0 z-50 transform
          bg-gradient-to-b from-gray-900/95 to-gray-800/95 shadow-2xl backdrop-blur-sm
          transition-all duration-300 ease-in-out border-r border-gray-700/30 overflow-hidden
          ${l?"translate-x-0":"-translate-x-full"}
          md:translate-x-0 md:static md:inset-0
          ${c?"translate-x-0":"-translate-x-full md:translate-x-0"}
          ${s?"w-16 md:w-16":"w-64 md:w-64"}
        `,children:a.jsxs("div",{className:"flex h-full flex-col bg-gray-900/95 backdrop-blur-sm overflow-hidden",children:[a.jsxs("div",{className:"flex h-16 shrink-0 items-center justify-between px-3 md:px-4 border-b border-gray-700/50 bg-gradient-to-r from-gray-900 to-gray-800 backdrop-blur-sm",children:[a.jsx("div",{className:"flex-1"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:i,className:"p-1.5 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-white/10 transition-colors duration-200 md:block hidden",title:s?"Expand sidebar":"Collapse sidebar",children:s?a.jsx(lC,{className:"h-5 w-5"}):a.jsx(_$,{className:"h-5 w-5"})}),a.jsx("button",{onClick:o,className:"p-1.5 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 md:hidden transition-colors duration-200",children:a.jsx(xp,{className:"h-6 w-6"})})]}),a.jsx("div",{className:"flex-1"})]}),a.jsx("nav",{className:"flex flex-1 flex-col overflow-y-auto py-6 overflow-x-hidden",children:a.jsx("ul",{role:"list",className:"space-y-2 px-1 md:px-2",children:f.map(b=>{const j=b.icon,y=b.name==="Dashboard"?d.pathname===b.href:d.pathname===b.href||d.pathname.startsWith(b.href+"/"),w=b.name==="Conversations"&&t>0;return a.jsx("li",{children:a.jsxs(wi,{to:b.href,className:`
                        group relative flex items-center rounded-lg py-3 text-sm font-medium transition-all duration-200
                        ${s?"justify-center px-3.5 w-16":"justify-start px-4 flex-1 min-w-0"}
                        ${y?"bg-gradient-to-r from-green-500/10 to-teal-500/10 text-green-400 border border-green-500/30 shadow-lg":"text-gray-400 hover:bg-white/10 hover:text-gray-200 hover:border-gray-600/30 border border-transparent/50"}
                        ${c?"justify-start w-full px-4":""}
                        hover:shadow-md
                        no-underline
                        max-w-full
                      `,title:h(b.name),onClick:x,children:[a.jsx(j,{className:`
                          h-5 w-5 flex-shrink-0 transition-transform duration-200
                          ${s?"mx-0.5":"mr-3 ml-0"}
                          ${y?"text-green-400 scale-110":"text-gray-400 group-hover:text-gray-200 group-hover:scale-110"}
                          ${y?"drop-shadow-sm":""}
                        `,"aria-hidden":"true"}),w&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold min-w-[20px]",children:t>99?"99+":t}),y&&c&&a.jsx("div",{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-1 h-6 bg-green-500 rounded-r-full"}),!s&&!c&&a.jsx("span",{className:"ml-2.5 whitespace-nowrap font-medium text-gray-200 opacity-90 min-w-0 truncate max-w-full",children:b.name})]})},b.name)})})})]})}),c&&a.jsx("div",{className:"fixed inset-0 z-40 bg-gray-900/60 md:hidden backdrop-blur-md",onClick:()=>u(!1)})]})},pB=({agent:e,onMenuClick:t,onLogout:r,collapsed:n=!1})=>{const s=ta(),i=ra(),[o,l]=g.useState(!1),c=()=>{l(!o)},u=()=>{l(!1)},d=b=>b.split(" ").map(j=>j[0]).join("").toUpperCase().substring(0,2),m=()=>{const j=s.pathname.split("/").filter(Boolean);if(j.length<2)return"Dashboard";const y=j[1];return y==="dashboard"?"Dashboard":y==="conversations"?"Conversations":y==="customers"?"Customers":y==="orders"?j.length>2?"Order Details":"Orders":y==="appointments"?"Appointments":y==="services"?"Services":y==="inventory"?"Inventory":y==="invoices"?"Invoices":y==="templates"?"Templates":y==="analytics"?"Analytics":y==="settings"?"Settings":"Dashboard"},f=()=>{const j=s.pathname.split("/").filter(Boolean);if(j.length<2)return"Overview of your business";const y=j[1];return y==="dashboard"?"Overview of your business":y==="conversations"?"Manage your conversations":y==="customers"?"Manage your customer base and insights":y==="orders"?j.length>2?"Order details":"Manage your orders":y==="appointments"?"Schedule and manage appointments":y==="services"?"Manage your services":y==="inventory"?"Manage your inventory":y==="invoices"?"Create and send invoices":y==="templates"?"Manage message templates":y==="analytics"?"View your analytics":y==="settings"?"Configure your settings":"Overview of your business"},h=m(),x=f();return a.jsx("nav",{className:"bg-white shadow-sm border-b border-gray-200 py-2",children:a.jsx("div",{className:`
        w-full
        px-4 sm:px-6
        md:${n?"pl-16 pr-6":"pl-64 pr-6"}
        lg:${n?"pl-16 pr-8":"pl-64 pr-8"}
      `,children:a.jsxs("div",{className:"flex justify-between h-16 items-center w-full",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:t,className:"md:hidden p-2 text-gray-500 hover:text-gray-900 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Open sidebar",children:a.jsx(aC,{className:"h-6 w-6"})}),a.jsxs("div",{className:"block",children:[a.jsx("span",{className:"text-xl font-bold text-gray-900 block",children:h}),a.jsx("span",{className:"text-sm text-gray-600 block",children:x})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsx(P$,{className:"h-4 w-4 text-blue-600"}),a.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Credits: ",e.credits]})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:c,className:"relative p-2.5 text-gray-400 hover:text-gray-500 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx(b4,{className:"h-5 w-5"}),e.unreadCount>0&&a.jsx("span",{className:"absolute -top-1 -right-1 min-w-[20px] h-5 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold ring-2 ring-white",children:e.unreadCount>99?"99+":e.unreadCount})]}),o&&a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 py-1 z-50 max-h-96 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Notifications"}),a.jsxs("p",{className:"text-xs text-gray-500",children:[e.unreadCount," unread messages"]})]}),e.recentNotifications.length>0?e.recentNotifications.map(b=>a.jsx("button",{onClick:()=>{e.onNotificationClick(b),u()},className:"w-full text-left px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-blue-600 font-medium text-sm",children:b.customerName.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2)})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:b.customerName}),a.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:b.preview}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:b.timestamp})]})]})},b.id)):a.jsxs("div",{className:"px-4 py-4 text-center text-gray-500",children:[a.jsx(b4,{className:"mx-auto h-6 w-6 text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm",children:"No new notifications"})]}),a.jsx("div",{className:"px-4 py-2 border-t border-gray-200",children:a.jsx("button",{onClick:()=>{i("/agent/conversations"),u()},className:"w-full text-left text-sm text-blue-600 hover:text-blue-500 font-medium",children:"View all conversations"})})]}),o&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:u})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.name}),a.jsx("span",{className:"text-xs text-gray-500",children:e.email})]}),a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${e.name?"bg-green-100 text-green-800":"bg-gray-300 text-gray-600"}`,children:e.name?d(e.name):a.jsx(cB,{className:"h-6 w-6"})})]}),a.jsxs("button",{onClick:r,className:"hidden md:flex items-center space-x-2 px-4 py-2 text-sm font-medium text-red-700 bg-red-50 hover:bg-red-100 rounded-lg transition-colors border border-red-200",children:[a.jsx(v4,{className:"h-4 w-4"}),a.jsx("span",{children:"Logout"})]}),a.jsx("button",{onClick:r,className:"md:hidden p-2 text-gray-400 hover:text-gray-900 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Logout",children:a.jsx(v4,{className:"h-6 w-6"})})]})]})})})},gB=({children:e})=>{const[t,r]=g.useState(!1),[n,s]=g.useState(!0),[i,o]=g.useState(null),[l,c]=g.useState(!0),u=g.useRef(!1),[d,m]=g.useState(0),[f,h]=g.useState([]),x=g.useMemo(()=>l?{id:"",user_id:"",name:"Loading...",email:"",agent_prefix:"WA",role:"agent",credits:0,created_at:new Date().toISOString()}:i||{id:"",user_id:"",name:"Not logged in",email:"",agent_prefix:"WA",role:"agent",credits:0,created_at:new Date().toISOString()},[i,l]),b=ra(),j=g.useCallback(_=>{b(`/agent/conversations?customerId=${_.customerId}`),h(w=>w.filter(S=>S.id!==_.id)),m(w=>Math.max(0,w-1))},[b]),y={...x,unreadCount:d,recentNotifications:f,onNotificationClick:j};return g.useEffect(()=>{const _=async()=>{if(u.current)return;c(!0);const S=await lb();if(o(S),u.current=!0,c(!1),S&&S.agent_prefix){const E=`${S.agent_prefix}_messages`,$=`${S.agent_prefix}_customers`,{count:U,error:I}=await ge.from(E).select("*",{count:"exact",head:!0}).eq("direction","inbound").eq("is_read",!1);!I&&U!==null&&m(U);const{data:T,error:D}=await ge.from(E).select("id, message, timestamp, customer_id").eq("direction","inbound").eq("is_read",!1).order("timestamp",{ascending:!1}).limit(5);if(!D&&T&&T.length>0){const C=[...new Set(T.map(A=>A.customer_id))],{data:P,error:F}=await ge.from($).select("id, name, phone").in("id",C);if(!F&&P){const A=new Map(P.map(R=>[R.id,R]));h(T.map(R=>{const H=A.get(R.customer_id);return{id:R.id,customerName:H?H.name:`Customer ${R.customer_id}`,customerPhone:H?H.phone:"",customerId:R.customer_id,preview:R.message.length>50?`${R.message.substring(0,50)}...`:R.message,timestamp:new Date(R.timestamp).toLocaleString([],{hour:"2-digit",minute:"2-digit"})}}))}}else h([])}};_();const{data:w}=ge.auth.onAuthStateChange((S,E)=>{S==="SIGNED_IN"&&!i?_():S==="SIGNED_OUT"&&(o(null),m(0),h([]))});return()=>{w.subscription.unsubscribe()}},[]),g.useEffect(()=>{if(!(i!=null&&i.agent_prefix)||!(i!=null&&i.id))return;const _=`${i.agent_prefix}_messages`,w=ge.channel(`unread-notifications-${i.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:_,filter:"direction=eq.inbound"},async S=>{const E=S.new;if(!E.is_read){m(T=>T+1);const $=`${i.agent_prefix}_customers`,{data:U,error:I}=await ge.from($).select("name, phone").eq("id",E.customer_id).single();if(!I&&U){const T=E.message?E.message.length>50?`${E.message.substring(0,50)}...`:E.message:"",D={id:E.id,customerName:U.name||`Customer ${E.customer_id}`,customerPhone:U.phone||"",customerId:E.customer_id,preview:T,timestamp:new Date(E.timestamp).toLocaleString([],{hour:"2-digit",minute:"2-digit"})};h(C=>{const P=[D,...C];return P.length>5?P.slice(0,5):P})}}}).on("postgres_changes",{event:"UPDATE",schema:"public",table:_,filter:"direction=eq.inbound"},S=>{const E=S.old,$=S.new;E.is_read===!1&&$.is_read===!0&&(m(U=>Math.max(0,U-1)),h(U=>U.filter(I=>I.id!==$.id)))}).subscribe(S=>{S==="SUBSCRIBED"&&console.log("Subscribed to unread notifications")});return()=>{ge.removeChannel(w)}},[i==null?void 0:i.agent_prefix,i==null?void 0:i.id]),g.useEffect(()=>{const _=w=>{const{customerId:S,count:E}=w.detail;m($=>Math.max(0,$-E)),h($=>$.filter(U=>U.customerId!==S))};return window.addEventListener("unread-messages-read",_),()=>{window.removeEventListener("unread-messages-read",_)}},[]),l?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading agent..."})]})}):i?a.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col",children:[a.jsx(pB,{agent:y,collapsed:n,onMenuClick:()=>r(!0),onLogout:async()=>{if(confirm("Are you sure you want to logout?")){const{error:_}=await ge.auth.signOut();_&&console.error("Logout error:",_),window.location.href="/login"}}}),a.jsxs("div",{className:"flex flex-1 overflow-hidden h-full",children:[a.jsx(mB,{agent:x,unreadCount:d,open:t,collapsed:n,onCollapseToggle:()=>s(!n),onClose:()=>r(!1)}),a.jsx("main",{className:"flex-1 overflow-y-auto relative z-0 transition-all duration-300 h-full ease-in-out",children:a.jsx("div",{className:"h-full",children:a.jsx("div",{className:"w-full h-full",children:a.jsxs("div",{className:"h-full",children:[a.jsx(cT,{}),e]})})})})]})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Agent Not Found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Please log in as an agent or contact administrator."}),a.jsx("button",{onClick:()=>window.location.href="/login",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Go to Login"})]})})},xB=()=>{var f,h;const[e,t]=g.useState([{title:"Active Conversations",value:"0",change:"+0",trend:"up",color:"bg-blue-100 border-blue-200 text-blue-800",icon:a.jsx(S0,{className:"h-6 w-6"}),description:"Live customer conversations"},{title:"Total Customers",value:"0",change:"+0",trend:"up",color:"bg-green-100 border-green-200 text-green-800",icon:a.jsx(C0,{className:"h-6 w-6"}),description:"Registered customers"},{title:"Orders Today",value:"0",change:"0",trend:"down",color:"bg-purple-100 border-purple-200 text-purple-800",icon:a.jsx(k0,{className:"h-6 w-6"}),description:"New orders received"},{title:"Avg Response Time",value:"0 min",change:"0",trend:"down",color:"bg-orange-100 border-orange-200 text-orange-800",icon:a.jsx(w4,{className:"h-6 w-6"}),description:"Average reply time"}]),[r,n]=g.useState([]),[s,i]=g.useState(null),[o,l]=g.useState(!0),[c,u]=g.useState(null);if(g.useEffect(()=>{(async()=>{try{l(!0);const{data:{user:b}}=await ge.auth.getUser();if(!b){u("User not authenticated");return}const{data:j,error:y}=await ge.from("agents").select("id, agent_prefix").eq("user_id",b.id).single();if(y||!j){console.error("Agent fetch error:",y),u("Agent not found");return}const _=j.agent_prefix,{data:w,error:S}=await ge.from("users").select("name").eq("id",b.id).single();S?console.error("User fetch error:",S):i({name:(w==null?void 0:w.name)||"Agent"});const E=`${_}_customers`,$=`${_}_messages`,{data:U,error:I}=await ge.from(E).select("id, name, phone").eq("agent_id",j.id),T=(U==null?void 0:U.map(R=>R.id))||[];let D=[],C=null;if(T.length>0){const{data:R,error:H}=await ge.from($).select("id, customer_id, message, direction, timestamp, is_read").in("customer_id",T).order("timestamp",{ascending:!1}).limit(10);D=R||[],C=H}const P=D.filter(R=>R.message.toLowerCase().includes("order")).length||0,F=D.length>0?new Set(D.map(R=>R.customer_id)).size:0,A=D.slice(0,3).map(R=>{const H=U==null?void 0:U.find(W=>W.id===R.customer_id);return{id:R.id.toString(),type:"conversation",title:`Message from ${(H==null?void 0:H.name)||`Customer ${R.customer_id}`}`,description:R.message.substring(0,50)+"...",time:new Date(R.timestamp).toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})+" ago",status:R.is_read?"completed":"new"}});n(A),t(R=>[{...R[0],value:F,change:`+${F}`},{...R[1],value:(U==null?void 0:U.length)||0,change:`+${(U==null?void 0:U.length)||0}`},{...R[2],value:P,change:`+${P}`},{...R[3],value:"2.3 min",change:"-0.4"}]),u(null)}catch(b){console.error("Failed to fetch dashboard data:",b),u("Failed to load dashboard data")}finally{l(!1)}})()},[]),o)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});if(c)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"text-center max-w-md",children:[a.jsx("div",{className:"text-red-600 mb-4",children:a.jsx(B$,{className:"h-12 w-12 mx-auto"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Dashboard"}),a.jsx("p",{className:"text-gray-600 mb-6",children:c}),a.jsxs("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors inline-flex items-center gap-2",children:[a.jsx(y4,{className:"h-4 w-4"}),"Retry"]})]})});const d=x=>x==="up"?a.jsx(y4,{className:"h-4 w-4"}):a.jsx(ZD,{className:"h-4 w-4"}),m=x=>{switch(x){case"new":return"bg-blue-100 text-blue-800";case"active":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return a.jsxs("div",{className:"space-y-8 p-4 md:p-6",children:[a.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white p-6 md:p-8 rounded-2xl shadow-xl",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:["Welcome back, ",(s==null?void 0:s.name)||"Agent","!"]}),a.jsx("p",{className:"text-blue-100 text-sm md:text-lg",children:"Monitor your WhatsApp business performance and customer interactions"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg md:text-xl font-semibold",children:"Real-time Dashboard"}),a.jsxs("p",{className:"text-xs md:text-sm text-blue-200",children:["Updated ",new Date().toLocaleTimeString()]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map((x,b)=>a.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:b*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100 overflow-hidden group relative",whileHover:{y:-2},children:[a.jsx("div",{className:`absolute -top-2 -right-2 w-16 h-16 ${x.color} rounded-full opacity-20 group-hover:opacity-30 transition-opacity`}),a.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[a.jsx("div",{className:`p-3 rounded-xl ${x.color}`,children:x.icon}),a.jsxs("div",{className:`text-xs font-semibold px-2 py-1 rounded-full flex items-center gap-1 ${x.trend==="up"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[d(x.trend),x.change]})]}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:x.title}),a.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-1",children:x.value}),a.jsx("p",{className:"text-sm text-gray-500",children:x.description})]})]},x.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs(Qe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"lg:col-span-2 bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100",children:a.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(w4,{className:"h-5 w-5 text-gray-500"}),"Recent Activity"]})}),a.jsxs("div",{className:"divide-y divide-gray-200",children:[r.map((x,b)=>a.jsx(Qe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3+b*.1},className:"p-6 hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsxs("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${m(x.status)}`,children:[x.type==="conversation"&&a.jsx(S0,{className:"h-5 w-5 text-current"}),x.type==="order"&&a.jsx(k0,{className:"h-5 w-5 text-current"}),x.type==="customer"&&a.jsx(C0,{className:"h-5 w-5 text-current"})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:x.title}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(x.status)}`,children:x.status})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:x.description}),a.jsx("p",{className:"text-xs text-gray-500",children:x.time})]})]})},x.id)),r.length===0&&a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(K$,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),a.jsx("p",{className:"text-lg font-medium",children:"No recent activity"}),a.jsx("p",{className:"mt-1",children:"Your activity will appear here as you interact with customers"})]})]})]}),a.jsxs(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[a.jsx(hC,{className:"h-5 w-5 text-gray-500"}),"Quick Actions"]}),a.jsx("div",{className:"space-y-3",children:[{icon:S0,title:"Start New Conversation",description:"Message a customer",action:"#",color:"from-blue-500 to-blue-600"},{icon:C0,title:"View Customer Profile",description:"Access customer details",action:"#",color:"from-green-500 to-green-600"},{icon:k0,title:"Create Order",description:"Process new order",action:"#",color:"from-purple-500 to-purple-600"},{icon:ev,title:"View Analytics",description:"Performance reports",action:"/agent/analytics",color:"from-indigo-500 to-indigo-600"},{icon:cC,title:"Account Settings",description:"Update preferences",action:"/agent/settings",color:"from-gray-500 to-gray-600"}].map((x,b)=>a.jsxs(Qe.a,{href:x.action,initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{delay:.4+b*.05},className:"group flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 transition-all duration-200 border border-gray-100 hover:border-gray-200",children:[a.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-r ${x.color} group-hover:scale-105 transition-transform`,children:a.jsx(x.icon,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 group-hover:text-gray-700",children:x.title}),a.jsx("p",{className:"text-xs text-gray-500",children:x.description})]}),a.jsx(lC,{className:"h-4 w-4 text-gray-400 group-hover:text-gray-600 transition-colors"})]},x.title))})]})]}),a.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100",children:a.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(ev,{className:"h-5 w-5 text-gray-500"}),"Performance Overview"]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[a.jsxs("div",{className:"border-r border-gray-200 pr-6 md:pr-8",children:[a.jsx("p",{className:"text-3xl font-bold text-blue-600",children:typeof((f=e[0])==null?void 0:f.value)=="number"&&e[0].value>0?"98%":"N/A"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Customer Satisfaction"})]}),a.jsxs("div",{className:"border-r border-gray-200 pr-6 md:pr-8",children:[a.jsx("p",{className:"text-3xl font-bold text-green-600",children:"2.3 min"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Avg First Response"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-3xl font-bold text-purple-600",children:typeof((h=e[2])==null?void 0:h.value)=="number"&&e[2].value>0?"99%":"N/A"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Messages Delivered"})]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:a.jsx("p",{className:"text-sm text-gray-600",children:"Your performance is excellent! Keep up the great work with your customers."})})]})]})]})},_4=()=>a.jsx(xB,{}),vB=({conversations:e,filteredConversations:t,searchConversations:r,selectedConversationId:n,totalUnread:s,displayedConversations:i,onSearchChange:o,onSelectConversation:l,onNewConversation:c})=>{const u=g.useRef(null);g.useEffect(()=>{u.current&&u.current.scrollIntoView({behavior:"smooth",block:"center"})},[n]);const d=m=>{const{conversionStage:f,interestStage:h,leadStage:x}=m;return f?{stage:f,className:"bg-green-100 text-green-800"}:h?{stage:h,className:"bg-yellow-100 text-yellow-800"}:x?{stage:x,className:"bg-blue-100 text-blue-800"}:{stage:null,className:""}};return a.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col shadow-lg h-full",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-white to-gray-50 flex-shrink-0",children:a.jsxs("div",{className:"flex items-stretch justify-between",children:[a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Messages"}),a.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-semibold",children:[s," unread"]})]}),c&&a.jsx("button",{onClick:c,className:"flex items-center justify-center ml-4 h-16 w-16 text-green-600 bg-green-100 hover:bg-green-200 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 rounded-lg",children:a.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})}),a.jsx("div",{className:"px-4 py-3 border-b border-gray-100 bg-white flex-shrink-0",children:a.jsx("input",{type:"text",value:r,onChange:o,placeholder:"Search conversations...",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-gray-50/50 placeholder-gray-500"})}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.length===0?a.jsx("div",{className:"flex items-center justify-center h-full p-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No conversations yet"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Start a conversation with your customers"})]})}):a.jsx(a.Fragment,{children:t.map((m,f)=>a.jsx("div",{ref:n===m.id?u:null,className:`px-4 py-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-all duration-200 ${n===m.id?"bg-green-50 border-r-4 border-green-500 shadow-md":""}`,onClick:()=>l(m),children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center shadow-md",children:a.jsx("span",{className:"text-white font-bold text-sm",children:m.customerName.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate pr-4 mr-auto",children:m.customerName}),a.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{const h=d(m);return h.stage?a.jsx("span",{className:`w-20 truncate px-2 py-0.5 rounded-full text-xs font-medium ${h.className} flex-shrink-0`,children:h.stage}):null})(),m.unreadCount>0&&a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-green-600 text-white shadow-sm",children:m.unreadCount})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-sm text-gray-600 truncate max-w-[200px] font-medium",children:m.lastMessage}),a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:m.lastMessageTime})]}),a.jsx("div",{className:"text-xs text-gray-400 mt-2 truncate",children:m.customerPhone})]})]})},`${m.id}-${f}`))})})]})},yB=({isOpen:e,onClose:t,onSelectProduct:r,agentPrefix:n,agentId:s})=>{const[i,o]=g.useState([]),[l,c]=g.useState(""),[u,d]=g.useState(!1),[m,f]=g.useState([]);g.useEffect(()=>{e&&h()},[e]),g.useEffect(()=>{const x=i.filter(b=>b.name.toLowerCase().includes(l.toLowerCase()));f(x)},[l,i]);const h=async()=>{if(!n||!s){console.error("Agent prefix or ID not available"),d(!1);return}d(!0);try{const x=`${n}_inventory_items`,{data:b,error:j}=await ge.from(x).select("id, name, description, price, image_urls, category_id").eq("agent_id",s).order("name",{ascending:!0});if(j)console.error("Error fetching products:",j);else{const y=(b||[]).map(_=>({id:_.id.toString(),name:_.name,description:_.description,price:_.price,images:_.image_urls||[],category_id:_.category_id||void 0}));o(y)}}catch(x){console.error("Unexpected error:",x)}finally{d(!1)}};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[80vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Product"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search products...",value:l,onChange:x=>c(x.target.value),className:"w-full px-4 py-2 pl-10 pr-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"}),a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading products..."})]}):m.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:l?"No products found.":"No products available."}):a.jsx("div",{className:"space-y-3",children:m.map(x=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>{r(x),t()},children:[x.images&&x.images.length>0&&a.jsx("img",{src:x.images[0],alt:x.name,className:"w-12 h-12 object-cover rounded-lg flex-shrink-0",onError:b=>{b.target.style.display="none"}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:x.name}),x.description&&a.jsx("p",{className:"text-sm text-gray-500 truncate",children:x.description}),x.price&&a.jsxs("p",{className:"text-sm font-semibold text-green-600",children:["$",x.price.toFixed(2)]})]})]},x.id))})}),a.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:a.jsx("button",{onClick:t,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"})})]})}):null},bB=({isOpen:e,onClose:t,onSelectService:r})=>{const[n,s]=g.useState([]),[i,o]=g.useState(""),[l,c]=g.useState(!1),[u,d]=g.useState([]);g.useEffect(()=>{e&&m()},[e]),g.useEffect(()=>{const f=n.filter(h=>h.service_name.toLowerCase().includes(i.toLowerCase()));d(f)},[i,n]);const m=async()=>{c(!0);try{const{data:f}=await ge.auth.getUser();if(!(f!=null&&f.user)){console.error("User not authenticated"),c(!1);return}const{data:h}=await ge.from("agents").select("id, agent_prefix").eq("user_id",f.user.id).single();if(!h){console.error("Agent not found"),c(!1);return}const x=`${h.agent_prefix}_services`,b=`${h.agent_prefix}_service_packages`,{data:j,error:y}=await ge.from(x).select("id, service_name, description").eq("agent_id",h.id).eq("is_active",!0).order("service_name",{ascending:!0});if(y)console.error("Error fetching services:",y),s([]);else{const _=[];for(const w of j||[]){const{data:S,error:E}=await ge.from(b).select("id, package_name, price, currency, discount, description").eq("service_id",w.id).eq("is_active",!0);E&&console.error(`Error fetching packages for service ${w.id}:`,E);const $=(S||[]).map(U=>({id:U.id,package_name:U.package_name,price:Number(U.price),currency:U.currency||"USD",discount:U.discount?Number(U.discount):void 0,description:U.description}));_.push({id:w.id,service_name:w.service_name,description:w.description,packages:$})}s(_)}}catch(f){console.error("Unexpected error fetching services:",f),s([])}finally{c(!1)}};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[80vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Service"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search services...",value:i,onChange:f=>o(f.target.value),className:"w-full px-4 py-2 pl-10 pr-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"}),a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading services..."})]}):u.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:i?"No services found.":"No services available."}):a.jsx("div",{className:"space-y-3",children:u.map(f=>a.jsx("div",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>{r(f),t()},children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:f.service_name}),f.description&&a.jsx("p",{className:"text-sm text-gray-500 truncate",children:f.description}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Packages: ",f.packages.map(h=>h.package_name).join(", ")]})]})},f.id))})}),a.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:a.jsx("button",{onClick:t,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"})})]})}):null},cb=({customer:e,agentPrefix:t,agentId:r,onClose:n,onSuccess:s})=>{const[i,o]=g.useState([]),[l,c]=g.useState(""),[u,d]=g.useState(""),[m,f]=g.useState(null),[h,x]=g.useState([]),[b,j]=g.useState(""),[y,_]=g.useState(1),[w,S]=g.useState(!1),[E,$]=g.useState(null);g.useEffect(()=>{(async()=>{if(r)try{const{data:R,error:H}=await ge.from("agents").select("business_type").eq("id",r).single();if(H){console.error("Failed to fetch business type:",H);return}R&&f(R.business_type)}catch(R){console.error("Error fetching business type:",R)}})()},[r]),g.useEffect(()=>{(async()=>{if(m==="product")try{const{data:{session:R}}=await ge.auth.getSession();if(!R)return;const H=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"GET",headers:{Authorization:`Bearer ${R.access_token}`,"Content-Type":"application/json"}});if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const W=await H.json();if(W.error)throw new Error(W.error);x(W.items||[])}catch(R){console.error("Failed to fetch inventory:",R),$("Failed to load inventory items")}})()},[m]);const U=()=>{o([...i,{name:"",quantity:1,price:0}])},I=A=>{(i.length>1||m==="product")&&o(i.filter((R,H)=>H!==A))},T=(A,R,H)=>{const W=[...i];W[A]={...W[A],[R]:H},o(W)},D=(A,R=1)=>{o([...i,{name:A.name,quantity:R,price:A.price}])},C=h.filter(A=>{var R;return A.name.toLowerCase().includes(b.toLowerCase())||((R=A.sku)==null?void 0:R.toLowerCase().includes(b.toLowerCase()))}),P=()=>i.reduce((A,R)=>A+R.quantity*R.price,0),F=async A=>{if(A.preventDefault(),!t||!r){$("Agent configuration missing");return}const R=i.filter(G=>G.name.trim()&&G.price>0&&G.quantity>0);if(R.length===0){$("Please add at least one valid item");return}const H=P(),W=l.trim()||null,M=u.trim()||null;try{S(!0),$(null);const G=`${t}_orders`,ce=`${t}_orders_items`,{data:ue,error:O}=await ge.from(G).insert({customer_id:e.id,total_amount:H,status:"pending",notes:W,shipping_address:M}).select("id").single();if(O)throw O;if(!(ue!=null&&ue.id))throw new Error("Failed to get order ID - orderData: "+JSON.stringify(ue));const Z=ue.id,B=R.map(X=>{const ne=X.name.trim().replace(/,/g," - ").replace(/"/g,"'").replace(/'/g,"''").replace(/\n/g," ").replace(/\r/g," ").replace(/--/g,"-").replace(/;/g,"").replace(/\//g,"-").substring(0,100),le=Math.floor(Number(X.quantity))||1,de=Number(X.price)||0;if(le<=0||de<=0||!ne.trim())throw new Error(`Invalid item data: quantity=${le}, price=${de}, name="${ne}"`);return{order_id:parseInt(Z.toString()),name:ne,quantity:le,price:parseFloat(de.toFixed(2)),original_name:X.name}}),{error:ee}=await ge.from(ce).insert(B.map(X=>{const{original_name:ne,...le}=X;return le}));if(ee){let X=!0;for(const ne of B){const{original_name:le,...de}=ne,{error:je}=await ge.from(ce).insert(de);if(je){X=!1;break}}if(!X)throw new Error("Failed to insert order items even with individual inserts")}s(),n()}catch(G){const ce=G.message||"Unknown error";$(`Failed to create order: ${ce}`),console.error("Order creation error:",{message:ce,code:G.code,details:G.details,hint:G.hint,stack:G.stack})}finally{S(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Create Order for ",e.name]}),a.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Customer: ",a.jsx("span",{className:"font-medium",children:e.name})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",a.jsx("span",{className:"font-medium",children:e.phone})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),a.jsx("p",{className:"px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",children:"LKR"})]}),E&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-4",children:E}),a.jsxs("form",{onSubmit:F,className:"space-y-4",children:[m==="service"?a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Items"}),i.map((A,R)=>a.jsxs("div",{className:"flex space-x-3 items-end bg-gray-50 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Item Name"}),a.jsx("input",{type:"text",value:A.name,onChange:H=>T(R,"name",H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Item name",required:!0})]}),a.jsxs("div",{className:"w-20",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Qty"}),a.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:H=>T(R,"quantity",parseInt(H.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{className:"w-24",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Price (LKR)"}),a.jsx("input",{type:"number",min:"0",step:"0.01",value:A.price,onChange:H=>T(R,"price",parseFloat(H.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),a.jsxs("div",{className:"w-20",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Total"}),a.jsx("input",{type:"number",value:(A.quantity*A.price).toFixed(2),readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg",prefix:"LKR"})]}),i.length>1&&a.jsx("button",{type:"button",onClick:()=>I(R),className:"w-8 h-8 flex items-center justify-center text-red-600 hover:text-red-800 -mt-2",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},R)),a.jsx("button",{type:"button",onClick:U,className:"text-blue-600 hover:text-blue-800 font-medium text-sm",children:"+ Add Item"})]}):m==="product"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Products from Inventory"}),a.jsx("input",{type:"text",placeholder:"Search products by name or SKU...",value:b,onChange:A=>j(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Default Quantity:"}),a.jsx("input",{type:"number",min:"1",value:y,onChange:A=>_(parseInt(A.target.value)||1),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),C.length>0?a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-lg p-2",children:C.map(A=>{var R;return a.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-100 rounded",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[((R=A.image_urls)==null?void 0:R[0])&&a.jsx("img",{src:A.image_urls[0],alt:A.name,className:"w-10 h-10 object-cover rounded flex-shrink-0"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"font-medium truncate",children:A.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:["LKR ",A.price.toFixed(2)]})]})]}),a.jsx("button",{type:"button",onClick:()=>D(A,y),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm ml-2 flex-shrink-0",children:"Add"})]},A.id)})}):a.jsx("div",{className:"text-center py-4 text-gray-500 border rounded-lg",children:b?"No products found":"No inventory items available. Add some in the Inventory page."})]}),i.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Added Order Items"}),i.map((A,R)=>a.jsxs("div",{className:"flex space-x-3 items-end bg-gray-50 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Item Name"}),a.jsx("input",{type:"text",value:A.name,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),a.jsxs("div",{className:"w-20",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Qty"}),a.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:H=>T(R,"quantity",parseInt(H.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"w-24",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Price (LKR)"}),a.jsx("input",{type:"number",min:"0",step:"0.01",value:A.price,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),a.jsxs("div",{className:"w-20",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Total"}),a.jsx("input",{type:"number",value:(A.quantity*A.price).toFixed(2),readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg"})]}),a.jsx("button",{type:"button",onClick:()=>I(R),className:"w-8 h-8 flex items-center justify-center text-red-600 hover:text-red-800 -mt-2",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},R))]})]}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"Loading business type..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),a.jsx("textarea",{value:l,onChange:A=>c(A.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Order notes or special instructions..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shipping Address (Optional)"}),a.jsx("textarea",{value:u,onChange:A=>d(A.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter shipping address..."})]}),a.jsx("div",{className:"border-t pt-4",children:a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:["Total: LKR ",P().toFixed(2)]})})}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:n,className:"flex-1 bg-gray-200 text-gray-800 py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w||P()===0,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:w?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:"Creating..."})]}):a.jsx("span",{children:"Create Order"})})]})]})]})})},fC=({order:e,onClose:t,agentPrefix:r,agentId:n})=>{var h,x,b,j,y,_,w,S,E,$,U,I;const[s,i]=g.useState(null),[o,l]=g.useState(!0),[c,u]=g.useState(null);g.useEffect(()=>{e&&r&&n&&d()},[e,r,n]);const d=async()=>{var T;if(!(!e||!r||!n))try{l(!0),u(null);let D=((T=e.parsed_order_details)==null?void 0:T.items)||[];if(D.length===0&&e.id){const P=`${r}_orders_items`,{data:F,error:A}=await ge.from(P).select("name, quantity, price").eq("order_id",e.id);A||(D=(F||[]).map(R=>({name:R.name,quantity:R.quantity,price:R.price,total:R.quantity*R.price})))}const C={...e,customer_name:e.customer_name||"Unknown Customer",customer_phone:e.customer_phone||"",parsed_order_details:{...e.parsed_order_details,items:D}};i(C)}catch(D){u("Failed to load order details"),console.error("Fetch error:",D)}finally{l(!1)}},m=()=>{var P,F,A;if(!s||!s.customer_phone){alert("Customer phone number not available");return}const T=s.customer_phone.replace(/\D/g,""),D=`Order #${s.id.toString().padStart(4,"0")} Update

Customer: ${s.customer_name}
Status: ${s.status}

Items:
${((F=(P=s.parsed_order_details)==null?void 0:P.items)==null?void 0:F.map(R=>`${R.name} - Qty: ${R.quantity} x LKR ${R.price.toFixed(2)} = LKR ${R.total.toFixed(2)}`).join(`
`))||"No items"}

Total: LKR ${((A=s.total_amount)==null?void 0:A.toFixed(2))||"0.00"}

${s.notes?`Notes: ${s.notes}`:""}

Thank you!`,C=`https://wa.me/${T}?text=${encodeURIComponent(D)}`;window.open(C,"_blank")},f=T=>{const D=T.toLowerCase();return D==="pending"?"text-yellow-600 bg-yellow-100":D==="processing"?"text-blue-600 bg-blue-100":D==="shipped"?"text-purple-600 bg-purple-100":D==="delivered"||D==="completed"?"text-green-600 bg-green-100":"text-gray-600 bg-gray-100"};return o?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4 sm:p-6",children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity","aria-hidden":"true"}),a.jsx("div",{className:"relative w-full max-w-4xl mx-auto my-8 max-h-[95vh] flex flex-col bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl ring-1 ring-black/10 overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",children:a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})]})}):c||!s?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4 sm:p-6",children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity","aria-hidden":"true"}),a.jsx("div",{className:"relative w-full max-w-md mx-auto my-8 max-h-[95vh] flex flex-col bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl ring-1 ring-black/10 overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",children:a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("p",{className:"text-red-600 mb-3 text-sm",children:c||"Order not found"}),a.jsx("button",{onClick:t,className:"inline-flex justify-center px-4 py-2 rounded-lg border border-gray-300 shadow-sm bg-white text-sm font-semibold text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all",children:"Close"})]})})]})}):a.jsx("div",{className:"fixed inset-0 z-50",children:a.jsxs("div",{className:"flex min-h-screen items-center justify-center p-2 sm:p-4",children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity","aria-hidden":"true"}),a.jsxs("div",{className:"relative w-full max-w-6xl mx-auto max-h-[95vh] flex flex-col bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl ring-1 ring-black/10 overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-blue-50/30",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"p-1.5 bg-blue-100 rounded-xl",children:a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Order #",s.id.toString().padStart(4,"0")]}),a.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-semibold rounded-full ${f(s.status)}`,children:s.status})]})]}),a.jsx("button",{type:"button",className:"group inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white border border-gray-200 text-gray-400 hover:text-gray-600 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 hover:scale-110",onClick:t,children:a.jsx("svg",{className:"h-4 w-4 group-hover:rotate-90 transition-transform",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),a.jsx("div",{className:"flex flex-1",children:a.jsx("div",{className:"p-4 space-y-4 w-full",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-3",children:[a.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-3 border border-emerald-100 shadow-sm",children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-800 uppercase tracking-wide mb-2 flex items-center",children:[a.jsx("svg",{className:"w-3 h-3 mr-1 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Customer Info"]}),a.jsxs("div",{className:"space-y-1 text-xs",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-500 font-medium",children:"Name:"}),a.jsx("span",{className:"text-gray-900 font-medium truncate",children:s.customer_name})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-500 font-medium",children:"Phone:"}),a.jsx("span",{className:"text-gray-900 font-medium",children:s.customer_phone||"N/A"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-500 font-medium",children:"Date:"}),a.jsx("span",{className:"text-gray-900 text-right",children:new Date(s.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-3 border border-blue-100 shadow-sm",children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-800 uppercase tracking-wide mb-2 flex items-center",children:[a.jsx("svg",{className:"w-3 h-3 mr-1 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.345 3.288a5.761 5.761 0 012.27 0l.99 0.383a4.606 4.606 0 004.832 0l.99-.383a5.76 5.76 0 012.27 0L21 3.288M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m0 0a2 2 0 012 2v4a2 2 0 001.343 1.856"})}),"Actions"]}),a.jsx("div",{className:"space-y-2",children:a.jsxs("button",{onClick:m,disabled:!s.customer_phone,className:"w-full disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none text-xs inline-flex justify-center items-center rounded-lg border-0 shadow-sm px-3 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium hover:from-green-700 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all duration-200",children:[a.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"WhatsApp Update"]})})]})]}),a.jsxs("div",{className:"lg:col-span-2 space-y-3",children:[a.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-3 border border-indigo-100 shadow-sm",children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-800 uppercase tracking-wide mb-2 flex items-center",children:[a.jsx("svg",{className:"w-3 h-3 mr-1 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Order Summary"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-center",children:[a.jsxs("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-2 border border-gray-100 shadow-sm",children:[a.jsxs("p",{className:"text-lg font-bold text-gray-900 mb-0.5",children:["LKR ",(s.total_amount||0).toLocaleString()]}),a.jsx("p",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"Total Amount"})]}),a.jsxs("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-2 border border-gray-100 shadow-sm",children:[a.jsx("p",{className:"text-lg font-bold text-gray-900 mb-0.5",children:((x=(h=s.parsed_order_details)==null?void 0:h.items)==null?void 0:x.length)||0}),a.jsx("p",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"Items"})]}),a.jsxs("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-2 border border-gray-100 shadow-sm",children:[a.jsx("p",{className:"text-lg font-bold text-gray-900 mb-0.5",children:((j=(b=s.parsed_order_details)==null?void 0:b.items)==null?void 0:j.reduce((T,D)=>T+(D.quantity||0),0))||0}),a.jsx("p",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"Total Quantity"})]})]})]}),a.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100/50 overflow-hidden flex-1",children:[a.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-blue-50/30 border-b border-gray-100",children:a.jsxs("h4",{className:"text-sm font-bold text-gray-900",children:["Order Items (",((_=(y=s.parsed_order_details)==null?void 0:y.items)==null?void 0:_.length)||0,")"]})}),a.jsx("div",{className:"max-h-48 overflow-y-auto",children:((S=(w=s.parsed_order_details)==null?void 0:w.items)==null?void 0:S.length)===0?a.jsxs("div",{className:"text-center py-6",children:[a.jsx("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),a.jsx("h3",{className:"mt-1 text-xs font-medium text-gray-900",children:"No items"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"No items in this order."})]}):a.jsxs("div",{className:"divide-y divide-gray-200",children:[($=(E=s.parsed_order_details)==null?void 0:E.items)==null?void 0:$.map((T,D)=>{const C=T.quantity*T.price;return a.jsx("div",{className:"px-4 py-3 bg-white hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h5",{className:"text-sm font-semibold text-gray-900 truncate mb-0.5",children:T.name}),a.jsxs("p",{className:"text-xs text-gray-600",children:["Qty: ",T.quantity,"  LKR ",T.price.toFixed(2)]})]}),a.jsx("div",{className:"text-right ml-3 min-w-[80px]",children:a.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["LKR ",C.toLocaleString()]})})]})},D)}),a.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-blue-50/30 border-t border-gray-100 font-bold",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm",children:"Total"}),a.jsxs("span",{className:"text-lg text-gray-900",children:["LKR ",(s.total_amount||0).toLocaleString()]})]})})]})})]}),(s.notes||((U=s.parsed_order_details)==null?void 0:U.shipping_address))&&a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[s.notes&&a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-3 border border-gray-200 shadow-sm",children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-800 uppercase tracking-wide mb-1 flex items-center",children:[a.jsx("svg",{className:"w-3 h-3 mr-1 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Notes"]}),a.jsx("p",{className:"text-xs text-gray-700 leading-tight line-clamp-3",children:s.notes})]}),((I=s.parsed_order_details)==null?void 0:I.shipping_address)&&a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-3 border border-blue-200 shadow-sm",children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-800 uppercase tracking-wide mb-1 flex items-center",children:[a.jsxs("svg",{className:"w-3 h-3 mr-1 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Shipping"]}),a.jsx("p",{className:"text-xs text-gray-700 leading-tight line-clamp-3",children:s.parsed_order_details.shipping_address})]})]})]})]})})}),a.jsx("div",{className:"pt-3 border-t border-gray-100 bg-gray-50 px-4 py-2 flex justify-end",children:a.jsx("button",{type:"button",onClick:t,className:"inline-flex justify-center px-4 py-2 rounded-lg border border-gray-300 shadow-sm bg-white text-sm font-semibold text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all",children:"Close"})})]})]})})},mC=({order:e,onClose:t,onSuccess:r,agentPrefix:n,agentId:s})=>{const[i,o]=g.useState((e==null?void 0:e.status)||""),[l,c]=g.useState((e==null?void 0:e.shipping_address)||""),[u,d]=g.useState([]),[m,f]=g.useState(!1),[h,x]=g.useState(""),[b,j]=g.useState(1),[y,_]=g.useState(0),[w,S]=g.useState(!0),[E,$]=g.useState(null),[U,I]=g.useState([]),[T,D]=g.useState(""),[C,P]=g.useState(1);g.useEffect(()=>{e&&n&&(c(e.shipping_address||""),F())},[e,n]),g.useEffect(()=>{(async()=>{let ee=s;if(!ee&&(e!=null&&e.agent_id)&&(ee=e.agent_id),!!ee)try{const{data:X,error:ne}=await ge.from("agents").select("business_type").eq("id",ee).single();if(ne){console.error("Failed to fetch business type:",ne);return}X&&$(X.business_type)}catch(X){console.error("Error fetching business type:",X)}})()},[s,e==null?void 0:e.agent_id]),g.useEffect(()=>{(async()=>{if(E==="product")try{const{data:{session:ee}}=await ge.auth.getSession();if(!ee)return;const X=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"GET",headers:{Authorization:`Bearer ${ee.access_token}`,"Content-Type":"application/json"}});if(!X.ok)throw new Error(`HTTP ${X.status}: ${X.statusText}`);const ne=await X.json();if(ne.error)throw new Error(ne.error);I(ne.items||[])}catch(ee){console.error("Failed to fetch inventory:",ee)}})()},[E]);const F=async()=>{if(!e||!n){S(!1);return}try{S(!0);const B=`${n}_orders_items`,{data:ee,error:X}=await ge.from(B).select("name, quantity, price").eq("order_id",e.id).order("created_at");if(X)throw X;d((ee||[]).map(ne=>({name:ne.name,quantity:ne.quantity,price:ne.price,total:ne.quantity*ne.price})))}catch(B){console.error("Failed to fetch order items:",B)}finally{S(!1)}},A=B=>{o(B.target.value)},R=(B,ee)=>{const X=[...u];X[B]&&(X[B].name=ee,X[B].total=X[B].quantity*X[B].price,d(X))},H=(B,ee)=>{const X=[...u];X[B]&&(X[B].quantity=Math.max(1,ee),X[B].total=X[B].quantity*X[B].price,d(X))},W=(B,ee)=>{const X=[...u];X[B]&&(X[B].price=Math.max(0,ee),X[B].total=X[B].quantity*X[B].price,d(X))},M=()=>{if(E==="service"){if(!h.trim()||b<=0||y<=0)return;const B={id:0,order_id:e.id,name:h.trim(),quantity:b,price:y,total:b*y,created_at:new Date().toISOString()};d([...u,B]),x(""),j(1),_(0)}},G=(B,ee=1)=>{const X={id:0,order_id:e.id,name:B.name,quantity:ee,price:B.price,total:ee*B.price,created_at:new Date().toISOString()};d([...u,X])},ce=U.filter(B=>{var ee;return B.name.toLowerCase().includes(T.toLowerCase())||((ee=B.sku)==null?void 0:ee.toLowerCase().includes(T.toLowerCase()))}),ue=B=>{d(u.filter((ee,X)=>X!==B))},O=async()=>{if(!(!e||!n||!s)){f(!0);try{const B=`${n}_orders`,ee=`${n}_orders_items`,{error:X}=await ge.from(B).update({status:i,total_amount:u.reduce((le,de)=>le+de.quantity*de.price,0),notes:e.notes||null,shipping_address:l.trim()||null,updated_at:new Date().toISOString()}).eq("id",e.id);if(X)throw X;const{error:ne}=await ge.from(ee).delete().eq("order_id",e.id);if(ne&&ne.code!=="PGRST116")throw ne;if(u.length>0){const le=u.map(je=>({order_id:e.id,name:je.name,quantity:je.quantity,price:je.price})),{error:de}=await ge.from(ee).insert(le);if(de)throw de}r(),t()}catch(B){console.error("Update order error:",B),alert("Failed to update order: "+B.message)}finally{f(!1)}}};if(!e||w)return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx("div",{className:"bg-white rounded-xl p-6",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(E===null)return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 text-center",children:[a.jsx("p",{className:"text-red-600 mb-4",children:"Unable to load business type. Please refresh and try again."}),a.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Close"})]})});const Z=u.reduce((B,ee)=>B+ee.quantity*ee.price,0);return a.jsx("div",{className:"fixed inset-0 z-50",children:a.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4 sm:p-6",children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity","aria-hidden":"true"}),a.jsxs("div",{className:"relative w-full max-w-6xl mx-auto my-4 max-h-[90vh] flex flex-col bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl ring-1 ring-black/10 animate-in fade-in-0 zoom-in-95 duration-300 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 lg:px-4 py-3 lg:py-3.5 border-b border-gray-100 bg-gradient-to-r from-gray-50/80 to-blue-50/50 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-2xl",children:a.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 01-2-2m0 13l6-6m-6 6V5a2 2 0 012-2h2a2 2 0 012 2v8a2 2 0 001 1.732V19a2 2 0 01-2 2h-1v-6a1 1 0 00-1-1H9a1 1 0 00-1 1v6H7a2 2 0 01-2-2v-4a2 2 0 011.732-1.732M9 5a2 2 0 002 2h2a2 2 0 002-2m0 4v-6a1 1 0 00-1-1H9a1 1 0 00-1 1v6H7"})})}),a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Edit Order #",e.id]})]}),a.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-500 rounded-lg hover:bg-gray-100 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 lg:p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Status"}),a.jsxs("select",{value:i,onChange:A,className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"processing",children:"Processing"}),a.jsx("option",{value:"shipped",children:"Shipped"}),a.jsx("option",{value:"delivered",children:"Delivered"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Items"}),u.length>0&&a.jsxs("span",{className:"text-sm text-gray-500",children:[u.length," item(s)"]})]}),a.jsx("div",{className:"space-y-3 mb-4",children:u.map((B,ee)=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",value:B.name,onChange:X=>E==="service"?R(ee,X.target.value):void 0,placeholder:"Item name",className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${E==="product"?"bg-gray-100 cursor-not-allowed":""}`,readOnly:E==="product"})}),a.jsx("div",{className:"w-20",children:a.jsx("input",{type:"number",value:B.quantity,onChange:X=>H(ee,parseInt(X.target.value)||1),min:"1",placeholder:"Qty",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center"})}),a.jsx("div",{className:"w-24",children:a.jsx("input",{type:"number",value:B.price,onChange:X=>E==="service"?W(ee,parseFloat(X.target.value)||0):void 0,min:"0",step:"0.01",placeholder:"Price",className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-right ${E==="product"?"bg-gray-100 cursor-not-allowed":""}`,readOnly:E==="product"})}),a.jsxs("div",{className:"w-24 text-right font-medium text-gray-900",children:["LKR ",(B.quantity*B.price).toFixed(2)]}),a.jsx("button",{onClick:()=>ue(ee),className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},ee))}),E==="service"?a.jsxs("div",{className:"flex items-end space-x-3 p-3 bg-blue-50 rounded-xl",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",value:h,onChange:B=>x(B.target.value),placeholder:"Add new item",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),a.jsx("div",{className:"w-20",children:a.jsx("input",{type:"number",value:b,onChange:B=>j(parseInt(B.target.value)||1),min:"1",placeholder:"Qty",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center"})}),a.jsx("div",{className:"w-24",children:a.jsx("input",{type:"number",value:y,onChange:B=>_(parseFloat(B.target.value)||0),min:"0",step:"0.01",placeholder:"Price",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-right"})}),a.jsx("button",{onClick:M,disabled:!h.trim()||b<=0||y<=0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Add"})]}):E==="product"?a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Products from Inventory"}),a.jsx("input",{type:"text",placeholder:"Search products by name or SKU...",value:T,onChange:B=>D(B.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Default Quantity:"}),a.jsx("input",{type:"number",min:"1",value:C,onChange:B=>P(parseInt(B.target.value)||1),className:"w-20 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center"})]}),ce.length>0?a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-lg p-2",children:ce.map(B=>{var ee;return a.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-100 rounded",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[((ee=B.image_urls)==null?void 0:ee[0])&&a.jsx("img",{src:B.image_urls[0],alt:B.name,className:"w-10 h-10 object-cover rounded flex-shrink-0"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"font-medium truncate",children:B.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:["LKR ",B.price.toFixed(2)]})]})]}),a.jsx("button",{type:"button",onClick:()=>G(B,C),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm ml-2 flex-shrink-0",children:"Add"})]},B.id)})}):a.jsx("div",{className:"text-center py-4 text-gray-500 border rounded-lg",children:T?"No products found":"No inventory items available."})]}):null]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shipping Address (Optional)"}),a.jsx("textarea",{value:l,onChange:B=>c(B.target.value),rows:3,className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-vertical",placeholder:"Enter shipping address..."})]}),a.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-xl",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total Amount:"}),a.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["LKR ",Z.toFixed(2)]})]})})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 px-4 py-4 bg-gray-50 border-t border-gray-100",children:[a.jsx("button",{onClick:t,disabled:m,className:"px-6 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-xl hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:O,disabled:m||u.length===0,className:"px-6 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 transition-colors",children:m?"Updating...":"Update Order"})]})]})]})})},pC=({customer:e,createAppointment:t,onClose:r,onSuccess:n})=>{const[s,i]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState(30),[d,m]=g.useState("pending"),[f,h]=g.useState(""),[x,b]=g.useState(!1),[j,y]=g.useState(null),_=[{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],w=async S=>{if(S.preventDefault(),!s.trim()){y("Title is required");return}const E=new Date(o);if(isNaN(E.getTime())||E<new Date){y("Appointment date must be a valid future date");return}if(c<=0||c>1440){y("Duration must be between 1 and 1440 minutes");return}if(!_.some($=>$.value===d)){y("Invalid status");return}try{b(!0),y(null);const $={customer_id:e.id,title:s.trim(),appointment_date:E.toISOString(),duration_minutes:c,status:"pending",notes:f.trim()||void 0};await t($),n(),r()}catch($){const U=$.message||"Unknown error";y(`Failed to create appointment: ${U}`),console.error("Appointment creation error:",$)}finally{b(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Create Appointment for ",e.name]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Customer: ",a.jsx("span",{className:"font-medium",children:e.name})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",a.jsx("span",{className:"font-medium",children:e.phone})]})]}),j&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-4",children:j}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",value:s,onChange:S=>i(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Appointment title",required:!0,maxLength:100})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date & Time *"}),a.jsx("input",{type:"datetime-local",value:o,onChange:S=>l(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),a.jsx("input",{type:"number",min:"1",max:"1440",value:c,onChange:S=>u(parseInt(S.target.value)||30),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"30"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsx("select",{value:d,onChange:S=>m(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:_.map(S=>a.jsx("option",{value:S.value,children:S.label},S.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),a.jsx("textarea",{value:f,onChange:S=>h(S.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional notes..."})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:r,className:"flex-1 bg-gray-200 text-gray-800 py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:x||!s.trim()||!o,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:x?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:"Creating..."})]}):a.jsx("span",{children:"Create Appointment"})})]})]})]})})},gC=({appointment:e,onClose:t})=>{const r=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=s=>{const i=s.toLowerCase();return i==="pending"?"bg-yellow-100 text-yellow-800":i==="confirmed"?"bg-blue-100 text-blue-800":i==="completed"?"bg-green-100 text-green-800":i==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Appointment Details"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment #"}),a.jsxs("p",{className:"text-sm text-gray-900",children:["#",e.id.toString().padStart(4,"0")]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.customer_name}),a.jsx("p",{className:"text-sm text-gray-500",children:e.customer_phone})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("p",{className:"text-sm text-gray-900",children:e.title})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date & Time"}),a.jsx("p",{className:"text-sm text-gray-900",children:r(e.appointment_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),a.jsxs("p",{className:"text-sm text-gray-900",children:[e.duration_minutes," minutes"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${n(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),e.notes&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-900",children:e.notes})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Created"}),a.jsx("p",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]}),a.jsx("div",{className:"flex justify-end space-x-3 pt-6",children:a.jsx("button",{onClick:t,className:"bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})},xC=({appointment:e,updateAppointment:t,onClose:r,onSuccess:n})=>{const s=E=>{const $=E.getFullYear(),U=String(E.getMonth()+1).padStart(2,"0"),I=String(E.getDate()).padStart(2,"0"),T=String(E.getHours()).padStart(2,"0"),D=String(E.getMinutes()).padStart(2,"0");return`${$}-${U}-${I}T${T}:${D}`},[i,o]=g.useState(e.title);console.log("Original appointment_date:",e.appointment_date),console.log("Parsed date:",new Date(e.appointment_date)),console.log("Formatted local datetime:",s(new Date(e.appointment_date)));const[l,c]=g.useState(s(new Date(e.appointment_date))),[u,d]=g.useState(e.duration_minutes),[m,f]=g.useState(e.status),[h,x]=g.useState(e.notes||""),[b,j]=g.useState(!1),[y,_]=g.useState(null),w=[{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}];g.useEffect(()=>{o(e.title),c(s(new Date(e.appointment_date))),d(e.duration_minutes),f(e.status),x(e.notes||"")},[e]);const S=async E=>{if(E.preventDefault(),!i.trim()){_("Title is required");return}const $=new Date(l);if(isNaN($.getTime())||$<new Date){_("Appointment date must be a valid future date");return}if(u<=0||u>1440){_("Duration must be between 1 and 1440 minutes");return}if(!w.some(U=>U.value===m)){_("Invalid status");return}try{j(!0),_(null);const U={title:i.trim(),appointment_date:$.toISOString(),duration_minutes:u,status:m,notes:h.trim()||void 0};await t(e.id,U),n(),r()}catch(U){const I=U.message||"Unknown error";_(`Failed to update appointment: ${I}`),console.error("Appointment update error:",U)}finally{j(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Edit Appointment"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Customer:"," ",a.jsx("span",{className:"font-medium",children:e.customer_name})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Phone:"," ",a.jsx("span",{className:"font-medium",children:e.customer_phone})]})]}),y&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-4",children:y}),a.jsxs("form",{onSubmit:S,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",value:i,onChange:E=>o(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Appointment title",required:!0,maxLength:100})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date & Time *"}),a.jsx("input",{type:"datetime-local",value:l,onChange:E=>c(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),a.jsx("input",{type:"number",min:"1",max:"1440",value:u,onChange:E=>d(parseInt(E.target.value)||30),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"30"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsx("select",{value:m,onChange:E=>f(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:w.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),a.jsx("textarea",{value:h,onChange:E=>x(E.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional notes..."})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:r,className:"flex-1 bg-gray-200 text-gray-800 py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:b||!i.trim()||!l,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:b?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:"Updating..."})]}):a.jsx("span",{children:"Update Appointment"})})]})]})]})})},wB=({orders:e,customerId:t,loading:r,agentPrefix:n,agentId:s,customerName:i,customerPhone:o,onViewOrder:l,onEditOrder:c,onGenerateInvoice:u,onDeleteOrder:d,onRefresh:m})=>{const f=async h=>{if(window.confirm(`Are you sure you want to delete Order #${h}? This action cannot be undone.`))try{if(!n)throw new Error("Missing agent prefix");const x=`${n}_orders`,{error:b}=await ge.from(x).delete().eq("id",h);if(b)throw b;m()}catch(x){alert("Failed to delete order: "+x.message)}};return r?a.jsx("div",{className:"flex justify-center items-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):a.jsx(a.Fragment,{children:e.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No orders found for this customer."}):a.jsx("div",{className:"space-y-4",children:e.map(h=>{var x;return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("h3",{className:"font-medium text-gray-900",children:["Order #",h.id.toString().padStart(4,"0")]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.status==="completed"?"bg-green-100 text-green-800":h.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:h.status})]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Total: LKR ",((x=h.total_amount)==null?void 0:x.toFixed(2))||"0.00"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Placed on: ",new Date(h.created_at).toLocaleDateString()]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pt-2 border-t border-gray-100",children:[a.jsxs("button",{onClick:()=>l(h),className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors flex items-center space-x-1",children:[a.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),a.jsx("span",{children:"View"})]}),a.jsxs("button",{onClick:()=>c(h),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 transition-colors flex items-center space-x-1",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>u(h.id,`Invoice for Order #${h.id.toString().padStart(4,"0")}`),className:"px-3 py-1 bg-purple-600 text-white text-xs rounded hover:bg-purple-700 transition-colors flex items-center space-x-1",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("span",{children:"Generate Invoice"})]}),a.jsxs("button",{onClick:()=>f(h.id),className:"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors flex items-center space-x-1",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),a.jsx("span",{children:"Delete"})]})]})]},h.id)})})})},_B=({invoices:e,agentPrefix:t,customerPhone:r,agentId:n,customerName:s,updatingId:i,onRefresh:o,onSendInvoice:l,onDeleteInvoice:c,onMarkPaid:u})=>{const d=async f=>{try{const h=await fetch(f.pdf_url);if(!h.ok)throw new Error("Failed to fetch PDF");const x=await h.blob(),b=URL.createObjectURL(x),j=document.createElement("a");j.href=b,j.download=`${f.name.replace(/[^a-z0-9]/gi,"_")}.pdf`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(b)}catch(h){console.error("Download error:",h);const x=document.createElement("a");x.href=f.pdf_url,x.download=`${f.name.replace(/[^a-z0-9]/gi,"_")}.pdf`,x.click()}},m=async f=>{if(window.confirm(`Are you sure you want to delete invoice "${f.name}"? This action cannot be undone.`)){if(!t){alert("Missing agent prefix");return}try{const h=f.pdf_url.split("/invoices/");if(h.length<2)throw new Error("Invalid invoice URL");const x=h[1],b=`${t}_orders_invoices`,{error:j}=await ge.storage.from("invoices").remove([x]);j&&console.warn("Storage delete error:",j);const{error:y}=await ge.from(b).delete().eq("id",f.id);if(y)throw y;o(),alert("Invoice deleted successfully!")}catch(h){alert("Failed to delete invoice: "+h.message),console.error("Error deleting invoice:",h)}}};return a.jsx(a.Fragment,{children:e.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No invoices found for this customer."}):a.jsx("div",{className:"space-y-4",children:e.map(f=>{var h;return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("h3",{className:"font-medium text-gray-900",children:[f.name," - #",f.id.toString().padStart(4,"0")]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f.status==="paid"?"bg-green-100 text-green-800":f.status==="sent"?"bg-yellow-100 text-yellow-800":f.status==="generated"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:f.status.charAt(0).toUpperCase()+f.status.slice(1)})]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Total: LKR ",((h=f.total_amount)==null?void 0:h.toFixed(2))||"0.00"]}),a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Created on: ",new Date(f.created_at).toLocaleDateString()]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>window.open(f.pdf_url,"_blank"),className:"px-3 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors",children:"View"}),a.jsx("button",{onClick:()=>d(f),className:"px-3 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors",children:"Download"}),a.jsx("button",{onClick:()=>l(f),className:"px-3 py-1 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors",children:"Send"}),(f.status==="generated"||f.status==="sent")&&a.jsx("button",{onClick:()=>u(f),disabled:i===f.id,className:`px-3 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors ${i===f.id?"opacity-50 cursor-not-allowed":""}`,children:i===f.id?"Updating...":"Mark Paid"}),a.jsx("button",{onClick:()=>m(f),className:"px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"Delete"})]})]},f.id)})})})},jB=({appointments:e,loading:t,onViewAppointment:r,onEditAppointment:n,onDeleteAppointment:s})=>{const i=o=>{window.confirm("Are you sure you want to delete this appointment? This action cannot be undone.")&&s(o)};return t?a.jsx("div",{className:"flex justify-center items-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):a.jsx(a.Fragment,{children:e.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No appointments found for this customer."}):a.jsx("div",{className:"space-y-4",children:e.map(o=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:o.title}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o.status==="completed"?"bg-green-100 text-green-800":o.status==="pending"?"bg-yellow-100 text-yellow-800":o.status==="confirmed"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:o.status})]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Date: ",new Date(o.appointment_date).toLocaleDateString()]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Duration: ",o.duration_minutes," minutes"]}),o.notes&&a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Notes: ",o.notes]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Created on: ",new Date(o.created_at).toLocaleDateString()]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pt-2 border-t border-gray-100",children:[a.jsxs("button",{onClick:()=>r(o),className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors flex items-center space-x-1",children:[a.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),a.jsx("span",{children:"View"})]}),a.jsxs("button",{onClick:()=>n(o),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 transition-colors flex items-center space-x-1",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>i(o.id),className:"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors flex items-center space-x-1",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),a.jsx("span",{children:"Delete"})]})]})]},o.id))})})};function xr(e){"@babel/helpers - typeof";return xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xr(e)}var Xi=Uint8Array,ni=Uint16Array,ub=Int32Array,db=new Xi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hb=new Xi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),j4=new Xi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vC=function(e,t){for(var r=new ni(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new ub(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},yC=vC(db,2),NB=yC.b,tv=yC.r;NB[28]=258,tv[258]=28;var SB=vC(hb,0),N4=SB.r,rv=new ni(32768);for(var Mr=0;Mr<32768;++Mr){var qo=(Mr&43690)>>1|(Mr&21845)<<1;qo=(qo&52428)>>2|(qo&13107)<<2,qo=(qo&61680)>>4|(qo&3855)<<4,rv[Mr]=((qo&65280)>>8|(qo&255)<<8)>>1}var $h=function(e,t,r){for(var n=e.length,s=0,i=new ni(t);s<n;++s)e[s]&&++i[e[s]-1];var o=new ni(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(r){l=new ni(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var u=s<<4|e[s],d=t-e[s],m=o[e[s]-1]++<<d,f=m|(1<<d)-1;m<=f;++m)l[rv[m]>>c]=u}else for(l=new ni(n),s=0;s<n;++s)e[s]&&(l[s]=rv[o[e[s]-1]++]>>15-e[s]);return l},Tc=new Xi(288);for(var Mr=0;Mr<144;++Mr)Tc[Mr]=8;for(var Mr=144;Mr<256;++Mr)Tc[Mr]=9;for(var Mr=256;Mr<280;++Mr)Tc[Mr]=7;for(var Mr=280;Mr<288;++Mr)Tc[Mr]=8;var vp=new Xi(32);for(var Mr=0;Mr<32;++Mr)vp[Mr]=5;var kB=$h(Tc,9,0),CB=$h(vp,5,0),bC=function(e){return(e+7)/8|0},EB=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new Xi(e.subarray(t,r))},Wa=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},ch=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},q1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,i=r.slice();if(!s)return{t:_C,l:0};if(s==1){var o=new Xi(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(E,$){return E.f-$.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,m=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[u].f<r[m].f?u++:m++],c=r[u!=d&&r[u].f<r[m].f?u++:m++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var f=i[0].s,n=1;n<s;++n)i[n].s>f&&(f=i[n].s);var h=new ni(f+1),x=nv(r[d-1],h,0);if(x>t){var n=0,b=0,j=x-t,y=1<<j;for(i.sort(function($,U){return h[U.s]-h[$.s]||$.f-U.f});n<s;++n){var _=i[n].s;if(h[_]>t)b+=y-(1<<x-h[_]),h[_]=t;else break}for(b>>=j;b>0;){var w=i[n].s;h[w]<t?b-=1<<t-h[w]++-1:++n}for(;n>=0&&b;--n){var S=i[n].s;h[S]==t&&(--h[S],++b)}x=t}return{t:new Xi(h),l:x}},nv=function(e,t,r){return e.s==-1?Math.max(nv(e.l,t,r+1),nv(e.r,t,r+1)):t[e.s]=r},S4=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ni(++t),n=0,s=e[0],i=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=e[l]}return{c:r.subarray(0,n),n:t}},uh=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},wC=function(e,t,r){var n=r.length,s=bC(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<n;++i)e[s+i+4]=r[i];return(s+4+n)*8},k4=function(e,t,r,n,s,i,o,l,c,u,d){Wa(t,d++,r),++s[256];for(var m=q1(s,15),f=m.t,h=m.l,x=q1(i,15),b=x.t,j=x.l,y=S4(f),_=y.c,w=y.n,S=S4(b),E=S.c,$=S.n,U=new ni(19),I=0;I<_.length;++I)++U[_[I]&31];for(var I=0;I<E.length;++I)++U[E[I]&31];for(var T=q1(U,7),D=T.t,C=T.l,P=19;P>4&&!D[j4[P-1]];--P);var F=u+5<<3,A=uh(s,Tc)+uh(i,vp)+o,R=uh(s,f)+uh(i,b)+o+14+3*P+uh(U,D)+2*U[16]+3*U[17]+7*U[18];if(c>=0&&F<=A&&F<=R)return wC(t,d,e.subarray(c,c+u));var H,W,M,G;if(Wa(t,d,1+(R<A)),d+=2,R<A){H=$h(f,h,0),W=f,M=$h(b,j,0),G=b;var ce=$h(D,C,0);Wa(t,d,w-257),Wa(t,d+5,$-1),Wa(t,d+10,P-4),d+=14;for(var I=0;I<P;++I)Wa(t,d+3*I,D[j4[I]]);d+=3*P;for(var ue=[_,E],O=0;O<2;++O)for(var Z=ue[O],I=0;I<Z.length;++I){var B=Z[I]&31;Wa(t,d,ce[B]),d+=D[B],B>15&&(Wa(t,d,Z[I]>>5&127),d+=Z[I]>>12)}}else H=kB,W=Tc,M=CB,G=vp;for(var I=0;I<l;++I){var ee=n[I];if(ee>255){var B=ee>>18&31;ch(t,d,H[B+257]),d+=W[B+257],B>7&&(Wa(t,d,ee>>23&31),d+=db[B]);var X=ee&31;ch(t,d,M[X]),d+=G[X],X>3&&(ch(t,d,ee>>5&8191),d+=hb[X])}else ch(t,d,H[ee]),d+=W[ee]}return ch(t,d,H[256]),d+W[256]},AB=new ub([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_C=new Xi(0),LB=function(e,t,r,n,s,i){var o=i.z||e.length,l=new Xi(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),u=i.l,d=(i.r||0)&7;if(t){d&&(c[0]=i.r>>3);for(var m=AB[t-1],f=m>>13,h=m&8191,x=(1<<r)-1,b=i.p||new ni(32768),j=i.h||new ni(x+1),y=Math.ceil(r/3),_=2*y,w=function(he){return(e[he]^e[he+1]<<y^e[he+2]<<_)&x},S=new ub(25e3),E=new ni(288),$=new ni(32),U=0,I=0,T=i.i||0,D=0,C=i.w||0,P=0;T+2<o;++T){var F=w(T),A=T&32767,R=j[F];if(b[A]=R,j[F]=A,C<=T){var H=o-T;if((U>7e3||D>24576)&&(H>423||!u)){d=k4(e,c,0,S,E,$,I,D,P,T-P,d),D=U=I=0,P=T;for(var W=0;W<286;++W)E[W]=0;for(var W=0;W<30;++W)$[W]=0}var M=2,G=0,ce=h,ue=A-R&32767;if(H>2&&F==w(T-ue))for(var O=Math.min(f,H)-1,Z=Math.min(32767,T),B=Math.min(258,H);ue<=Z&&--ce&&A!=R;){if(e[T+M]==e[T+M-ue]){for(var ee=0;ee<B&&e[T+ee]==e[T+ee-ue];++ee);if(ee>M){if(M=ee,G=ue,ee>O)break;for(var X=Math.min(ue,ee-2),ne=0,W=0;W<X;++W){var le=T-ue+W&32767,de=b[le],je=le-de&32767;je>ne&&(ne=je,R=le)}}}A=R,R=b[A],ue+=A-R&32767}if(G){S[D++]=268435456|tv[M]<<18|N4[G];var me=tv[M]&31,Le=N4[G]&31;I+=db[me]+hb[Le],++E[257+me],++$[Le],C=T+M,++U}else S[D++]=e[T],++E[e[T]]}}for(T=Math.max(T,C);T<o;++T)S[D++]=e[T],++E[e[T]];d=k4(e,c,u,S,E,$,I,D,P,T-P,d),u||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=j,i.p=b,i.i=T,i.w=C)}else{for(var T=i.w||0;T<o+u;T+=65535){var ve=T+65535;ve>=o&&(c[d/8|0]=u,ve=o),d=wC(c,d+1,e.subarray(T,ve))}i.i=o}return EB(l,0,n+bC(d)+s)},jC=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},PB=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Xi(i.length+e.length);o.set(i),o.set(e,i.length),e=o,s.w=i.length}return LB(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},NC=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},TB=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=jC();s.p(t.dictionary),NC(e,2,s.d())}};function sv(e,t){t||(t={});var r=jC();r.p(e);var n=PB(e,t,t.dictionary?6:2,4);return TB(n,t),NC(n,n.length-4,r.d()),n}var IB=typeof TextDecoder<"u"&&new TextDecoder,MB=0;try{IB.decode(_C,{stream:!0}),MB=1}catch{}function OB(e){if(Array.isArray(e))return e}function RB(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function C4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function FB(e,t){if(e){if(typeof e=="string")return C4(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C4(e,t):void 0}}function DB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E4(e,t){return OB(e)||RB(e,t)||FB(e,t)||DB()}function A4(e,t="utf8"){return new TextDecoder(t).decode(e)}const $B=new TextEncoder;function BB(e){return $B.encode(e)}const UB=1024*8,zB=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),V1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class fb{constructor(t=UB,r={}){gr(this,"buffer");gr(this,"byteLength");gr(this,"byteOffset");gr(this,"length");gr(this,"offset");gr(this,"lastWrittenByte");gr(this,"littleEndian");gr(this,"_data");gr(this,"_mark");gr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,i=t.byteLength-s;let o=s;(ArrayBuffer.isView(t)||t instanceof fb)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=V1[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+n);if(this.littleEndian===zB&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new V1[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new V1[r](i);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return A4(this.readBytes(t))}decodeText(t=1,r="utf8"){return A4(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(BB(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const qB=4,L4=0,P4=1,VB=2;function yd(e){let t=e.length;for(;--t>=0;)e[t]=0}const WB=0,SC=1,HB=2,GB=3,KB=258,mb=29,zf=256,pf=zf+1+mb,zu=30,pb=19,kC=2*pf+1,yc=15,W1=16,YB=7,gb=256,CC=16,EC=17,AC=18,iv=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),E0=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ZB=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),LC=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),JB=512,Ja=new Array((pf+2)*2);yd(Ja);const Bh=new Array(zu*2);yd(Bh);const gf=new Array(JB);yd(gf);const xf=new Array(KB-GB+1);yd(xf);const xb=new Array(mb);yd(xb);const yp=new Array(zu);yd(yp);function H1(e,t,r,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let PC,TC,IC;function G1(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const MC=e=>e<256?gf[e]:gf[256+(e>>>7)],vf=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Rs=(e,t,r)=>{e.bi_valid>W1-r?(e.bi_buf|=t<<e.bi_valid&65535,vf(e,e.bi_buf),e.bi_buf=t>>W1-e.bi_valid,e.bi_valid+=r-W1):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},ba=(e,t,r)=>{Rs(e,r[t*2],r[t*2+1])},OC=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},XB=e=>{e.bi_valid===16?(vf(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},QB=(e,t)=>{const r=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,m,f,h,x,b=0;for(f=0;f<=yc;f++)e.bl_count[f]=0;for(r[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<kC;u++)d=e.heap[u],f=r[r[d*2+1]*2+1]+1,f>c&&(f=c,b++),r[d*2+1]=f,!(d>n)&&(e.bl_count[f]++,h=0,d>=l&&(h=o[d-l]),x=r[d*2],e.opt_len+=x*(f+h),i&&(e.static_len+=x*(s[d*2+1]+h)));if(b!==0){do{for(f=c-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[c]--,b-=2}while(b>0);for(f=c;f!==0;f--)for(d=e.bl_count[f];d!==0;)m=e.heap[--u],!(m>n)&&(r[m*2+1]!==f&&(e.opt_len+=(f-r[m*2+1])*r[m*2],r[m*2+1]=f),d--)}},RC=(e,t,r)=>{const n=new Array(yc+1);let s=0,i,o;for(i=1;i<=yc;i++)s=s+r[i-1]<<1,n[i]=s;for(o=0;o<=t;o++){let l=e[o*2+1];l!==0&&(e[o*2]=OC(n[l]++,l))}},eU=()=>{let e,t,r,n,s;const i=new Array(yc+1);for(r=0,n=0;n<mb-1;n++)for(xb[n]=r,e=0;e<1<<iv[n];e++)xf[r++]=n;for(xf[r-1]=n,s=0,n=0;n<16;n++)for(yp[n]=s,e=0;e<1<<E0[n];e++)gf[s++]=n;for(s>>=7;n<zu;n++)for(yp[n]=s<<7,e=0;e<1<<E0[n]-7;e++)gf[256+s++]=n;for(t=0;t<=yc;t++)i[t]=0;for(e=0;e<=143;)Ja[e*2+1]=8,e++,i[8]++;for(;e<=255;)Ja[e*2+1]=9,e++,i[9]++;for(;e<=279;)Ja[e*2+1]=7,e++,i[7]++;for(;e<=287;)Ja[e*2+1]=8,e++,i[8]++;for(RC(Ja,pf+1,i),e=0;e<zu;e++)Bh[e*2+1]=5,Bh[e*2]=OC(e,5);PC=new H1(Ja,iv,zf+1,pf,yc),TC=new H1(Bh,E0,0,zu,yc),IC=new H1(new Array(0),ZB,0,pb,YB)},FC=e=>{let t;for(t=0;t<pf;t++)e.dyn_ltree[t*2]=0;for(t=0;t<zu;t++)e.dyn_dtree[t*2]=0;for(t=0;t<pb;t++)e.bl_tree[t*2]=0;e.dyn_ltree[gb*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},DC=e=>{e.bi_valid>8?vf(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},T4=(e,t,r,n)=>{const s=t*2,i=r*2;return e[s]<e[i]||e[s]===e[i]&&n[t]<=n[r]},K1=(e,t,r)=>{const n=e.heap[r];let s=r<<1;for(;s<=e.heap_len&&(s<e.heap_len&&T4(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!T4(t,n,e.heap[s],e.depth));)e.heap[r]=e.heap[s],r=s,s<<=1;e.heap[r]=n},I4=(e,t,r)=>{let n,s,i=0,o,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+i++]&255,n+=(e.pending_buf[e.sym_buf+i++]&255)<<8,s=e.pending_buf[e.sym_buf+i++],n===0?ba(e,s,t):(o=xf[s],ba(e,o+zf+1,t),l=iv[o],l!==0&&(s-=xb[o],Rs(e,s,l)),n--,o=MC(n),ba(e,o,r),l=E0[o],l!==0&&(n-=yp[o],Rs(e,n,l)));while(i<e.sym_next);ba(e,gb,t)},av=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.elems;let o,l,c=-1,u;for(e.heap_len=0,e.heap_max=kC,o=0;o<i;o++)r[o*2]!==0?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):r[o*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,r[u*2]=1,e.depth[u]=0,e.opt_len--,s&&(e.static_len-=n[u*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)K1(e,r,o);u=i;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],K1(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=l,r[u*2]=r[o*2]+r[l*2],e.depth[u]=(e.depth[o]>=e.depth[l]?e.depth[o]:e.depth[l])+1,r[o*2+1]=r[l*2+1]=u,e.heap[1]=u++,K1(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],QB(e,t),RC(r,c,e.bl_count)},M4=(e,t,r)=>{let n,s=-1,i,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)i=o,o=t[(n+1)*2+1],!(++l<c&&i===o)&&(l<u?e.bl_tree[i*2]+=l:i!==0?(i!==s&&e.bl_tree[i*2]++,e.bl_tree[CC*2]++):l<=10?e.bl_tree[EC*2]++:e.bl_tree[AC*2]++,l=0,s=i,o===0?(c=138,u=3):i===o?(c=6,u=3):(c=7,u=4))},O4=(e,t,r)=>{let n,s=-1,i,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),n=0;n<=r;n++)if(i=o,o=t[(n+1)*2+1],!(++l<c&&i===o)){if(l<u)do ba(e,i,e.bl_tree);while(--l!==0);else i!==0?(i!==s&&(ba(e,i,e.bl_tree),l--),ba(e,CC,e.bl_tree),Rs(e,l-3,2)):l<=10?(ba(e,EC,e.bl_tree),Rs(e,l-3,3)):(ba(e,AC,e.bl_tree),Rs(e,l-11,7));l=0,s=i,o===0?(c=138,u=3):i===o?(c=6,u=3):(c=7,u=4)}},tU=e=>{let t;for(M4(e,e.dyn_ltree,e.l_desc.max_code),M4(e,e.dyn_dtree,e.d_desc.max_code),av(e,e.bl_desc),t=pb-1;t>=3&&e.bl_tree[LC[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},rU=(e,t,r,n)=>{let s;for(Rs(e,t-257,5),Rs(e,r-1,5),Rs(e,n-4,4),s=0;s<n;s++)Rs(e,e.bl_tree[LC[s]*2+1],3);O4(e,e.dyn_ltree,t-1),O4(e,e.dyn_dtree,r-1)},nU=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return L4;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return P4;for(r=32;r<zf;r++)if(e.dyn_ltree[r*2]!==0)return P4;return L4};let R4=!1;const sU=e=>{R4||(eU(),R4=!0),e.l_desc=new G1(e.dyn_ltree,PC),e.d_desc=new G1(e.dyn_dtree,TC),e.bl_desc=new G1(e.bl_tree,IC),e.bi_buf=0,e.bi_valid=0,FC(e)},$C=(e,t,r,n)=>{Rs(e,(WB<<1)+(n?1:0),3),DC(e),vf(e,r),vf(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},iU=e=>{Rs(e,SC<<1,3),ba(e,gb,Ja),XB(e)},aU=(e,t,r,n)=>{let s,i,o=0;e.level>0?(e.strm.data_type===VB&&(e.strm.data_type=nU(e)),av(e,e.l_desc),av(e,e.d_desc),o=tU(e),s=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=s&&(s=i)):s=i=r+5,r+4<=s&&t!==-1?$C(e,t,r,n):e.strategy===qB||i===s?(Rs(e,(SC<<1)+(n?1:0),3),I4(e,Ja,Bh)):(Rs(e,(HB<<1)+(n?1:0),3),rU(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),I4(e,e.dyn_ltree,e.dyn_dtree)),FC(e),n&&DC(e)},oU=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(xf[r]+zf+1)*2]++,e.dyn_dtree[MC(t)*2]++),e.sym_next===e.sym_end);var lU=sU,cU=$C,uU=aU,dU=oU,hU=iU,fU={_tr_init:lU,_tr_stored_block:cU,_tr_flush_block:uU,_tr_tally:dU,_tr_align:hU};const mU=(e,t,r,n)=>{let s=e&65535|0,i=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+t[n++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var yf=mU;const pU=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},gU=new Uint32Array(pU()),xU=(e,t,r,n)=>{const s=gU,i=n+r;e^=-1;for(let o=n;o<i;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var Mn=xU,ad={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},qf={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:vU,_tr_stored_block:ov,_tr_flush_block:yU,_tr_tally:xl,_tr_align:bU}=fU,{Z_NO_FLUSH:vl,Z_PARTIAL_FLUSH:wU,Z_FULL_FLUSH:_U,Z_FINISH:Ni,Z_BLOCK:F4,Z_OK:Hn,Z_STREAM_END:D4,Z_STREAM_ERROR:Ca,Z_DATA_ERROR:jU,Z_BUF_ERROR:Y1,Z_DEFAULT_COMPRESSION:NU,Z_FILTERED:SU,Z_HUFFMAN_ONLY:Zm,Z_RLE:kU,Z_FIXED:CU,Z_DEFAULT_STRATEGY:EU,Z_UNKNOWN:AU,Z_DEFLATED:cg}=qf,LU=9,PU=15,TU=8,IU=29,MU=256,lv=MU+1+IU,OU=30,RU=19,FU=2*lv+1,DU=15,Xt=3,sl=258,Ea=sl+Xt+1,$U=32,od=42,vb=57,cv=69,uv=73,dv=91,hv=103,bc=113,vh=666,_s=1,bd=2,Ic=3,wd=4,BU=3,wc=(e,t)=>(e.msg=ad[t],t),$4=e=>e*2-(e>4?9:0),tl=e=>{let t=e.length;for(;--t>=0;)e[t]=0},UU=e=>{let t,r,n,s=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=s?r-s:0;while(--t);t=s,n=t;do r=e.prev[--n],e.prev[n]=r>=s?r-s:0;while(--t)};let zU=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,yl=zU;const Qs=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},si=(e,t)=>{yU(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Qs(e.strm)},lr=(e,t)=>{e.pending_buf[e.pending++]=t},dh=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},fv=(e,t,r,n)=>{let s=e.avail_in;return s>n&&(s=n),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),r),e.state.wrap===1?e.adler=yf(e.adler,t,s,r):e.state.wrap===2&&(e.adler=Mn(e.adler,t,s,r)),e.next_in+=s,e.total_in+=s,s)},BC=(e,t)=>{let r=e.max_chain_length,n=e.strstart,s,i,o=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-Ea?e.strstart-(e.w_size-Ea):0,u=e.window,d=e.w_mask,m=e.prev,f=e.strstart+sl;let h=u[n+o-1],x=u[n+o];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do if(s=t,!(u[s+o]!==x||u[s+o-1]!==h||u[s]!==u[n]||u[++s]!==u[n+1])){n+=2,s++;do;while(u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&n<f);if(i=sl-(f-n),n=f-sl,i>o){if(e.match_start=t,o=i,i>=l)break;h=u[n+o-1],x=u[n+o]}}while((t=m[t&d])>c&&--r!==0);return o<=e.lookahead?o:e.lookahead},ld=e=>{const t=e.w_size;let r,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ea)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),UU(e),n+=t),e.strm.avail_in===0)break;if(r=fv(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Xt)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=yl(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=yl(e,e.ins_h,e.window[s+Xt-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<Xt)););}while(e.lookahead<Ea&&e.strm.avail_in!==0)},UC=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,s,i,o=0,l=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,s=e.strstart-e.block_start,n>s+e.strm.avail_in&&(n=s+e.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&t!==Ni||t===vl||n!==s+e.strm.avail_in)))break;o=t===Ni&&n===s+e.strm.avail_in?1:0,ov(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Qs(e.strm),s&&(s>n&&(s=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,n-=s),n&&(fv(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(o===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?wd:t!==vl&&t!==Ni&&e.strm.avail_in===0&&e.strstart===e.block_start?bd:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(fv(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,s=e.strstart-e.block_start,(s>=r||(s||t===Ni)&&t!==vl&&e.strm.avail_in===0&&s<=i)&&(n=s>i?i:s,o=t===Ni&&e.strm.avail_in===0&&n===s?1:0,ov(e,e.block_start,n,o),e.block_start+=n,Qs(e.strm)),o?Ic:_s)},Z1=(e,t)=>{let r,n;for(;;){if(e.lookahead<Ea){if(ld(e),e.lookahead<Ea&&t===vl)return _s;if(e.lookahead===0)break}if(r=0,e.lookahead>=Xt&&(e.ins_h=yl(e,e.ins_h,e.window[e.strstart+Xt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Ea&&(e.match_length=BC(e,r)),e.match_length>=Xt)if(n=xl(e,e.strstart-e.match_start,e.match_length-Xt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Xt){e.match_length--;do e.strstart++,e.ins_h=yl(e,e.ins_h,e.window[e.strstart+Xt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=yl(e,e.ins_h,e.window[e.strstart+1]);else n=xl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(si(e,!1),e.strm.avail_out===0))return _s}return e.insert=e.strstart<Xt-1?e.strstart:Xt-1,t===Ni?(si(e,!0),e.strm.avail_out===0?Ic:wd):e.sym_next&&(si(e,!1),e.strm.avail_out===0)?_s:bd},lu=(e,t)=>{let r,n,s;for(;;){if(e.lookahead<Ea){if(ld(e),e.lookahead<Ea&&t===vl)return _s;if(e.lookahead===0)break}if(r=0,e.lookahead>=Xt&&(e.ins_h=yl(e,e.ins_h,e.window[e.strstart+Xt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Xt-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Ea&&(e.match_length=BC(e,r),e.match_length<=5&&(e.strategy===SU||e.match_length===Xt&&e.strstart-e.match_start>4096)&&(e.match_length=Xt-1)),e.prev_length>=Xt&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-Xt,n=xl(e,e.strstart-1-e.prev_match,e.prev_length-Xt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=yl(e,e.ins_h,e.window[e.strstart+Xt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Xt-1,e.strstart++,n&&(si(e,!1),e.strm.avail_out===0))return _s}else if(e.match_available){if(n=xl(e,0,e.window[e.strstart-1]),n&&si(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return _s}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=xl(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Xt-1?e.strstart:Xt-1,t===Ni?(si(e,!0),e.strm.avail_out===0?Ic:wd):e.sym_next&&(si(e,!1),e.strm.avail_out===0)?_s:bd},qU=(e,t)=>{let r,n,s,i;const o=e.window;for(;;){if(e.lookahead<=sl){if(ld(e),e.lookahead<=sl&&t===vl)return _s;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Xt&&e.strstart>0&&(s=e.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){i=e.strstart+sl;do;while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<i);e.match_length=sl-(i-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Xt?(r=xl(e,1,e.match_length-Xt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=xl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(si(e,!1),e.strm.avail_out===0))return _s}return e.insert=0,t===Ni?(si(e,!0),e.strm.avail_out===0?Ic:wd):e.sym_next&&(si(e,!1),e.strm.avail_out===0)?_s:bd},VU=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(ld(e),e.lookahead===0)){if(t===vl)return _s;break}if(e.match_length=0,r=xl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(si(e,!1),e.strm.avail_out===0))return _s}return e.insert=0,t===Ni?(si(e,!0),e.strm.avail_out===0?Ic:wd):e.sym_next&&(si(e,!1),e.strm.avail_out===0)?_s:bd};function ma(e,t,r,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=s}const yh=[new ma(0,0,0,0,UC),new ma(4,4,8,4,Z1),new ma(4,5,16,8,Z1),new ma(4,6,32,32,Z1),new ma(4,4,16,16,lu),new ma(8,16,32,32,lu),new ma(8,16,128,128,lu),new ma(8,32,128,256,lu),new ma(32,128,258,1024,lu),new ma(32,258,258,4096,lu)],WU=e=>{e.window_size=2*e.w_size,tl(e.head),e.max_lazy_match=yh[e.level].max_lazy,e.good_match=yh[e.level].good_length,e.nice_match=yh[e.level].nice_length,e.max_chain_length=yh[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Xt-1,e.match_available=0,e.ins_h=0};function HU(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=cg,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(FU*2),this.dyn_dtree=new Uint16Array((2*OU+1)*2),this.bl_tree=new Uint16Array((2*RU+1)*2),tl(this.dyn_ltree),tl(this.dyn_dtree),tl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(DU+1),this.heap=new Uint16Array(2*lv+1),tl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*lv+1),tl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Vf=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==od&&t.status!==vb&&t.status!==cv&&t.status!==uv&&t.status!==dv&&t.status!==hv&&t.status!==bc&&t.status!==vh?1:0},zC=e=>{if(Vf(e))return wc(e,Ca);e.total_in=e.total_out=0,e.data_type=AU;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?vb:t.wrap?od:bc,e.adler=t.wrap===2?0:1,t.last_flush=-2,vU(t),Hn},qC=e=>{const t=zC(e);return t===Hn&&WU(e.state),t},GU=(e,t)=>Vf(e)||e.state.wrap!==2?Ca:(e.state.gzhead=t,Hn),VC=(e,t,r,n,s,i)=>{if(!e)return Ca;let o=1;if(t===NU&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>LU||r!==cg||n<8||n>15||t<0||t>9||i<0||i>CU||n===8&&o!==1)return wc(e,Ca);n===8&&(n=9);const l=new HU;return e.state=l,l.strm=e,l.status=od,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Xt-1)/Xt),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=i,l.method=r,qC(e)},KU=(e,t)=>VC(e,t,cg,PU,TU,EU),YU=(e,t)=>{if(Vf(e)||t>F4||t<0)return e?wc(e,Ca):Ca;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===vh&&t!==Ni)return wc(e,e.avail_out===0?Y1:Ca);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Qs(e),e.avail_out===0)return r.last_flush=-1,Hn}else if(e.avail_in===0&&$4(t)<=$4(n)&&t!==Ni)return wc(e,Y1);if(r.status===vh&&e.avail_in!==0)return wc(e,Y1);if(r.status===od&&r.wrap===0&&(r.status=bc),r.status===od){let s=cg+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=Zm||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,s|=i<<6,r.strstart!==0&&(s|=$U),s+=31-s%31,dh(r,s),r.strstart!==0&&(dh(r,e.adler>>>16),dh(r,e.adler&65535)),e.adler=1,r.status=bc,Qs(e),r.pending!==0)return r.last_flush=-1,Hn}if(r.status===vb){if(e.adler=0,lr(r,31),lr(r,139),lr(r,8),r.gzhead)lr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),lr(r,r.gzhead.time&255),lr(r,r.gzhead.time>>8&255),lr(r,r.gzhead.time>>16&255),lr(r,r.gzhead.time>>24&255),lr(r,r.level===9?2:r.strategy>=Zm||r.level<2?4:0),lr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(lr(r,r.gzhead.extra.length&255),lr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Mn(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=cv;else if(lr(r,0),lr(r,0),lr(r,0),lr(r,0),lr(r,0),lr(r,r.level===9?2:r.strategy>=Zm||r.level<2?4:0),lr(r,BU),r.status=bc,Qs(e),r.pending!==0)return r.last_flush=-1,Hn}if(r.status===cv){if(r.gzhead.extra){let s=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let l=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>s&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex+=l,Qs(e),r.pending!==0)return r.last_flush=-1,Hn;s=0,i-=l}let o=new Uint8Array(r.gzhead.extra);r.pending_buf.set(o.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>s&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=uv}if(r.status===uv){if(r.gzhead.name){let s=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-s,s)),Qs(e),r.pending!==0)return r.last_flush=-1,Hn;s=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,lr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>s&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=dv}if(r.status===dv){if(r.gzhead.comment){let s=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-s,s)),Qs(e),r.pending!==0)return r.last_flush=-1,Hn;s=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,lr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>s&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-s,s))}r.status=hv}if(r.status===hv){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Qs(e),r.pending!==0))return r.last_flush=-1,Hn;lr(r,e.adler&255),lr(r,e.adler>>8&255),e.adler=0}if(r.status=bc,Qs(e),r.pending!==0)return r.last_flush=-1,Hn}if(e.avail_in!==0||r.lookahead!==0||t!==vl&&r.status!==vh){let s=r.level===0?UC(r,t):r.strategy===Zm?VU(r,t):r.strategy===kU?qU(r,t):yh[r.level].func(r,t);if((s===Ic||s===wd)&&(r.status=vh),s===_s||s===Ic)return e.avail_out===0&&(r.last_flush=-1),Hn;if(s===bd&&(t===wU?bU(r):t!==F4&&(ov(r,0,0,!1),t===_U&&(tl(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Qs(e),e.avail_out===0))return r.last_flush=-1,Hn}return t!==Ni?Hn:r.wrap<=0?D4:(r.wrap===2?(lr(r,e.adler&255),lr(r,e.adler>>8&255),lr(r,e.adler>>16&255),lr(r,e.adler>>24&255),lr(r,e.total_in&255),lr(r,e.total_in>>8&255),lr(r,e.total_in>>16&255),lr(r,e.total_in>>24&255)):(dh(r,e.adler>>>16),dh(r,e.adler&65535)),Qs(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Hn:D4)},ZU=e=>{if(Vf(e))return Ca;const t=e.state.status;return e.state=null,t===bc?wc(e,jU):Hn},JU=(e,t)=>{let r=t.length;if(Vf(e))return Ca;const n=e.state,s=n.wrap;if(s===2||s===1&&n.status!==od||n.lookahead)return Ca;if(s===1&&(e.adler=yf(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){s===0&&(tl(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const i=e.avail_in,o=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,ld(n);n.lookahead>=Xt;){let c=n.strstart,u=n.lookahead-(Xt-1);do n.ins_h=yl(n,n.ins_h,n.window[c+Xt-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--u);n.strstart=c,n.lookahead=Xt-1,ld(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Xt-1,n.match_available=0,e.next_in=o,e.input=l,e.avail_in=i,n.wrap=s,Hn};var XU=KU,QU=VC,ez=qC,tz=zC,rz=GU,nz=YU,sz=ZU,iz=JU,az="pako deflate (from Nodeca project)",Uh={deflateInit:XU,deflateInit2:QU,deflateReset:ez,deflateResetKeep:tz,deflateSetHeader:rz,deflate:nz,deflateEnd:sz,deflateSetDictionary:iz,deflateInfo:az};const oz=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var lz=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)oz(r,n)&&(e[n]=r[n])}}return e},cz=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,i=e.length;n<i;n++){let o=e[n];r.set(o,s),s+=o.length}return r},ug={assign:lz,flattenChunks:cz};let WC=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{WC=!1}const bf=new Uint8Array(256);for(let e=0;e<256;e++)bf[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;bf[254]=bf[254]=1;var uz=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,i,o=e.length,l=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,s=0;i<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const dz=(e,t)=>{if(t<65534&&e.subarray&&WC)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var hz=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const i=new Array(r*2);for(s=0,n=0;n<r;){let o=e[n++];if(o<128){i[s++]=o;continue}let l=bf[o];if(l>4){i[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return dz(i,s)},fz=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+bf[e[r]]>t?r:t},wf={string2buf:uz,buf2string:hz,utf8border:fz};function mz(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var HC=mz;const GC=Object.prototype.toString,{Z_NO_FLUSH:pz,Z_SYNC_FLUSH:gz,Z_FULL_FLUSH:xz,Z_FINISH:vz,Z_OK:bp,Z_STREAM_END:yz,Z_DEFAULT_COMPRESSION:bz,Z_DEFAULT_STRATEGY:wz,Z_DEFLATED:_z}=qf;function yb(e){this.options=ug.assign({level:bz,method:_z,chunkSize:16384,windowBits:15,memLevel:8,strategy:wz},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new HC,this.strm.avail_out=0;let r=Uh.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==bp)throw new Error(ad[r]);if(t.header&&Uh.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=wf.string2buf(t.dictionary):GC.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Uh.deflateSetDictionary(this.strm,n),r!==bp)throw new Error(ad[r]);this._dict_set=!0}}yb.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let s,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?vz:pz,typeof e=="string"?r.input=wf.string2buf(e):GC.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===gz||i===xz)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(s=Uh.deflate(r,i),s===yz)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=Uh.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===bp;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};yb.prototype.onData=function(e){this.chunks.push(e)};yb.prototype.onEnd=function(e){e===bp&&(this.result=ug.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const Jm=16209,jz=16191;var Nz=function(t,r){let n,s,i,o,l,c,u,d,m,f,h,x,b,j,y,_,w,S,E,$,U,I,T,D;const C=t.state;n=t.next_in,T=t.input,s=n+(t.avail_in-5),i=t.next_out,D=t.output,o=i-(r-t.avail_out),l=i+(t.avail_out-257),c=C.dmax,u=C.wsize,d=C.whave,m=C.wnext,f=C.window,h=C.hold,x=C.bits,b=C.lencode,j=C.distcode,y=(1<<C.lenbits)-1,_=(1<<C.distbits)-1;e:do{x<15&&(h+=T[n++]<<x,x+=8,h+=T[n++]<<x,x+=8),w=b[h&y];t:for(;;){if(S=w>>>24,h>>>=S,x-=S,S=w>>>16&255,S===0)D[i++]=w&65535;else if(S&16){E=w&65535,S&=15,S&&(x<S&&(h+=T[n++]<<x,x+=8),E+=h&(1<<S)-1,h>>>=S,x-=S),x<15&&(h+=T[n++]<<x,x+=8,h+=T[n++]<<x,x+=8),w=j[h&_];r:for(;;){if(S=w>>>24,h>>>=S,x-=S,S=w>>>16&255,S&16){if($=w&65535,S&=15,x<S&&(h+=T[n++]<<x,x+=8,x<S&&(h+=T[n++]<<x,x+=8)),$+=h&(1<<S)-1,$>c){t.msg="invalid distance too far back",C.mode=Jm;break e}if(h>>>=S,x-=S,S=i-o,$>S){if(S=$-S,S>d&&C.sane){t.msg="invalid distance too far back",C.mode=Jm;break e}if(U=0,I=f,m===0){if(U+=u-S,S<E){E-=S;do D[i++]=f[U++];while(--S);U=i-$,I=D}}else if(m<S){if(U+=u+m-S,S-=m,S<E){E-=S;do D[i++]=f[U++];while(--S);if(U=0,m<E){S=m,E-=S;do D[i++]=f[U++];while(--S);U=i-$,I=D}}}else if(U+=m-S,S<E){E-=S;do D[i++]=f[U++];while(--S);U=i-$,I=D}for(;E>2;)D[i++]=I[U++],D[i++]=I[U++],D[i++]=I[U++],E-=3;E&&(D[i++]=I[U++],E>1&&(D[i++]=I[U++]))}else{U=i-$;do D[i++]=D[U++],D[i++]=D[U++],D[i++]=D[U++],E-=3;while(E>2);E&&(D[i++]=D[U++],E>1&&(D[i++]=D[U++]))}}else if(S&64){t.msg="invalid distance code",C.mode=Jm;break e}else{w=j[(w&65535)+(h&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){C.mode=jz;break e}else{t.msg="invalid literal/length code",C.mode=Jm;break e}else{w=b[(w&65535)+(h&(1<<S)-1)];continue t}break}}while(n<s&&i<l);E=x>>3,n-=E,x-=E<<3,h&=(1<<x)-1,t.next_in=n,t.next_out=i,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=i<l?257+(l-i):257-(i-l),C.hold=h,C.bits=x};const cu=15,B4=852,U4=592,z4=0,J1=1,q4=2,Sz=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),kz=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Cz=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ez=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Az=(e,t,r,n,s,i,o,l)=>{const c=l.bits;let u=0,d=0,m=0,f=0,h=0,x=0,b=0,j=0,y=0,_=0,w,S,E,$,U,I=null,T;const D=new Uint16Array(cu+1),C=new Uint16Array(cu+1);let P=null,F,A,R;for(u=0;u<=cu;u++)D[u]=0;for(d=0;d<n;d++)D[t[r+d]]++;for(h=c,f=cu;f>=1&&D[f]===0;f--);if(h>f&&(h=f),f===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,l.bits=1,0;for(m=1;m<f&&D[m]===0;m++);for(h<m&&(h=m),j=1,u=1;u<=cu;u++)if(j<<=1,j-=D[u],j<0)return-1;if(j>0&&(e===z4||f!==1))return-1;for(C[1]=0,u=1;u<cu;u++)C[u+1]=C[u]+D[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[C[t[r+d]]++]=d);if(e===z4?(I=P=o,T=20):e===J1?(I=Sz,P=kz,T=257):(I=Cz,P=Ez,T=0),_=0,d=0,u=m,U=i,x=h,b=0,E=-1,y=1<<h,$=y-1,e===J1&&y>B4||e===q4&&y>U4)return 1;for(;;){F=u-b,o[d]+1<T?(A=0,R=o[d]):o[d]>=T?(A=P[o[d]-T],R=I[o[d]-T]):(A=32+64,R=0),w=1<<u-b,S=1<<x,m=S;do S-=w,s[U+(_>>b)+S]=F<<24|A<<16|R|0;while(S!==0);for(w=1<<u-1;_&w;)w>>=1;if(w!==0?(_&=w-1,_+=w):_=0,d++,--D[u]===0){if(u===f)break;u=t[r+o[d]]}if(u>h&&(_&$)!==E){for(b===0&&(b=h),U+=m,x=u-b,j=1<<x;x+b<f&&(j-=D[x+b],!(j<=0));)x++,j<<=1;if(y+=1<<x,e===J1&&y>B4||e===q4&&y>U4)return 1;E=_&$,s[E]=h<<24|x<<16|U-i|0}}return _!==0&&(s[U+_]=u-b<<24|64<<16|0),l.bits=h,0};var zh=Az;const Lz=0,KC=1,YC=2,{Z_FINISH:V4,Z_BLOCK:Pz,Z_TREES:Xm,Z_OK:Mc,Z_STREAM_END:Tz,Z_NEED_DICT:Iz,Z_STREAM_ERROR:Pi,Z_DATA_ERROR:ZC,Z_MEM_ERROR:JC,Z_BUF_ERROR:Mz,Z_DEFLATED:W4}=qf,dg=16180,H4=16181,G4=16182,K4=16183,Y4=16184,Z4=16185,J4=16186,X4=16187,Q4=16188,ej=16189,wp=16190,Ha=16191,X1=16192,tj=16193,Q1=16194,rj=16195,nj=16196,sj=16197,ij=16198,Qm=16199,e0=16200,aj=16201,oj=16202,lj=16203,cj=16204,uj=16205,ex=16206,dj=16207,hj=16208,$r=16209,XC=16210,QC=16211,Oz=852,Rz=592,Fz=15,Dz=Fz,fj=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function $z(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<dg||t.mode>QC?1:0},e8=e=>{if(qc(e))return Pi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=dg,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Oz),t.distcode=t.distdyn=new Int32Array(Rz),t.sane=1,t.back=-1,Mc},t8=e=>{if(qc(e))return Pi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,e8(e)},r8=(e,t)=>{let r;if(qc(e))return Pi;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Pi:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,t8(e))},n8=(e,t)=>{if(!e)return Pi;const r=new $z;e.state=r,r.strm=e,r.window=null,r.mode=dg;const n=r8(e,t);return n!==Mc&&(e.state=null),n},Bz=e=>n8(e,Dz);let mj=!0,tx,rx;const Uz=e=>{if(mj){tx=new Int32Array(512),rx=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(zh(KC,e.lens,0,288,tx,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;zh(YC,e.lens,0,32,rx,0,e.work,{bits:5}),mj=!1}e.lencode=tx,e.lenbits=9,e.distcode=rx,e.distbits=5},s8=(e,t,r,n)=>{let s;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(t.subarray(r-n,r-n+s),i.wnext),n-=s,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},zz=(e,t)=>{let r,n,s,i,o,l,c,u,d,m,f,h,x,b,j=0,y,_,w,S,E,$,U,I;const T=new Uint8Array(4);let D,C;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qc(e)||!e.output||!e.input&&e.avail_in!==0)return Pi;r=e.state,r.mode===Ha&&(r.mode=X1),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,m=l,f=c,I=Mc;e:for(;;)switch(r.mode){case dg:if(r.wrap===0){r.mode=X1;break}for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,T[0]=u&255,T[1]=u>>>8&255,r.check=Mn(r.check,T,2,0),u=0,d=0,r.mode=H4;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=$r;break}if((u&15)!==W4){e.msg="unknown compression method",r.mode=$r;break}if(u>>>=4,d-=4,U=(u&15)+8,r.wbits===0&&(r.wbits=U),U>15||U>r.wbits){e.msg="invalid window size",r.mode=$r;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?ej:Ha,u=0,d=0;break;case H4:for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==W4){e.msg="unknown compression method",r.mode=$r;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=$r;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,r.check=Mn(r.check,T,2,0)),u=0,d=0,r.mode=G4;case G4:for(;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,r.check=Mn(r.check,T,4,0)),u=0,d=0,r.mode=K4;case K4:for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,r.check=Mn(r.check,T,2,0)),u=0,d=0,r.mode=Y4;case Y4:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,r.check=Mn(r.check,T,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=Z4;case Z4:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(U=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),U)),r.flags&512&&r.wrap&4&&(r.check=Mn(r.check,n,h,i)),l-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=J4;case J4:if(r.flags&2048){if(l===0)break e;h=0;do U=n[i+h++],r.head&&U&&r.length<65536&&(r.head.name+=String.fromCharCode(U));while(U&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Mn(r.check,n,h,i)),l-=h,i+=h,U)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=X4;case X4:if(r.flags&4096){if(l===0)break e;h=0;do U=n[i+h++],r.head&&U&&r.length<65536&&(r.head.comment+=String.fromCharCode(U));while(U&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Mn(r.check,n,h,i)),l-=h,i+=h,U)break e}else r.head&&(r.head.comment=null);r.mode=Q4;case Q4:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=$r;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Ha;break;case ej:for(;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}e.adler=r.check=fj(u),u=0,d=0,r.mode=wp;case wp:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=d,Iz;e.adler=r.check=1,r.mode=Ha;case Ha:if(t===Pz||t===Xm)break e;case X1:if(r.last){u>>>=d&7,d-=d&7,r.mode=ex;break}for(;d<3;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=tj;break;case 1:if(Uz(r),r.mode=Qm,t===Xm){u>>>=2,d-=2;break e}break;case 2:r.mode=nj;break;case 3:e.msg="invalid block type",r.mode=$r}u>>>=2,d-=2;break;case tj:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=$r;break}if(r.length=u&65535,u=0,d=0,r.mode=Q1,t===Xm)break e;case Q1:r.mode=rj;case rj:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;s.set(n.subarray(i,i+h),o),l-=h,i+=h,c-=h,o+=h,r.length-=h;break}r.mode=Ha;break;case nj:for(;d<14;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=$r;break}r.have=0,r.mode=sj;case sj:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.lens[P[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,D={bits:r.lenbits},I=zh(Lz,r.lens,0,19,r.lencode,0,r.work,D),r.lenbits=D.bits,I){e.msg="invalid code lengths set",r.mode=$r;break}r.have=0,r.mode=ij;case ij:for(;r.have<r.nlen+r.ndist;){for(;j=r.lencode[u&(1<<r.lenbits)-1],y=j>>>24,_=j>>>16&255,w=j&65535,!(y<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(w<16)u>>>=y,d-=y,r.lens[r.have++]=w;else{if(w===16){for(C=y+2;d<C;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(u>>>=y,d-=y,r.have===0){e.msg="invalid bit length repeat",r.mode=$r;break}U=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(w===17){for(C=y+3;d<C;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=y,d-=y,U=0,h=3+(u&7),u>>>=3,d-=3}else{for(C=y+7;d<C;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=y,d-=y,U=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=$r;break}for(;h--;)r.lens[r.have++]=U}}if(r.mode===$r)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=$r;break}if(r.lenbits=9,D={bits:r.lenbits},I=zh(KC,r.lens,0,r.nlen,r.lencode,0,r.work,D),r.lenbits=D.bits,I){e.msg="invalid literal/lengths set",r.mode=$r;break}if(r.distbits=6,r.distcode=r.distdyn,D={bits:r.distbits},I=zh(YC,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,D),r.distbits=D.bits,I){e.msg="invalid distances set",r.mode=$r;break}if(r.mode=Qm,t===Xm)break e;case Qm:r.mode=e0;case e0:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=d,Nz(e,f),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===Ha&&(r.back=-1);break}for(r.back=0;j=r.lencode[u&(1<<r.lenbits)-1],y=j>>>24,_=j>>>16&255,w=j&65535,!(y<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(_&&!(_&240)){for(S=y,E=_,$=w;j=r.lencode[$+((u&(1<<S+E)-1)>>S)],y=j>>>24,_=j>>>16&255,w=j&65535,!(S+y<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=y,d-=y,r.back+=y,r.length=w,_===0){r.mode=uj;break}if(_&32){r.back=-1,r.mode=Ha;break}if(_&64){e.msg="invalid literal/length code",r.mode=$r;break}r.extra=_&15,r.mode=aj;case aj:if(r.extra){for(C=r.extra;d<C;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=oj;case oj:for(;j=r.distcode[u&(1<<r.distbits)-1],y=j>>>24,_=j>>>16&255,w=j&65535,!(y<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(!(_&240)){for(S=y,E=_,$=w;j=r.distcode[$+((u&(1<<S+E)-1)>>S)],y=j>>>24,_=j>>>16&255,w=j&65535,!(S+y<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=y,d-=y,r.back+=y,_&64){e.msg="invalid distance code",r.mode=$r;break}r.offset=w,r.extra=_&15,r.mode=lj;case lj:if(r.extra){for(C=r.extra;d<C;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=$r;break}r.mode=cj;case cj:if(c===0)break e;if(h=f-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=$r;break}h>r.wnext?(h-=r.wnext,x=r.wsize-h):x=r.wnext-h,h>r.length&&(h=r.length),b=r.window}else b=s,x=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do s[o++]=b[x++];while(--h);r.length===0&&(r.mode=e0);break;case uj:if(c===0)break e;s[o++]=r.length,c--,r.mode=e0;break;case ex:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[i++]<<d,d+=8}if(f-=c,e.total_out+=f,r.total+=f,r.wrap&4&&f&&(e.adler=r.check=r.flags?Mn(r.check,s,f,o-f):yf(r.check,s,f,o-f)),f=c,r.wrap&4&&(r.flags?u:fj(u))!==r.check){e.msg="incorrect data check",r.mode=$r;break}u=0,d=0}r.mode=dj;case dj:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=$r;break}u=0,d=0}r.mode=hj;case hj:I=Tz;break e;case $r:I=ZC;break e;case XC:return JC;case QC:default:return Pi}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||f!==e.avail_out&&r.mode<$r&&(r.mode<ex||t!==V4))&&s8(e,e.output,e.next_out,f-e.avail_out),m-=e.avail_in,f-=e.avail_out,e.total_in+=m,e.total_out+=f,r.total+=f,r.wrap&4&&f&&(e.adler=r.check=r.flags?Mn(r.check,s,f,e.next_out-f):yf(r.check,s,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Ha?128:0)+(r.mode===Qm||r.mode===Q1?256:0),(m===0&&f===0||t===V4)&&I===Mc&&(I=Mz),I},qz=e=>{if(qc(e))return Pi;let t=e.state;return t.window&&(t.window=null),e.state=null,Mc},Vz=(e,t)=>{if(qc(e))return Pi;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Mc):Pi},Wz=(e,t)=>{const r=t.length;let n,s,i;return qc(e)||(n=e.state,n.wrap!==0&&n.mode!==wp)?Pi:n.mode===wp&&(s=1,s=yf(s,t,r,0),s!==n.check)?ZC:(i=s8(e,t,r,r),i?(n.mode=XC,JC):(n.havedict=1,Mc))};var Hz=t8,Gz=r8,Kz=e8,Yz=Bz,Zz=n8,Jz=zz,Xz=qz,Qz=Vz,eq=Wz,tq="pako inflate (from Nodeca project)",Xa={inflateReset:Hz,inflateReset2:Gz,inflateResetKeep:Kz,inflateInit:Yz,inflateInit2:Zz,inflate:Jz,inflateEnd:Xz,inflateGetHeader:Qz,inflateSetDictionary:eq,inflateInfo:tq};function rq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var nq=rq;const i8=Object.prototype.toString,{Z_NO_FLUSH:sq,Z_FINISH:iq,Z_OK:_f,Z_STREAM_END:nx,Z_NEED_DICT:sx,Z_STREAM_ERROR:aq,Z_DATA_ERROR:pj,Z_MEM_ERROR:oq}=qf;function Wf(e){this.options=ug.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new HC,this.strm.avail_out=0;let r=Xa.inflateInit2(this.strm,t.windowBits);if(r!==_f)throw new Error(ad[r]);if(this.header=new nq,Xa.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=wf.string2buf(t.dictionary):i8.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Xa.inflateSetDictionary(this.strm,t.dictionary),r!==_f)))throw new Error(ad[r])}Wf.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?iq:sq,i8.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=Xa.inflate(r,o),i===sx&&s&&(i=Xa.inflateSetDictionary(r,s),i===_f?i=Xa.inflate(r,o):i===pj&&(i=sx));r.avail_in>0&&i===nx&&r.state.wrap>0&&e[r.next_in]!==0;)Xa.inflateReset(r),i=Xa.inflate(r,o);switch(i){case aq:case pj:case sx:case oq:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===nx))if(this.options.to==="string"){let c=wf.utf8border(r.output,r.next_out),u=r.next_out-c,d=wf.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===_f&&l===0)){if(i===nx)return i=Xa.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Wf.prototype.onData=function(e){this.chunks.push(e)};Wf.prototype.onEnd=function(e){e===_f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ug.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function bb(e,t){const r=new Wf(t);if(r.push(e),r.err)throw r.msg||ad[r.err];return r.result}function lq(e,t){return t=t||{},t.raw=!0,bb(e,t)}var cq=Wf,uq=bb,dq=lq,hq=bb,fq=qf,mq={Inflate:cq,inflate:uq,inflateRaw:dq,ungzip:hq,constants:fq};const{Inflate:pq,inflate:gq,inflateRaw:zZ,ungzip:qZ}=mq;var gj=pq,xq=gq;const a8=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;a8[e]=t}const xj=4294967295;function vq(e,t,r){let n=e;for(let s=0;s<r;s++)n=a8[(n^t[s])&255]^n>>>8;return n}function yq(e,t){return(vq(xj,e,t)^xj)>>>0}function vj(e,t,r){const n=e.readUint32(),s=yq(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function o8(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function l8(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function c8(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function u8(e,t,r,n,s){let i=0;if(r.length===0){for(;i<s;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-s]>>1)&255}else{for(;i<s;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-s]+r[i]>>1)&255}}function d8(e,t,r,n,s){let i=0;if(r.length===0){for(;i<s;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-s]&255}else{for(;i<s;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+bq(t[i-s],r[i],r[i-s])&255}}function bq(e,t,r){const n=e+t-r,s=Math.abs(n-e),i=Math.abs(n-t),o=Math.abs(n-r);return s<=i&&s<=o?e:i<=o?t:r}function wq(e,t,r,n,s,i){switch(e){case 0:o8(t,r,s);break;case 1:l8(t,r,s,i);break;case 2:c8(t,r,n,s);break;case 3:u8(t,r,n,s,i);break;case 4:d8(t,r,n,s,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const _q=new Uint16Array([255]),jq=new Uint8Array(_q.buffer),Nq=jq[0]===255;function Sq(e){const{data:t,width:r,height:n,channels:s,depth:i}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*s,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const m=o[d],f=Math.ceil((r-m.x)/m.xStep),h=Math.ceil((n-m.y)/m.yStep);if(f<=0||h<=0)continue;const x=f*l,b=new Uint8Array(x);for(let j=0;j<h;j++){const y=t[u++],_=t.subarray(u,u+x);u+=x;const w=new Uint8Array(x);wq(y,_,w,b,x,l),b.set(w);for(let S=0;S<f;S++){const E=m.x+S*m.xStep,$=m.y+j*m.yStep;if(!(E>=r||$>=n))for(let U=0;U<l;U++)c[($*r+E)*l+U]=w[S*l+U]}}}if(i===16){const d=new Uint16Array(c.buffer);if(Nq)for(let m=0;m<d.length;m++)d[m]=kq(d[m]);return d}else return c}function kq(e){return(e&255)<<8|e>>8&255}const Cq=new Uint16Array([255]),Eq=new Uint8Array(Cq.buffer),Aq=Eq[0]===255,Lq=new Uint8Array(0);function yj(e){const{data:t,width:r,height:n,channels:s,depth:i}=e,o=Math.ceil(i/8)*s,l=Math.ceil(i/8*s*r),c=new Uint8Array(n*l);let u=Lq,d=0,m,f;for(let h=0;h<n;h++){switch(m=t.subarray(d+1,d+1+l),f=c.subarray(h*l,(h+1)*l),t[d]){case 0:o8(m,f,l);break;case 1:l8(m,f,l,o);break;case 2:c8(m,f,u,l);break;case 3:u8(m,f,u,l,o);break;case 4:d8(m,f,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=f,d+=l+1}if(i===16){const h=new Uint16Array(c.buffer);if(Aq)for(let x=0;x<h.length;x++)h[x]=Pq(h[x]);return h}else return c}function Pq(e){return(e&255)<<8|e>>8&255}const A0=Uint8Array.of(137,80,78,71,13,10,26,10);function bj(e){if(!Tq(e.readBytes(A0.length)))throw new Error("wrong PNG signature")}function Tq(e){if(e.length<A0.length)return!1;for(let t=0;t<A0.length;t++)if(e[t]!==A0[t])return!1;return!0}const Iq="tEXt",Mq=0,h8=new TextDecoder("latin1");function Oq(e){if(Fq(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Rq=/^[\u0000-\u00FF]*$/;function Fq(e){if(!Rq.test(e))throw new Error("invalid latin1 text")}function Dq(e,t,r){const n=f8(t);e[n]=$q(t,r-n.length-1)}function f8(e){for(e.mark();e.readByte()!==Mq;);const t=e.offset;e.reset();const r=h8.decode(e.readBytes(t-e.offset-1));return e.skip(1),Oq(r),r}function $q(e,t){return h8.decode(e.readBytes(t))}const Xs={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ix={UNKNOWN:-1,DEFLATE:0},wj={UNKNOWN:-1,ADAPTIVE:0},ax={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},t0={NONE:0,BACKGROUND:1,PREVIOUS:2},ox={SOURCE:0,OVER:1};class Bq extends fb{constructor(r,n={}){super(r);gr(this,"_checkCrc");gr(this,"_inflator");gr(this,"_png");gr(this,"_apng");gr(this,"_end");gr(this,"_hasPalette");gr(this,"_palette");gr(this,"_hasTransparency");gr(this,"_transparency");gr(this,"_compressionMethod");gr(this,"_filterMethod");gr(this,"_interlaceMethod");gr(this,"_colorType");gr(this,"_isAnimated");gr(this,"_numberOfFrames");gr(this,"_numberOfPlays");gr(this,"_frames");gr(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new gj,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ix.UNKNOWN,this._filterMethod=wj.UNKNOWN,this._interlaceMethod=ax.UNKNOWN,this._colorType=Xs.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(bj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(bj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Iq:Dq(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vj(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vj(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Uq(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case Xs.GREYSCALE:s=1;break;case Xs.TRUECOLOUR:s=3;break;case Xs.INDEXED_COLOUR:s=1;break;case Xs.GREYSCALE_ALPHA:s=2;break;case Xs.TRUECOLOUR_ALPHA:s=4;break;case Xs.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==ix.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<n;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Xs.GREYSCALE:case Xs.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Xs.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Xs.UNKNOWN:case Xs.GREYSCALE_ALPHA:case Xs.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=f8(this),s=this.readUint8();if(s!==ix.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:xq(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=yj({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(s,i,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case t0.NONE:break;case t0.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case t0.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,i=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case ox.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=i(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case ox.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=i(o,l);for(let d=0;d<this._png.channels;d++){const m=n.data[u+this._png.channels-1]/s,f=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(m*f+(1-m)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==wj.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===ax.NO_INTERLACE)this._png.data=yj({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===ax.ADAM7)this._png.data=Sq({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:t0.NONE,blendOp:ox.SOURCE,data:r}),this._inflator=new gj,this._writingDataChunks=!1}}function Uq(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var _j;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(_j||(_j={}));function zq(e,t){return new Bq(e,t).decode()}var Ot=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function lx(){Ot.console&&typeof Ot.console.log=="function"&&Ot.console.log.apply(Ot.console,arguments)}var _r={log:lx,warn:function(e){Ot.console&&(typeof Ot.console.warn=="function"?Ot.console.warn.apply(Ot.console,arguments):lx.call(null,arguments))},error:function(e){Ot.console&&(typeof Ot.console.error=="function"?Ot.console.error.apply(Ot.console,arguments):lx(e))}};function cx(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){dc(n.response,t,r)},n.onerror=function(){_r.error("could not download file")},n.send()}function jj(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function r0(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var dc=Ot.saveAs||((typeof window>"u"?"undefined":xr(window))!=="object"||window!==Ot?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Ot.URL||Ot.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?jj(s.href)?cx(e,t,r):r0(s,s.target="_blank"):r0(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){r0(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(jj(e))cx(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){r0(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:xr(i)!=="object"&&(_r.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob([String.fromCharCode(65279),s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return cx(e,t,r);var s=e.type==="application/octet-stream",i=/constructor/i.test(Ot.HTMLElement)||Ot.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":xr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=Ot.URL||Ot.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function m8(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,o=s.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var L0=Ot.atob.bind(Ot),Nj=Ot.btoa.bind(Ot);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function ux(e,t){var r=e[0],n=e[1],s=e[2],i=e[3];r=ns(r,n,s,i,t[0],7,-680876936),i=ns(i,r,n,s,t[1],12,-389564586),s=ns(s,i,r,n,t[2],17,606105819),n=ns(n,s,i,r,t[3],22,-1044525330),r=ns(r,n,s,i,t[4],7,-176418897),i=ns(i,r,n,s,t[5],12,1200080426),s=ns(s,i,r,n,t[6],17,-1473231341),n=ns(n,s,i,r,t[7],22,-45705983),r=ns(r,n,s,i,t[8],7,1770035416),i=ns(i,r,n,s,t[9],12,-1958414417),s=ns(s,i,r,n,t[10],17,-42063),n=ns(n,s,i,r,t[11],22,-1990404162),r=ns(r,n,s,i,t[12],7,1804603682),i=ns(i,r,n,s,t[13],12,-40341101),s=ns(s,i,r,n,t[14],17,-1502002290),r=ss(r,n=ns(n,s,i,r,t[15],22,1236535329),s,i,t[1],5,-165796510),i=ss(i,r,n,s,t[6],9,-1069501632),s=ss(s,i,r,n,t[11],14,643717713),n=ss(n,s,i,r,t[0],20,-373897302),r=ss(r,n,s,i,t[5],5,-701558691),i=ss(i,r,n,s,t[10],9,38016083),s=ss(s,i,r,n,t[15],14,-660478335),n=ss(n,s,i,r,t[4],20,-405537848),r=ss(r,n,s,i,t[9],5,568446438),i=ss(i,r,n,s,t[14],9,-1019803690),s=ss(s,i,r,n,t[3],14,-187363961),n=ss(n,s,i,r,t[8],20,1163531501),r=ss(r,n,s,i,t[13],5,-1444681467),i=ss(i,r,n,s,t[2],9,-51403784),s=ss(s,i,r,n,t[7],14,1735328473),r=is(r,n=ss(n,s,i,r,t[12],20,-1926607734),s,i,t[5],4,-378558),i=is(i,r,n,s,t[8],11,-2022574463),s=is(s,i,r,n,t[11],16,1839030562),n=is(n,s,i,r,t[14],23,-35309556),r=is(r,n,s,i,t[1],4,-1530992060),i=is(i,r,n,s,t[4],11,1272893353),s=is(s,i,r,n,t[7],16,-155497632),n=is(n,s,i,r,t[10],23,-1094730640),r=is(r,n,s,i,t[13],4,681279174),i=is(i,r,n,s,t[0],11,-358537222),s=is(s,i,r,n,t[3],16,-722521979),n=is(n,s,i,r,t[6],23,76029189),r=is(r,n,s,i,t[9],4,-640364487),i=is(i,r,n,s,t[12],11,-421815835),s=is(s,i,r,n,t[15],16,530742520),r=as(r,n=is(n,s,i,r,t[2],23,-995338651),s,i,t[0],6,-198630844),i=as(i,r,n,s,t[7],10,1126891415),s=as(s,i,r,n,t[14],15,-1416354905),n=as(n,s,i,r,t[5],21,-57434055),r=as(r,n,s,i,t[12],6,1700485571),i=as(i,r,n,s,t[3],10,-1894986606),s=as(s,i,r,n,t[10],15,-1051523),n=as(n,s,i,r,t[1],21,-2054922799),r=as(r,n,s,i,t[8],6,1873313359),i=as(i,r,n,s,t[15],10,-30611744),s=as(s,i,r,n,t[6],15,-1560198380),n=as(n,s,i,r,t[13],21,1309151649),r=as(r,n,s,i,t[4],6,-145523070),i=as(i,r,n,s,t[11],10,-1120210379),s=as(s,i,r,n,t[2],15,718787259),n=as(n,s,i,r,t[9],21,-343485551),e[0]=il(r,e[0]),e[1]=il(n,e[1]),e[2]=il(s,e[2]),e[3]=il(i,e[3])}function hg(e,t,r,n,s,i){return t=il(il(t,e),il(n,i)),il(t<<s|t>>>32-s,r)}function ns(e,t,r,n,s,i,o){return hg(t&r|~t&n,e,t,s,i,o)}function ss(e,t,r,n,s,i,o){return hg(t&n|r&~n,e,t,s,i,o)}function is(e,t,r,n,s,i,o){return hg(t^r^n,e,t,s,i,o)}function as(e,t,r,n,s,i,o){return hg(r^(t|~n),e,t,s,i,o)}function p8(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)ux(n,qq(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(ux(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,ux(n,s),n}function qq(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var Sj="0123456789abcdef".split("");function Vq(e){for(var t="",r=0;r<4;r++)t+=Sj[e>>8*r+4&15]+Sj[e>>8*r&15];return t}function Wq(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function mv(e){return p8(e).map(Wq).join("")}var Hq=function(e){for(var t=0;t<e.length;t++)e[t]=Vq(e[t]);return e.join("")}(p8("hello"))!="5d41402abc4b2a76b9719d911017c592";function il(e,t){if(Hq){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function pv(e,t){var r,n,s,i;if(e!==r){for(var o=(s=e,i=1+(256/e.length|0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var m=t.length,f=0,h=0,x="";for(c=0;c<m;c++)h=(h+(d=l[f=(f+1)%256]))%256,l[f]=l[h],l[h]=d,o=l[(l[f]+l[h])%256],x+=String.fromCharCode(t.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var kj={print:4,modify:8,copy:16,"annot-forms":32};function pu(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(kj.perm!==void 0)throw new Error("Invalid permission: "+l);s+=kj[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=mv(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=pv(this.encryptionKey,this.padding)}function gu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function Cj(e){if(xr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,n)}catch(l){Ot.console&&_r.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function _p(e){if(!(this instanceof _p))return new _p(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function g8(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function fc(e,t,r,n,s){if(!(this instanceof fc))return new fc(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,g8.call(this,n,s)}function Iu(e,t,r,n,s){if(!(this instanceof Iu))return new Iu(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,g8.call(this,n,s)}function Et(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,u="S",d=null;xr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=e.putOnlyUsedFonts||!1,f={},h={internal:{},__private__:{}};h.__private__.PubSub=Cj;var x="1.3",b=h.__private__.getPdfVersion=function(){return x};h.__private__.setPdfVersion=function(N){x=N};var j={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return j};var y=h.__private__.getPageFormat=function(N){return j[N]};s=s||"a4";var _="compat",w="advanced",S=_;function E(){this.saveGraphicsState(),V(new Nt(Ee,0,0,-Ee,0,ql()*Ee).toString()+" cm"),this.setFontSize(this.getFontSize()/Ee),u="n",S=w}function $(){this.restoreGraphicsState(),u="S",S=_}var U=h.__private__.combineFontStyleAndFontWeight=function(N,z){if(N=="bold"&&z=="normal"||N=="bold"&&z==400||N=="normal"&&z=="italic"||N=="bold"&&z=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return z&&(N=z==400||z==="normal"?N==="italic"?"italic":"normal":z!=700&&z!=="bold"||N!=="normal"?(z==700?"bold":z)+""+N:"bold"),N};h.advancedAPI=function(N){var z=S===_;return z&&E.call(this),typeof N!="function"||(N(this),z&&$.call(this)),this},h.compatAPI=function(N){var z=S===w;return z&&$.call(this),typeof N!="function"||(N(this),z&&E.call(this)),this},h.isAdvancedAPI=function(){return S===w};var I,T=function(N){if(S!==w)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},D=h.roundToPrecision=h.__private__.roundToPrecision=function(N,z){var oe=t||z;if(isNaN(N)||isNaN(oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(oe).replace(/0+$/,"")};I=h.hpf=h.__private__.hpf=typeof c=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return D(N,c)}:c==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return D(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return D(N,16)};var C=h.f2=h.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return D(N,2)},P=h.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return D(N,3)},F=h.scale=h.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return S===_?N*Ee:S===w?N:void 0},A=function(N){return F(function(z){return S===_?ql()-z:S===w?z:void 0}(N))};h.__private__.setPrecision=h.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(t=parseInt(N,10))};var R,H="00000000000000000000000000000000",W=h.__private__.getFileId=function(){return H},M=h.__private__.setFileId=function(N){return H=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():H.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Fe=new pu(d.userPermissions,d.userPassword,d.ownerPassword,H)),H};h.setFileId=function(N){return M(N),this},h.getFileId=function(){return W()};var G=h.__private__.convertDateToPDFDate=function(N){var z=N.getTimezoneOffset(),oe=z<0?"+":"-",pe=Math.floor(Math.abs(z/60)),ke=Math.abs(z%60),ze=[oe,B(pe),"'",B(ke),"'"].join("");return["D:",N.getFullYear(),B(N.getMonth()+1),B(N.getDate()),B(N.getHours()),B(N.getMinutes()),B(N.getSeconds()),ze].join("")},ce=h.__private__.convertPDFDateToDate=function(N){var z=parseInt(N.substr(2,4),10),oe=parseInt(N.substr(6,2),10)-1,pe=parseInt(N.substr(8,2),10),ke=parseInt(N.substr(10,2),10),ze=parseInt(N.substr(12,2),10),Ke=parseInt(N.substr(14,2),10);return new Date(z,oe,pe,ke,ze,Ke,0)},ue=h.__private__.setCreationDate=function(N){var z;if(N===void 0&&(N=new Date),N instanceof Date)z=G(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");z=N}return R=z},O=h.__private__.getCreationDate=function(N){var z=R;return N==="jsDate"&&(z=ce(R)),z};h.setCreationDate=function(N){return ue(N),this},h.getCreationDate=function(N){return O(N)};var Z,B=h.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},ee=h.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},X=0,ne=[],le=[],de=0,je=[],me=[],Le=!1,ve=le;h.__private__.setCustomOutputDestination=function(N){Le=!0,ve=N};var he=function(N){Le||(ve=N)};h.__private__.resetCustomOutputDestination=function(){Le=!1,ve=le};var V=h.__private__.out=function(N){return N=N.toString(),de+=N.length+1,ve.push(N),ve},Re=h.__private__.write=function(N){return V(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},xe=h.__private__.getArrayBuffer=function(N){for(var z=N.length,oe=new ArrayBuffer(z),pe=new Uint8Array(oe);z--;)pe[z]=N.charCodeAt(z);return oe},Ce=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Ce};var fe=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(N){return fe=S===w?N/Ee:N,this};var We,Oe=h.__private__.getFontSize=h.getFontSize=function(){return S===_?fe:fe*Ee},nt=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(N){return nt=N,this},h.__private__.getR2L=h.getR2L=function(){return nt};var K,be=h.__private__.setZoomMode=function(N){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))We=N;else if(isNaN(N)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');We=N}else We=parseInt(N,10)};h.__private__.getZoomMode=function(){return We};var _e,re=h.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');K=N};h.__private__.getPageMode=function(){return K};var De=h.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');_e=N};h.__private__.getLayoutMode=function(){return _e},h.__private__.setDisplayMode=h.setDisplayMode=function(N,z,oe){return be(N),De(z),re(oe),this};var se={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(N){if(Object.keys(se).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return se[N]},h.__private__.getDocumentProperties=function(){return se},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(N){for(var z in se)se.hasOwnProperty(z)&&N[z]&&(se[z]=N[z]);return this},h.__private__.setDocumentProperty=function(N,z){if(Object.keys(se).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return se[N]=z};var Pe,Ee,Ne,Me,Ve,$e={},Ye={},pt=[],it={},Je={},Xe={},At={},Pt=null,Lt=0,St=[],dt=new Cj(h),fr=e.hotfixes||[],Ft={},bn={},wn=[],Nt=function N(z,oe,pe,ke,ze,Ke){if(!(this instanceof N))return new N(z,oe,pe,ke,ze,Ke);isNaN(z)&&(z=1),isNaN(oe)&&(oe=0),isNaN(pe)&&(pe=0),isNaN(ke)&&(ke=1),isNaN(ze)&&(ze=0),isNaN(Ke)&&(Ke=0),this._matrix=[z,oe,pe,ke,ze,Ke]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(N)},Nt.prototype.multiply=function(N){var z=N.sx*this.sx+N.shy*this.shx,oe=N.sx*this.shy+N.shy*this.sy,pe=N.shx*this.sx+N.sy*this.shx,ke=N.shx*this.shy+N.sy*this.sy,ze=N.tx*this.sx+N.ty*this.shx+this.tx,Ke=N.tx*this.shy+N.ty*this.sy+this.ty;return new Nt(z,oe,pe,ke,ze,Ke)},Nt.prototype.decompose=function(){var N=this.sx,z=this.shy,oe=this.shx,pe=this.sy,ke=this.tx,ze=this.ty,Ke=Math.sqrt(N*N+z*z),yt=(N/=Ke)*oe+(z/=Ke)*pe;oe-=N*yt,pe-=z*yt;var kt=Math.sqrt(oe*oe+pe*pe);return yt/=kt,N*(pe/=kt)<z*(oe/=kt)&&(N=-N,z=-z,yt=-yt,Ke=-Ke),{scale:new Nt(Ke,0,0,kt,0,0),translate:new Nt(1,0,0,1,ke,ze),rotate:new Nt(N,z,-z,N,0,0),skew:new Nt(1,0,yt,1,0,0)}},Nt.prototype.toString=function(N){return this.join(" ")},Nt.prototype.inversed=function(){var N=this.sx,z=this.shy,oe=this.shx,pe=this.sy,ke=this.tx,ze=this.ty,Ke=1/(N*pe-z*oe),yt=pe*Ke,kt=-z*Ke,Rt=-oe*Ke,Dt=N*Ke;return new Nt(yt,kt,Rt,Dt,-yt*ke-Rt*ze,-kt*ke-Dt*ze)},Nt.prototype.applyToPoint=function(N){var z=N.x*this.sx+N.y*this.shx+this.tx,oe=N.x*this.shy+N.y*this.sy+this.ty;return new Ul(z,oe)},Nt.prototype.applyToRectangle=function(N){var z=this.applyToPoint(N),oe=this.applyToPoint(new Ul(N.x+N.w,N.y+N.h));return new Id(z.x,z.y,oe.x-z.x,oe.y-z.y)},Nt.prototype.clone=function(){var N=this.sx,z=this.shy,oe=this.shx,pe=this.sy,ke=this.tx,ze=this.ty;return new Nt(N,z,oe,pe,ke,ze)},h.Matrix=Nt;var Wt=h.matrixMult=function(N,z){return z.multiply(N)},Yr=new Nt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Yr;var er=function(N,z){if(!Je[N]){var oe=(z instanceof fc?"Sh":"P")+(Object.keys(it).length+1).toString(10);z.id=oe,Je[N]=oe,it[oe]=z,dt.publish("addPattern",z)}};h.ShadingPattern=fc,h.TilingPattern=Iu,h.addShadingPattern=function(N,z){return T("addShadingPattern()"),er(N,z),this},h.beginTilingPattern=function(N){T("beginTilingPattern()"),Md(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},h.endTilingPattern=function(N,z){T("endTilingPattern()"),z.stream=me[Z].join(`
`),er(N,z),dt.publish("endTilingPattern",z),wn.pop().restore()};var cr,ar=h.__private__.newObject=function(){var N=Sr();return It(N,!0),N},Sr=h.__private__.newObjectDeferred=function(){return X++,ne[X]=function(){return de},X},It=function(N,z){return z=typeof z=="boolean"&&z,ne[N]=de,z&&V(N+" 0 obj"),N},nr=h.__private__.newAdditionalObject=function(){var N={objId:Sr(),content:""};return je.push(N),N},zr=Sr(),ur=Sr(),sn=h.__private__.decodeColorString=function(N){var z=N.split(" ");if(z.length!==2||z[1]!=="g"&&z[1]!=="G")z.length!==5||z[4]!=="k"&&z[4]!=="K"||(z=[(1-z[0])*(1-z[3]),(1-z[1])*(1-z[3]),(1-z[2])*(1-z[3]),"r"]);else{var oe=parseFloat(z[0]);z=[oe,oe,oe,"r"]}for(var pe="#",ke=0;ke<3;ke++)pe+=("0"+Math.floor(255*parseFloat(z[ke])).toString(16)).slice(-2);return pe},mn=h.__private__.encodeColorString=function(N){var z;typeof N=="string"&&(N={ch1:N});var oe=N.ch1,pe=N.ch2,ke=N.ch3,ze=N.ch4,Ke=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof oe=="string"&&oe.charAt(0)!=="#"){var yt=new m8(oe);if(yt.ok)oe=yt.toHex();else if(!/^\d*\.?\d*$/.test(oe))throw new Error('Invalid color "'+oe+'" passed to jsPDF.encodeColorString.')}if(typeof oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(oe)&&(oe="#"+oe[1]+oe[1]+oe[2]+oe[2]+oe[3]+oe[3]),typeof oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(oe)){var kt=parseInt(oe.substr(1),16);oe=kt>>16&255,pe=kt>>8&255,ke=255&kt}if(pe===void 0||ze===void 0&&oe===pe&&pe===ke)z=typeof oe=="string"?oe+" "+Ke[0]:N.precision===2?C(oe/255)+" "+Ke[0]:P(oe/255)+" "+Ke[0];else if(ze===void 0||xr(ze)==="object"){if(ze&&!isNaN(ze.a)&&ze.a===0)return["1.","1.","1.",Ke[1]].join(" ");z=typeof oe=="string"?[oe,pe,ke,Ke[1]].join(" "):N.precision===2?[C(oe/255),C(pe/255),C(ke/255),Ke[1]].join(" "):[P(oe/255),P(pe/255),P(ke/255),Ke[1]].join(" ")}else z=typeof oe=="string"?[oe,pe,ke,ze,Ke[2]].join(" "):N.precision===2?[C(oe),C(pe),C(ke),C(ze),Ke[2]].join(" "):[P(oe),P(pe),P(ke),P(ze),Ke[2]].join(" ");return z},$n=h.__private__.getFilters=function(){return o},Zr=h.__private__.putStream=function(N){var z=(N=N||{}).data||"",oe=N.filters||$n(),pe=N.alreadyAppliedFilters||[],ke=N.addLength1||!1,ze=z.length,Ke=N.objectId,yt=function(_n){return _n};if(d!==null&&Ke===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(yt=Fe.encryptor(Ke,0));var kt={};oe===!0&&(oe=["FlateEncode"]);var Rt=N.additionalKeyValues||[],Dt=(kt=Et.API.processDataByFilters!==void 0?Et.API.processDataByFilters(z,oe):{data:z,reverseChain:[]}).reverseChain+(Array.isArray(pe)?pe.join(" "):pe.toString());if(kt.data.length!==0&&(Rt.push({key:"Length",value:kt.data.length}),ke===!0&&Rt.push({key:"Length1",value:ze})),Dt.length!=0)if(Dt.split("/").length-1==1)Rt.push({key:"Filter",value:Dt});else{Rt.push({key:"Filter",value:"["+Dt+"]"});for(var or=0;or<Rt.length;or+=1)if(Rt[or].key==="DecodeParms"){for(var Vr=[],pn=0;pn<kt.reverseChain.split("/").length-1;pn+=1)Vr.push("null");Vr.push(Rt[or].value),Rt[or].value="["+Vr.join(" ")+"]"}}V("<<");for(var kr=0;kr<Rt.length;kr++)V("/"+Rt[kr].key+" "+Rt[kr].value);V(">>"),kt.data.length!==0&&(V("stream"),V(yt(kt.data)),V("endstream"))},hs=h.__private__.putPage=function(N){var z=N.number,oe=N.data,pe=N.objId,ke=N.contentsObjId;It(pe,!0),V("<</Type /Page"),V("/Parent "+N.rootDictionaryObjId+" 0 R"),V("/Resources "+N.resourceDictionaryObjId+" 0 R"),V("/MediaBox ["+parseFloat(I(N.mediaBox.bottomLeftX))+" "+parseFloat(I(N.mediaBox.bottomLeftY))+" "+I(N.mediaBox.topRightX)+" "+I(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&V("/CropBox ["+I(N.cropBox.bottomLeftX)+" "+I(N.cropBox.bottomLeftY)+" "+I(N.cropBox.topRightX)+" "+I(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&V("/BleedBox ["+I(N.bleedBox.bottomLeftX)+" "+I(N.bleedBox.bottomLeftY)+" "+I(N.bleedBox.topRightX)+" "+I(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&V("/TrimBox ["+I(N.trimBox.bottomLeftX)+" "+I(N.trimBox.bottomLeftY)+" "+I(N.trimBox.topRightX)+" "+I(N.trimBox.topRightY)+"]"),N.artBox!==null&&V("/ArtBox ["+I(N.artBox.bottomLeftX)+" "+I(N.artBox.bottomLeftY)+" "+I(N.artBox.topRightX)+" "+I(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&V("/UserUnit "+N.userUnit),dt.publish("putPage",{objId:pe,pageContext:St[z],pageNumber:z,page:oe}),V("/Contents "+ke+" 0 R"),V(">>"),V("endobj");var ze=oe.join(`
`);return S===w&&(ze+=`
Q`),It(ke,!0),Zr({data:ze,filters:$n(),objectId:ke}),V("endobj"),pe},fs=h.__private__.putPages=function(){var N,z,oe=[];for(N=1;N<=Lt;N++)St[N].objId=Sr(),St[N].contentsObjId=Sr();for(N=1;N<=Lt;N++)oe.push(hs({number:N,data:me[N],objId:St[N].objId,contentsObjId:St[N].contentsObjId,mediaBox:St[N].mediaBox,cropBox:St[N].cropBox,bleedBox:St[N].bleedBox,trimBox:St[N].trimBox,artBox:St[N].artBox,userUnit:St[N].userUnit,rootDictionaryObjId:zr,resourceDictionaryObjId:ur}));It(zr,!0),V("<</Type /Pages");var pe="/Kids [";for(z=0;z<Lt;z++)pe+=oe[z]+" 0 R ";V(pe+"]"),V("/Count "+Lt),V(">>"),V("endobj"),dt.publish("postPutPages")},Ii=function(N){dt.publish("putFont",{font:N,out:V,newObject:ar,putStream:Zr}),N.isAlreadyPutted!==!0&&(N.objectNumber=ar(),V("<<"),V("/Type /Font"),V("/BaseFont /"+gu(N.postScriptName)),V("/Subtype /Type1"),typeof N.encoding=="string"&&V("/Encoding /"+N.encoding),V("/FirstChar 32"),V("/LastChar 255"),V(">>"),V("endobj"))},Pr=function(N){N.objectNumber=ar();var z=[];z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Form"}),z.push({key:"BBox",value:"["+[I(N.x),I(N.y),I(N.x+N.width),I(N.y+N.height)].join(" ")+"]"}),z.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var oe=N.pages[1].join(`
`);Zr({data:oe,additionalKeyValues:z,objectId:N.objectNumber}),V("endobj")},ms=function(N,z){z||(z=21);var oe=ar(),pe=function(Ke,yt){var kt,Rt=[],Dt=1/(yt-1);for(kt=0;kt<1;kt+=Dt)Rt.push(kt);if(Rt.push(1),Ke[0].offset!=0){var or={offset:0,color:Ke[0].color};Ke.unshift(or)}if(Ke[Ke.length-1].offset!=1){var Vr={offset:1,color:Ke[Ke.length-1].color};Ke.push(Vr)}for(var pn="",kr=0,_n=0;_n<Rt.length;_n++){for(kt=Rt[_n];kt>Ke[kr+1].offset;)kr++;var gn=Ke[kr].offset,Un=(kt-gn)/(Ke[kr+1].offset-gn),fi=Ke[kr].color,Ls=Ke[kr+1].color;pn+=ee(Math.round((1-Un)*fi[0]+Un*Ls[0]).toString(16))+ee(Math.round((1-Un)*fi[1]+Un*Ls[1]).toString(16))+ee(Math.round((1-Un)*fi[2]+Un*Ls[2]).toString(16))}return pn.trim()}(N.colors,z),ke=[];ke.push({key:"FunctionType",value:"0"}),ke.push({key:"Domain",value:"[0.0 1.0]"}),ke.push({key:"Size",value:"["+z+"]"}),ke.push({key:"BitsPerSample",value:"8"}),ke.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ke.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zr({data:pe,additionalKeyValues:ke,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:oe}),V("endobj"),N.objectNumber=ar(),V("<< /ShadingType "+N.type),V("/ColorSpace /DeviceRGB");var ze="/Coords ["+I(parseFloat(N.coords[0]))+" "+I(parseFloat(N.coords[1]))+" ";N.type===2?ze+=I(parseFloat(N.coords[2]))+" "+I(parseFloat(N.coords[3])):ze+=I(parseFloat(N.coords[2]))+" "+I(parseFloat(N.coords[3]))+" "+I(parseFloat(N.coords[4]))+" "+I(parseFloat(N.coords[5])),V(ze+="]"),N.matrix&&V("/Matrix ["+N.matrix.toString()+"]"),V("/Function "+oe+" 0 R"),V("/Extend [true true]"),V(">>"),V("endobj")},Jn=function(N,z){var oe=Sr(),pe=ar();z.push({resourcesOid:oe,objectOid:pe}),N.objectNumber=pe;var ke=[];ke.push({key:"Type",value:"/Pattern"}),ke.push({key:"PatternType",value:"1"}),ke.push({key:"PaintType",value:"1"}),ke.push({key:"TilingType",value:"1"}),ke.push({key:"BBox",value:"["+N.boundingBox.map(I).join(" ")+"]"}),ke.push({key:"XStep",value:I(N.xStep)}),ke.push({key:"YStep",value:I(N.yStep)}),ke.push({key:"Resources",value:oe+" 0 R"}),N.matrix&&ke.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),Zr({data:N.stream,additionalKeyValues:ke,objectId:N.objectNumber}),V("endobj")},Mi=function(N){for(var z in N.objectNumber=ar(),V("<<"),N)switch(z){case"opacity":V("/ca "+C(N[z]));break;case"stroke-opacity":V("/CA "+C(N[z]))}V(">>"),V("endobj")},ia=function(N){It(N.resourcesOid,!0),V("<<"),V("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var z in V("/Font <<"),$e)$e.hasOwnProperty(z)&&(m===!1||m===!0&&f.hasOwnProperty(z))&&V("/"+z+" "+$e[z].objectNumber+" 0 R");V(">>")}(),function(){if(Object.keys(it).length>0){for(var z in V("/Shading <<"),it)it.hasOwnProperty(z)&&it[z]instanceof fc&&it[z].objectNumber>=0&&V("/"+z+" "+it[z].objectNumber+" 0 R");dt.publish("putShadingPatternDict"),V(">>")}}(),function(z){if(Object.keys(it).length>0){for(var oe in V("/Pattern <<"),it)it.hasOwnProperty(oe)&&it[oe]instanceof h.TilingPattern&&it[oe].objectNumber>=0&&it[oe].objectNumber<z&&V("/"+oe+" "+it[oe].objectNumber+" 0 R");dt.publish("putTilingPatternDict"),V(">>")}}(N.objectOid),function(){if(Object.keys(Xe).length>0){var z;for(z in V("/ExtGState <<"),Xe)Xe.hasOwnProperty(z)&&Xe[z].objectNumber>=0&&V("/"+z+" "+Xe[z].objectNumber+" 0 R");dt.publish("putGStateDict"),V(">>")}}(),function(){for(var z in V("/XObject <<"),Ft)Ft.hasOwnProperty(z)&&Ft[z].objectNumber>=0&&V("/"+z+" "+Ft[z].objectNumber+" 0 R");dt.publish("putXobjectDict"),V(">>")}(),V(">>"),V("endobj")},_o=function(N){Ye[N.fontName]=Ye[N.fontName]||{},Ye[N.fontName][N.fontStyle]=N.id},Oa=function(N,z,oe,pe,ke){var ze={id:"F"+(Object.keys($e).length+1).toString(10),postScriptName:N,fontName:z,fontStyle:oe,encoding:pe,isStandardFont:ke||!1,metadata:{}};return dt.publish("addFont",{font:ze,instance:this}),$e[ze.id]=ze,_o(ze),ze.id},In=h.__private__.pdfEscape=h.pdfEscape=function(N,z){return function(oe,pe){var ke,ze,Ke,yt,kt,Rt,Dt,or,Vr;if(Ke=(pe=pe||{}).sourceEncoding||"Unicode",kt=pe.outputEncoding,(pe.autoencode||kt)&&$e[Pe].metadata&&$e[Pe].metadata[Ke]&&$e[Pe].metadata[Ke].encoding&&(yt=$e[Pe].metadata[Ke].encoding,!kt&&$e[Pe].encoding&&(kt=$e[Pe].encoding),!kt&&yt.codePages&&(kt=yt.codePages[0]),typeof kt=="string"&&(kt=yt[kt]),kt)){for(Dt=!1,Rt=[],ke=0,ze=oe.length;ke<ze;ke++)(or=kt[oe.charCodeAt(ke)])?Rt.push(String.fromCharCode(or)):Rt.push(oe[ke]),Rt[ke].charCodeAt(0)>>8&&(Dt=!0);oe=Rt.join("")}for(ke=oe.length;Dt===void 0&&ke!==0;)oe.charCodeAt(ke-1)>>8&&(Dt=!0),ke--;if(!Dt)return oe;for(Rt=pe.noBOM?[]:[254,255],ke=0,ze=oe.length;ke<ze;ke++){if((Vr=(or=oe.charCodeAt(ke))>>8)>>8)throw new Error("Character at position "+ke+" of string '"+oe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Rt.push(Vr),Rt.push(or-(Vr<<8))}return String.fromCharCode.apply(void 0,Rt)}(N,z).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},aa=h.__private__.beginPage=function(N){me[++Lt]=[],St[Lt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Hc(Lt),he(me[Z])},jo=function(N,z){var oe,pe,ke;switch(r=z||r,typeof N=="string"&&(oe=y(N.toLowerCase()),Array.isArray(oe)&&(pe=oe[0],ke=oe[1])),Array.isArray(N)&&(pe=N[0]*Ee,ke=N[1]*Ee),isNaN(pe)&&(pe=s[0],ke=s[1]),(pe>14400||ke>14400)&&(_r.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),pe=Math.min(14400,pe),ke=Math.min(14400,ke)),s=[pe,ke],r.substr(0,1)){case"l":ke>pe&&(s=[ke,pe]);break;case"p":pe>ke&&(s=[ke,pe])}aa(s),ps(Yt),V(ko),Pd!==0&&V(Pd+" J"),Td!==0&&V(Td+" j"),dt.publish("addPage",{pageNumber:Lt})},Ra=function(N){N>0&&N<=Lt&&(me.splice(N,1),St.splice(N,1),Lt--,Z>Lt&&(Z=Lt),this.setPage(Z))},Hc=function(N){N>0&&N<=Lt&&(Z=N)},Rl=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return me.length-1},Gc=function(N,z,oe){var pe,ke=void 0;return oe=oe||{},N=N!==void 0?N:$e[Pe].fontName,z=z!==void 0?z:$e[Pe].fontStyle,pe=N.toLowerCase(),Ye[pe]!==void 0&&Ye[pe][z]!==void 0?ke=Ye[pe][z]:Ye[N]!==void 0&&Ye[N][z]!==void 0?ke=Ye[N][z]:oe.disableWarning===!1&&_r.warn("Unable to look up font label for font '"+N+"', '"+z+"'. Refer to getFontList() for available fonts."),ke||oe.noFallback||(ke=Ye.times[z])==null&&(ke=Ye.times.normal),ke},No=h.__private__.putInfo=function(){var N=ar(),z=function(pe){return pe};for(var oe in d!==null&&(z=Fe.encryptor(N,0)),V("<<"),V("/Producer ("+In(z("jsPDF "+Et.version))+")"),se)se.hasOwnProperty(oe)&&se[oe]&&V("/"+oe.substr(0,1).toUpperCase()+oe.substr(1)+" ("+In(z(se[oe]))+")");V("/CreationDate ("+In(z(R))+")"),V(">>"),V("endobj")},Ed=h.__private__.putCatalog=function(N){var z=(N=N||{}).rootDictionaryObjId||zr;switch(ar(),V("<<"),V("/Type /Catalog"),V("/Pages "+z+" 0 R"),We||(We="fullwidth"),We){case"fullwidth":V("/OpenAction [3 0 R /FitH null]");break;case"fullheight":V("/OpenAction [3 0 R /FitV null]");break;case"fullpage":V("/OpenAction [3 0 R /Fit]");break;case"original":V("/OpenAction [3 0 R /XYZ null null 1]");break;default:var oe=""+We;oe.substr(oe.length-1)==="%"&&(We=parseInt(We)/100),typeof We=="number"&&V("/OpenAction [3 0 R /XYZ null null "+C(We)+"]")}switch(_e||(_e="continuous"),_e){case"continuous":V("/PageLayout /OneColumn");break;case"single":V("/PageLayout /SinglePage");break;case"two":case"twoleft":V("/PageLayout /TwoColumnLeft");break;case"tworight":V("/PageLayout /TwoColumnRight")}K&&V("/PageMode /"+K),dt.publish("putCatalog"),V(">>"),V("endobj")},Jr=h.__private__.putTrailer=function(){V("trailer"),V("<<"),V("/Size "+(X+1)),V("/Root "+X+" 0 R"),V("/Info "+(X-1)+" 0 R"),d!==null&&V("/Encrypt "+Fe.oid+" 0 R"),V("/ID [ <"+H+"> <"+H+"> ]"),V(">>")},Fl=h.__private__.putHeader=function(){V("%PDF-"+x),V("%")},Dl=h.__private__.putXRef=function(){var N="0000000000";V("xref"),V("0 "+(X+1)),V("0000000000 65535 f ");for(var z=1;z<=X;z++)typeof ne[z]=="function"?V((N+ne[z]()).slice(-10)+" 00000 n "):ne[z]!==void 0?V((N+ne[z]).slice(-10)+" 00000 n "):V("0000000000 00000 n ")},di=h.__private__.buildDocument=function(){var N;X=0,de=0,le=[],ne=[],je=[],zr=Sr(),ur=Sr(),he(le),dt.publish("buildDocument"),Fl(),fs(),function(){dt.publish("putAdditionalObjects");for(var oe=0;oe<je.length;oe++){var pe=je[oe];It(pe.objId,!0),V(pe.content),V("endobj")}dt.publish("postPutAdditionalObjects")}(),N=[],function(){for(var oe in $e)$e.hasOwnProperty(oe)&&(m===!1||m===!0&&f.hasOwnProperty(oe))&&Ii($e[oe])}(),function(){var oe;for(oe in Xe)Xe.hasOwnProperty(oe)&&Mi(Xe[oe])}(),function(){for(var oe in Ft)Ft.hasOwnProperty(oe)&&Pr(Ft[oe])}(),function(oe){var pe;for(pe in it)it.hasOwnProperty(pe)&&(it[pe]instanceof fc?ms(it[pe]):it[pe]instanceof Iu&&Jn(it[pe],oe))}(N),dt.publish("putResources"),N.forEach(ia),ia({resourcesOid:ur,objectOid:Number.MAX_SAFE_INTEGER}),dt.publish("postPutResources"),d!==null&&(Fe.oid=ar(),V("<<"),V("/Filter /Standard"),V("/V "+Fe.v),V("/R "+Fe.r),V("/U <"+Fe.toHexString(Fe.U)+">"),V("/O <"+Fe.toHexString(Fe.O)+">"),V("/P "+Fe.P),V(">>"),V("endobj")),No(),Ed();var z=de;return Dl(),Jr(),V("startxref"),V(""+z),V("%%EOF"),he(me[Z]),le.join(`
`)},oa=h.__private__.getBlob=function(N){return new Blob([xe(N)],{type:"application/pdf"})},we=h.output=h.__private__.output=(cr=function(N,z){switch(typeof(z=z||{})=="string"?z={filename:z}:z.filename=z.filename||"generated.pdf",N){case void 0:return di();case"save":h.save(z.filename);break;case"arraybuffer":return xe(di());case"blob":return oa(di());case"bloburi":case"bloburl":if(Ot.URL!==void 0&&typeof Ot.URL.createObjectURL=="function")return Ot.URL&&Ot.URL.createObjectURL(oa(di()))||void 0;_r.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var oe="",pe=di();try{oe=Nj(pe)}catch{oe=Nj(unescape(encodeURIComponent(pe)))}return"data:application/pdf;filename="+z.filename+";base64,"+oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ot)==="[object Window]"){var ke="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ze=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';z.pdfObjectUrl&&(ke=z.pdfObjectUrl,ze="");var Ke='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ke+'"'+ze+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(z)+");<\/script></body></html>",yt=Ot.open();return yt!==null&&yt.document.write(Ke),yt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ot)==="[object Window]"){var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(z.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+z.filename+'" width="500px" height="400px" /></body></html>',Rt=Ot.open();if(Rt!==null){Rt.document.write(kt);var Dt=this;Rt.document.documentElement.querySelector("#pdfViewer").onload=function(){Rt.document.title=z.filename,Rt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Dt.output("bloburl"))}}return Rt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ot)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var or='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",z)+'"></iframe></body></html>',Vr=Ot.open();if(Vr!==null&&(Vr.document.write(or),Vr.document.title=z.filename),Vr||typeof safari>"u")return Vr;break;case"datauri":case"dataurl":return Ot.document.location.href=this.output("datauristring",z);default:return null}},cr.foo=function(){try{return cr.apply(this,arguments)}catch(oe){var N=oe.stack||"";~N.indexOf(" at ")&&(N=N.split(" at ")[1]);var z="Error in function "+N.split(`
`)[0].split("<")[0]+": "+oe.message;if(!Ot.console)throw new Error(z);Ot.console.error(z,oe),Ot.alert&&alert(z)}},cr.foo.bar=cr,cr.foo),He=function(N){return Array.isArray(fr)===!0&&fr.indexOf(N)>-1};switch(n){case"pt":Ee=1;break;case"mm":Ee=72/25.4;break;case"cm":Ee=72/2.54;break;case"in":Ee=72;break;case"px":Ee=He("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ee=12;break;case"ex":Ee=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Ee=n}var Fe=null;ue(),M();var lt=h.__private__.getPageInfo=h.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[N].objId,pageNumber:N,pageContext:St[N]}},ft=h.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var z in St)if(St[z].objId===N)break;return lt(z)},ot=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:St[Z].objId,pageNumber:Z,pageContext:St[Z]}};h.addPage=function(){return jo.apply(this,arguments),this},h.setPage=function(){return Hc.apply(this,arguments),he.call(this,me[Z]),this},h.insertPage=function(N){return this.addPage(),this.movePage(Z,N),this},h.movePage=function(N,z){var oe,pe;if(N>z){oe=me[N],pe=St[N];for(var ke=N;ke>z;ke--)me[ke]=me[ke-1],St[ke]=St[ke-1];me[z]=oe,St[z]=pe,this.setPage(z)}else if(N<z){oe=me[N],pe=St[N];for(var ze=N;ze<z;ze++)me[ze]=me[ze+1],St[ze]=St[ze+1];me[z]=oe,St[z]=pe,this.setPage(z)}return this},h.deletePage=function(){return Ra.apply(this,arguments),this},h.__private__.text=h.text=function(N,z,oe,pe,ke){var ze,Ke,yt,kt,Rt,Dt,or,Vr,pn,kr=(pe=pe||{}).scope||this;if(typeof N=="number"&&typeof z=="number"&&(typeof oe=="string"||Array.isArray(oe))){var _n=oe;oe=z,z=N,N=_n}if(arguments[3]instanceof Nt==0?(yt=arguments[4],kt=arguments[5],xr(or=arguments[3])==="object"&&or!==null||(typeof yt=="string"&&(kt=yt,yt=null),typeof or=="string"&&(kt=or,or=null),typeof or=="number"&&(yt=or,or=null),pe={flags:or,angle:yt,align:kt})):(T("The transform parameter of text() with a Matrix value"),pn=ke),isNaN(z)||isNaN(oe)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return kr;var gn,Un="",fi=typeof pe.lineHeightFactor=="number"?pe.lineHeightFactor:Fr,Ls=kr.internal.scaleFactor;function sm(dr){return dr=dr.split("	").join(Array(pe.TabLen||9).join(" ")),In(dr,or)}function Jc(dr){for(var br,on=dr.concat(),jn=[],Ua=on.length;Ua--;)typeof(br=on.shift())=="string"?jn.push(br):Array.isArray(dr)&&(br.length===1||br[1]===void 0&&br[2]===void 0)?jn.push(br[0]):jn.push([br[0],br[1],br[2]]);return jn}function Vl(dr,br){var on;if(typeof dr=="string")on=br(dr)[0];else if(Array.isArray(dr)){for(var jn,Ua,Vd=dr.concat(),eu=[],om=Vd.length;om--;)typeof(jn=Vd.shift())=="string"?eu.push(br(jn)[0]):Array.isArray(jn)&&typeof jn[0]=="string"&&(Ua=br(jn[0],jn[1],jn[2]),eu.push([Ua[0],Ua[1],Ua[2]]));on=eu}return on}var Co=!1,Wl=!0;if(typeof N=="string")Co=!0;else if(Array.isArray(N)){var Hl=N.concat();Ke=[];for(var Gl,Xn=Hl.length;Xn--;)(typeof(Gl=Hl.shift())!="string"||Array.isArray(Gl)&&typeof Gl[0]!="string")&&(Wl=!1);Co=Wl}if(Co===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var Kl=fe/kr.internal.scaleFactor,Yl=Kl*(fi-1);switch(pe.baseline){case"bottom":oe-=Yl;break;case"top":oe+=Kl-Yl;break;case"hanging":oe+=Kl-2*Yl;break;case"middle":oe+=Kl/2-Yl}if((Dt=pe.maxWidth||0)>0&&(typeof N=="string"?N=kr.splitTextToSize(N,Dt):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(dr,br){return dr.concat(kr.splitTextToSize(br,Dt))},[]))),ze={text:N,x:z,y:oe,options:pe,mutex:{pdfEscape:In,activeFontKey:Pe,fonts:$e,activeFontSize:fe}},dt.publish("preProcessText",ze),N=ze.text,yt=(pe=ze.options).angle,pn instanceof Nt==0&&yt&&typeof yt=="number"){yt*=Math.PI/180,pe.rotationDirection===0&&(yt=-yt),S===w&&(yt=-yt);var Od=Math.cos(yt),Rd=Math.sin(yt);pn=new Nt(Od,Rd,-Rd,Od,0,0)}else yt&&yt instanceof Nt&&(pn=yt);S!==w||pn||(pn=Yr),(Rt=pe.charSpace||Yc)!==void 0&&(Un+=I(F(Rt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Vr=pe.horizontalScale)!==void 0&&(Un+=I(100*Vr)+` Tz
`),pe.lang;var Xr=-1,$a=pe.renderingMode!==void 0?pe.renderingMode:pe.stroke,Xc=kr.internal.getCurrentPageInfo().pageContext;switch($a){case 0:case!1:case"fill":Xr=0;break;case 1:case!0:case"stroke":Xr=1;break;case 2:case"fillThenStroke":Xr=2;break;case 3:case"invisible":Xr=3;break;case 4:case"fillAndAddForClipping":Xr=4;break;case 5:case"strokeAndAddPathForClipping":Xr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Xr=6;break;case 7:case"addToPathForClipping":Xr=7}var im=Xc.usedRenderingMode!==void 0?Xc.usedRenderingMode:-1;Xr!==-1?Un+=Xr+` Tr
`:im!==-1&&(Un+=`0 Tr
`),Xr!==-1&&(Xc.usedRenderingMode=Xr),kt=pe.align||"left";var mi,Zl=fe*fi,Fd=kr.internal.pageSize.getWidth(),Dd=$e[Pe];Rt=pe.charSpace||Yc,Dt=pe.maxWidth||0,or=Object.assign({autoencode:!0,noBOM:!0},pe.flags);var Eo=[],Jl=function(dr){return kr.getStringUnitWidth(dr,{font:Dd,charSpace:Rt,fontSize:fe,doKerning:!1})*fe/Ls};if(Object.prototype.toString.call(N)==="[object Array]"){var Vs;Ke=Jc(N),kt!=="left"&&(mi=Ke.map(Jl));var Ws,Ao=0;if(kt==="right"){z-=mi[0],N=[],Xn=Ke.length;for(var Ba=0;Ba<Xn;Ba++)Ba===0?(Ws=Ri(z),Vs=Fi(oe)):(Ws=F(Ao-mi[Ba]),Vs=-Zl),N.push([Ke[Ba],Ws,Vs]),Ao=mi[Ba]}else if(kt==="center"){z-=mi[0]/2,N=[],Xn=Ke.length;for(var Lo=0;Lo<Xn;Lo++)Lo===0?(Ws=Ri(z),Vs=Fi(oe)):(Ws=F((Ao-mi[Lo])/2),Vs=-Zl),N.push([Ke[Lo],Ws,Vs]),Ao=mi[Lo]}else if(kt==="left"){N=[],Xn=Ke.length;for(var $d=0;$d<Xn;$d++)N.push(Ke[$d])}else if(kt==="justify"&&Dd.encoding==="Identity-H"){N=[],Xn=Ke.length,Dt=Dt!==0?Dt:Fd;for(var Qc=0,an=0;an<Xn;an++)if(Vs=an===0?Fi(oe):-Zl,Ws=an===0?Ri(z):Qc,an<Xn-1){var am=F((Dt-mi[an])/(Ke[an].split(" ").length-1)),ca=Ke[an].split(" ");N.push([ca[0]+" ",Ws,Vs]),Qc=0;for(var ua=1;ua<ca.length;ua++){var Bd=(Jl(ca[ua-1]+" "+ca[ua])-Jl(ca[ua]))*Ls+am;ua==ca.length-1?N.push([ca[ua],Bd,0]):N.push([ca[ua]+" ",Bd,0]),Qc-=Bd}}else N.push([Ke[an],Ws,Vs]);N.push(["",Qc,0])}else{if(kt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],Xn=Ke.length,Dt=Dt!==0?Dt:Fd,an=0;an<Xn;an++){Vs=an===0?Fi(oe):-Zl,Ws=an===0?Ri(z):0;var Ud=Ke[an].split(" ").length-1,zd=Ud>0?(Dt-mi[an])/Ud:0;an<Xn-1?Eo.push(I(F(zd))):Eo.push(0),N.push([Ke[an],Ws,Vs])}}}(typeof pe.R2L=="boolean"?pe.R2L:nt)===!0&&(N=Vl(N,function(dr,br,on){return[dr.split("").reverse().join(""),br,on]})),ze={text:N,x:z,y:oe,options:pe,mutex:{pdfEscape:In,activeFontKey:Pe,fonts:$e,activeFontSize:fe}},dt.publish("postProcessText",ze),N=ze.text,gn=ze.mutex.isHex||!1;var qd=$e[Pe].encoding;qd!=="WinAnsiEncoding"&&qd!=="StandardEncoding"||(N=Vl(N,function(dr,br,on){return[sm(dr),br,on]})),Ke=Jc(N),N=[];for(var Po,To,Io,Xl=Array.isArray(Ke[0])?1:0,Mo="",Ql=function(dr,br,on){var jn="";return on instanceof Nt?(on=typeof pe.angle=="number"?Wt(on,new Nt(1,0,0,1,dr,br)):Wt(new Nt(1,0,0,1,dr,br),on),S===w&&(on=Wt(new Nt(1,0,0,-1,0,0),on)),jn=on.join(" ")+` Tm
`):jn=I(dr)+" "+I(br)+` Td
`,jn},pi=0;pi<Ke.length;pi++){switch(Mo="",Xl){case 1:Io=(gn?"<":"(")+Ke[pi][0]+(gn?">":")"),Po=parseFloat(Ke[pi][1]),To=parseFloat(Ke[pi][2]);break;case 0:Io=(gn?"<":"(")+Ke[pi]+(gn?">":")"),Po=Ri(z),To=Fi(oe)}Eo!==void 0&&Eo[pi]!==void 0&&(Mo=Eo[pi]+` Tw
`),pi===0?N.push(Mo+Ql(Po,To,pn)+Io):Xl===0?N.push(Mo+Io):Xl===1&&N.push(Mo+Ql(Po,To,pn)+Io)}N=Xl===0?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var da=`BT
/`;return da+=Pe+" "+fe+` Tf
`,da+=I(fe*fi)+` TL
`,da+=$l+`
`,da+=Un,da+=N,V(da+="ET"),f[Pe]=!0,kr};var et=h.__private__.clip=h.clip=function(N){return V(N==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return et("evenodd")},h.__private__.discardPath=h.discardPath=function(){return V("n"),this};var rt=h.__private__.isValidStyle=function(N){var z=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(z=!0),z};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(N){return rt(N)&&(u=N),this};var ht=h.__private__.getStyle=h.getStyle=function(N){var z=u;switch(N){case"D":case"S":z="S";break;case"F":z="f";break;case"FD":case"DF":z="B";break;case"f":case"f*":case"B":case"B*":z=N}return z},at=h.close=function(){return V("h"),this};h.stroke=function(){return V("S"),this},h.fill=function(N){return wt("f",N),this},h.fillEvenOdd=function(N){return wt("f*",N),this},h.fillStroke=function(N){return wt("B",N),this},h.fillStrokeEvenOdd=function(N){return wt("B*",N),this};var wt=function(N,z){xr(z)==="object"?Mt(z,N):V(N)},Bt=function(N){N===null||S===w&&N===void 0||(N=ht(N),V(N))};function ut(N,z,oe,pe,ke){var ze=new Iu(z||this.boundingBox,oe||this.xStep,pe||this.yStep,this.gState,ke||this.matrix);ze.stream=this.stream;var Ke=N+"$$"+this.cloneIndex+++"$$";return er(Ke,ze),ze}var Mt=function(N,z){var oe=Je[N.key],pe=it[oe];if(pe instanceof fc)V("q"),V(qr(z)),pe.gState&&h.setGState(pe.gState),V(N.matrix.toString()+" cm"),V("/"+oe+" sh"),V("Q");else if(pe instanceof Iu){var ke=new Nt(1,0,0,-1,0,ql());N.matrix&&(ke=ke.multiply(N.matrix||Yr),oe=ut.call(pe,N.key,N.boundingBox,N.xStep,N.yStep,ke).id),V("q"),V("/Pattern cs"),V("/"+oe+" scn"),pe.gState&&h.setGState(pe.gState),V(z),V("Q")}},qr=function(N){switch(N){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Bn=h.moveTo=function(N,z){return V(I(F(N))+" "+I(A(z))+" m"),this},Oi=h.lineTo=function(N,z){return V(I(F(N))+" "+I(A(z))+" l"),this},qs=h.curveTo=function(N,z,oe,pe,ke,ze){return V([I(F(N)),I(A(z)),I(F(oe)),I(A(pe)),I(F(ke)),I(A(ze)),"c"].join(" ")),this};h.__private__.line=h.line=function(N,z,oe,pe,ke){if(isNaN(N)||isNaN(z)||isNaN(oe)||isNaN(pe)||!rt(ke))throw new Error("Invalid arguments passed to jsPDF.line");return S===_?this.lines([[oe-N,pe-z]],N,z,[1,1],ke||"S"):this.lines([[oe-N,pe-z]],N,z,[1,1]).stroke()},h.__private__.lines=h.lines=function(N,z,oe,pe,ke,ze){var Ke,yt,kt,Rt,Dt,or,Vr,pn,kr,_n,gn,Un;if(typeof N=="number"&&(Un=oe,oe=z,z=N,N=Un),pe=pe||[1,1],ze=ze||!1,isNaN(z)||isNaN(oe)||!Array.isArray(N)||!Array.isArray(pe)||!rt(ke)||typeof ze!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bn(z,oe),Ke=pe[0],yt=pe[1],Rt=N.length,_n=z,gn=oe,kt=0;kt<Rt;kt++)(Dt=N[kt]).length===2?(_n=Dt[0]*Ke+_n,gn=Dt[1]*yt+gn,Oi(_n,gn)):(or=Dt[0]*Ke+_n,Vr=Dt[1]*yt+gn,pn=Dt[2]*Ke+_n,kr=Dt[3]*yt+gn,_n=Dt[4]*Ke+_n,gn=Dt[5]*yt+gn,qs(or,Vr,pn,kr,_n,gn));return ze&&at(),Bt(ke),this},h.path=function(N){for(var z=0;z<N.length;z++){var oe=N[z],pe=oe.c;switch(oe.op){case"m":Bn(pe[0],pe[1]);break;case"l":Oi(pe[0],pe[1]);break;case"c":qs.apply(this,pe);break;case"h":at()}}return this},h.__private__.rect=h.rect=function(N,z,oe,pe,ke){if(isNaN(N)||isNaN(z)||isNaN(oe)||isNaN(pe)||!rt(ke))throw new Error("Invalid arguments passed to jsPDF.rect");return S===_&&(pe=-pe),V([I(F(N)),I(A(z)),I(F(oe)),I(F(pe)),"re"].join(" ")),Bt(ke),this},h.__private__.triangle=h.triangle=function(N,z,oe,pe,ke,ze,Ke){if(isNaN(N)||isNaN(z)||isNaN(oe)||isNaN(pe)||isNaN(ke)||isNaN(ze)||!rt(Ke))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[oe-N,pe-z],[ke-oe,ze-pe],[N-ke,z-ze]],N,z,[1,1],Ke,!0),this},h.__private__.roundedRect=h.roundedRect=function(N,z,oe,pe,ke,ze,Ke){if(isNaN(N)||isNaN(z)||isNaN(oe)||isNaN(pe)||isNaN(ke)||isNaN(ze)||!rt(Ke))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var yt=4/3*(Math.SQRT2-1);return ke=Math.min(ke,.5*oe),ze=Math.min(ze,.5*pe),this.lines([[oe-2*ke,0],[ke*yt,0,ke,ze-ze*yt,ke,ze],[0,pe-2*ze],[0,ze*yt,-ke*yt,ze,-ke,ze],[2*ke-oe,0],[-ke*yt,0,-ke,-ze*yt,-ke,-ze],[0,2*ze-pe],[0,-ze*yt,ke*yt,-ze,ke,-ze]],N+ke,z,[1,1],Ke,!0),this},h.__private__.ellipse=h.ellipse=function(N,z,oe,pe,ke){if(isNaN(N)||isNaN(z)||isNaN(oe)||isNaN(pe)||!rt(ke))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ze=4/3*(Math.SQRT2-1)*oe,Ke=4/3*(Math.SQRT2-1)*pe;return Bn(N+oe,z),qs(N+oe,z-Ke,N+ze,z-pe,N,z-pe),qs(N-ze,z-pe,N-oe,z-Ke,N-oe,z),qs(N-oe,z+Ke,N-ze,z+pe,N,z+pe),qs(N+ze,z+pe,N+oe,z+Ke,N+oe,z),Bt(ke),this},h.__private__.circle=h.circle=function(N,z,oe,pe){if(isNaN(N)||isNaN(z)||isNaN(oe)||!rt(pe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,z,oe,oe,pe)},h.setFont=function(N,z,oe){return oe&&(z=U(z,oe)),Pe=Gc(N,z,{disableWarning:!1}),this};var So=h.__private__.getFont=h.getFont=function(){return $e[Gc.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var N,z,oe={};for(N in Ye)if(Ye.hasOwnProperty(N))for(z in oe[N]=[],Ye[N])Ye[N].hasOwnProperty(z)&&oe[N].push(z);return oe},h.addFont=function(N,z,oe,pe,ke){var ze=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ze.indexOf(arguments[3])!==-1?ke=arguments[3]:arguments[3]&&ze.indexOf(arguments[3])==-1&&(oe=U(oe,pe)),Oa.call(this,N,z,oe,ke=ke||"Identity-H")};var Fr,Yt=e.lineWidth||.200025,bt=h.__private__.getLineWidth=h.getLineWidth=function(){return Yt},ps=h.__private__.setLineWidth=h.setLineWidth=function(N){return Yt=N,V(I(F(N))+" w"),this};h.__private__.setLineDash=Et.API.setLineDash=Et.API.setLineDashPattern=function(N,z){if(N=N||[],z=z||0,isNaN(z)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(oe){return I(F(oe))}).join(" "),z=I(F(z)),V("["+N+"] "+z+" d"),this};var hi=h.__private__.getLineHeight=h.getLineHeight=function(){return fe*Fr};h.__private__.getLineHeight=h.getLineHeight=function(){return fe*Fr};var As=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(Fr=N),this},Ad=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Fr};As(e.lineHeight);var Ri=h.__private__.getHorizontalCoordinate=function(N){return F(N)},Fi=h.__private__.getVerticalCoordinate=function(N){return S===w?N:St[Z].mediaBox.topRightY-St[Z].mediaBox.bottomLeftY-F(N)},Dr=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(N){return I(Ri(N))},la=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(N){return I(Fi(N))},ko=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return sn(ko)},h.__private__.setStrokeColor=h.setDrawColor=function(N,z,oe,pe){return ko=mn({ch1:N,ch2:z,ch3:oe,ch4:pe,pdfColorType:"draw",precision:2}),V(ko),this};var Ld=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return sn(Ld)},h.__private__.setFillColor=h.setFillColor=function(N,z,oe,pe){return Ld=mn({ch1:N,ch2:z,ch3:oe,ch4:pe,pdfColorType:"fill",precision:2}),V(Ld),this};var $l=e.textColor||"0 g",Kc=h.__private__.getTextColor=h.getTextColor=function(){return sn($l)};h.__private__.setTextColor=h.setTextColor=function(N,z,oe,pe){return $l=mn({ch1:N,ch2:z,ch3:oe,ch4:pe,pdfColorType:"text",precision:3}),this};var Yc=e.charSpace,Lg=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Yc||0)};h.__private__.setCharSpace=h.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yc=N,this};var Pd=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(N){var z=h.CapJoinStyles[N];if(z===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Pd=z,V(z+" J"),this};var Td=0;h.__private__.setLineJoin=h.setLineJoin=function(N){var z=h.CapJoinStyles[N];if(z===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Td=z,V(z+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return V(I(F(N))+" M"),this},h.GState=_p,h.setGState=function(N){(N=typeof N=="string"?Xe[At[N]]:Bl(null,N)).equals(Pt)||(V("/"+N.id+" gs"),Pt=N)};var Bl=function(N,z){if(!N||!At[N]){var oe=!1;for(var pe in Xe)if(Xe.hasOwnProperty(pe)&&Xe[pe].equals(z)){oe=!0;break}if(oe)z=Xe[pe];else{var ke="GS"+(Object.keys(Xe).length+1).toString(10);Xe[ke]=z,z.id=ke}return N&&(At[N]=z.id),dt.publish("addGState",z),z}};h.addGState=function(N,z){return Bl(N,z),this},h.saveGraphicsState=function(){return V("q"),pt.push({key:Pe,size:fe,color:$l}),this},h.restoreGraphicsState=function(){V("Q");var N=pt.pop();return Pe=N.key,fe=N.size,$l=N.color,Pt=null,this},h.setCurrentTransformationMatrix=function(N){return V(N.toString()+" cm"),this},h.comment=function(N){return V("#"+N),this};var Ul=function(N,z){var oe=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return oe},set:function(ze){isNaN(ze)||(oe=parseFloat(ze))}});var pe=z||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return pe},set:function(ze){isNaN(ze)||(pe=parseFloat(ze))}});var ke="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ke},set:function(ze){ke=ze.toString()}}),this},Id=function(N,z,oe,pe){Ul.call(this,N,z),this.type="rect";var ke=oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ke},set:function(Ke){isNaN(Ke)||(ke=parseFloat(Ke))}});var ze=pe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ze},set:function(Ke){isNaN(Ke)||(ze=parseFloat(Ke))}}),this},Zc=function(){this.page=Lt,this.currentPage=Z,this.pages=me.slice(0),this.pagesContext=St.slice(0),this.x=Ne,this.y=Me,this.matrix=Ve,this.width=Qf(Z),this.height=Fa(Z),this.outputDestination=ve,this.id="",this.objectNumber=-1};Zc.prototype.restore=function(){Lt=this.page,Z=this.currentPage,St=this.pagesContext,me=this.pages,Ne=this.x,Me=this.y,Ve=this.matrix,em(Z,this.width),Da(Z,this.height),ve=this.outputDestination};var Md=function(N,z,oe,pe,ke){wn.push(new Zc),Lt=Z=0,me=[],Ne=N,Me=z,Ve=ke,aa([oe,pe])};for(var zl in h.beginFormObject=function(N,z,oe,pe,ke){return Md(N,z,oe,pe,ke),this},h.endFormObject=function(N){return function(z){if(bn[z])wn.pop().restore();else{var oe=new Zc,pe="Xo"+(Object.keys(Ft).length+1).toString(10);oe.id=pe,bn[z]=pe,Ft[pe]=oe,dt.publish("addFormObject",oe),wn.pop().restore()}}(N),this},h.doFormObject=function(N,z){var oe=Ft[bn[N]];return V("q"),V(z.toString()+" cm"),V("/"+oe.id+" Do"),V("Q"),this},h.getFormObject=function(N){var z=Ft[bn[N]];return{x:z.x,y:z.y,width:z.width,height:z.height,matrix:z.matrix}},h.save=function(N,z){return N=N||"generated.pdf",(z=z||{}).returnPromise=z.returnPromise||!1,z.returnPromise===!1?(dc(oa(di()),N),typeof dc.unload=="function"&&Ot.setTimeout&&setTimeout(dc.unload,911),this):new Promise(function(oe,pe){try{var ke=dc(oa(di()),N);typeof dc.unload=="function"&&Ot.setTimeout&&setTimeout(dc.unload,911),oe(ke)}catch(ze){pe(ze.message)}})},Et.API)Et.API.hasOwnProperty(zl)&&(zl==="events"&&Et.API.events.length?function(N,z){var oe,pe,ke;for(ke=z.length-1;ke!==-1;ke--)oe=z[ke][0],pe=z[ke][1],N.subscribe.apply(N,[oe].concat(typeof pe=="function"?[pe]:pe))}(dt,Et.API.events):h[zl]=Et.API[zl]);function Qf(N){return St[N].mediaBox.topRightX-St[N].mediaBox.bottomLeftX}function em(N,z){St[N].mediaBox.topRightX=z+St[N].mediaBox.bottomLeftX}function Fa(N){return St[N].mediaBox.topRightY-St[N].mediaBox.bottomLeftY}function Da(N,z){St[N].mediaBox.topRightY=z+St[N].mediaBox.bottomLeftY}var tm=h.getPageWidth=function(N){return Qf(N=N||Z)/Ee},rm=h.setPageWidth=function(N,z){em(N,z*Ee)},ql=h.getPageHeight=function(N){return Fa(N=N||Z)/Ee},nm=h.setPageHeight=function(N,z){Da(N,z*Ee)};return h.internal={pdfEscape:In,getStyle:ht,getFont:So,getFontSize:Oe,getCharSpace:Lg,getTextColor:Kc,getLineHeight:hi,getLineHeightFactor:Ad,getLineWidth:bt,write:Re,getHorizontalCoordinate:Ri,getVerticalCoordinate:Fi,getCoordinateString:Dr,getVerticalCoordinateString:la,collections:{},newObject:ar,newAdditionalObject:nr,newObjectDeferred:Sr,newObjectDeferredBegin:It,getFilters:$n,putStream:Zr,events:dt,scaleFactor:Ee,pageSize:{getWidth:function(){return tm(Z)},setWidth:function(N){rm(Z,N)},getHeight:function(){return ql(Z)},setHeight:function(N){nm(Z,N)}},encryptionOptions:d,encryption:Fe,getEncryptor:function(N){return d!==null?Fe.encryptor(N,0):function(z){return z}},output:we,getNumberOfPages:Rl,pages:me,out:V,f2:C,f3:P,getPageInfo:lt,getPageInfoByObjId:ft,getCurrentPageInfo:ot,getPDFVersion:b,Point:Ul,Rectangle:Id,Matrix:Nt,hasHotfix:He},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return tm(Z)},set:function(N){rm(Z,N)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return ql(Z)},set:function(N){nm(Z,N)},enumerable:!0,configurable:!0}),(function(N){for(var z=0,oe=Ce.length;z<oe;z++){var pe=Oa.call(this,N[z][0],N[z][1],N[z][2],Ce[z][3],!0);m===!1&&(f[pe]=!0);var ke=N[z][0].split("-");_o({id:pe,fontName:ke[0],fontStyle:ke[1]||""})}dt.publish("addFonts",{fonts:$e,dictionary:Ye})}).call(h,Ce),Pe="F1",jo(s,r),dt.publish("initialized"),h}pu.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},pu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},pu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},pu.prototype.processOwnerPassword=function(e,t){return pv(mv(t).substr(0,5),e)},pu.prototype.encryptor=function(e,t){var r=mv(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return pv(r,n)}},_p.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||xr(e)!==xr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Et.API={events:[]},Et.version="3.0.3";var tn=Et.API,wb=1,Vc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},uu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},$t=function(e){return e.toFixed(2)},Vo=function(e){return e.toFixed(5)};tn.__acroform__={};var zs=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Ej=function(e){return e*wb},pa=function(e){var t=new v8,r=vt.internal.getHeight(e)||0,n=vt.internal.getWidth(e)||0;return t.BBox=[0,0,Number($t(n)),Number($t(r))],t},Gq=tn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Kq=tn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},Yq=tn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},dn=tn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Yq(e,t-1)},hn=tn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Gq(e,t-1)},fn=tn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Kq(e,t-1)},Zq=tn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(i)||0,[Number($t(c.lowerLeft_X)),Number($t(c.lowerLeft_Y)),Number($t(c.upperRight_X)),Number($t(c.upperRight_Y))]},Jq=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=gv(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+$t(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=pa(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},gv=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(C){return C.split(`
`)}):s.map(function(C){return[C]});var i=r,o=vt.internal.getHeight(e)||0;o=o<0?-o:o;var l=vt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(C,P,F){if(C+1<s.length){var A=P+" "+s[C+1][0];return n0(A,e,F).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var u,d,m=n0("3",e,i).height,f=e.multiline?o-i:(o-m)/2,h=f+=2,x=0,b=0,j=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+n0(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var y="",_=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var S=!1;if(s[w].length!==1&&j!==s[w].length-1){if((m+2)*(_+2)+2>o)continue e;y+=s[w][j],S=!0,b=w,w--}else{y=(y+=s[w][j]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var E=parseInt(w),$=c(E,y,i),U=w>=s.length-1;if($&&!U){y+=" ",j=0;continue}if($||U){if(U)b=E;else if(e.multiline&&(m+2)*(_+2)+2>o)continue e}else{if(!e.multiline||(m+2)*(_+2)+2>o)continue e;b=E}}for(var I="",T=x;T<=b;T++){var D=s[T];if(e.multiline){if(T===b){I+=D[j]+" ",j=(j+1)%D.length;continue}if(T===x){I+=D[D.length-1]+" ";continue}}I+=D[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,d=n0(I,e,i).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=$t(u)+" "+$t(h)+` Td
`,t+="("+Vc(I)+`) Tj
`,t+=-$t(u)+` 0 Td
`,h=-(i+2),d=0,x=S?b:b+1,_++,y=""}break}return n.text=t,n.fontSize=i,n},n0=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Xq={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Qq=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},eV=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(na.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Xq)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");wb=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new y8,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&Qq(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=Zq(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=vt.createDefaultAppearanceStream(l),xr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Jq(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var m="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var h=l.appearanceStreamContent[f];if(m+="/"+f+" ",m+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var x=h[o];typeof x=="function"&&(x=x.call(s,l)),m+="/"+o+" "+x+" ",s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x)}}else typeof(x=h)=="function"&&(x=x.call(s,l)),m+="/"+o+" "+x,s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&function(b,j){for(var y in b)if(b.hasOwnProperty(y)){var _=y,w=b[y];j.internal.newObjectDeferredBegin(w.objId,!0),xr(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete b[_]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},x8=tn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),xr(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Vc(n(e[i].toString()))+")"):s+=e[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},dx=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Vc(n(e))+")"},_a=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};_a.prototype.toString=function(){return this.objId+" 0 R"},_a.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},_a.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:x8(s,this.objId,this.scope)}):s instanceof _a?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var v8=function(){_a.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};zs(v8,_a);var y8=function(){_a.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Vc(r(e))+")"}},set:function(r){e=r}})};zs(y8,_a);var na=function e(){_a.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!dn(t,3)},set:function(y){y?this.F=hn(t,3):this.F=fn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof jp)return;i="FieldObject"+e.FieldNum++}var y=function(_){return _};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+Vc(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/wb:u},set:function(y){u=y}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(y){d=y}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof jp||this instanceof kc))return dx(m,this.objId,this.scope)},set:function(y){y=y.toString(),m=y}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Rn==0?dx(f,this.objId,this.scope):f},set:function(y){y=y.toString(),f=this instanceof Rn==0?y.substr(0,1)==="("?uu(y.substr(1,y.length-2)):uu(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Rn==1?uu(f.substr(1,f.length-1)):f},set:function(y){y=y.toString(),f=this instanceof Rn==1?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Rn==0?dx(h,this.objId,this.scope):h},set:function(y){y=y.toString(),h=this instanceof Rn==0?y.substr(0,1)==="("?uu(y.substr(1,y.length-2)):uu(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Rn==1?uu(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof Rn==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(y){y=!!y,b=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(y){x=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,1)},set:function(y){y?this.Ff=hn(this.Ff,1):this.Ff=fn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,2)},set:function(y){y?this.Ff=hn(this.Ff,2):this.Ff=fn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,3)},set:function(y){y?this.Ff=hn(this.Ff,3):this.Ff=fn(this.Ff,3)}});var j=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(j!==null)return j},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');j=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(j){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:j=2;break;case"center":case 1:j=1;break;default:j=0}}})};zs(na,_a);var qu=function(){na.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return x8(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,u=[];c=o.exec(i);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,18)},set:function(r){r?this.Ff=hn(this.Ff,18):this.Ff=fn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=hn(this.Ff,19):this.Ff=fn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,20)},set:function(r){r?(this.Ff=hn(this.Ff,20),t.sort()):this.Ff=fn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,22)},set:function(r){r?this.Ff=hn(this.Ff,22):this.Ff=fn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(r){r?this.Ff=hn(this.Ff,23):this.Ff=fn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,27)},set:function(r){r?this.Ff=hn(this.Ff,27):this.Ff=fn(this.Ff,27)}}),this.hasAppearanceStream=!1};zs(qu,na);var Vu=function(){qu.call(this),this.fontName="helvetica",this.combo=!1};zs(Vu,qu);var Wu=function(){Vu.call(this),this.combo=!0};zs(Wu,Vu);var P0=function(){Wu.call(this),this.edit=!0};zs(P0,Wu);var Rn=function(){na.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,15)},set:function(r){r?this.Ff=hn(this.Ff,15):this.Ff=fn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,16)},set:function(r){r?this.Ff=hn(this.Ff,16):this.Ff=fn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,17)},set:function(r){r?this.Ff=hn(this.Ff,17):this.Ff=fn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(r){r?this.Ff=hn(this.Ff,26):this.Ff=fn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Vc(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){xr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};zs(Rn,na);var T0=function(){Rn.call(this),this.pushButton=!0};zs(T0,Rn);var Hu=function(){Rn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};zs(Hu,Rn);var jp=function(){var e,t;na.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+Vc(s(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){xr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};zs(jp,na),Hu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Hu.prototype.createOption=function(e){var t=new jp;return t.Parent=this,t.optionName=e,this.Kids.push(t),tV.call(this.scope,t),t};var I0=function(){Rn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vt.CheckBox.createAppearanceStream()};zs(I0,Rn);var kc=function(){na.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,13)},set:function(t){t?this.Ff=hn(this.Ff,13):this.Ff=fn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,21)},set:function(t){t?this.Ff=hn(this.Ff,21):this.Ff=fn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(t){t?this.Ff=hn(this.Ff,23):this.Ff=fn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,24)},set:function(t){t?this.Ff=hn(this.Ff,24):this.Ff=fn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,25)},set:function(t){t?this.Ff=hn(this.Ff,25):this.Ff=fn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(t){t?this.Ff=hn(this.Ff,26):this.Ff=fn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};zs(kc,na);var M0=function(){kc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,14)},set:function(e){e?this.Ff=hn(this.Ff,14):this.Ff=fn(this.Ff,14)}}),this.password=!0};zs(M0,kc);var vt={CheckBox:{createAppearanceStream:function(){return{N:{On:vt.CheckBox.YesNormal},D:{On:vt.CheckBox.YesPushDown,Off:vt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=pa(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=gv(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+$t(vt.internal.getWidth(e))+" "+$t(vt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+$t(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=pa(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],i=vt.internal.getHeight(e),o=vt.internal.getWidth(e),l=gv(e,e.caption);return s.push("1 g"),s.push("0 0 "+$t(o)+" "+$t(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+$t(o-1)+" "+$t(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+$t(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=pa(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$t(vt.internal.getWidth(e))+" "+$t(vt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:vt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=vt.RadioButton.Circle.YesNormal,t.D[e]=vt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=pa(e);t.scope=e.scope;var r=[],n=vt.internal.getWidth(e)<=vt.internal.getHeight(e)?vt.internal.getWidth(e)/4:vt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=vt.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Vo(vt.internal.getWidth(e)/2)+" "+Vo(vt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=pa(e);t.scope=e.scope;var r=[],n=vt.internal.getWidth(e)<=vt.internal.getHeight(e)?vt.internal.getWidth(e)/4:vt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*vt.internal.Bezier_C).toFixed(5)),o=Number((n*vt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Vo(vt.internal.getWidth(e)/2)+" "+Vo(vt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Vo(vt.internal.getWidth(e)/2)+" "+Vo(vt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=pa(e);t.scope=e.scope;var r=[],n=vt.internal.getWidth(e)<=vt.internal.getHeight(e)?vt.internal.getWidth(e)/4:vt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*vt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Vo(vt.internal.getWidth(e)/2)+" "+Vo(vt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:vt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=vt.RadioButton.Cross.YesNormal,t.D[e]=vt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=pa(e);t.scope=e.scope;var r=[],n=vt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+$t(vt.internal.getWidth(e)-2)+" "+$t(vt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push($t(n.x1.x)+" "+$t(n.x1.y)+" m"),r.push($t(n.x2.x)+" "+$t(n.x2.y)+" l"),r.push($t(n.x4.x)+" "+$t(n.x4.y)+" m"),r.push($t(n.x3.x)+" "+$t(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=pa(e);t.scope=e.scope;var r=vt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+$t(vt.internal.getWidth(e))+" "+$t(vt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+$t(vt.internal.getWidth(e)-2)+" "+$t(vt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push($t(r.x1.x)+" "+$t(r.x1.y)+" m"),n.push($t(r.x2.x)+" "+$t(r.x2.y)+" l"),n.push($t(r.x4.x)+" "+$t(r.x4.y)+" m"),n.push($t(r.x3.x)+" "+$t(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=pa(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$t(vt.internal.getWidth(e))+" "+$t(vt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};vt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=vt.internal.getWidth(e),r=vt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},vt.internal.getWidth=function(e){var t=0;return xr(e)==="object"&&(t=Ej(e.Rect[2])),t},vt.internal.getHeight=function(e){var t=0;return xr(e)==="object"&&(t=Ej(e.Rect[3])),t};var tV=tn.addField=function(e){if(eV(this,e),!(e instanceof na))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};tn.AcroFormChoiceField=qu,tn.AcroFormListBox=Vu,tn.AcroFormComboBox=Wu,tn.AcroFormEditBox=P0,tn.AcroFormButton=Rn,tn.AcroFormPushButton=T0,tn.AcroFormRadioButton=Hu,tn.AcroFormCheckBox=I0,tn.AcroFormTextField=kc,tn.AcroFormPasswordField=M0,tn.AcroFormAppearance=vt,tn.AcroForm={ChoiceField:qu,ListBox:Vu,ComboBox:Wu,EditBox:P0,Button:Rn,PushButton:T0,RadioButton:Hu,CheckBox:I0,TextField:kc,PasswordField:M0,Appearance:vt},Et.AcroForm={ChoiceField:qu,ListBox:Vu,ComboBox:Wu,EditBox:P0,Button:Rn,PushButton:T0,RadioButton:Hu,CheckBox:I0,TextField:kc,PasswordField:M0,Appearance:vt};function b8(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(C,P){var F,A,R,H,W,M=r;if((P=P||r)==="RGBA"||C.data!==void 0&&C.data instanceof Uint8ClampedArray&&"height"in C&&"width"in C)return"RGBA";if($(C))for(W in n)for(R=n[W],F=0;F<R.length;F+=1){for(H=!0,A=0;A<R[F].length;A+=1)if(R[F][A]!==void 0&&R[F][A]!==C[A]){H=!1;break}if(H===!0){M=W;break}}else for(W in n)for(R=n[W],F=0;F<R.length;F+=1){for(H=!0,A=0;A<R[F].length;A+=1)if(R[F][A]!==void 0&&R[F][A]!==C.charCodeAt(A)){H=!1;break}if(H===!0){M=W;break}}return M===r&&P!==r&&(M=P),M},i=function C(P){for(var F=this.internal.write,A=this.internal.putStream,R=(0,this.internal.getFilters)();R.indexOf("FlateEncode")!==-1;)R.splice(R.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var H=[];if(H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Image"}),H.push({key:"Width",value:P.width}),H.push({key:"Height",value:P.height}),P.colorSpace===y.INDEXED?H.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(H.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===y.DEVICE_CMYK&&H.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),H.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&H.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var W="",M=0,G=P.transparency.length;M<G;M++)W+=P.transparency[M]+" "+P.transparency[M]+" ";H.push({key:"Mask",value:"["+W+"]"})}P.sMask!==void 0&&H.push({key:"SMask",value:P.objectId+1+" 0 R"});var ce=P.filter!==void 0?["/"+P.filter]:void 0;if(A({data:P.data,additionalKeyValues:H,alreadyAppliedFilters:ce,objectId:P.objectId}),F("endobj"),"sMask"in P&&P.sMask!==void 0){var ue,O=(ue=P.sMaskBitsPerComponent)!==null&&ue!==void 0?ue:P.bitsPerComponent,Z={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:P.sMask};"filter"in P&&(Z.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(P.width),Z.filter=P.filter),C.call(this,Z)}if(P.colorSpace===y.INDEXED){var B=this.internal.newObject();A({data:I(new Uint8Array(P.palette)),objectId:B}),F("endobj")}},o=function(){var C=this.internal.collections[t+"images"];for(var P in C)i.call(this,C[P])},l=function(){var C,P=this.internal.collections[t+"images"],F=this.internal.write;for(var A in P)F("/I"+(C=P[A]).index,C.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var C=this.internal.collections[t+"images"];return c.call(this),C},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},m=function(C){return typeof e["process"+C.toUpperCase()]=="function"},f=function(C){return xr(C)==="object"&&C.nodeType===1},h=function(C,P){if(C.nodeName==="IMG"&&C.hasAttribute("src")){var F=""+C.getAttribute("src");if(F.indexOf("data:image/")===0)return L0(unescape(F).split("base64,").pop());var A=e.loadFile(F,!0);if(A!==void 0)return A}if(C.nodeName==="CANVAS"){if(C.width===0||C.height===0)throw new Error("Given canvas must have data. Canvas width: "+C.width+", height: "+C.height);var R;switch(P){case"PNG":R="image/png";break;case"WEBP":R="image/webp";break;default:R="image/jpeg"}return L0(C.toDataURL(R,1).split("base64,").pop())}},x=function(C){var P=this.internal.collections[t+"images"];if(P){for(var F in P)if(C===P[F].alias)return P[F]}},b=function(C,P,F){return C||P||(C=-96,P=-96),C<0&&(C=-1*F.width*72/C/this.internal.scaleFactor),P<0&&(P=-1*F.height*72/P/this.internal.scaleFactor),C===0&&(C=P*F.width/F.height),P===0&&(P=C*F.height/F.width),[C,P]},j=function(C,P,F,A,R,H){var W=b.call(this,F,A,R),M=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,ce=u.call(this);if(F=W[0],A=W[1],ce[R.index]=R,H){H*=Math.PI/180;var ue=Math.cos(H),O=Math.sin(H),Z=function(ee){return ee.toFixed(4)},B=[Z(ue),Z(O),Z(-1*O),Z(ue),0,0,"cm"]}this.internal.write("q"),H?(this.internal.write([1,"0","0",1,M(C),G(P+A),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([M(F),"0","0",M(A),"0","0","cm"].join(" "))):this.internal.write([M(F),"0","0",M(A),M(C),G(P+A),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+R.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(C){var P,F,A=0;if(typeof C=="string")for(F=C.length,P=0;P<F;P++)A=(A<<5)-A+C.charCodeAt(P),A|=0;else if($(C))for(F=C.byteLength/2,P=0;P<F;P++)A=(A<<5)-A+C[P],A|=0;return A},S=e.__addimage__.validateStringAsBase64=function(C){(C=C||"").toString().trim();var P=!0;return C.length===0&&(P=!1),C.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(C.substr(0,C.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(C.substr(-2))===!1&&(P=!1),P},E=e.__addimage__.extractImageFromDataUrl=function(C){if(C==null||!(C=C.trim()).startsWith("data:"))return null;var P=C.indexOf(",");return P<0?null:C.substring(0,P).trim().endsWith("base64")?C.substring(P+1):null};e.__addimage__.isArrayBuffer=function(C){return C instanceof ArrayBuffer};var $=e.__addimage__.isArrayBufferView=function(C){return C instanceof Int8Array||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array},U=e.__addimage__.binaryStringToUint8Array=function(C){for(var P=C.length,F=new Uint8Array(P),A=0;A<P;A++)F[A]=C.charCodeAt(A);return F},I=e.__addimage__.arrayBufferToBinaryString=function(C){for(var P="",F=$(C)?C:new Uint8Array(C),A=0;A<F.length;A+=8192)P+=String.fromCharCode.apply(null,F.subarray(A,A+8192));return P};e.addImage=function(){var C,P,F,A,R,H,W,M,G;if(typeof arguments[1]=="number"?(P=r,F=arguments[1],A=arguments[2],R=arguments[3],H=arguments[4],W=arguments[5],M=arguments[6],G=arguments[7]):(P=arguments[1],F=arguments[2],A=arguments[3],R=arguments[4],H=arguments[5],W=arguments[6],M=arguments[7],G=arguments[8]),xr(C=arguments[0])==="object"&&!f(C)&&"imageData"in C){var ce=C;C=ce.imageData,P=ce.format||P||r,F=ce.x||F||0,A=ce.y||A||0,R=ce.w||ce.width||R,H=ce.h||ce.height||H,W=ce.alias||W,M=ce.compression||M,G=ce.rotation||ce.angle||G}var ue=this.internal.getFilters();if(M===void 0&&ue.indexOf("FlateEncode")!==-1&&(M="SLOW"),isNaN(F)||isNaN(A))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var O=T.call(this,C,P,W,M);return j.call(this,F,A,R,H,O,G),this};var T=function(C,P,F,A){var R,H,W;if(typeof C=="string"&&s(C)===r){C=unescape(C);var M=D(C,!1);(M!==""||(M=e.loadFile(C,!0))!==void 0)&&(C=M)}if(f(C)&&(C=h(C,P)),P=s(C,P),!m(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((W=F)==null||W.length===0)&&(F=function(G){return typeof G=="string"||$(G)?w(G):$(G.data)?w(G.data):null}(C)),(R=x.call(this,F))||(C instanceof Uint8Array||P==="RGBA"||(H=C,C=U(C)),R=this["process"+P.toUpperCase()](C,d.call(this),F,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:_.NONE}(A),H)),!R)throw new Error("An unknown error occurred whilst processing the image.");return R},D=e.__addimage__.convertBase64ToBinaryString=function(C,P){P=typeof P!="boolean"||P;var F,A="";if(typeof C=="string"){var R;F=(R=E(C))!==null&&R!==void 0?R:C;try{A=L0(F)}catch(H){if(P)throw S(F)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+H.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return A};e.getImageProperties=function(C){var P,F,A="";if(f(C)&&(C=h(C)),typeof C=="string"&&s(C)===r&&((A=D(C,!1))===""&&(A=e.loadFile(C)||""),C=A),F=s(C),!m(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(C instanceof Uint8Array||(C=U(C)),!(P=this["process"+F.toUpperCase()](C)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=F,P}})(Et.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Et.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,m=0;m<u.length&&!d;m++)switch((n=u[m]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var f=0;f<u.length;f++){n=u[f];var h=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),j=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(b.objId),_=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",i+=" /Popup "+j.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(y(_))+") >>",b.content=i;var w=b.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",j.content=i,this.internal.write(b.objId,"0 R",j.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(x(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var E=this.annotations._nameMap[n.options.name];n.options.pageNumber=E.page,n.options.top=E.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var $=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+$+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+i)},options:o,type:"link"})},e.textWithLink=function(r,n,s,i){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,s,i),s+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-u,l,o,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Et.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(b){return t[b.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},l=e.__arabicParser__.isArabicEndLetter=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(b){return o(b)&&s.indexOf(b.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length==4},m=e.__arabicParser__.resolveLigatures=function(b){var j=0,y=r,_="",w=0;for(j=0;j<b.length;j+=1)y[b.charCodeAt(j)]!==void 0?(w++,typeof(y=y[b.charCodeAt(j)])=="number"&&(_+=String.fromCharCode(y),y=r,w=0),j===b.length-1&&(y=r,_+=b.charAt(j-(w-1)),j-=w-1,w=0)):(y=r,_+=b.charAt(j-w),j-=w,w=0);return _};e.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&n[b.charCodeAt(0)]!==void 0};var f=e.__arabicParser__.getCorrectForm=function(b,j,y){return o(b)?i(b)===!1?-1:!u(b)||!o(j)&&!o(y)||!o(y)&&l(j)||l(b)&&!o(j)||l(b)&&c(j)||l(b)&&l(j)?0:d(b)&&o(j)&&!l(j)&&o(y)&&u(y)?3:l(b)||!o(y)?1:2:-1},h=function(b){var j=0,y=0,_=0,w="",S="",E="",$=(b=b||"").split("\\s+"),U=[];for(j=0;j<$.length;j+=1){for(U.push(""),y=0;y<$[j].length;y+=1)w=$[j][y],S=$[j][y-1],E=$[j][y+1],o(w)?(_=f(w,S,E),U[j]+=_!==-1?String.fromCharCode(t[w.charCodeAt(0)][_]):w):U[j]+=w;U[j]=m(U[j])}return U.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var b,j=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(j)){var _=0;for(y=[],_=0;_<j.length;_+=1)Array.isArray(j[_])?y.push([h(j[_][0]),j[_][1],j[_][2]]):y.push([h(j[_])]);b=y}else b=h(j);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};e.events.push(["preProcessText",x])}(Et.API),Et.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Et.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(b){c=b}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(b){f=b}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(b){x=b}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),m=u.font||this.getFont(),f=u.scaleFactor||this.internal.scaleFactor,h=0,x=0,b=0,j=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=u.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,S){return w.concat(j.splitTextToSize(S,y))},[])):c=Array.isArray(c)?c:[c];for(var _=0;_<c.length;_++)h<(b=this.getStringUnitWidth(c[_],{font:m})*d)&&(h=b);return h!==0&&(x=c.length),{w:h/=f,h:Math.max((x*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/f,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,m=this.internal.__cell__.margins||t,f=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,h&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,m,f){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,x,b,j,y=[],_=[],w=[],S={},E={},$=[],U=[],I=(f=f||{}).autoSize||!1,T=f.printHeaders!==!1,D=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,C=f.margins||Object.assign({width:this.getPageWidth()},t),P=typeof f.padding=="number"?f.padding:3,F=f.headerBackgroundColor||"#c8c8c8",A=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=D,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=F,this.internal.__cell__.headerTextColor=A,this.setFontSize(D),m==null)_=y=Object.keys(d[0]),w=y.map(function(){return"left"});else if(Array.isArray(m)&&xr(m[0])==="object")for(y=m.map(function(ce){return ce.name}),_=m.map(function(ce){return ce.prompt||ce.name||""}),w=m.map(function(ce){return ce.align||"left"}),h=0;h<m.length;h+=1)E[m[h].name]=.7499990551181103*m[h].width;else Array.isArray(m)&&typeof m[0]=="string"&&(_=y=m,w=y.map(function(){return"left"}));if(I||Array.isArray(m)&&typeof m[0]=="string")for(h=0;h<y.length;h+=1){for(S[j=y[h]]=d.map(function(ce){return ce[j]}),this.setFont(void 0,"bold"),$.push(this.getTextDimensions(_[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=S[j],this.setFont(void 0,"normal"),b=0;b<x.length;b+=1)$.push(this.getTextDimensions(x[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);E[j]=Math.max.apply(null,$)+P+P,$=[]}if(T){var R={};for(h=0;h<y.length;h+=1)R[y[h]]={},R[y[h]].text=_[h],R[y[h]].align=w[h];var H=l.call(this,R,E);U=y.map(function(ce){return new i(c,u,E[ce],H,R[ce].text,void 0,R[ce].align)}),this.setTableHeaderRow(U),this.printHeaderRow(1,!1)}var W=m.reduce(function(ce,ue){return ce[ue.name]=ue.align,ce},{});for(h=0;h<d.length;h+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:h,data:d[h]},this);var M=l.call(this,d[h],E);for(b=0;b<y.length;b+=1){var G=d[h][y[b]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:h,col:b,data:G},this),o.call(this,new i(c,u,E[y[b]],M,G,h+2,W[y[b]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(h){var x=c[h];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*m/f+d+d},this).reduce(function(h,x){return Math.max(h,x)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,f.push(d)),d.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(x)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(Et.API);var w8={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},_8=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],xv=b8(_8),j8=[100,200,300,400,500,600,700,800,900],rV=b8(j8);function hx(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return w8[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),s=function(i){return typeof xv[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function Aj(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var nV={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Lj={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Pj(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Tj(e){return e.trimLeft()}function sV(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function iV(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var s0,Ij,Mj,du,i0,Oj,Rj,Fj,fx=["times"];function Dj(e,t,r,n,s){var i=4,o=Bj;switch(s){case Et.API.image_compression.FAST:i=1,o=$j;break;case Et.API.image_compression.MEDIUM:i=6,o=Uj;break;case Et.API.image_compression.SLOW:i=9,o=zj}e=function(c,u,d,m){for(var f,h=c.length/u,x=new Uint8Array(c.length+h),b=[aV,$j,Bj,Uj,zj],j=0;j<h;j+=1){var y=j*u,_=c.subarray(y,y+u);if(m)x.set(m(_,d,f),y+j);else{for(var w=b.length,S=[],E=0;E<w;E+=1)S[E]=b[E](_,d,f);var $=lV(S.concat());x.set(S[$],y+j)}f=_}return x}(e,t,Math.ceil(r*n/8),o);var l=sv(e,{level:i});return Et.API.__addimage__.arrayBufferToBinaryString(l)}function aV(e){var t=Array.apply([],e);return t.unshift(0),t}function $j(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var i=e[s-t]||0;n[s+1]=e[s]-i+256&255}return n}function Bj(e,t,r){var n=e.length,s=[];s[0]=2;for(var i=0;i<n;i+=1){var o=r&&r[i]||0;s[i+1]=e[i]-o+256&255}return s}function Uj(e,t,r){var n=e.length,s=[];s[0]=3;for(var i=0;i<n;i+=1){var o=e[i-t]||0,l=r&&r[i]||0;s[i+1]=e[i]+256-(o+l>>>1)&255}return s}function zj(e,t,r){var n=e.length,s=[];s[0]=4;for(var i=0;i<n;i+=1){var o=oV(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);s[i+1]=e[i]-o+256&255}return s}function oV(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=s&&n<=i?e:s<=i?t:r}function lV(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function mx(e,t,r){var n=t*r,s=Math.floor(n/8),i=16-(n-8*s+r),o=(1<<r)-1;return N8(e,s)>>i&o}function qj(e,t,r,n){var s=r*n,i=Math.floor(s/8),o=16-(s-8*i+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,m){if(d+1<u.byteLength)u.setUint16(d,m,!1);else{var f=m>>8&255;u.setUint8(d,f)}})(e,i,N8(e,i)&~(l<<o)&65535|c)}function N8(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function cV(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,o=1<<1+(7&s);e[t++],e[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var u=!0,d=[],m=0,f=null,h=0,x=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var b=e[t++];m=e[t++]|e[t++]<<8,f=e[t++],1&b||(f=null),h=b>>2&7,t++;break;case 254:for(;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var j=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],E=S>>6&1,$=1<<1+(7&S),U=l,I=c,T=!1;S>>7&&(T=!0,U=t,I=$,t+=3*$);var D=t;for(t++;;){var C;if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}d.push({x:j,y,width:_,height:w,has_local_palette:T,palette_offset:U,palette_size:I,data_offset:D,data_length:t-D,transparent_index:f,interlaced:!!E,delay:m,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return x},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,F){var A=this.frameInfo(P),R=A.width*A.height,H=new Uint8Array(R);Vj(e,A.data_offset,H,R);var W=A.palette_offset,M=A.transparent_index;M===null&&(M=256);var G=A.width,ce=r-G,ue=G,O=4*(A.y*r+A.x),Z=4*((A.y+A.height)*r+A.x),B=O,ee=4*ce;A.interlaced===!0&&(ee+=4*r*7);for(var X=8,ne=0,le=H.length;ne<le;++ne){var de=H[ne];if(ue===0&&(ue=G,(B+=ee)>=Z&&(ee=4*ce+4*r*(X-1),B=O+(G+ce)*(X<<1),X>>=1)),de===M)B+=4;else{var je=e[W+3*de],me=e[W+3*de+1],Le=e[W+3*de+2];F[B++]=Le,F[B++]=me,F[B++]=je,F[B++]=255}--ue}},this.decodeAndBlitFrameRGBA=function(P,F){var A=this.frameInfo(P),R=A.width*A.height,H=new Uint8Array(R);Vj(e,A.data_offset,H,R);var W=A.palette_offset,M=A.transparent_index;M===null&&(M=256);var G=A.width,ce=r-G,ue=G,O=4*(A.y*r+A.x),Z=4*((A.y+A.height)*r+A.x),B=O,ee=4*ce;A.interlaced===!0&&(ee+=4*r*7);for(var X=8,ne=0,le=H.length;ne<le;++ne){var de=H[ne];if(ue===0&&(ue=G,(B+=ee)>=Z&&(ee=4*ce+4*r*(X-1),B=O+(G+ce)*(X<<1),X>>=1)),de===M)B+=4;else{var je=e[W+3*de],me=e[W+3*de+1],Le=e[W+3*de+2];F[B++]=je,F[B++]=me,F[B++]=Le,F[B++]=255}--ue}}}function Vj(e,t,r,n){for(var s=e[t++],i=1<<s,o=i+1,l=o+1,c=s+1,u=(1<<c)-1,d=0,m=0,f=0,h=e[t++],x=new Int32Array(4096),b=null;;){for(;d<16&&h!==0;)m|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var j=m&u;if(m>>=c,d-=c,j!==i){if(j===o)break;for(var y=j<l?j:b,_=0,w=y;w>i;)w=x[w]>>8,++_;var S=w;if(f+_+(y!==j?1:0)>n)return void _r.log("Warning, gif stream longer than expected.");r[f++]=S;var E=f+=_;for(y!==j&&(r[f++]=S),w=y;_--;)w=x[w],r[--E]=255&w,w>>=8;b!==null&&l<4096&&(x[l++]=b<<8|S,l>=u+1&&c<12&&(++c,u=u<<1|1)),b=j}else l=o+1,u=(1<<(c=s+1))-1,b=null}return f!==n&&_r.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function px(e){var t,r,n,s,i,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),m=new Array(65535),f=new Array(65535),h=new Array(64),x=new Array(64),b=[],j=0,y=7,_=new Array(64),w=new Array(64),S=new Array(64),E=new Array(256),$=new Array(2048),U=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function H(O,Z){for(var B=0,ee=0,X=new Array,ne=1;ne<=16;ne++){for(var le=1;le<=O[ne];le++)X[Z[ee]]=[],X[Z[ee]][0]=B,X[Z[ee]][1]=ne,ee++,B++;B*=2}return X}function W(O){for(var Z=O[0],B=O[1]-1;B>=0;)Z&1<<B&&(j|=1<<y),B--,--y<0&&(j==255?(M(255),M(0)):M(j),y=7,j=0)}function M(O){b.push(O)}function G(O){M(O>>8&255),M(255&O)}function ce(O,Z,B,ee,X){for(var ne,le=X[0],de=X[240],je=function(fe,We){var Oe,nt,K,be,_e,re,De,se,Pe,Ee,Ne=0;for(Pe=0;Pe<8;++Pe){Oe=fe[Ne],nt=fe[Ne+1],K=fe[Ne+2],be=fe[Ne+3],_e=fe[Ne+4],re=fe[Ne+5],De=fe[Ne+6];var Me=Oe+(se=fe[Ne+7]),Ve=Oe-se,$e=nt+De,Ye=nt-De,pt=K+re,it=K-re,Je=be+_e,Xe=be-_e,At=Me+Je,Pt=Me-Je,Lt=$e+pt,St=$e-pt;fe[Ne]=At+Lt,fe[Ne+4]=At-Lt;var dt=.707106781*(St+Pt);fe[Ne+2]=Pt+dt,fe[Ne+6]=Pt-dt;var fr=.382683433*((At=Xe+it)-(St=Ye+Ve)),Ft=.5411961*At+fr,bn=1.306562965*St+fr,wn=.707106781*(Lt=it+Ye),Nt=Ve+wn,Wt=Ve-wn;fe[Ne+5]=Wt+Ft,fe[Ne+3]=Wt-Ft,fe[Ne+1]=Nt+bn,fe[Ne+7]=Nt-bn,Ne+=8}for(Ne=0,Pe=0;Pe<8;++Pe){Oe=fe[Ne],nt=fe[Ne+8],K=fe[Ne+16],be=fe[Ne+24],_e=fe[Ne+32],re=fe[Ne+40],De=fe[Ne+48];var Yr=Oe+(se=fe[Ne+56]),er=Oe-se,cr=nt+De,ar=nt-De,Sr=K+re,It=K-re,nr=be+_e,zr=be-_e,ur=Yr+nr,sn=Yr-nr,mn=cr+Sr,$n=cr-Sr;fe[Ne]=ur+mn,fe[Ne+32]=ur-mn;var Zr=.707106781*($n+sn);fe[Ne+16]=sn+Zr,fe[Ne+48]=sn-Zr;var hs=.382683433*((ur=zr+It)-($n=ar+er)),fs=.5411961*ur+hs,Ii=1.306562965*$n+hs,Pr=.707106781*(mn=It+ar),ms=er+Pr,Jn=er-Pr;fe[Ne+40]=Jn+fs,fe[Ne+24]=Jn-fs,fe[Ne+8]=ms+Ii,fe[Ne+56]=ms-Ii,Ne++}for(Pe=0;Pe<64;++Pe)Ee=fe[Pe]*We[Pe],h[Pe]=Ee>0?Ee+.5|0:Ee-.5|0;return h}(O,Z),me=0;me<64;++me)x[U[me]]=je[me];var Le=x[0]-B;B=x[0],Le==0?W(ee[0]):(W(ee[f[ne=32767+Le]]),W(m[ne]));for(var ve=63;ve>0&&x[ve]==0;)ve--;if(ve==0)return W(le),B;for(var he,V=1;V<=ve;){for(var Re=V;x[V]==0&&V<=ve;)++V;var xe=V-Re;if(xe>=16){he=xe>>4;for(var Ce=1;Ce<=he;++Ce)W(de);xe&=15}ne=32767+x[V],W(X[(xe<<4)+f[ne]]),W(m[ne]),V++}return ve!=63&&W(le),B}function ue(O){O=Math.min(Math.max(O,1),100),i!=O&&(function(Z){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ee=0;ee<64;ee++){var X=o((B[ee]*Z+50)/100);X=Math.min(Math.max(X,1),255),l[U[ee]]=X}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],le=0;le<64;le++){var de=o((ne[le]*Z+50)/100);de=Math.min(Math.max(de,1),255),c[U[le]]=de}for(var je=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],me=0,Le=0;Le<8;Le++)for(var ve=0;ve<8;ve++)u[me]=1/(l[U[me]]*je[Le]*je[ve]*8),d[me]=1/(c[U[me]]*je[Le]*je[ve]*8),me++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),i=O)}this.encode=function(O,Z){Z&&ue(Z),b=new Array,j=0,y=7,G(65496),G(65504),G(16),M(74),M(70),M(73),M(70),M(0),M(1),M(1),M(0),G(1),G(1),M(0),M(0),function(){G(65499),G(132),M(0);for(var nt=0;nt<64;nt++)M(l[nt]);M(1);for(var K=0;K<64;K++)M(c[K])}(),function(nt,K){G(65472),G(17),M(8),G(K),G(nt),M(3),M(1),M(17),M(0),M(2),M(17),M(1),M(3),M(17),M(1)}(O.width,O.height),function(){G(65476),G(418),M(0);for(var nt=0;nt<16;nt++)M(I[nt+1]);for(var K=0;K<=11;K++)M(T[K]);M(16);for(var be=0;be<16;be++)M(D[be+1]);for(var _e=0;_e<=161;_e++)M(C[_e]);M(1);for(var re=0;re<16;re++)M(P[re+1]);for(var De=0;De<=11;De++)M(F[De]);M(17);for(var se=0;se<16;se++)M(A[se+1]);for(var Pe=0;Pe<=161;Pe++)M(R[Pe])}(),G(65498),G(12),M(3),M(1),M(0),M(2),M(17),M(3),M(17),M(0),M(63),M(0);var B=0,ee=0,X=0;j=0,y=7,this.encode.displayName="_encode_";for(var ne,le,de,je,me,Le,ve,he,V,Re=O.data,xe=O.width,Ce=O.height,fe=4*xe,We=0;We<Ce;){for(ne=0;ne<fe;){for(me=fe*We+ne,ve=-1,he=0,V=0;V<64;V++)Le=me+(he=V>>3)*fe+(ve=4*(7&V)),We+he>=Ce&&(Le-=fe*(We+1+he-Ce)),ne+ve>=fe&&(Le-=ne+ve-fe+4),le=Re[Le++],de=Re[Le++],je=Re[Le++],_[V]=($[le]+$[de+256|0]+$[je+512|0]>>16)-128,w[V]=($[le+768|0]+$[de+1024|0]+$[je+1280|0]>>16)-128,S[V]=($[le+1280|0]+$[de+1536|0]+$[je+1792|0]>>16)-128;B=ce(_,u,B,t,n),ee=ce(w,d,ee,r,s),X=ce(S,d,X,r,s),ne+=32}We+=8}if(y>=0){var Oe=[];Oe[1]=y+1,Oe[0]=(1<<y+1)-1,W(Oe)}return G(65497),new Uint8Array(b)},e=e||50,function(){for(var O=String.fromCharCode,Z=0;Z<256;Z++)E[Z]=O(Z)}(),t=H(I,T),r=H(P,F),n=H(D,C),s=H(A,R),function(){for(var O=1,Z=2,B=1;B<=15;B++){for(var ee=O;ee<Z;ee++)f[32767+ee]=B,m[32767+ee]=[],m[32767+ee][1]=B,m[32767+ee][0]=ee;for(var X=-(Z-1);X<=-O;X++)f[32767+X]=B,m[32767+X]=[],m[32767+X][1]=B,m[32767+X][0]=Z-1+X;O<<=1,Z<<=1}}(),function(){for(var O=0;O<256;O++)$[O]=19595*O,$[O+256|0]=38470*O,$[O+512|0]=7471*O+32768,$[O+768|0]=-11059*O,$[O+1024|0]=-21709*O,$[O+1280|0]=32768*O+8421375,$[O+1536|0]=-27439*O,$[O+1792|0]=-5329*O}(),ue(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function zi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Wj(e){function t(T){if(!T)throw Error("assert :P")}function r(T,D,C){for(var P=0;4>P;P++)if(T[D+P]!=C.charCodeAt(P))return!0;return!1}function n(T,D,C,P,F){for(var A=0;A<F;A++)T[D+A]=C[P+A]}function s(T,D,C,P){for(var F=0;F<P;F++)T[D+F]=C}function i(T){return new Int32Array(T)}function o(T,D){for(var C=[],P=0;P<T;P++)C.push(new D);return C}function l(T,D){var C=[];return function P(F,A,R){for(var H=R[A],W=0;W<H&&(F.push(R.length>A+1?[]:new D),!(R.length<A+1));W++)P(F[W],A+1,R)}(C,0,T),C}var c=function(){var T=this;function D(p,v){for(var k=1<<v-1>>>0;p&k;)k>>>=1;return k?(p&k-1)+k:p}function C(p,v,k,L,q){t(!(L%k));do p[v+(L-=k)]=q;while(0<L)}function P(p,v,k,L,q){if(t(2328>=q),512>=q)var Y=i(512);else if((Y=i(q))==null)return 0;return function(J,Q,te,ie,ye,Ie){var ae,Se,Ae=Q,Be=1<<te,Te=i(16),Ue=i(16);for(t(ye!=0),t(ie!=null),t(J!=null),t(0<te),Se=0;Se<ye;++Se){if(15<ie[Se])return 0;++Te[ie[Se]]}if(Te[0]==ye)return 0;for(Ue[1]=0,ae=1;15>ae;++ae){if(Te[ae]>1<<ae)return 0;Ue[ae+1]=Ue[ae]+Te[ae]}for(Se=0;Se<ye;++Se)ae=ie[Se],0<ie[Se]&&(Ie[Ue[ae]++]=Se);if(Ue[15]==1)return(ie=new F).g=0,ie.value=Ie[0],C(J,Ae,1,Be,ie),Be;var qe,Ze=-1,Ge=Be-1,Ct=0,xt=1,qt=1,_t=1<<te;for(Se=0,ae=1,ye=2;ae<=te;++ae,ye<<=1){if(xt+=qt<<=1,0>(qt-=Te[ae]))return 0;for(;0<Te[ae];--Te[ae])(ie=new F).g=ae,ie.value=Ie[Se++],C(J,Ae+Ct,ye,_t,ie),Ct=D(Ct,ae)}for(ae=te+1,ye=2;15>=ae;++ae,ye<<=1){if(xt+=qt<<=1,0>(qt-=Te[ae]))return 0;for(;0<Te[ae];--Te[ae]){if(ie=new F,(Ct&Ge)!=Ze){for(Ae+=_t,qe=1<<(Ze=ae)-te;15>Ze&&!(0>=(qe-=Te[Ze]));)++Ze,qe<<=1;Be+=_t=1<<(qe=Ze-te),J[Q+(Ze=Ct&Ge)].g=qe+te,J[Q+Ze].value=Ae-Q-Ze}ie.g=ae-te,ie.value=Ie[Se++],C(J,Ae+(Ct>>te),ye,_t,ie),Ct=D(Ct,ae)}}return xt!=2*Ue[15]-1?0:Be}(p,v,k,L,q,Y)}function F(){this.value=this.g=0}function A(){this.value=this.g=0}function R(){this.G=o(5,F),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Jl,A)}function H(p,v,k,L){t(p!=null),t(v!=null),t(2147483648>L),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=v,p.pa=k,p.Jd=v,p.Yc=k+L,p.Zc=4<=L?k+L-4+1:k,le(p)}function W(p,v){for(var k=0;0<v--;)k|=je(p,128)<<v;return k}function M(p,v){var k=W(p,v);return de(p)?-k:k}function G(p,v,k,L){var q,Y=0;for(t(p!=null),t(v!=null),t(4294967288>L),p.Sb=L,p.Ra=0,p.u=0,p.h=0,4<L&&(L=4),q=0;q<L;++q)Y+=v[k+q]<<8*q;p.Ra=Y,p.bb=L,p.oa=v,p.pa=k}function ce(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<Ao-8>>>0,++p.bb,p.u-=8;ee(p)&&(p.h=1,p.u=0)}function ue(p,v){if(t(0<=v),!p.h&&v<=Ws){var k=B(p)&Vs[v];return p.u+=v,ce(p),k}return p.h=1,p.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function B(p){return p.Ra>>>(p.u&Ao-1)>>>0}function ee(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>Ao}function X(p,v){p.u=v,p.h=ee(p)}function ne(p){p.u>=Ba&&(t(p.u>=Ba),ce(p))}function le(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function de(p){return W(p,1)}function je(p,v){var k=p.Ca;0>p.b&&le(p);var L=p.b,q=k*v>>>8,Y=(p.I>>>L>q)+0;for(Y?(k-=q,p.I-=q+1<<L>>>0):k=q+1,L=k,q=0;256<=L;)q+=8,L>>=8;return L=7^q+Lo[L],p.b-=L,p.Ca=(k<<L)-1,Y}function me(p,v,k){p[v+0]=k>>24&255,p[v+1]=k>>16&255,p[v+2]=k>>8&255,p[v+3]=255&k}function Le(p,v){return p[v+0]|p[v+1]<<8}function ve(p,v){return Le(p,v)|p[v+2]<<16}function he(p,v){return Le(p,v)|Le(p,v+2)<<16}function V(p,v){var k=1<<v;return t(p!=null),t(0<v),p.X=i(k),p.X==null?0:(p.Mb=32-v,p.Xa=v,1)}function Re(p,v){t(p!=null),t(v!=null),t(p.Xa==v.Xa),n(v.X,0,p.X,0,1<<v.Xa)}function xe(){this.X=[],this.Xa=this.Mb=0}function Ce(p,v,k,L){t(k!=null),t(L!=null);var q=k[0],Y=L[0];return q==0&&(q=(p*Y+v/2)/v),Y==0&&(Y=(v*q+p/2)/p),0>=q||0>=Y?0:(k[0]=q,L[0]=Y,1)}function fe(p,v){return p+(1<<v)-1>>>v}function We(p,v){return((4278255360&p)+(4278255360&v)>>>0&4278255360)+((16711935&p)+(16711935&v)>>>0&16711935)>>>0}function Oe(p,v){T[v]=function(k,L,q,Y,J,Q,te){var ie;for(ie=0;ie<J;++ie){var ye=T[p](Q[te+ie-1],q,Y+ie);Q[te+ie]=We(k[L+ie],ye)}}}function nt(){this.ud=this.hd=this.jd=0}function K(p,v){return((4278124286&(p^v))>>>1)+(p&v)>>>0}function be(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function _e(p,v){return be(p+(p-v+.5>>1))}function re(p,v,k){return Math.abs(v-k)-Math.abs(p-k)}function De(p,v,k,L,q,Y,J){for(L=Y[J-1],k=0;k<q;++k)Y[J+k]=L=We(p[v+k],L)}function se(p,v,k,L,q){var Y;for(Y=0;Y<k;++Y){var J=p[v+Y],Q=J>>8&255,te=16711935&(te=(te=16711935&J)+((Q<<16)+Q));L[q+Y]=(4278255360&J)+te>>>0}}function Pe(p,v){v.jd=255&p,v.hd=p>>8&255,v.ud=p>>16&255}function Ee(p,v,k,L,q,Y){var J;for(J=0;J<L;++J){var Q=v[k+J],te=Q>>>8,ie=Q,ye=255&(ye=(ye=Q>>>16)+((p.jd<<24>>24)*(te<<24>>24)>>>5));ie=255&(ie=(ie+=(p.hd<<24>>24)*(te<<24>>24)>>>5)+((p.ud<<24>>24)*(ye<<24>>24)>>>5)),q[Y+J]=(4278255360&Q)+(ye<<16)+ie}}function Ne(p,v,k,L,q){T[v]=function(Y,J,Q,te,ie,ye,Ie,ae,Se){for(te=Ie;te<ae;++te)for(Ie=0;Ie<Se;++Ie)ie[ye++]=q(Q[L(Y[J++])])},T[p]=function(Y,J,Q,te,ie,ye,Ie){var ae=8>>Y.b,Se=Y.Ea,Ae=Y.K[0],Be=Y.w;if(8>ae)for(Y=(1<<Y.b)-1,Be=(1<<ae)-1;J<Q;++J){var Te,Ue=0;for(Te=0;Te<Se;++Te)Te&Y||(Ue=L(te[ie++])),ye[Ie++]=q(Ae[Ue&Be]),Ue>>=ae}else T["VP8LMapColor"+k](te,ie,Ae,Be,ye,Ie,J,Q,Se)}}function Me(p,v,k,L,q){for(k=v+k;v<k;){var Y=p[v++];L[q++]=Y>>16&255,L[q++]=Y>>8&255,L[q++]=255&Y}}function Ve(p,v,k,L,q){for(k=v+k;v<k;){var Y=p[v++];L[q++]=Y>>16&255,L[q++]=Y>>8&255,L[q++]=255&Y,L[q++]=Y>>24&255}}function $e(p,v,k,L,q){for(k=v+k;v<k;){var Y=(J=p[v++])>>16&240|J>>12&15,J=240&J|J>>28&15;L[q++]=Y,L[q++]=J}}function Ye(p,v,k,L,q){for(k=v+k;v<k;){var Y=(J=p[v++])>>16&248|J>>13&7,J=J>>5&224|J>>3&31;L[q++]=Y,L[q++]=J}}function pt(p,v,k,L,q){for(k=v+k;v<k;){var Y=p[v++];L[q++]=255&Y,L[q++]=Y>>8&255,L[q++]=Y>>16&255}}function it(p,v,k,L,q,Y){if(Y==0)for(k=v+k;v<k;)me(L,((Y=p[v++])[0]>>24|Y[1]>>8&65280|Y[2]<<8&16711680|Y[3]<<24)>>>0),q+=32;else n(L,q,p,v,k)}function Je(p,v){T[v][0]=T[p+"0"],T[v][1]=T[p+"1"],T[v][2]=T[p+"2"],T[v][3]=T[p+"3"],T[v][4]=T[p+"4"],T[v][5]=T[p+"5"],T[v][6]=T[p+"6"],T[v][7]=T[p+"7"],T[v][8]=T[p+"8"],T[v][9]=T[p+"9"],T[v][10]=T[p+"10"],T[v][11]=T[p+"11"],T[v][12]=T[p+"12"],T[v][13]=T[p+"13"],T[v][14]=T[p+"0"],T[v][15]=T[p+"0"]}function Xe(p){return p==Ig||p==Mg||p==fm||p==Og}function At(){this.eb=[],this.size=this.A=this.fb=0}function Pt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Lt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new At,this.f.kb=new Pt,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function dt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function fr(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function Ft(p,v){var k=p.T,L=v.ba.f.RGBA,q=L.eb,Y=L.fb+p.ka*L.A,J=xi[v.ba.S],Q=p.y,te=p.O,ie=p.f,ye=p.N,Ie=p.ea,ae=p.W,Se=v.cc,Ae=v.dc,Be=v.Mc,Te=v.Nc,Ue=p.ka,qe=p.ka+p.T,Ze=p.U,Ge=Ze+1>>1;for(Ue==0?J(Q,te,null,null,ie,ye,Ie,ae,ie,ye,Ie,ae,q,Y,null,null,Ze):(J(v.ec,v.fc,Q,te,Se,Ae,Be,Te,ie,ye,Ie,ae,q,Y-L.A,q,Y,Ze),++k);Ue+2<qe;Ue+=2)Se=ie,Ae=ye,Be=Ie,Te=ae,ye+=p.Rc,ae+=p.Rc,Y+=2*L.A,J(Q,(te+=2*p.fa)-p.fa,Q,te,Se,Ae,Be,Te,ie,ye,Ie,ae,q,Y-L.A,q,Y,Ze);return te+=p.fa,p.j+qe<p.o?(n(v.ec,v.fc,Q,te,Ze),n(v.cc,v.dc,ie,ye,Ge),n(v.Mc,v.Nc,Ie,ae,Ge),k--):1&qe||J(Q,te,null,null,ie,ye,Ie,ae,ie,ye,Ie,ae,q,Y+L.A,null,null,Ze),k}function bn(p,v,k){var L=p.F,q=[p.J];if(L!=null){var Y=p.U,J=v.ba.S,Q=J==hm||J==fm;v=v.ba.f.RGBA;var te=[0],ie=p.ka;te[0]=p.T,p.Kb&&(ie==0?--te[0]:(--ie,q[0]-=p.width),p.j+p.ka+p.T==p.o&&(te[0]=p.o-p.j-ie));var ye=v.eb;ie=v.fb+ie*v.A,p=aw(L,q[0],p.width,Y,te,ye,ie+(Q?0:3),v.A),t(k==te),p&&Xe(J)&&Wd(ye,ie,Q,Y,te,v.A)}return 0}function wn(p){var v=p.ma,k=v.ba.S,L=11>k,q=k==um||k==dm||k==hm||k==Tg||k==12||Xe(k);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!Fd(v.Oa,p,q?11:12))return 0;if(q&&Xe(k)&&sm(),p.da)alert("todo:use_scaling");else{if(L){if(v.Ib=fr,p.Kb){if(k=p.U+1>>1,v.memory=i(p.U+2*k),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+p.U,v.Mc=v.cc,v.Nc=v.dc+k,v.Ib=Ft,sm()}}else alert("todo:EmitYUV");q&&(v.Jb=bn,L&&fi())}if(L&&!jw){for(p=0;256>p;++p)bA[p]=89858*(p-128)+pm>>mm,jA[p]=-22014*(p-128)+pm,_A[p]=-45773*(p-128),wA[p]=113618*(p-128)+pm>>mm;for(p=Gd;p<Dg;++p)v=76283*(p-16)+pm>>mm,NA[p-Gd]=Xr(v,255),SA[p-Gd]=Xr(v+8>>4,15);jw=1}return 1}function Nt(p){var v=p.ma,k=p.U,L=p.T;return t(!(1&p.ka)),0>=k||0>=L?0:(k=v.Ib(p,v),v.Jb!=null&&v.Jb(p,v,k),v.Dc+=k,1)}function Wt(p){p.ma.memory=null}function Yr(p,v,k,L){return ue(p,8)!=47?0:(v[0]=ue(p,14)+1,k[0]=ue(p,14)+1,L[0]=ue(p,1),ue(p,3)!=0?0:!p.h)}function er(p,v){if(4>p)return p+1;var k=p-2>>1;return(2+(1&p)<<k)+ue(v,k)+1}function cr(p,v){return 120<v?v-120:1<=(k=((k=aA[v-1])>>4)*p+(8-(15&k)))?k:1;var k}function ar(p,v,k){var L=B(k),q=p[v+=255&L].g-8;return 0<q&&(X(k,k.u+8),L=B(k),v+=p[v].value,v+=L&(1<<q)-1),X(k,k.u+p[v].g),p[v].value}function Sr(p,v,k){return k.g+=p.g,k.value+=p.value<<v>>>0,t(8>=k.g),p.g}function It(p,v,k){var L=p.xc;return t((v=L==0?0:p.vc[p.md*(k>>L)+(v>>L)])<p.Wb),p.Ya[v]}function nr(p,v,k,L){var q=p.ab,Y=p.c*v,J=p.C;v=J+v;var Q=k,te=L;for(L=p.Ta,k=p.Ua;0<q--;){var ie=p.gc[q],ye=J,Ie=v,ae=Q,Se=te,Ae=(te=L,Q=k,ie.Ea);switch(t(ye<Ie),t(Ie<=ie.nc),ie.hc){case 2:an(ae,Se,(Ie-ye)*Ae,te,Q);break;case 0:var Be=ye,Te=Ie,Ue=te,qe=Q,Ze=(_t=ie).Ea;Be==0&&($d(ae,Se,null,null,1,Ue,qe),De(ae,Se+1,0,0,Ze-1,Ue,qe+1),Se+=Ze,qe+=Ze,++Be);for(var Ge=1<<_t.b,Ct=Ge-1,xt=fe(Ze,_t.b),qt=_t.K,_t=_t.w+(Be>>_t.b)*xt;Be<Te;){var Zt=qt,Nn=_t,Vt=1;for(Qc(ae,Se,Ue,qe-Ze,1,Ue,qe);Vt<Ze;){var jt=(Vt&~Ct)+Ge;jt>Ze&&(jt=Ze),(0,Ud[Zt[Nn++]>>8&15])(ae,Se+ +Vt,Ue,qe+Vt-Ze,jt-Vt,Ue,qe+Vt),Vt=jt}Se+=Ze,qe+=Ze,++Be&Ct||(_t+=xt)}Ie!=ie.nc&&n(te,Q-Ae,te,Q+(Ie-ye-1)*Ae,Ae);break;case 1:for(Ae=ae,Te=Se,Ze=(ae=ie.Ea)-(qe=ae&~(Ue=(Se=1<<ie.b)-1)),Be=fe(ae,ie.b),Ge=ie.K,ie=ie.w+(ye>>ie.b)*Be;ye<Ie;){for(Ct=Ge,xt=ie,qt=new nt,_t=Te+qe,Zt=Te+ae;Te<_t;)Pe(Ct[xt++],qt),zd(qt,Ae,Te,Se,te,Q),Te+=Se,Q+=Se;Te<Zt&&(Pe(Ct[xt++],qt),zd(qt,Ae,Te,Ze,te,Q),Te+=Ze,Q+=Ze),++ye&Ue||(ie+=Be)}break;case 3:if(ae==te&&Se==Q&&0<ie.b){for(Te=te,ae=Ae=Q+(Ie-ye)*Ae-(qe=(Ie-ye)*fe(ie.Ea,ie.b)),Se=te,Ue=Q,Be=[],qe=(Ze=qe)-1;0<=qe;--qe)Be[qe]=Se[Ue+qe];for(qe=Ze-1;0<=qe;--qe)Te[ae+qe]=Be[qe];am(ie,ye,Ie,te,Ae,te,Q)}else am(ie,ye,Ie,ae,Se,te,Q)}Q=L,te=k}te!=k&&n(L,k,Q,te,Y)}function zr(p,v){var k=p.V,L=p.Ba+p.c*p.C,q=v-p.C;if(t(v<=p.l.o),t(16>=q),0<q){var Y=p.l,J=p.Ta,Q=p.Ua,te=Y.width;if(nr(p,q,k,L),q=Q=[Q],t((k=p.C)<(L=v)),t(Y.v<Y.va),L>Y.o&&(L=Y.o),k<Y.j){var ie=Y.j-k;k=Y.j,q[0]+=ie*te}if(k>=L?k=0:(q[0]+=4*Y.v,Y.ka=k-Y.j,Y.U=Y.va-Y.v,Y.T=L-k,k=1),k){if(Q=Q[0],11>(k=p.ca).S){var ye=k.f.RGBA,Ie=(L=k.S,q=Y.U,Y=Y.T,ie=ye.eb,ye.A),ae=Y;for(ye=ye.fb+p.Ma*ye.A;0<ae--;){var Se=J,Ae=Q,Be=q,Te=ie,Ue=ye;switch(L){case cm:qd(Se,Ae,Be,Te,Ue);break;case um:Po(Se,Ae,Be,Te,Ue);break;case Ig:Po(Se,Ae,Be,Te,Ue),Wd(Te,Ue,0,Be,1,0);break;case fw:Xl(Se,Ae,Be,Te,Ue);break;case dm:it(Se,Ae,Be,Te,Ue,1);break;case Mg:it(Se,Ae,Be,Te,Ue,1),Wd(Te,Ue,0,Be,1,0);break;case hm:it(Se,Ae,Be,Te,Ue,0);break;case fm:it(Se,Ae,Be,Te,Ue,0),Wd(Te,Ue,1,Be,1,0);break;case Tg:To(Se,Ae,Be,Te,Ue);break;case Og:To(Se,Ae,Be,Te,Ue),iw(Te,Ue,Be,1,0);break;case mw:Io(Se,Ae,Be,Te,Ue);break;default:t(0)}Q+=te,ye+=Ie}p.Ma+=Y}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=k.height)}}p.C=v,t(p.C<=p.i)}function ur(p){var v;if(0<p.ua)return 0;for(v=0;v<p.Wb;++v){var k=p.Ya[v].G,L=p.Ya[v].H;if(0<k[1][L[1]+0].g||0<k[2][L[2]+0].g||0<k[3][L[3]+0].g)return 0}return 1}function sn(p,v,k,L,q,Y){if(p.Z!=0){var J=p.qd,Q=p.rd;for(t(Ro[p.Z]!=null);v<k;++v)Ro[p.Z](J,Q,L,q,L,q,Y),J=L,Q=q,q+=Y;p.qd=J,p.rd=Q}}function mn(p,v){var k=p.l.ma,L=k.Z==0||k.Z==1?p.l.j:p.C;if(L=p.C<L?L:p.C,t(v<=p.l.o),v>L){var q=p.l.width,Y=k.ca,J=k.tb+q*L,Q=p.V,te=p.Ba+p.c*L,ie=p.gc;t(p.ab==1),t(ie[0].hc==3),ua(ie[0],L,v,Q,te,Y,J),sn(k,L,v,Y,J,q)}p.C=p.Ma=v}function $n(p,v,k,L,q,Y,J){var Q=p.$/L,te=p.$%L,ie=p.m,ye=p.s,Ie=k+p.$,ae=Ie;q=k+L*q;var Se=k+L*Y,Ae=280+ye.ua,Be=p.Pb?Q:16777216,Te=0<ye.ua?ye.Wa:null,Ue=ye.wc,qe=Ie<Se?It(ye,te,Q):null;t(p.C<Y),t(Se<=q);var Ze=!1;e:for(;;){for(;Ze||Ie<Se;){var Ge=0;if(Q>=Be){var Ct=Ie-k;t((Be=p).Pb),Be.wd=Be.m,Be.xd=Ct,0<Be.s.ua&&Re(Be.s.Wa,Be.s.vb),Be=Q+lA}if(te&Ue||(qe=It(ye,te,Q)),t(qe!=null),qe.Qb&&(v[Ie]=qe.qb,Ze=!0),!Ze)if(ne(ie),qe.jc){Ge=ie,Ct=v;var xt=Ie,qt=qe.pd[B(Ge)&Jl-1];t(qe.jc),256>qt.g?(X(Ge,Ge.u+qt.g),Ct[xt]=qt.value,Ge=0):(X(Ge,Ge.u+qt.g-256),t(256<=qt.value),Ge=qt.value),Ge==0&&(Ze=!0)}else Ge=ar(qe.G[0],qe.H[0],ie);if(ie.h)break;if(Ze||256>Ge){if(!Ze)if(qe.nd)v[Ie]=(qe.qb|Ge<<8)>>>0;else{if(ne(ie),Ze=ar(qe.G[1],qe.H[1],ie),ne(ie),Ct=ar(qe.G[2],qe.H[2],ie),xt=ar(qe.G[3],qe.H[3],ie),ie.h)break;v[Ie]=(xt<<24|Ze<<16|Ge<<8|Ct)>>>0}if(Ze=!1,++Ie,++te>=L&&(te=0,++Q,J!=null&&Q<=Y&&!(Q%16)&&J(p,Q),Te!=null))for(;ae<Ie;)Ge=v[ae++],Te.X[(506832829*Ge&4294967295)>>>Te.Mb]=Ge}else if(280>Ge){if(Ge=er(Ge-256,ie),Ct=ar(qe.G[4],qe.H[4],ie),ne(ie),Ct=cr(L,Ct=er(Ct,ie)),ie.h)break;if(Ie-k<Ct||q-Ie<Ge)break e;for(xt=0;xt<Ge;++xt)v[Ie+xt]=v[Ie+xt-Ct];for(Ie+=Ge,te+=Ge;te>=L;)te-=L,++Q,J!=null&&Q<=Y&&!(Q%16)&&J(p,Q);if(t(Ie<=q),te&Ue&&(qe=It(ye,te,Q)),Te!=null)for(;ae<Ie;)Ge=v[ae++],Te.X[(506832829*Ge&4294967295)>>>Te.Mb]=Ge}else{if(!(Ge<Ae))break e;for(Ze=Ge-280,t(Te!=null);ae<Ie;)Ge=v[ae++],Te.X[(506832829*Ge&4294967295)>>>Te.Mb]=Ge;Ge=Ie,t(!(Ze>>>(Ct=Te).Xa)),v[Ge]=Ct.X[Ze],Ze=!0}Ze||t(ie.h==ee(ie))}if(p.Pb&&ie.h&&Ie<q)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&Re(p.s.vb,p.s.Wa);else{if(ie.h)break e;J!=null&&J(p,Q>Y?Y:Q),p.a=0,p.$=Ie-k}return 1}return p.a=3,0}function Zr(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var v=p.Wa;v!=null&&(v.X=null),p.vb=null,t(p!=null)}function hs(){var p=new kt;return p==null?null:(p.a=0,p.xb=xw,Je("Predictor","VP8LPredictors"),Je("Predictor","VP8LPredictors_C"),Je("PredictorAdd","VP8LPredictorsAdd"),Je("PredictorAdd","VP8LPredictorsAdd_C"),an=se,zd=Ee,qd=Me,Po=Ve,To=$e,Io=Ye,Xl=pt,T.VP8LMapColor32b=ca,T.VP8LMapColor8b=Bd,p)}function fs(p,v,k,L,q){var Y=1,J=[p],Q=[v],te=L.m,ie=L.s,ye=null,Ie=0;e:for(;;){if(k)for(;Y&&ue(te,1);){var ae=J,Se=Q,Ae=L,Be=1,Te=Ae.m,Ue=Ae.gc[Ae.ab],qe=ue(Te,2);if(Ae.Oc&1<<qe)Y=0;else{switch(Ae.Oc|=1<<qe,Ue.hc=qe,Ue.Ea=ae[0],Ue.nc=Se[0],Ue.K=[null],++Ae.ab,t(4>=Ae.ab),qe){case 0:case 1:Ue.b=ue(Te,3)+2,Be=fs(fe(Ue.Ea,Ue.b),fe(Ue.nc,Ue.b),0,Ae,Ue.K),Ue.K=Ue.K[0];break;case 3:var Ze,Ge=ue(Te,8)+1,Ct=16<Ge?0:4<Ge?1:2<Ge?2:3;if(ae[0]=fe(Ue.Ea,Ct),Ue.b=Ct,Ze=Be=fs(Ge,1,0,Ae,Ue.K)){var xt,qt=Ge,_t=Ue,Zt=1<<(8>>_t.b),Nn=i(Zt);if(Nn==null)Ze=0;else{var Vt=_t.K[0],jt=_t.w;for(Nn[0]=_t.K[0][0],xt=1;xt<1*qt;++xt)Nn[xt]=We(Vt[jt+xt],Nn[xt-1]);for(;xt<4*Zt;++xt)Nn[xt]=0;_t.K[0]=null,_t.K[0]=Nn,Ze=1}}Be=Ze;break;case 2:break;default:t(0)}Y=Be}}if(J=J[0],Q=Q[0],Y&&ue(te,1)&&!(Y=1<=(Ie=ue(te,4))&&11>=Ie)){L.a=3;break e}var ct;if(ct=Y)t:{var ln,Ut,Qt,Tr=L,zn=J,gs=Q,Qr=Ie,Qn=k,xs=Tr.m,Sn=Tr.s,tr=[null],mr=1,en=0,pr=oA[Qr];r:for(;;){if(Qn&&ue(xs,1)){var qn=ue(xs,3)+2,$i=fe(zn,qn),cn=fe(gs,qn),Ps=$i*cn;if(!fs($i,cn,0,Tr,tr))break r;for(tr=tr[0],Sn.xc=qn,ln=0;ln<Ps;++ln){var wr=tr[ln]>>8&65535;tr[ln]=wr,wr>=mr&&(mr=wr+1)}}if(xs.h)break r;for(Ut=0;5>Ut;++Ut){var kn=pw[Ut];!Ut&&0<Qr&&(kn+=1<<Qr),en<kn&&(en=kn)}var Gs=o(mr*pr,F),vs=mr,Ks=o(vs,R);if(Ks==null)var Ys=null;else t(65536>=vs),Ys=Ks;var Ts=i(en);if(Ys==null||Ts==null||Gs==null){Tr.a=1;break r}var Zs=Gs;for(ln=Qt=0;ln<mr;++ln){var Cr=Ys[ln],Js=Cr.G,Bi=Cr.H,ec=0,qa=1,Vn=0;for(Ut=0;5>Ut;++Ut){kn=pw[Ut],Js[Ut]=Zs,Bi[Ut]=Qt,!Ut&&0<Qr&&(kn+=1<<Qr);s:{var xm,$g=kn,vm=Tr,Kd=Ts,EA=Zs,AA=Qt,Bg=0,Fo=vm.m,LA=ue(Fo,1);if(s(Kd,0,0,$g),LA){var PA=ue(Fo,1)+1,TA=ue(Fo,1),kw=ue(Fo,TA==0?1:8);Kd[kw]=1,PA==2&&(Kd[kw=ue(Fo,8)]=1);var ym=1}else{var Cw=i(19),Ew=ue(Fo,4)+4;if(19<Ew){vm.a=3;var bm=0;break s}for(xm=0;xm<Ew;++xm)Cw[iA[xm]]=ue(Fo,3);var Ug=void 0,Yd=void 0,Aw=vm,IA=Cw,wm=$g,Lw=Kd,zg=0,Do=Aw.m,Pw=8,Tw=o(128,F);n:for(;P(Tw,0,7,IA,19);){if(ue(Do,1)){var MA=2+2*ue(Do,3);if((Ug=2+ue(Do,MA))>wm)break n}else Ug=wm;for(Yd=0;Yd<wm&&Ug--;){ne(Do);var Iw=Tw[0+(127&B(Do))];X(Do,Do.u+Iw.g);var tu=Iw.value;if(16>tu)Lw[Yd++]=tu,tu!=0&&(Pw=tu);else{var OA=tu==16,Mw=tu-16,RA=nA[Mw],Ow=ue(Do,rA[Mw])+RA;if(Yd+Ow>wm)break n;for(var FA=OA?Pw:0;0<Ow--;)Lw[Yd++]=FA}}zg=1;break n}zg||(Aw.a=3),ym=zg}(ym=ym&&!Fo.h)&&(Bg=P(EA,AA,8,Kd,$g)),ym&&Bg!=0?bm=Bg:(vm.a=3,bm=0)}if(bm==0)break r;if(qa&&sA[Ut]==1&&(qa=Zs[Qt].g==0),ec+=Zs[Qt].g,Qt+=bm,3>=Ut){var Zd,qg=Ts[0];for(Zd=1;Zd<kn;++Zd)Ts[Zd]>qg&&(qg=Ts[Zd]);Vn+=qg}}if(Cr.nd=qa,Cr.Qb=0,qa&&(Cr.qb=(Js[3][Bi[3]+0].value<<24|Js[1][Bi[1]+0].value<<16|Js[2][Bi[2]+0].value)>>>0,ec==0&&256>Js[0][Bi[0]+0].value&&(Cr.Qb=1,Cr.qb+=Js[0][Bi[0]+0].value<<8)),Cr.jc=!Cr.Qb&&6>Vn,Cr.jc){var _m,Va=Cr;for(_m=0;_m<Jl;++_m){var $o=_m,Bo=Va.pd[$o],jm=Va.G[0][Va.H[0]+$o];256<=jm.value?(Bo.g=jm.g+256,Bo.value=jm.value):(Bo.g=0,Bo.value=0,$o>>=Sr(jm,8,Bo),$o>>=Sr(Va.G[1][Va.H[1]+$o],16,Bo),$o>>=Sr(Va.G[2][Va.H[2]+$o],0,Bo),Sr(Va.G[3][Va.H[3]+$o],24,Bo))}}}Sn.vc=tr,Sn.Wb=mr,Sn.Ya=Ys,Sn.yc=Gs,ct=1;break t}ct=0}if(!(Y=ct)){L.a=3;break e}if(0<Ie){if(ie.ua=1<<Ie,!V(ie.Wa,Ie)){L.a=1,Y=0;break e}}else ie.ua=0;var Vg=L,Rw=J,DA=Q,Wg=Vg.s,Hg=Wg.xc;if(Vg.c=Rw,Vg.i=DA,Wg.md=fe(Rw,Hg),Wg.wc=Hg==0?-1:(1<<Hg)-1,k){L.xb=pA;break e}if((ye=i(J*Q))==null){L.a=1,Y=0;break e}Y=(Y=$n(L,ye,0,J,Q,Q,null))&&!te.h;break e}return Y?(q!=null?q[0]=ye:(t(ye==null),t(k)),L.$=0,k||Zr(ie)):Zr(ie),Y}function Ii(p,v){var k=p.c*p.i,L=k+v+16*v;return t(p.c<=v),p.V=i(L),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+k+v,1)}function Pr(p,v){var k=p.C,L=v-k,q=p.V,Y=p.Ba+p.c*k;for(t(v<=p.l.o);0<L;){var J=16<L?16:L,Q=p.l.ma,te=p.l.width,ie=te*J,ye=Q.ca,Ie=Q.tb+te*k,ae=p.Ta,Se=p.Ua;nr(p,J,q,Y),ow(ae,Se,ye,Ie,ie),sn(Q,k,k+J,ye,Ie,te),L-=J,q+=J*p.c,k+=J}t(k==v),p.C=p.Ma=v}function ms(){this.ub=this.yd=this.td=this.Rb=0}function Jn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Mi(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function ia(){this.Yb=function(){var p=[];return function v(k,L,q){for(var Y=q[L],J=0;J<Y&&(k.push(q.length>L+1?[]:0),!(q.length<L+1));J++)v(k[J],L+1,q)}(p,0,[3,11]),p}()}function _o(){this.jb=i(3),this.Wc=l([4,8],ia),this.Xc=l([4,17],ia)}function Oa(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function In(){this.ld=this.La=this.dd=this.tc=0}function aa(){this.Na=this.la=0}function jo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ra(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Hc(){this.uc=this.M=this.Nb=0,this.wa=Array(new In),this.Y=0,this.ya=Array(new Ra),this.aa=0,this.l=new No}function Rl(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Gc(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new ms,this.Kc=new Jn,this.ed=new Oa,this.Qa=new Mi,this.Ic=this.$c=this.Aa=0,this.D=new Hc,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,jo),this.Pa=new _o,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Rl),this.Hd=0,this.rb=Array(new aa),this.sb=0,this.wa=Array(new In),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ra),this.L=this.aa=0,this.gd=l([4,2],In),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function No(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ed(){var p=new Gc;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,Hd||(Hd=di)),p}function Jr(p,v,k){return p.a==0&&(p.a=v,p.sc=k,p.cb=0),0}function Fl(p,v,k){return 3<=k&&p[v+0]==157&&p[v+1]==1&&p[v+2]==42}function Dl(p,v){if(p==null)return 0;if(p.a=0,p.sc="OK",v==null)return Jr(p,2,"null VP8Io passed to VP8GetHeaders()");var k=v.data,L=v.w,q=v.ha;if(4>q)return Jr(p,7,"Truncated header.");var Y=k[L+0]|k[L+1]<<8|k[L+2]<<16,J=p.Od;if(J.Rb=!(1&Y),J.td=Y>>1&7,J.yd=Y>>4&1,J.ub=Y>>5,3<J.td)return Jr(p,3,"Incorrect keyframe parameters.");if(!J.yd)return Jr(p,4,"Frame not displayable.");L+=3,q-=3;var Q=p.Kc;if(J.Rb){if(7>q)return Jr(p,7,"cannot parse picture header");if(!Fl(k,L,q))return Jr(p,3,"Bad code word");Q.c=16383&(k[L+4]<<8|k[L+3]),Q.Td=k[L+4]>>6,Q.i=16383&(k[L+6]<<8|k[L+5]),Q.Ud=k[L+6]>>6,L+=7,q-=7,p.za=Q.c+15>>4,p.Ub=Q.i+15>>4,v.width=Q.c,v.height=Q.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,s((Y=p.Pa).jb,0,255,Y.jb.length),t((Y=p.Qa)!=null),Y.Cb=0,Y.Bb=0,Y.Fb=1,s(Y.Zb,0,0,Y.Zb.length),s(Y.Lb,0,0,Y.Lb)}if(J.ub>q)return Jr(p,7,"bad partition length");H(Y=p.m,k,L,J.ub),L+=J.ub,q-=J.ub,J.Rb&&(Q.Ld=de(Y),Q.Kd=de(Y)),Q=p.Qa;var te,ie=p.Pa;if(t(Y!=null),t(Q!=null),Q.Cb=de(Y),Q.Cb){if(Q.Bb=de(Y),de(Y)){for(Q.Fb=de(Y),te=0;4>te;++te)Q.Zb[te]=de(Y)?M(Y,7):0;for(te=0;4>te;++te)Q.Lb[te]=de(Y)?M(Y,6):0}if(Q.Bb)for(te=0;3>te;++te)ie.jb[te]=de(Y)?W(Y,8):255}else Q.Bb=0;if(Y.Ka)return Jr(p,3,"cannot parse segment header");if((Q=p.ed).zd=de(Y),Q.Tb=W(Y,6),Q.wb=W(Y,3),Q.Pc=de(Y),Q.Pc&&de(Y)){for(ie=0;4>ie;++ie)de(Y)&&(Q.vd[ie]=M(Y,6));for(ie=0;4>ie;++ie)de(Y)&&(Q.od[ie]=M(Y,6))}if(p.L=Q.Tb==0?0:Q.zd?1:2,Y.Ka)return Jr(p,3,"cannot parse filter header");var ye=q;if(q=te=L,L=te+ye,Q=ye,p.Xb=(1<<W(p.m,2))-1,ye<3*(ie=p.Xb))k=7;else{for(te+=3*ie,Q-=3*ie,ye=0;ye<ie;++ye){var Ie=k[q+0]|k[q+1]<<8|k[q+2]<<16;Ie>Q&&(Ie=Q),H(p.Jc[+ye],k,te,Ie),te+=Ie,Q-=Ie,q+=3}H(p.Jc[+ie],k,te,Q),k=te<L?0:5}if(k!=0)return Jr(p,k,"cannot parse partitions");for(k=W(te=p.m,7),q=de(te)?M(te,4):0,L=de(te)?M(te,4):0,Q=de(te)?M(te,4):0,ie=de(te)?M(te,4):0,te=de(te)?M(te,4):0,ye=p.Qa,Ie=0;4>Ie;++Ie){if(ye.Cb){var ae=ye.Zb[Ie];ye.Fb||(ae+=k)}else{if(0<Ie){p.pb[Ie]=p.pb[0];continue}ae=k}var Se=p.pb[Ie];Se.Sc[0]=Rg[Xr(ae+q,127)],Se.Sc[1]=Fg[Xr(ae+0,127)],Se.Eb[0]=2*Rg[Xr(ae+L,127)],Se.Eb[1]=101581*Fg[Xr(ae+Q,127)]>>16,8>Se.Eb[1]&&(Se.Eb[1]=8),Se.Qc[0]=Rg[Xr(ae+ie,117)],Se.Qc[1]=Fg[Xr(ae+te,127)],Se.lc=ae+te}if(!J.Rb)return Jr(p,4,"Not a key frame.");for(de(Y),J=p.Pa,k=0;4>k;++k){for(q=0;8>q;++q)for(L=0;3>L;++L)for(Q=0;11>Q;++Q)ie=je(Y,fA[k][q][L][Q])?W(Y,8):dA[k][q][L][Q],J.Wc[k][q].Yb[L][Q]=ie;for(q=0;17>q;++q)J.Xc[k][q]=J.Wc[k][mA[q]]}return p.kc=de(Y),p.kc&&(p.Bd=W(Y,8)),p.cb=1}function di(p,v,k,L,q,Y,J){var Q=v[q].Yb[k];for(k=0;16>q;++q){if(!je(p,Q[k+0]))return q;for(;!je(p,Q[k+1]);)if(Q=v[++q].Yb[0],k=0,q==16)return 16;var te=v[q+1].Yb;if(je(p,Q[k+2])){var ie=p,ye=0;if(je(ie,(ae=Q)[(Ie=k)+3]))if(je(ie,ae[Ie+6])){for(Q=0,Ie=2*(ye=je(ie,ae[Ie+8]))+(ae=je(ie,ae[Ie+9+ye])),ye=0,ae=cA[Ie];ae[Q];++Q)ye+=ye+je(ie,ae[Q]);ye+=3+(8<<Ie)}else je(ie,ae[Ie+7])?(ye=7+2*je(ie,165),ye+=je(ie,145)):ye=5+je(ie,159);else ye=je(ie,ae[Ie+4])?3+je(ie,ae[Ie+5]):2;Q=te[2]}else ye=1,Q=te[1];te=J+uA[q],0>(ie=p).b&&le(ie);var Ie,ae=ie.b,Se=(Ie=ie.Ca>>1)-(ie.I>>ae)>>31;--ie.b,ie.Ca+=Se,ie.Ca|=1,ie.I-=(Ie+1&Se)<<ae,Y[te]=((ye^Se)-Se)*L[(0<q)+0]}return 16}function oa(p){var v=p.rb[p.sb-1];v.la=0,v.Na=0,s(p.zc,0,0,p.zc.length),p.ja=0}function we(p,v,k,L,q){q=p[v+k+32*L]+(q>>3),p[v+k+32*L]=-256&q?0>q?0:255:q}function He(p,v,k,L,q,Y){we(p,v,0,k,L+q),we(p,v,1,k,L+Y),we(p,v,2,k,L-Y),we(p,v,3,k,L-q)}function Fe(p){return(20091*p>>16)+p}function lt(p,v,k,L){var q,Y=0,J=i(16);for(q=0;4>q;++q){var Q=p[v+0]+p[v+8],te=p[v+0]-p[v+8],ie=(35468*p[v+4]>>16)-Fe(p[v+12]),ye=Fe(p[v+4])+(35468*p[v+12]>>16);J[Y+0]=Q+ye,J[Y+1]=te+ie,J[Y+2]=te-ie,J[Y+3]=Q-ye,Y+=4,v++}for(q=Y=0;4>q;++q)Q=(p=J[Y+0]+4)+J[Y+8],te=p-J[Y+8],ie=(35468*J[Y+4]>>16)-Fe(J[Y+12]),we(k,L,0,0,Q+(ye=Fe(J[Y+4])+(35468*J[Y+12]>>16))),we(k,L,1,0,te+ie),we(k,L,2,0,te-ie),we(k,L,3,0,Q-ye),Y++,L+=32}function ft(p,v,k,L){var q=p[v+0]+4,Y=35468*p[v+4]>>16,J=Fe(p[v+4]),Q=35468*p[v+1]>>16;He(k,L,0,q+J,p=Fe(p[v+1]),Q),He(k,L,1,q+Y,p,Q),He(k,L,2,q-Y,p,Q),He(k,L,3,q-J,p,Q)}function ot(p,v,k,L,q){lt(p,v,k,L),q&&lt(p,v+16,k,L+4)}function et(p,v,k,L){Ql(p,v+0,k,L,1),Ql(p,v+32,k,L+128,1)}function rt(p,v,k,L){var q;for(p=p[v+0]+4,q=0;4>q;++q)for(v=0;4>v;++v)we(k,L,v,q,p)}function ht(p,v,k,L){p[v+0]&&dr(p,v+0,k,L),p[v+16]&&dr(p,v+16,k,L+4),p[v+32]&&dr(p,v+32,k,L+128),p[v+48]&&dr(p,v+48,k,L+128+4)}function at(p,v,k,L){var q,Y=i(16);for(q=0;4>q;++q){var J=p[v+0+q]+p[v+12+q],Q=p[v+4+q]+p[v+8+q],te=p[v+4+q]-p[v+8+q],ie=p[v+0+q]-p[v+12+q];Y[0+q]=J+Q,Y[8+q]=J-Q,Y[4+q]=ie+te,Y[12+q]=ie-te}for(q=0;4>q;++q)J=(p=Y[0+4*q]+3)+Y[3+4*q],Q=Y[1+4*q]+Y[2+4*q],te=Y[1+4*q]-Y[2+4*q],ie=p-Y[3+4*q],k[L+0]=J+Q>>3,k[L+16]=ie+te>>3,k[L+32]=J-Q>>3,k[L+48]=ie-te>>3,L+=64}function wt(p,v,k){var L,q=v-32,Y=Hs,J=255-p[q-1];for(L=0;L<k;++L){var Q,te=Y,ie=J+p[v-1];for(Q=0;Q<k;++Q)p[v+Q]=te[ie+p[q+Q]];v+=32}}function Bt(p,v){wt(p,v,4)}function ut(p,v){wt(p,v,8)}function Mt(p,v){wt(p,v,16)}function qr(p,v){var k;for(k=0;16>k;++k)n(p,v+32*k,p,v-32,16)}function Bn(p,v){var k;for(k=16;0<k;--k)s(p,v,p[v-1],16),v+=32}function Oi(p,v,k){var L;for(L=0;16>L;++L)s(v,k+32*L,p,16)}function qs(p,v){var k,L=16;for(k=0;16>k;++k)L+=p[v-1+32*k]+p[v+k-32];Oi(L>>5,p,v)}function So(p,v){var k,L=8;for(k=0;16>k;++k)L+=p[v-1+32*k];Oi(L>>4,p,v)}function Fr(p,v){var k,L=8;for(k=0;16>k;++k)L+=p[v+k-32];Oi(L>>4,p,v)}function Yt(p,v){Oi(128,p,v)}function bt(p,v,k){return p+2*v+k+2>>2}function ps(p,v){var k,L=v-32;for(L=new Uint8Array([bt(p[L-1],p[L+0],p[L+1]),bt(p[L+0],p[L+1],p[L+2]),bt(p[L+1],p[L+2],p[L+3]),bt(p[L+2],p[L+3],p[L+4])]),k=0;4>k;++k)n(p,v+32*k,L,0,L.length)}function hi(p,v){var k=p[v-1],L=p[v-1+32],q=p[v-1+64],Y=p[v-1+96];me(p,v+0,16843009*bt(p[v-1-32],k,L)),me(p,v+32,16843009*bt(k,L,q)),me(p,v+64,16843009*bt(L,q,Y)),me(p,v+96,16843009*bt(q,Y,Y))}function As(p,v){var k,L=4;for(k=0;4>k;++k)L+=p[v+k-32]+p[v-1+32*k];for(L>>=3,k=0;4>k;++k)s(p,v+32*k,L,4)}function Ad(p,v){var k=p[v-1+0],L=p[v-1+32],q=p[v-1+64],Y=p[v-1-32],J=p[v+0-32],Q=p[v+1-32],te=p[v+2-32],ie=p[v+3-32];p[v+0+96]=bt(L,q,p[v-1+96]),p[v+1+96]=p[v+0+64]=bt(k,L,q),p[v+2+96]=p[v+1+64]=p[v+0+32]=bt(Y,k,L),p[v+3+96]=p[v+2+64]=p[v+1+32]=p[v+0+0]=bt(J,Y,k),p[v+3+64]=p[v+2+32]=p[v+1+0]=bt(Q,J,Y),p[v+3+32]=p[v+2+0]=bt(te,Q,J),p[v+3+0]=bt(ie,te,Q)}function Ri(p,v){var k=p[v+1-32],L=p[v+2-32],q=p[v+3-32],Y=p[v+4-32],J=p[v+5-32],Q=p[v+6-32],te=p[v+7-32];p[v+0+0]=bt(p[v+0-32],k,L),p[v+1+0]=p[v+0+32]=bt(k,L,q),p[v+2+0]=p[v+1+32]=p[v+0+64]=bt(L,q,Y),p[v+3+0]=p[v+2+32]=p[v+1+64]=p[v+0+96]=bt(q,Y,J),p[v+3+32]=p[v+2+64]=p[v+1+96]=bt(Y,J,Q),p[v+3+64]=p[v+2+96]=bt(J,Q,te),p[v+3+96]=bt(Q,te,te)}function Fi(p,v){var k=p[v-1+0],L=p[v-1+32],q=p[v-1+64],Y=p[v-1-32],J=p[v+0-32],Q=p[v+1-32],te=p[v+2-32],ie=p[v+3-32];p[v+0+0]=p[v+1+64]=Y+J+1>>1,p[v+1+0]=p[v+2+64]=J+Q+1>>1,p[v+2+0]=p[v+3+64]=Q+te+1>>1,p[v+3+0]=te+ie+1>>1,p[v+0+96]=bt(q,L,k),p[v+0+64]=bt(L,k,Y),p[v+0+32]=p[v+1+96]=bt(k,Y,J),p[v+1+32]=p[v+2+96]=bt(Y,J,Q),p[v+2+32]=p[v+3+96]=bt(J,Q,te),p[v+3+32]=bt(Q,te,ie)}function Dr(p,v){var k=p[v+0-32],L=p[v+1-32],q=p[v+2-32],Y=p[v+3-32],J=p[v+4-32],Q=p[v+5-32],te=p[v+6-32],ie=p[v+7-32];p[v+0+0]=k+L+1>>1,p[v+1+0]=p[v+0+64]=L+q+1>>1,p[v+2+0]=p[v+1+64]=q+Y+1>>1,p[v+3+0]=p[v+2+64]=Y+J+1>>1,p[v+0+32]=bt(k,L,q),p[v+1+32]=p[v+0+96]=bt(L,q,Y),p[v+2+32]=p[v+1+96]=bt(q,Y,J),p[v+3+32]=p[v+2+96]=bt(Y,J,Q),p[v+3+64]=bt(J,Q,te),p[v+3+96]=bt(Q,te,ie)}function la(p,v){var k=p[v-1+0],L=p[v-1+32],q=p[v-1+64],Y=p[v-1+96];p[v+0+0]=k+L+1>>1,p[v+2+0]=p[v+0+32]=L+q+1>>1,p[v+2+32]=p[v+0+64]=q+Y+1>>1,p[v+1+0]=bt(k,L,q),p[v+3+0]=p[v+1+32]=bt(L,q,Y),p[v+3+32]=p[v+1+64]=bt(q,Y,Y),p[v+3+64]=p[v+2+64]=p[v+0+96]=p[v+1+96]=p[v+2+96]=p[v+3+96]=Y}function ko(p,v){var k=p[v-1+0],L=p[v-1+32],q=p[v-1+64],Y=p[v-1+96],J=p[v-1-32],Q=p[v+0-32],te=p[v+1-32],ie=p[v+2-32];p[v+0+0]=p[v+2+32]=k+J+1>>1,p[v+0+32]=p[v+2+64]=L+k+1>>1,p[v+0+64]=p[v+2+96]=q+L+1>>1,p[v+0+96]=Y+q+1>>1,p[v+3+0]=bt(Q,te,ie),p[v+2+0]=bt(J,Q,te),p[v+1+0]=p[v+3+32]=bt(k,J,Q),p[v+1+32]=p[v+3+64]=bt(L,k,J),p[v+1+64]=p[v+3+96]=bt(q,L,k),p[v+1+96]=bt(Y,q,L)}function Ld(p,v){var k;for(k=0;8>k;++k)n(p,v+32*k,p,v-32,8)}function $l(p,v){var k;for(k=0;8>k;++k)s(p,v,p[v-1],8),v+=32}function Kc(p,v,k){var L;for(L=0;8>L;++L)s(v,k+32*L,p,8)}function Yc(p,v){var k,L=8;for(k=0;8>k;++k)L+=p[v+k-32]+p[v-1+32*k];Kc(L>>4,p,v)}function Lg(p,v){var k,L=4;for(k=0;8>k;++k)L+=p[v+k-32];Kc(L>>3,p,v)}function Pd(p,v){var k,L=4;for(k=0;8>k;++k)L+=p[v-1+32*k];Kc(L>>3,p,v)}function Td(p,v){Kc(128,p,v)}function Bl(p,v,k){var L=p[v-k],q=p[v+0],Y=3*(q-L)+Pg[1020+p[v-2*k]-p[v+k]],J=lm[112+(Y+4>>3)];p[v-k]=Hs[255+L+lm[112+(Y+3>>3)]],p[v+0]=Hs[255+q-J]}function Ul(p,v,k,L){var q=p[v+0],Y=p[v+k];return gi[255+p[v-2*k]-p[v-k]]>L||gi[255+Y-q]>L}function Id(p,v,k,L){return 4*gi[255+p[v-k]-p[v+0]]+gi[255+p[v-2*k]-p[v+k]]<=L}function Zc(p,v,k,L,q){var Y=p[v-3*k],J=p[v-2*k],Q=p[v-k],te=p[v+0],ie=p[v+k],ye=p[v+2*k],Ie=p[v+3*k];return 4*gi[255+Q-te]+gi[255+J-ie]>L?0:gi[255+p[v-4*k]-Y]<=q&&gi[255+Y-J]<=q&&gi[255+J-Q]<=q&&gi[255+Ie-ye]<=q&&gi[255+ye-ie]<=q&&gi[255+ie-te]<=q}function Md(p,v,k,L){var q=2*L+1;for(L=0;16>L;++L)Id(p,v+L,k,q)&&Bl(p,v+L,k)}function zl(p,v,k,L){var q=2*L+1;for(L=0;16>L;++L)Id(p,v+L*k,1,q)&&Bl(p,v+L*k,1)}function Qf(p,v,k,L){var q;for(q=3;0<q;--q)Md(p,v+=4*k,k,L)}function em(p,v,k,L){var q;for(q=3;0<q;--q)zl(p,v+=4,k,L)}function Fa(p,v,k,L,q,Y,J,Q){for(Y=2*Y+1;0<q--;){if(Zc(p,v,k,Y,J))if(Ul(p,v,k,Q))Bl(p,v,k);else{var te=p,ie=v,ye=k,Ie=te[ie-2*ye],ae=te[ie-ye],Se=te[ie+0],Ae=te[ie+ye],Be=te[ie+2*ye],Te=27*(qe=Pg[1020+3*(Se-ae)+Pg[1020+Ie-Ae]])+63>>7,Ue=18*qe+63>>7,qe=9*qe+63>>7;te[ie-3*ye]=Hs[255+te[ie-3*ye]+qe],te[ie-2*ye]=Hs[255+Ie+Ue],te[ie-ye]=Hs[255+ae+Te],te[ie+0]=Hs[255+Se-Te],te[ie+ye]=Hs[255+Ae-Ue],te[ie+2*ye]=Hs[255+Be-qe]}v+=L}}function Da(p,v,k,L,q,Y,J,Q){for(Y=2*Y+1;0<q--;){if(Zc(p,v,k,Y,J))if(Ul(p,v,k,Q))Bl(p,v,k);else{var te=p,ie=v,ye=k,Ie=te[ie-ye],ae=te[ie+0],Se=te[ie+ye],Ae=lm[112+(4+(Be=3*(ae-Ie))>>3)],Be=lm[112+(Be+3>>3)],Te=Ae+1>>1;te[ie-2*ye]=Hs[255+te[ie-2*ye]+Te],te[ie-ye]=Hs[255+Ie+Be],te[ie+0]=Hs[255+ae-Ae],te[ie+ye]=Hs[255+Se-Te]}v+=L}}function tm(p,v,k,L,q,Y){Fa(p,v,k,1,16,L,q,Y)}function rm(p,v,k,L,q,Y){Fa(p,v,1,k,16,L,q,Y)}function ql(p,v,k,L,q,Y){var J;for(J=3;0<J;--J)Da(p,v+=4*k,k,1,16,L,q,Y)}function nm(p,v,k,L,q,Y){var J;for(J=3;0<J;--J)Da(p,v+=4,1,k,16,L,q,Y)}function N(p,v,k,L,q,Y,J,Q){Fa(p,v,q,1,8,Y,J,Q),Fa(k,L,q,1,8,Y,J,Q)}function z(p,v,k,L,q,Y,J,Q){Fa(p,v,1,q,8,Y,J,Q),Fa(k,L,1,q,8,Y,J,Q)}function oe(p,v,k,L,q,Y,J,Q){Da(p,v+4*q,q,1,8,Y,J,Q),Da(k,L+4*q,q,1,8,Y,J,Q)}function pe(p,v,k,L,q,Y,J,Q){Da(p,v+4,1,q,8,Y,J,Q),Da(k,L+4,1,q,8,Y,J,Q)}function ke(){this.ba=new Lt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new dt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ze(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ke(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function yt(){this.ua=0,this.Wa=new xe,this.vb=new xe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new R,this.yc=new F}function kt(){this.xb=this.a=0,this.l=new No,this.ca=new Lt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Z,this.Pb=0,this.wd=new Z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new yt,this.ab=0,this.gc=o(4,Ke),this.Oc=0}function Rt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new No,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Dt(p,v,k,L,q,Y,J){for(p=p==null?0:p[v+0],v=0;v<J;++v)q[Y+v]=p+k[L+v]&255,p=q[Y+v]}function or(p,v,k,L,q,Y,J){var Q;if(p==null)Dt(null,null,k,L,q,Y,J);else for(Q=0;Q<J;++Q)q[Y+Q]=p[v+Q]+k[L+Q]&255}function Vr(p,v,k,L,q,Y,J){if(p==null)Dt(null,null,k,L,q,Y,J);else{var Q,te=p[v+0],ie=te,ye=te;for(Q=0;Q<J;++Q)ie=ye+(te=p[v+Q])-ie,ye=k[L+Q]+(-256&ie?0>ie?0:255:ie)&255,ie=te,q[Y+Q]=ye}}function pn(p,v,k,L){var q=v.width,Y=v.o;if(t(p!=null&&v!=null),0>k||0>=L||k+L>Y)return null;if(!p.Cc){if(p.ga==null){var J;if(p.ga=new Rt,(J=p.ga==null)||(J=v.width*v.o,t(p.Gb.length==0),p.Gb=i(J),p.Uc=0,p.Gb==null?J=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,J=1),J=!J),!J){J=p.ga;var Q=p.Fa,te=p.P,ie=p.qc,ye=p.mb,Ie=p.nb,ae=te+1,Se=ie-1,Ae=J.l;if(t(Q!=null&&ye!=null&&v!=null),Ro[0]=null,Ro[1]=Dt,Ro[2]=or,Ro[3]=Vr,J.ca=ye,J.tb=Ie,J.c=v.width,J.i=v.height,t(0<J.c&&0<J.i),1>=ie)v=0;else if(J.$a=3&Q[te+0],J.Z=Q[te+0]>>2&3,J.Lc=Q[te+0]>>4&3,te=Q[te+0]>>6&3,0>J.$a||1<J.$a||4<=J.Z||1<J.Lc||te)v=0;else if(Ae.put=Nt,Ae.ac=wn,Ae.bc=Wt,Ae.ma=J,Ae.width=v.width,Ae.height=v.height,Ae.Da=v.Da,Ae.v=v.v,Ae.va=v.va,Ae.j=v.j,Ae.o=v.o,J.$a)e:{t(J.$a==1),v=hs();t:for(;;){if(v==null){v=0;break e}if(t(J!=null),J.mc=v,v.c=J.c,v.i=J.i,v.l=J.l,v.l.ma=J,v.l.width=J.c,v.l.height=J.i,v.a=0,G(v.m,Q,ae,Se),!fs(J.c,J.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&ur(v.s)?(J.ic=1,Q=v.c*v.i,v.Ta=null,v.Ua=0,v.V=i(Q),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(J.ic=0,v=Ii(v,J.c)),!v))break t;v=1;break e}J.mc=null,v=0}else v=Se>=J.c*J.i;J=!v}if(J)return null;p.ga.Lc!=1?p.Ga=0:L=Y-k}t(p.ga!=null),t(k+L<=Y);e:{if(v=(Q=p.ga).c,Y=Q.l.o,Q.$a==0){if(ae=p.rc,Se=p.Vc,Ae=p.Fa,te=p.P+1+k*v,ie=p.mb,ye=p.nb+k*v,t(te<=p.P+p.qc),Q.Z!=0)for(t(Ro[Q.Z]!=null),J=0;J<L;++J)Ro[Q.Z](ae,Se,Ae,te,ie,ye,v),ae=ie,Se=ye,ye+=v,te+=v;else for(J=0;J<L;++J)n(ie,ye,Ae,te,v),ae=ie,Se=ye,ye+=v,te+=v;p.rc=ae,p.Vc=Se}else{if(t(Q.mc!=null),v=k+L,t((J=Q.mc)!=null),t(v<=J.i),J.C>=v)v=1;else if(Q.ic||fi(),Q.ic){Q=J.V,ae=J.Ba,Se=J.c;var Be=J.i,Te=(Ae=1,te=J.$/Se,ie=J.$%Se,ye=J.m,Ie=J.s,J.$),Ue=Se*Be,qe=Se*v,Ze=Ie.wc,Ge=Te<qe?It(Ie,ie,te):null;t(Te<=Ue),t(v<=Be),t(ur(Ie));t:for(;;){for(;!ye.h&&Te<qe;){if(ie&Ze||(Ge=It(Ie,ie,te)),t(Ge!=null),ne(ye),256>(Be=ar(Ge.G[0],Ge.H[0],ye)))Q[ae+Te]=Be,++Te,++ie>=Se&&(ie=0,++te<=v&&!(te%16)&&mn(J,te));else{if(!(280>Be)){Ae=0;break t}Be=er(Be-256,ye);var Ct,xt=ar(Ge.G[4],Ge.H[4],ye);if(ne(ye),!(Te>=(xt=cr(Se,xt=er(xt,ye)))&&Ue-Te>=Be)){Ae=0;break t}for(Ct=0;Ct<Be;++Ct)Q[ae+Te+Ct]=Q[ae+Te+Ct-xt];for(Te+=Be,ie+=Be;ie>=Se;)ie-=Se,++te<=v&&!(te%16)&&mn(J,te);Te<qe&&ie&Ze&&(Ge=It(Ie,ie,te))}t(ye.h==ee(ye))}mn(J,te>v?v:te);break t}!Ae||ye.h&&Te<Ue?(Ae=0,J.a=ye.h?5:3):J.$=Te,v=Ae}else v=$n(J,J.V,J.Ba,J.c,J.i,v,Pr);if(!v){L=0;break e}}k+L>=Y&&(p.Cc=1),L=1}if(!L)return null;if(p.Cc&&((L=p.ga)!=null&&(L.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+k*q}function kr(p,v,k,L,q,Y){for(;0<q--;){var J,Q=p,te=v+(k?1:0),ie=p,ye=v+(k?0:3);for(J=0;J<L;++J){var Ie=ie[ye+4*J];Ie!=255&&(Ie*=32897,Q[te+4*J+0]=Q[te+4*J+0]*Ie>>23,Q[te+4*J+1]=Q[te+4*J+1]*Ie>>23,Q[te+4*J+2]=Q[te+4*J+2]*Ie>>23)}v+=Y}}function _n(p,v,k,L,q){for(;0<L--;){var Y;for(Y=0;Y<k;++Y){var J=p[v+2*Y+0],Q=15&(ie=p[v+2*Y+1]),te=4369*Q,ie=(240&ie|ie>>4)*te>>16;p[v+2*Y+0]=(240&J|J>>4)*te>>16&240|(15&J|J<<4)*te>>16>>4&15,p[v+2*Y+1]=240&ie|Q}v+=q}}function gn(p,v,k,L,q,Y,J,Q){var te,ie,ye=255;for(ie=0;ie<q;++ie){for(te=0;te<L;++te){var Ie=p[v+te];Y[J+4*te]=Ie,ye&=Ie}v+=k,J+=Q}return ye!=255}function Un(p,v,k,L,q){var Y;for(Y=0;Y<q;++Y)k[L+Y]=p[v+Y]>>8}function fi(){Wd=kr,iw=_n,aw=gn,ow=Un}function Ls(p,v,k){T[p]=function(L,q,Y,J,Q,te,ie,ye,Ie,ae,Se,Ae,Be,Te,Ue,qe,Ze){var Ge,Ct=Ze-1>>1,xt=Q[te+0]|ie[ye+0]<<16,qt=Ie[ae+0]|Se[Ae+0]<<16;t(L!=null);var _t=3*xt+qt+131074>>2;for(v(L[q+0],255&_t,_t>>16,Be,Te),Y!=null&&(_t=3*qt+xt+131074>>2,v(Y[J+0],255&_t,_t>>16,Ue,qe)),Ge=1;Ge<=Ct;++Ge){var Zt=Q[te+Ge]|ie[ye+Ge]<<16,Nn=Ie[ae+Ge]|Se[Ae+Ge]<<16,Vt=xt+Zt+qt+Nn+524296,jt=Vt+2*(Zt+qt)>>3;_t=jt+xt>>1,xt=(Vt=Vt+2*(xt+Nn)>>3)+Zt>>1,v(L[q+2*Ge-1],255&_t,_t>>16,Be,Te+(2*Ge-1)*k),v(L[q+2*Ge-0],255&xt,xt>>16,Be,Te+(2*Ge-0)*k),Y!=null&&(_t=Vt+qt>>1,xt=jt+Nn>>1,v(Y[J+2*Ge-1],255&_t,_t>>16,Ue,qe+(2*Ge-1)*k),v(Y[J+2*Ge+0],255&xt,xt>>16,Ue,qe+(2*Ge+0)*k)),xt=Zt,qt=Nn}1&Ze||(_t=3*xt+qt+131074>>2,v(L[q+Ze-1],255&_t,_t>>16,Be,Te+(Ze-1)*k),Y!=null&&(_t=3*qt+xt+131074>>2,v(Y[J+Ze-1],255&_t,_t>>16,Ue,qe+(Ze-1)*k)))}}function sm(){xi[cm]=gA,xi[um]=vw,xi[fw]=xA,xi[dm]=yw,xi[hm]=bw,xi[Tg]=ww,xi[mw]=vA,xi[Ig]=vw,xi[Mg]=yw,xi[fm]=bw,xi[Og]=ww}function Jc(p){return p&~yA?0>p?0:255:p>>_w}function Vl(p,v){return Jc((19077*p>>8)+(26149*v>>8)-14234)}function Co(p,v,k){return Jc((19077*p>>8)-(6419*v>>8)-(13320*k>>8)+8708)}function Wl(p,v){return Jc((19077*p>>8)+(33050*v>>8)-17685)}function Hl(p,v,k,L,q){L[q+0]=Vl(p,k),L[q+1]=Co(p,v,k),L[q+2]=Wl(p,v)}function Gl(p,v,k,L,q){L[q+0]=Wl(p,v),L[q+1]=Co(p,v,k),L[q+2]=Vl(p,k)}function Xn(p,v,k,L,q){var Y=Co(p,v,k);v=Y<<3&224|Wl(p,v)>>3,L[q+0]=248&Vl(p,k)|Y>>5,L[q+1]=v}function Kl(p,v,k,L,q){var Y=240&Wl(p,v)|15;L[q+0]=240&Vl(p,k)|Co(p,v,k)>>4,L[q+1]=Y}function Yl(p,v,k,L,q){L[q+0]=255,Hl(p,v,k,L,q+1)}function Od(p,v,k,L,q){Gl(p,v,k,L,q),L[q+3]=255}function Rd(p,v,k,L,q){Hl(p,v,k,L,q),L[q+3]=255}function Xr(p,v){return 0>p?0:p>v?v:p}function $a(p,v,k){T[p]=function(L,q,Y,J,Q,te,ie,ye,Ie){for(var ae=ye+(-2&Ie)*k;ye!=ae;)v(L[q+0],Y[J+0],Q[te+0],ie,ye),v(L[q+1],Y[J+0],Q[te+0],ie,ye+k),q+=2,++J,++te,ye+=2*k;1&Ie&&v(L[q+0],Y[J+0],Q[te+0],ie,ye)}}function Xc(p,v,k){return k==0?p==0?v==0?6:5:v==0?4:0:k}function im(p,v,k,L,q){switch(p>>>30){case 3:Ql(v,k,L,q,0);break;case 2:pi(v,k,L,q);break;case 1:dr(v,k,L,q)}}function mi(p,v){var k,L,q=v.M,Y=v.Nb,J=p.oc,Q=p.pc+40,te=p.oc,ie=p.pc+584,ye=p.oc,Ie=p.pc+600;for(k=0;16>k;++k)J[Q+32*k-1]=129;for(k=0;8>k;++k)te[ie+32*k-1]=129,ye[Ie+32*k-1]=129;for(0<q?J[Q-1-32]=te[ie-1-32]=ye[Ie-1-32]=129:(s(J,Q-32-1,127,21),s(te,ie-32-1,127,9),s(ye,Ie-32-1,127,9)),L=0;L<p.za;++L){var ae=v.ya[v.aa+L];if(0<L){for(k=-1;16>k;++k)n(J,Q+32*k-4,J,Q+32*k+12,4);for(k=-1;8>k;++k)n(te,ie+32*k-4,te,ie+32*k+4,4),n(ye,Ie+32*k-4,ye,Ie+32*k+4,4)}var Se=p.Gd,Ae=p.Hd+L,Be=ae.ad,Te=ae.Hc;if(0<q&&(n(J,Q-32,Se[Ae].y,0,16),n(te,ie-32,Se[Ae].f,0,8),n(ye,Ie-32,Se[Ae].ea,0,8)),ae.Za){var Ue=J,qe=Q-32+16;for(0<q&&(L>=p.za-1?s(Ue,qe,Se[Ae].y[15],4):n(Ue,qe,Se[Ae+1].y,0,4)),k=0;4>k;k++)Ue[qe+128+k]=Ue[qe+256+k]=Ue[qe+384+k]=Ue[qe+0+k];for(k=0;16>k;++k,Te<<=2)Ue=J,qe=Q+Nw[k],Di[ae.Ob[k]](Ue,qe),im(Te,Be,16*+k,Ue,qe)}else if(Ue=Xc(L,q,ae.Ob[0]),Oo[Ue](J,Q),Te!=0)for(k=0;16>k;++k,Te<<=2)im(Te,Be,16*+k,J,Q+Nw[k]);for(k=ae.Gc,Ue=Xc(L,q,ae.Dd),za[Ue](te,ie),za[Ue](ye,Ie),Te=Be,Ue=te,qe=ie,255&(ae=0|k)&&(170&ae?da(Te,256,Ue,qe):br(Te,256,Ue,qe)),ae=ye,Te=Ie,255&(k>>=8)&&(170&k?da(Be,320,ae,Te):br(Be,320,ae,Te)),q<p.Ub-1&&(n(Se[Ae].y,0,J,Q+480,16),n(Se[Ae].f,0,te,ie+224,8),n(Se[Ae].ea,0,ye,Ie+224,8)),k=8*Y*p.B,Se=p.sa,Ae=p.ta+16*L+16*Y*p.R,Be=p.qa,ae=p.ra+8*L+k,Te=p.Ha,Ue=p.Ia+8*L+k,k=0;16>k;++k)n(Se,Ae+k*p.R,J,Q+32*k,16);for(k=0;8>k;++k)n(Be,ae+k*p.B,te,ie+32*k,8),n(Te,Ue+k*p.B,ye,Ie+32*k,8)}}function Zl(p,v,k,L,q,Y,J,Q,te){var ie=[0],ye=[0],Ie=0,ae=te!=null?te.kd:0,Se=te??new ze;if(p==null||12>k)return 7;Se.data=p,Se.w=v,Se.ha=k,v=[v],k=[k],Se.gb=[Se.gb];e:{var Ae=v,Be=k,Te=Se.gb;if(t(p!=null),t(Be!=null),t(Te!=null),Te[0]=0,12<=Be[0]&&!r(p,Ae[0],"RIFF")){if(r(p,Ae[0]+8,"WEBP")){Te=3;break e}var Ue=he(p,Ae[0]+4);if(12>Ue||4294967286<Ue){Te=3;break e}if(ae&&Ue>Be[0]-8){Te=7;break e}Te[0]=Ue,Ae[0]+=12,Be[0]-=12}Te=0}if(Te!=0)return Te;for(Ue=0<Se.gb[0],k=k[0];;){e:{var qe=p;Be=v,Te=k;var Ze=ie,Ge=ye,Ct=Ae=[0];if((_t=Ie=[Ie])[0]=0,8>Te[0])Te=7;else{if(!r(qe,Be[0],"VP8X")){if(he(qe,Be[0]+4)!=10){Te=3;break e}if(18>Te[0]){Te=7;break e}var xt=he(qe,Be[0]+8),qt=1+ve(qe,Be[0]+12);if(2147483648<=qt*(qe=1+ve(qe,Be[0]+15))){Te=3;break e}Ct!=null&&(Ct[0]=xt),Ze!=null&&(Ze[0]=qt),Ge!=null&&(Ge[0]=qe),Be[0]+=18,Te[0]-=18,_t[0]=1}Te=0}}if(Ie=Ie[0],Ae=Ae[0],Te!=0)return Te;if(Be=!!(2&Ae),!Ue&&Ie)return 3;if(Y!=null&&(Y[0]=!!(16&Ae)),J!=null&&(J[0]=Be),Q!=null&&(Q[0]=0),J=ie[0],Ae=ye[0],Ie&&Be&&te==null){Te=0;break}if(4>k){Te=7;break}if(Ue&&Ie||!Ue&&!Ie&&!r(p,v[0],"ALPH")){k=[k],Se.na=[Se.na],Se.P=[Se.P],Se.Sa=[Se.Sa];e:{xt=p,Te=v,Ue=k;var _t=Se.gb;Ze=Se.na,Ge=Se.P,Ct=Se.Sa,qt=22,t(xt!=null),t(Ue!=null),qe=Te[0];var Zt=Ue[0];for(t(Ze!=null),t(Ct!=null),Ze[0]=null,Ge[0]=null,Ct[0]=0;;){if(Te[0]=qe,Ue[0]=Zt,8>Zt){Te=7;break e}var Nn=he(xt,qe+4);if(4294967286<Nn){Te=3;break e}var Vt=8+Nn+1&-2;if(qt+=Vt,0<_t&&qt>_t){Te=3;break e}if(!r(xt,qe,"VP8 ")||!r(xt,qe,"VP8L")){Te=0;break e}if(Zt[0]<Vt){Te=7;break e}r(xt,qe,"ALPH")||(Ze[0]=xt,Ge[0]=qe+8,Ct[0]=Nn),qe+=Vt,Zt-=Vt}}if(k=k[0],Se.na=Se.na[0],Se.P=Se.P[0],Se.Sa=Se.Sa[0],Te!=0)break}k=[k],Se.Ja=[Se.Ja],Se.xa=[Se.xa];e:if(_t=p,Te=v,Ue=k,Ze=Se.gb[0],Ge=Se.Ja,Ct=Se.xa,xt=Te[0],qe=!r(_t,xt,"VP8 "),qt=!r(_t,xt,"VP8L"),t(_t!=null),t(Ue!=null),t(Ge!=null),t(Ct!=null),8>Ue[0])Te=7;else{if(qe||qt){if(_t=he(_t,xt+4),12<=Ze&&_t>Ze-12){Te=3;break e}if(ae&&_t>Ue[0]-8){Te=7;break e}Ge[0]=_t,Te[0]+=8,Ue[0]-=8,Ct[0]=qt}else Ct[0]=5<=Ue[0]&&_t[xt+0]==47&&!(_t[xt+4]>>5),Ge[0]=Ue[0];Te=0}if(k=k[0],Se.Ja=Se.Ja[0],Se.xa=Se.xa[0],v=v[0],Te!=0)break;if(4294967286<Se.Ja)return 3;if(Q==null||Be||(Q[0]=Se.xa?2:1),J=[J],Ae=[Ae],Se.xa){if(5>k){Te=7;break}Q=J,ae=Ae,Be=Y,p==null||5>k?p=0:5<=k&&p[v+0]==47&&!(p[v+4]>>5)?(Ue=[0],_t=[0],Ze=[0],G(Ge=new Z,p,v,k),Yr(Ge,Ue,_t,Ze)?(Q!=null&&(Q[0]=Ue[0]),ae!=null&&(ae[0]=_t[0]),Be!=null&&(Be[0]=Ze[0]),p=1):p=0):p=0}else{if(10>k){Te=7;break}Q=Ae,p==null||10>k||!Fl(p,v+3,k-3)?p=0:(ae=p[v+0]|p[v+1]<<8|p[v+2]<<16,Be=16383&(p[v+7]<<8|p[v+6]),p=16383&(p[v+9]<<8|p[v+8]),1&ae||3<(ae>>1&7)||!(ae>>4&1)||ae>>5>=Se.Ja||!Be||!p?p=0:(J&&(J[0]=Be),Q&&(Q[0]=p),p=1))}if(!p||(J=J[0],Ae=Ae[0],Ie&&(ie[0]!=J||ye[0]!=Ae)))return 3;te!=null&&(te[0]=Se,te.offset=v-te.w,t(4294967286>v-te.w),t(te.offset==te.ha-k));break}return Te==0||Te==7&&Ie&&te==null?(Y!=null&&(Y[0]|=Se.na!=null&&0<Se.na.length),L!=null&&(L[0]=J),q!=null&&(q[0]=Ae),0):Te}function Fd(p,v,k){var L=v.width,q=v.height,Y=0,J=0,Q=L,te=q;if(v.Da=p!=null&&0<p.Da,v.Da&&(Q=p.cd,te=p.bd,Y=p.v,J=p.j,11>k||(Y&=-2,J&=-2),0>Y||0>J||0>=Q||0>=te||Y+Q>L||J+te>q))return 0;if(v.v=Y,v.j=J,v.va=Y+Q,v.o=J+te,v.U=Q,v.T=te,v.da=p!=null&&0<p.da,v.da){if(!Ce(Q,te,k=[p.ib],Y=[p.hb]))return 0;v.ib=k[0],v.hb=Y[0]}return v.ob=p!=null&&p.ob,v.Kb=p==null||!p.Sd,v.da&&(v.ob=v.ib<3*L/4&&v.hb<3*q/4,v.Kb=0),1}function Dd(p){if(p==null)return 2;if(11>p.S){var v=p.f.RGBA;v.fb+=(p.height-1)*v.A,v.A=-v.A}else v=p.f.kb,p=p.height,v.O+=(p-1)*v.fa,v.fa=-v.fa,v.N+=(p-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(p-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(p-1)*v.lb,v.lb=-v.lb);return 0}function Eo(p,v,k,L){if(L==null||0>=p||0>=v)return 2;if(k!=null){if(k.Da){var q=k.cd,Y=k.bd,J=-2&k.v,Q=-2&k.j;if(0>J||0>Q||0>=q||0>=Y||J+q>p||Q+Y>v)return 2;p=q,v=Y}if(k.da){if(!Ce(p,v,q=[k.ib],Y=[k.hb]))return 2;p=q[0],v=Y[0]}}L.width=p,L.height=v;e:{var te=L.width,ie=L.height;if(p=L.S,0>=te||0>=ie||!(p>=cm&&13>p))p=2;else{if(0>=L.Rd&&L.sd==null){J=Y=q=v=0;var ye=(Q=te*Sw[p])*ie;if(11>p||(Y=(ie+1)/2*(v=(te+1)/2),p==12&&(J=(q=te)*ie)),(ie=i(ye+2*Y+J))==null){p=1;break e}L.sd=ie,11>p?((te=L.f.RGBA).eb=ie,te.fb=0,te.A=Q,te.size=ye):((te=L.f.kb).y=ie,te.O=0,te.fa=Q,te.Fd=ye,te.f=ie,te.N=0+ye,te.Ab=v,te.Cd=Y,te.ea=ie,te.W=0+ye+Y,te.Db=v,te.Ed=Y,p==12&&(te.F=ie,te.J=0+ye+2*Y),te.Tc=J,te.lb=q)}if(v=1,q=L.S,Y=L.width,J=L.height,q>=cm&&13>q)if(11>q)p=L.f.RGBA,v&=(Q=Math.abs(p.A))*(J-1)+Y<=p.size,v&=Q>=Y*Sw[q],v&=p.eb!=null;else{p=L.f.kb,Q=(Y+1)/2,ye=(J+1)/2,te=Math.abs(p.fa),ie=Math.abs(p.Ab);var Ie=Math.abs(p.Db),ae=Math.abs(p.lb),Se=ae*(J-1)+Y;v&=te*(J-1)+Y<=p.Fd,v&=ie*(ye-1)+Q<=p.Cd,v=(v&=Ie*(ye-1)+Q<=p.Ed)&te>=Y&ie>=Q&Ie>=Q,v&=p.y!=null,v&=p.f!=null,v&=p.ea!=null,q==12&&(v&=ae>=Y,v&=Se<=p.Tc,v&=p.F!=null)}else v=0;p=v?0:2}}return p!=0||k!=null&&k.fd&&(p=Dd(L)),p}var Jl=64,Vs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ws=24,Ao=32,Ba=8,Lo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Oe("Predictor0","PredictorAdd0"),T.Predictor0=function(){return 4278190080},T.Predictor1=function(p){return p},T.Predictor2=function(p,v,k){return v[k+0]},T.Predictor3=function(p,v,k){return v[k+1]},T.Predictor4=function(p,v,k){return v[k-1]},T.Predictor5=function(p,v,k){return K(K(p,v[k+1]),v[k+0])},T.Predictor6=function(p,v,k){return K(p,v[k-1])},T.Predictor7=function(p,v,k){return K(p,v[k+0])},T.Predictor8=function(p,v,k){return K(v[k-1],v[k+0])},T.Predictor9=function(p,v,k){return K(v[k+0],v[k+1])},T.Predictor10=function(p,v,k){return K(K(p,v[k-1]),K(v[k+0],v[k+1]))},T.Predictor11=function(p,v,k){var L=v[k+0];return 0>=re(L>>24&255,p>>24&255,(v=v[k-1])>>24&255)+re(L>>16&255,p>>16&255,v>>16&255)+re(L>>8&255,p>>8&255,v>>8&255)+re(255&L,255&p,255&v)?L:p},T.Predictor12=function(p,v,k){var L=v[k+0];return(be((p>>24&255)+(L>>24&255)-((v=v[k-1])>>24&255))<<24|be((p>>16&255)+(L>>16&255)-(v>>16&255))<<16|be((p>>8&255)+(L>>8&255)-(v>>8&255))<<8|be((255&p)+(255&L)-(255&v)))>>>0},T.Predictor13=function(p,v,k){var L=v[k-1];return(_e((p=K(p,v[k+0]))>>24&255,L>>24&255)<<24|_e(p>>16&255,L>>16&255)<<16|_e(p>>8&255,L>>8&255)<<8|_e(255&p,255&L))>>>0};var $d=T.PredictorAdd0;T.PredictorAdd1=De,Oe("Predictor2","PredictorAdd2"),Oe("Predictor3","PredictorAdd3"),Oe("Predictor4","PredictorAdd4"),Oe("Predictor5","PredictorAdd5"),Oe("Predictor6","PredictorAdd6"),Oe("Predictor7","PredictorAdd7"),Oe("Predictor8","PredictorAdd8"),Oe("Predictor9","PredictorAdd9"),Oe("Predictor10","PredictorAdd10"),Oe("Predictor11","PredictorAdd11"),Oe("Predictor12","PredictorAdd12"),Oe("Predictor13","PredictorAdd13");var Qc=T.PredictorAdd2;Ne("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),Ne("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var an,am=T.ColorIndexInverseTransform,ca=T.MapARGB,ua=T.VP8LColorIndexInverseTransformAlpha,Bd=T.MapAlpha,Ud=T.VP8LPredictorsAdd=[];Ud.length=16,(T.VP8LPredictors=[]).length=16,(T.VP8LPredictorsAdd_C=[]).length=16,(T.VP8LPredictors_C=[]).length=16;var zd,qd,Po,To,Io,Xl,Mo,Ql,pi,da,dr,br,on,jn,Ua,Vd,eu,om,Qb,ew,tw,rw,nw,sw,Wd,iw,aw,ow,lw=i(511),cw=i(2041),uw=i(225),dw=i(767),hw=0,Pg=cw,lm=uw,Hs=dw,gi=lw,cm=0,um=1,fw=2,dm=3,hm=4,Tg=5,mw=6,Ig=7,Mg=8,fm=9,Og=10,rA=[2,3,7],nA=[3,3,11],pw=[280,256,256,256,40],sA=[0,1,1,1,0],iA=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],aA=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],oA=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],lA=8,Rg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Fg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Hd=null,cA=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],uA=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gw=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],dA=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],hA=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],fA=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],mA=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Oo=[],Di=[],za=[],pA=1,xw=2,Ro=[],xi=[];Ls("UpsampleRgbLinePair",Hl,3),Ls("UpsampleBgrLinePair",Gl,3),Ls("UpsampleRgbaLinePair",Rd,4),Ls("UpsampleBgraLinePair",Od,4),Ls("UpsampleArgbLinePair",Yl,4),Ls("UpsampleRgba4444LinePair",Kl,2),Ls("UpsampleRgb565LinePair",Xn,2);var gA=T.UpsampleRgbLinePair,xA=T.UpsampleBgrLinePair,vw=T.UpsampleRgbaLinePair,yw=T.UpsampleBgraLinePair,bw=T.UpsampleArgbLinePair,ww=T.UpsampleRgba4444LinePair,vA=T.UpsampleRgb565LinePair,mm=16,pm=1<<mm-1,Gd=-227,Dg=482,_w=6,yA=(256<<_w)-1,jw=0,bA=i(256),wA=i(256),_A=i(256),jA=i(256),NA=i(Dg-Gd),SA=i(Dg-Gd);$a("YuvToRgbRow",Hl,3),$a("YuvToBgrRow",Gl,3),$a("YuvToRgbaRow",Rd,4),$a("YuvToBgraRow",Od,4),$a("YuvToArgbRow",Yl,4),$a("YuvToRgba4444Row",Kl,2),$a("YuvToRgb565Row",Xn,2);var Nw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],gm=[0,2,8],kA=[8,7,6,4,4,2,2,2,1,1,1,1],CA=1;this.WebPDecodeRGBA=function(p,v,k,L,q){var Y=um,J=new ke,Q=new Lt;J.ba=Q,Q.S=Y,Q.width=[Q.width],Q.height=[Q.height];var te=Q.width,ie=Q.height,ye=new St;if(ye==null||p==null)var Ie=2;else t(ye!=null),Ie=Zl(p,v,k,ye.width,ye.height,ye.Pd,ye.Qd,ye.format,null);if(Ie!=0?te=0:(te!=null&&(te[0]=ye.width[0]),ie!=null&&(ie[0]=ye.height[0]),te=1),te){Q.width=Q.width[0],Q.height=Q.height[0],L!=null&&(L[0]=Q.width),q!=null&&(q[0]=Q.height);e:{if(L=new No,(q=new ze).data=p,q.w=v,q.ha=k,q.kd=1,v=[0],t(q!=null),((p=Zl(q.data,q.w,q.ha,null,null,null,v,null,q))==0||p==7)&&v[0]&&(p=4),(v=p)==0){if(t(J!=null),L.data=q.data,L.w=q.w+q.offset,L.ha=q.ha-q.offset,L.put=Nt,L.ac=wn,L.bc=Wt,L.ma=J,q.xa){if((p=hs())==null){J=1;break e}if(function(ae,Se){var Ae=[0],Be=[0],Te=[0];t:for(;;){if(ae==null)return 0;if(Se==null)return ae.a=2,0;if(ae.l=Se,ae.a=0,G(ae.m,Se.data,Se.w,Se.ha),!Yr(ae.m,Ae,Be,Te)){ae.a=3;break t}if(ae.xb=xw,Se.width=Ae[0],Se.height=Be[0],!fs(Ae[0],Be[0],1,ae,null))break t;return 1}return t(ae.a!=0),0}(p,L)){if(L=(v=Eo(L.width,L.height,J.Oa,J.ba))==0){t:{L=p;r:for(;;){if(L==null){L=0;break t}if(t(L.s.yc!=null),t(L.s.Ya!=null),t(0<L.s.Wb),t((k=L.l)!=null),t((q=k.ma)!=null),L.xb!=0){if(L.ca=q.ba,L.tb=q.tb,t(L.ca!=null),!Fd(q.Oa,k,dm)){L.a=2;break r}if(!Ii(L,k.width)||k.da)break r;if((k.da||Xe(L.ca.S))&&fi(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&fi()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!V(L.s.vb,L.s.Wa.Xa)){L.a=1;break r}L.xb=0}if(!$n(L,L.V,L.Ba,L.c,L.i,k.o,zr))break r;q.Dc=L.Ma,L=1;break t}t(L.a!=0),L=0}L=!L}L&&(v=p.a)}else v=p.a}else{if((p=new Ed)==null){J=1;break e}if(p.Fa=q.na,p.P=q.P,p.qc=q.Sa,Dl(p,L)){if((v=Eo(L.width,L.height,J.Oa,J.ba))==0){if(p.Aa=0,k=J.Oa,t((q=p)!=null),k!=null){if(0<(te=0>(te=k.Md)?0:100<te?255:255*te/100)){for(ie=ye=0;4>ie;++ie)12>(Ie=q.pb[ie]).lc&&(Ie.ia=te*kA[0>Ie.lc?0:Ie.lc]>>3),ye|=Ie.ia;ye&&(alert("todo:VP8InitRandom"),q.ia=1)}q.Ga=k.Id,100<q.Ga?q.Ga=100:0>q.Ga&&(q.Ga=0)}(function(ae,Se){if(ae==null)return 0;if(Se==null)return Jr(ae,2,"NULL VP8Io parameter in VP8Decode().");if(!ae.cb&&!Dl(ae,Se))return 0;if(t(ae.cb),Se.ac==null||Se.ac(Se)){Se.ob&&(ae.L=0);var Ae=gm[ae.L];if(ae.L==2?(ae.yb=0,ae.zb=0):(ae.yb=Se.v-Ae>>4,ae.zb=Se.j-Ae>>4,0>ae.yb&&(ae.yb=0),0>ae.zb&&(ae.zb=0)),ae.Va=Se.o+15+Ae>>4,ae.Hb=Se.va+15+Ae>>4,ae.Hb>ae.za&&(ae.Hb=ae.za),ae.Va>ae.Ub&&(ae.Va=ae.Ub),0<ae.L){var Be=ae.ed;for(Ae=0;4>Ae;++Ae){var Te;if(ae.Qa.Cb){var Ue=ae.Qa.Lb[Ae];ae.Qa.Fb||(Ue+=Be.Tb)}else Ue=Be.Tb;for(Te=0;1>=Te;++Te){var qe=ae.gd[Ae][Te],Ze=Ue;if(Be.Pc&&(Ze+=Be.vd[0],Te&&(Ze+=Be.od[0])),0<(Ze=0>Ze?0:63<Ze?63:Ze)){var Ge=Ze;0<Be.wb&&(Ge=4<Be.wb?Ge>>2:Ge>>1)>9-Be.wb&&(Ge=9-Be.wb),1>Ge&&(Ge=1),qe.dd=Ge,qe.tc=2*Ze+Ge,qe.ld=40<=Ze?2:15<=Ze?1:0}else qe.tc=0;qe.La=Te}}}Ae=0}else Jr(ae,6,"Frame setup failed"),Ae=ae.a;if(Ae=Ae==0){if(Ae){ae.$c=0,0<ae.Aa||(ae.Ic=CA);t:{Ae=ae.Ic,Be=4*(Ge=ae.za);var Ct=32*Ge,xt=Ge+1,qt=0<ae.L?Ge*(0<ae.Aa?2:1):0,_t=(ae.Aa==2?2:1)*Ge;if((qe=Be+832+(Te=3*(16*Ae+gm[ae.L])/2*Ct)+(Ue=ae.Fa!=null&&0<ae.Fa.length?ae.Kc.c*ae.Kc.i:0))!=qe)Ae=0;else{if(qe>ae.Vb){if(ae.Vb=0,ae.Ec=i(qe),ae.Fc=0,ae.Ec==null){Ae=Jr(ae,1,"no memory during frame initialization.");break t}ae.Vb=qe}qe=ae.Ec,Ze=ae.Fc,ae.Ac=qe,ae.Bc=Ze,Ze+=Be,ae.Gd=o(Ct,Rl),ae.Hd=0,ae.rb=o(xt+1,aa),ae.sb=1,ae.wa=qt?o(qt,In):null,ae.Y=0,ae.D.Nb=0,ae.D.wa=ae.wa,ae.D.Y=ae.Y,0<ae.Aa&&(ae.D.Y+=Ge),t(!0),ae.oc=qe,ae.pc=Ze,Ze+=832,ae.ya=o(_t,Ra),ae.aa=0,ae.D.ya=ae.ya,ae.D.aa=ae.aa,ae.Aa==2&&(ae.D.aa+=Ge),ae.R=16*Ge,ae.B=8*Ge,Ge=(Ct=gm[ae.L])*ae.R,Ct=Ct/2*ae.B,ae.sa=qe,ae.ta=Ze+Ge,ae.qa=ae.sa,ae.ra=ae.ta+16*Ae*ae.R+Ct,ae.Ha=ae.qa,ae.Ia=ae.ra+8*Ae*ae.B+Ct,ae.$c=0,Ze+=Te,ae.mb=Ue?qe:null,ae.nb=Ue?Ze:null,t(Ze+Ue<=ae.Fc+ae.Vb),oa(ae),s(ae.Ac,ae.Bc,0,Be),Ae=1}}if(Ae){if(Se.ka=0,Se.y=ae.sa,Se.O=ae.ta,Se.f=ae.qa,Se.N=ae.ra,Se.ea=ae.Ha,Se.Vd=ae.Ia,Se.fa=ae.R,Se.Rc=ae.B,Se.F=null,Se.J=0,!hw){for(Ae=-255;255>=Ae;++Ae)lw[255+Ae]=0>Ae?-Ae:Ae;for(Ae=-1020;1020>=Ae;++Ae)cw[1020+Ae]=-128>Ae?-128:127<Ae?127:Ae;for(Ae=-112;112>=Ae;++Ae)uw[112+Ae]=-16>Ae?-16:15<Ae?15:Ae;for(Ae=-255;510>=Ae;++Ae)dw[255+Ae]=0>Ae?0:255<Ae?255:Ae;hw=1}Mo=at,Ql=ot,da=et,dr=rt,br=ht,pi=ft,on=tm,jn=rm,Ua=N,Vd=z,eu=ql,om=nm,Qb=oe,ew=pe,tw=Md,rw=zl,nw=Qf,sw=em,Di[0]=As,Di[1]=Bt,Di[2]=ps,Di[3]=hi,Di[4]=Ad,Di[5]=Fi,Di[6]=Ri,Di[7]=Dr,Di[8]=ko,Di[9]=la,Oo[0]=qs,Oo[1]=Mt,Oo[2]=qr,Oo[3]=Bn,Oo[4]=So,Oo[5]=Fr,Oo[6]=Yt,za[0]=Yc,za[1]=ut,za[2]=Ld,za[3]=$l,za[4]=Pd,za[5]=Lg,za[6]=Td,Ae=1}else Ae=0}Ae&&(Ae=function(Zt,Nn){for(Zt.M=0;Zt.M<Zt.Va;++Zt.M){var Vt,jt=Zt.Jc[Zt.M&Zt.Xb],ct=Zt.m,ln=Zt;for(Vt=0;Vt<ln.za;++Vt){var Ut=ct,Qt=ln,Tr=Qt.Ac,zn=Qt.Bc+4*Vt,gs=Qt.zc,Qr=Qt.ya[Qt.aa+Vt];if(Qt.Qa.Bb?Qr.$b=je(Ut,Qt.Pa.jb[0])?2+je(Ut,Qt.Pa.jb[2]):je(Ut,Qt.Pa.jb[1]):Qr.$b=0,Qt.kc&&(Qr.Ad=je(Ut,Qt.Bd)),Qr.Za=!je(Ut,145)+0,Qr.Za){var Qn=Qr.Ob,xs=0;for(Qt=0;4>Qt;++Qt){var Sn,tr=gs[0+Qt];for(Sn=0;4>Sn;++Sn){tr=hA[Tr[zn+Sn]][tr];for(var mr=gw[je(Ut,tr[0])];0<mr;)mr=gw[2*mr+je(Ut,tr[mr])];tr=-mr,Tr[zn+Sn]=tr}n(Qn,xs,Tr,zn,4),xs+=4,gs[0+Qt]=tr}}else tr=je(Ut,156)?je(Ut,128)?1:3:je(Ut,163)?2:0,Qr.Ob[0]=tr,s(Tr,zn,tr,4),s(gs,0,tr,4);Qr.Dd=je(Ut,142)?je(Ut,114)?je(Ut,183)?1:3:2:0}if(ln.m.Ka)return Jr(Zt,7,"Premature end-of-partition0 encountered.");for(;Zt.ja<Zt.za;++Zt.ja){if(ln=jt,Ut=(ct=Zt).rb[ct.sb-1],Tr=ct.rb[ct.sb+ct.ja],Vt=ct.ya[ct.aa+ct.ja],zn=ct.kc?Vt.Ad:0)Ut.la=Tr.la=0,Vt.Za||(Ut.Na=Tr.Na=0),Vt.Hc=0,Vt.Gc=0,Vt.ia=0;else{var en,pr;if(Ut=Tr,Tr=ln,zn=ct.Pa.Xc,gs=ct.ya[ct.aa+ct.ja],Qr=ct.pb[gs.$b],Qt=gs.ad,Qn=0,xs=ct.rb[ct.sb-1],tr=Sn=0,s(Qt,Qn,0,384),gs.Za)var qn=0,$i=zn[3];else{mr=i(16);var cn=Ut.Na+xs.Na;if(cn=Hd(Tr,zn[1],cn,Qr.Eb,0,mr,0),Ut.Na=xs.Na=(0<cn)+0,1<cn)Mo(mr,0,Qt,Qn);else{var Ps=mr[0]+3>>3;for(mr=0;256>mr;mr+=16)Qt[Qn+mr]=Ps}qn=1,$i=zn[0]}var wr=15&Ut.la,kn=15&xs.la;for(mr=0;4>mr;++mr){var Gs=1&kn;for(Ps=pr=0;4>Ps;++Ps)wr=wr>>1|(Gs=(cn=Hd(Tr,$i,cn=Gs+(1&wr),Qr.Sc,qn,Qt,Qn))>qn)<<7,pr=pr<<2|(3<cn?3:1<cn?2:Qt[Qn+0]!=0),Qn+=16;wr>>=4,kn=kn>>1|Gs<<7,Sn=(Sn<<8|pr)>>>0}for($i=wr,qn=kn>>4,en=0;4>en;en+=2){for(pr=0,wr=Ut.la>>4+en,kn=xs.la>>4+en,mr=0;2>mr;++mr){for(Gs=1&kn,Ps=0;2>Ps;++Ps)cn=Gs+(1&wr),wr=wr>>1|(Gs=0<(cn=Hd(Tr,zn[2],cn,Qr.Qc,0,Qt,Qn)))<<3,pr=pr<<2|(3<cn?3:1<cn?2:Qt[Qn+0]!=0),Qn+=16;wr>>=2,kn=kn>>1|Gs<<5}tr|=pr<<4*en,$i|=wr<<4<<en,qn|=(240&kn)<<en}Ut.la=$i,xs.la=qn,gs.Hc=Sn,gs.Gc=tr,gs.ia=43690&tr?0:Qr.ia,zn=!(Sn|tr)}if(0<ct.L&&(ct.wa[ct.Y+ct.ja]=ct.gd[Vt.$b][Vt.Za],ct.wa[ct.Y+ct.ja].La|=!zn),ln.Ka)return Jr(Zt,7,"Premature end-of-file encountered.")}if(oa(Zt),ct=Nn,ln=1,Vt=(jt=Zt).D,Ut=0<jt.L&&jt.M>=jt.zb&&jt.M<=jt.Va,jt.Aa==0)t:{if(Vt.M=jt.M,Vt.uc=Ut,mi(jt,Vt),ln=1,Vt=(pr=jt.D).Nb,Ut=(tr=gm[jt.L])*jt.R,Tr=tr/2*jt.B,mr=16*Vt*jt.R,Ps=8*Vt*jt.B,zn=jt.sa,gs=jt.ta-Ut+mr,Qr=jt.qa,Qt=jt.ra-Tr+Ps,Qn=jt.Ha,xs=jt.Ia-Tr+Ps,kn=(wr=pr.M)==0,Sn=wr>=jt.Va-1,jt.Aa==2&&mi(jt,pr),pr.uc)for(Gs=(cn=jt).D.M,t(cn.D.uc),pr=cn.yb;pr<cn.Hb;++pr){qn=pr,$i=Gs;var vs=(Ks=(Vn=cn).D).Nb;en=Vn.R;var Ks=Ks.wa[Ks.Y+qn],Ys=Vn.sa,Ts=Vn.ta+16*vs*en+16*qn,Zs=Ks.dd,Cr=Ks.tc;if(Cr!=0)if(t(3<=Cr),Vn.L==1)0<qn&&rw(Ys,Ts,en,Cr+4),Ks.La&&sw(Ys,Ts,en,Cr),0<$i&&tw(Ys,Ts,en,Cr+4),Ks.La&&nw(Ys,Ts,en,Cr);else{var Js=Vn.B,Bi=Vn.qa,ec=Vn.ra+8*vs*Js+8*qn,qa=Vn.Ha,Vn=Vn.Ia+8*vs*Js+8*qn;vs=Ks.ld,0<qn&&(jn(Ys,Ts,en,Cr+4,Zs,vs),Vd(Bi,ec,qa,Vn,Js,Cr+4,Zs,vs)),Ks.La&&(om(Ys,Ts,en,Cr,Zs,vs),ew(Bi,ec,qa,Vn,Js,Cr,Zs,vs)),0<$i&&(on(Ys,Ts,en,Cr+4,Zs,vs),Ua(Bi,ec,qa,Vn,Js,Cr+4,Zs,vs)),Ks.La&&(eu(Ys,Ts,en,Cr,Zs,vs),Qb(Bi,ec,qa,Vn,Js,Cr,Zs,vs))}}if(jt.ia&&alert("todo:DitherRow"),ct.put!=null){if(pr=16*wr,wr=16*(wr+1),kn?(ct.y=jt.sa,ct.O=jt.ta+mr,ct.f=jt.qa,ct.N=jt.ra+Ps,ct.ea=jt.Ha,ct.W=jt.Ia+Ps):(pr-=tr,ct.y=zn,ct.O=gs,ct.f=Qr,ct.N=Qt,ct.ea=Qn,ct.W=xs),Sn||(wr-=tr),wr>ct.o&&(wr=ct.o),ct.F=null,ct.J=null,jt.Fa!=null&&0<jt.Fa.length&&pr<wr&&(ct.J=pn(jt,ct,pr,wr-pr),ct.F=jt.mb,ct.F==null&&ct.F.length==0)){ln=Jr(jt,3,"Could not decode alpha data.");break t}pr<ct.j&&(tr=ct.j-pr,pr=ct.j,t(!(1&tr)),ct.O+=jt.R*tr,ct.N+=jt.B*(tr>>1),ct.W+=jt.B*(tr>>1),ct.F!=null&&(ct.J+=ct.width*tr)),pr<wr&&(ct.O+=ct.v,ct.N+=ct.v>>1,ct.W+=ct.v>>1,ct.F!=null&&(ct.J+=ct.v),ct.ka=pr-ct.j,ct.U=ct.va-ct.v,ct.T=wr-pr,ln=ct.put(ct))}Vt+1!=jt.Ic||Sn||(n(jt.sa,jt.ta-Ut,zn,gs+16*jt.R,Ut),n(jt.qa,jt.ra-Tr,Qr,Qt+8*jt.B,Tr),n(jt.Ha,jt.Ia-Tr,Qn,xs+8*jt.B,Tr))}if(!ln)return Jr(Zt,6,"Output aborted.")}return 1}(ae,Se)),Se.bc!=null&&Se.bc(Se),Ae&=1}return Ae?(ae.cb=0,Ae):0})(p,L)||(v=p.a)}}else v=p.a}v==0&&J.Oa!=null&&J.Oa.fd&&(v=Dd(J.ba))}J=v}Y=J!=0?null:11>Y?Q.f.RGBA.eb:Q.f.kb.y}else Y=null;return Y};var Sw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(T,D){for(var C="",P=0;P<4;P++)C+=String.fromCharCode(T[D++]);return C}function d(T,D){return T[D+0]|T[D+1]<<8}function m(T,D){return(T[D+0]|T[D+1]<<8|T[D+2]<<16)>>>0}function f(T,D){return(T[D+0]|T[D+1]<<8|T[D+2]<<16|T[D+3]<<24)>>>0}new c;var h=[0],x=[0],b=[],j=new c,y=e,_=function(T,D){var C={},P=0,F=!1,A=0,R=0;if(C.frames=[],!function(O,Z){for(var B=0;B<4;B++)if(O[Z+B]!="RIFF".charCodeAt(B))return!0;return!1}(T,D)){for(f(T,D+=4),D+=8;D<T.length;){var H=u(T,D),W=f(T,D+=4);D+=4;var M=W+(1&W);switch(H){case"VP8 ":case"VP8L":C.frames[P]===void 0&&(C.frames[P]={}),(ue=C.frames[P]).src_off=F?R:D-8,ue.src_size=A+W+8,P++,F&&(F=!1,A=0,R=0);break;case"VP8X":(ue=C.header={}).feature_flags=T[D];var G=D+4;ue.canvas_width=1+m(T,G),G+=3,ue.canvas_height=1+m(T,G),G+=3;break;case"ALPH":F=!0,A=M+8,R=D-8;break;case"ANIM":(ue=C.header).bgcolor=f(T,D),G=D+4,ue.loop_count=d(T,G),G+=2;break;case"ANMF":var ce,ue;(ue=C.frames[P]={}).offset_x=2*m(T,D),D+=3,ue.offset_y=2*m(T,D),D+=3,ue.width=1+m(T,D),D+=3,ue.height=1+m(T,D),D+=3,ue.duration=m(T,D),D+=3,ce=T[D++],ue.dispose=1&ce,ue.blend=ce>>1&1}H!="ANMF"&&(D+=M)}return C}}(y,0);_.response=y,_.rgbaoutput=!0,_.dataurl=!1;var w=_.header?_.header:null,S=_.frames?_.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],x=[w.canvas_width];for(var E=0;E<S.length&&S[E].blend!=0;E++);}var $=S[0],U=j.WebPDecodeRGBA(y,$.src_off,$.src_size,x,h);$.rgba=U,$.imgwidth=x[0],$.imgheight=h[0];for(var I=0;I<x[0]*h[0]*4;I++)b[I]=U[I];return this.width=x,this.height=h,this.data=b,this}(function(e){var t,r,n,s,i,o,l,c,u,d=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new m(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var m=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Z=O;Object.defineProperty(this,"pdf",{get:function(){return Z}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(he){B=!!he}});var ee=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ee},set:function(he){ee=!!he}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(he){isNaN(he)||(X=he)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(he){isNaN(he)||(ne=he)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(he){var V;typeof he=="number"?V=[he,he,he,he]:((V=new Array(4))[0]=he[0],V[1]=he.length>=2?he[1]:V[0],V[2]=he.length>=3?he[2]:V[0],V[3]=he.length>=4?he[3]:V[1]),u.margin=V}});var le=!1;Object.defineProperty(this,"autoPaging",{get:function(){return le},set:function(he){le=he}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(he){de=he}});var je=[];Object.defineProperty(this,"pageBreaks",{get:function(){return je},set:function(he){je=he}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(he){he instanceof d&&(u=he)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(he){u.path=he}});var me=[];Object.defineProperty(this,"ctxStack",{get:function(){return me},set:function(he){me=he}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(he){var V;V=f(he),this.ctx.fillStyle=V.style,this.ctx.isFillTransparent=V.a===0,this.ctx.fillOpacity=V.a,this.pdf.setFillColor(V.r,V.g,V.b,{a:V.a}),this.pdf.setTextColor(V.r,V.g,V.b,{a:V.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(he){var V=f(he);this.ctx.strokeStyle=V.style,this.ctx.isStrokeTransparent=V.a===0,this.ctx.strokeOpacity=V.a,V.a===0?this.pdf.setDrawColor(255,255,255):(V.a,this.pdf.setDrawColor(V.r,V.g,V.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(he){["butt","round","square"].indexOf(he)!==-1&&(this.ctx.lineCap=he,this.pdf.setLineCap(he))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(he){isNaN(he)||(this.ctx.lineWidth=he,this.pdf.setLineWidth(he))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(he){["bevel","round","miter"].indexOf(he)!==-1&&(this.ctx.lineJoin=he,this.pdf.setLineJoin(he))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(he){isNaN(he)||(this.ctx.miterLimit=he,this.pdf.setMiterLimit(he))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(he){this.ctx.textBaseline=he}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(he){["right","end","center","left","start"].indexOf(he)!==-1&&(this.ctx.textAlign=he)}});var Le=null,ve=null;Object.defineProperty(this,"fontFaces",{get:function(){return ve},set:function(he){Le=null,ve=he}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(he){var V;if(this.ctx.font=he,(V=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(he))!==null){var Re=V[1];V[2];var xe=V[3],Ce=V[4];V[5];var fe=V[6],We=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ce)[2];Ce=Math.floor(We==="px"?parseFloat(Ce)*this.pdf.internal.scaleFactor:We==="em"?parseFloat(Ce)*this.pdf.getFontSize():parseFloat(Ce)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ce);var Oe=function(Ee){var Ne,Me,Ve=[],$e=Ee.trim();if($e==="")return fx;if($e in Lj)return[Lj[$e]];for(;$e!=="";){switch(Me=null,Ne=($e=Tj($e)).charAt(0)){case'"':case"'":Me=sV($e.substring(1),Ne);break;default:Me=iV($e)}if(Me===null||(Ve.push(Me[0]),($e=Tj(Me[1]))!==""&&$e.charAt(0)!==","))return fx;$e=$e.replace(/^,/,"")}return Ve}(fe);if(this.fontFaces){var nt=function(Ee,Ne){if(Le===null){var Me=function(Ve){var $e=[];return Object.keys(Ve).forEach(function(Ye){Ve[Ye].forEach(function(pt){var it=null;switch(pt){case"bold":it={family:Ye,weight:"bold"};break;case"italic":it={family:Ye,style:"italic"};break;case"bolditalic":it={family:Ye,weight:"bold",style:"italic"};break;case"":case"normal":it={family:Ye}}it!==null&&(it.ref={name:Ye,style:pt},$e.push(it))})}),$e}(Ee.getFontList());Le=function(Ve){for(var $e={},Ye=0;Ye<Ve.length;++Ye){var pt=hx(Ve[Ye]),it=pt.family,Je=pt.stretch,Xe=pt.style,At=pt.weight;$e[it]=$e[it]||{},$e[it][Je]=$e[it][Je]||{},$e[it][Je][Xe]=$e[it][Je][Xe]||{},$e[it][Je][Xe][At]=pt}return $e}(Me.concat(Ne))}return Le}(this.pdf,this.fontFaces),K=Oe.map(function(Ee){return{family:Ee,stretch:"normal",weight:xe,style:Re}}),be=function(Ee,Ne,Me){for(var Ve=(Me=Me||{}).defaultFontFamily||"times",$e=Object.assign({},nV,Me.genericFontFamilies||{}),Ye=null,pt=null,it=0;it<Ne.length;++it)if($e[(Ye=hx(Ne[it])).family]&&(Ye.family=$e[Ye.family]),Ee.hasOwnProperty(Ye.family)){pt=Ee[Ye.family];break}if(!(pt=pt||Ee[Ve]))throw new Error("Could not find a font-family for the rule '"+Pj(Ye)+"' and default family '"+Ve+"'.");if(pt=function(Je,Xe){if(Xe[Je])return Xe[Je];var At=xv[Je],Pt=At<=xv.normal?-1:1,Lt=Aj(Xe,_8,At,Pt);if(!Lt)throw new Error("Could not find a matching font-stretch value for "+Je);return Lt}(Ye.stretch,pt),pt=function(Je,Xe){if(Xe[Je])return Xe[Je];for(var At=w8[Je],Pt=0;Pt<At.length;++Pt)if(Xe[At[Pt]])return Xe[At[Pt]];throw new Error("Could not find a matching font-style for "+Je)}(Ye.style,pt),!(pt=function(Je,Xe){if(Xe[Je])return Xe[Je];if(Je===400&&Xe[500])return Xe[500];if(Je===500&&Xe[400])return Xe[400];var At=rV[Je],Pt=Aj(Xe,j8,At,Je<400?-1:1);if(!Pt)throw new Error("Could not find a matching font-weight for value "+Je);return Pt}(Ye.weight,pt)))throw new Error("Failed to resolve a font for the rule '"+Pj(Ye)+"'.");return pt}(nt,K);this.pdf.setFont(be.ref.name,be.ref.style)}else{var _e="";(xe==="bold"||parseInt(xe,10)>=700||Re==="bold")&&(_e="bold"),Re==="italic"&&(_e+="italic"),_e.length===0&&(_e="normal");for(var re="",De={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},se=0;se<Oe.length;se++){if(this.pdf.internal.getFont(Oe[se],_e,{noFallback:!0,disableWarning:!0})!==void 0){re=Oe[se];break}if(_e==="bolditalic"&&this.pdf.internal.getFont(Oe[se],"bold",{noFallback:!0,disableWarning:!0})!==void 0)re=Oe[se],_e="bold";else if(this.pdf.internal.getFont(Oe[se],"normal",{noFallback:!0,disableWarning:!0})!==void 0){re=Oe[se],_e="normal";break}}if(re===""){for(var Pe=0;Pe<Oe.length;Pe++)if(De[Oe[Pe]]){re=De[Oe[Pe]];break}}re=re===""?"Times":re,this.pdf.setFont(re,_e)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(he){this.ctx.globalCompositeOperation=he}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(he){this.ctx.globalAlpha=he}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(he){this.ctx.lineDashOffset=he,ue.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(he){this.ctx.lineDash=he,ue.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(he){this.ctx.ignoreClearRect=!!he}})};m.prototype.setLineDash=function(O){this.lineDash=O},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){S.call(this,"fill",!1)},m.prototype.stroke=function(){S.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(O,Z){if(isNaN(O)||isNaN(Z))throw _r.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new o(O,Z));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(O,Z)},m.prototype.closePath=function(){var O=new o(0,0),Z=0;for(Z=this.path.length-1;Z!==-1;Z--)if(this.path[Z].type==="begin"&&xr(this.path[Z+1])==="object"&&typeof this.path[Z+1].x=="number"){O=new o(this.path[Z+1].x,this.path[Z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},m.prototype.lineTo=function(O,Z){if(isNaN(O)||isNaN(Z))throw _r.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new o(O,Z));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(B.x,B.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},m.prototype.quadraticCurveTo=function(O,Z,B,ee){if(isNaN(B)||isNaN(ee)||isNaN(O)||isNaN(Z))throw _r.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(B,ee)),ne=this.ctx.transform.applyToPoint(new o(O,Z));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},m.prototype.bezierCurveTo=function(O,Z,B,ee,X,ne){if(isNaN(X)||isNaN(ne)||isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee))throw _r.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var le=this.ctx.transform.applyToPoint(new o(X,ne)),de=this.ctx.transform.applyToPoint(new o(O,Z)),je=this.ctx.transform.applyToPoint(new o(B,ee));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:je.x,y2:je.y,x:le.x,y:le.y}),this.ctx.lastPoint=new o(le.x,le.y)},m.prototype.arc=function(O,Z,B,ee,X,ne){if(isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee)||isNaN(X))throw _r.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var le=this.ctx.transform.applyToPoint(new o(O,Z));O=le.x,Z=le.y;var de=this.ctx.transform.applyToPoint(new o(0,B)),je=this.ctx.transform.applyToPoint(new o(0,0));B=Math.sqrt(Math.pow(de.x-je.x,2)+Math.pow(de.y-je.y,2))}Math.abs(X-ee)>=2*Math.PI&&(ee=0,X=2*Math.PI),this.path.push({type:"arc",x:O,y:Z,radius:B,startAngle:ee,endAngle:X,counterclockwise:ne})},m.prototype.arcTo=function(O,Z,B,ee,X){throw new Error("arcTo not implemented.")},m.prototype.rect=function(O,Z,B,ee){if(isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee))throw _r.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,Z),this.lineTo(O+B,Z),this.lineTo(O+B,Z+ee),this.lineTo(O,Z+ee),this.lineTo(O,Z),this.lineTo(O+B,Z),this.lineTo(O,Z)},m.prototype.fillRect=function(O,Z,B,ee){if(isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee))throw _r.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,Z,B,ee),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},m.prototype.strokeRect=function(O,Z,B,ee){if(isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee))throw _r.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(O,Z,B,ee),this.stroke())},m.prototype.clearRect=function(O,Z,B,ee){if(isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee))throw _r.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,Z,B,ee))},m.prototype.save=function(O){O=typeof O!="boolean"||O;for(var Z=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(Z),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var ee=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ee}},m.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var Z=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(Z),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(O){var Z,B,ee,X;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))Z=0,B=0,ee=0,X=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(ne!==null)Z=parseInt(ne[1]),B=parseInt(ne[2]),ee=parseInt(ne[3]),X=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)Z=parseInt(ne[1]),B=parseInt(ne[2]),ee=parseInt(ne[3]),X=parseFloat(ne[4]);else{if(X=1,typeof O=="string"&&O.charAt(0)!=="#"){var le=new m8(O);O=le.ok?le.toHex():"#000000"}O.length===4?(Z=O.substring(1,2),Z+=Z,B=O.substring(2,3),B+=B,ee=O.substring(3,4),ee+=ee):(Z=O.substring(1,3),B=O.substring(3,5),ee=O.substring(5,7)),Z=parseInt(Z,16),B=parseInt(B,16),ee=parseInt(ee,16)}}return{r:Z,g:B,b:ee,a:X,style:O}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(O,Z,B,ee){if(isNaN(Z)||isNaN(B)||typeof O!="string")throw _r.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ee=isNaN(ee)?void 0:ee,!h.call(this)){var X=M(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;P.call(this,{text:O,x:Z,y:B,scale:ne,angle:X,align:this.textAlign,maxWidth:ee})}},m.prototype.strokeText=function(O,Z,B,ee){if(isNaN(Z)||isNaN(B)||typeof O!="string")throw _r.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){ee=isNaN(ee)?void 0:ee;var X=M(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;P.call(this,{text:O,x:Z,y:B,scale:ne,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:ee})}},m.prototype.measureText=function(O){if(typeof O!="string")throw _r.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Z=this.pdf,B=this.pdf.internal.scaleFactor,ee=Z.internal.getFontSize(),X=Z.getStringUnitWidth(O)*ee/Z.internal.scaleFactor;return new function(ne){var le=(ne=ne||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return le}}),this}({width:X*=Math.round(96*B/72*1e4)/1e4})},m.prototype.scale=function(O,Z){if(isNaN(O)||isNaN(Z))throw _r.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new c(O,0,0,Z,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},m.prototype.rotate=function(O){if(isNaN(O))throw _r.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Z=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(Z)},m.prototype.translate=function(O,Z){if(isNaN(O)||isNaN(Z))throw _r.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new c(1,0,0,1,O,Z);this.ctx.transform=this.ctx.transform.multiply(B)},m.prototype.transform=function(O,Z,B,ee,X,ne){if(isNaN(O)||isNaN(Z)||isNaN(B)||isNaN(ee)||isNaN(X)||isNaN(ne))throw _r.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var le=new c(O,Z,B,ee,X,ne);this.ctx.transform=this.ctx.transform.multiply(le)},m.prototype.setTransform=function(O,Z,B,ee,X,ne){O=isNaN(O)?1:O,Z=isNaN(Z)?0:Z,B=isNaN(B)?0:B,ee=isNaN(ee)?1:ee,X=isNaN(X)?0:X,ne=isNaN(ne)?0:ne,this.ctx.transform=new c(O,Z,B,ee,X,ne)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(O,Z,B,ee,X,ne,le,de,je){var me=this.pdf.getImageProperties(O),Le=1,ve=1,he=1,V=1;ee!==void 0&&de!==void 0&&(he=de/ee,V=je/X,Le=me.width/ee*de/ee,ve=me.height/X*je/X),ne===void 0&&(ne=Z,le=B,Z=0,B=0),ee!==void 0&&de===void 0&&(de=ee,je=X),ee===void 0&&de===void 0&&(de=me.width,je=me.height);for(var Re,xe=this.ctx.transform.decompose(),Ce=M(xe.rotate.shx),fe=new c,We=(fe=(fe=(fe=fe.multiply(xe.translate)).multiply(xe.skew)).multiply(xe.scale)).applyToRectangle(new l(ne-Z*he,le-B*V,ee*Le,X*ve)),Oe=j.call(this,We),nt=[],K=0;K<Oe.length;K+=1)nt.indexOf(Oe[K])===-1&&nt.push(Oe[K]);if(w(nt),this.autoPaging)for(var be=nt[0],_e=nt[nt.length-1],re=be;re<_e+1;re++){this.pdf.setPage(re);var De=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],se=re===1?this.posY+this.margin[0]:this.margin[0],Pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ee=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ne=re===1?0:Pe+(re-2)*Ee;if(this.ctx.clip_path.length!==0){var Me=this.path;Re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(Re,this.posX+this.margin[3],-Ne+se+this.ctx.prevPageLastElemOffset),E.call(this,"fill",!0),this.path=Me}var Ve=JSON.parse(JSON.stringify(We));Ve=_([Ve],this.posX+this.margin[3],-Ne+se+this.ctx.prevPageLastElemOffset)[0];var $e=(re>be||re<_e)&&b.call(this);$e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],De,Ee,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",Ve.x,Ve.y,Ve.w,Ve.h,null,null,Ce),$e&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(O,"JPEG",We.x,We.y,We.w,We.h,null,null,Ce)};var j=function(O,Z,B){var ee=[];Z=Z||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":ee.push(Math.floor((O.y+X)/B)+1);break;case"arc":ee.push(Math.floor((O.y+X-O.radius)/B)+1),ee.push(Math.floor((O.y+X+O.radius)/B)+1);break;case"qct":var ne=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);ee.push(Math.floor((ne.y+X)/B)+1),ee.push(Math.floor((ne.y+ne.h+X)/B)+1);break;case"bct":var le=ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);ee.push(Math.floor((le.y+X)/B)+1),ee.push(Math.floor((le.y+le.h+X)/B)+1);break;case"rect":ee.push(Math.floor((O.y+X)/B)+1),ee.push(Math.floor((O.y+O.h+X)/B)+1)}for(var de=0;de<ee.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<ee[de];)y.call(this);return ee},y=function(){var O=this.fillStyle,Z=this.strokeStyle,B=this.font,ee=this.lineCap,X=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=Z,this.font=B,this.lineCap=ee,this.lineWidth=X,this.lineJoin=ne},_=function(O,Z,B){for(var ee=0;ee<O.length;ee++)switch(O[ee].type){case"bct":O[ee].x2+=Z,O[ee].y2+=B;case"qct":O[ee].x1+=Z,O[ee].y1+=B;default:O[ee].x+=Z,O[ee].y+=B}return O},w=function(O){return O.sort(function(Z,B){return Z-B})},S=function(O,Z){for(var B,ee,X=this.fillStyle,ne=this.strokeStyle,le=this.lineCap,de=this.lineWidth,je=Math.abs(de*this.ctx.transform.scaleX),me=this.lineJoin,Le=JSON.parse(JSON.stringify(this.path)),ve=JSON.parse(JSON.stringify(this.path)),he=[],V=0;V<ve.length;V++)if(ve[V].x!==void 0)for(var Re=j.call(this,ve[V]),xe=0;xe<Re.length;xe+=1)he.indexOf(Re[xe])===-1&&he.push(Re[xe]);for(var Ce=0;Ce<he.length;Ce++)for(;this.pdf.internal.getNumberOfPages()<he[Ce];)y.call(this);if(w(he),this.autoPaging)for(var fe=he[0],We=he[he.length-1],Oe=fe;Oe<We+1;Oe++){this.pdf.setPage(Oe),this.fillStyle=X,this.strokeStyle=ne,this.lineCap=le,this.lineWidth=je,this.lineJoin=me;var nt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],K=Oe===1?this.posY+this.margin[0]:this.margin[0],be=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],re=Oe===1?0:be+(Oe-2)*_e;if(this.ctx.clip_path.length!==0){var De=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(B,this.posX+this.margin[3],-re+K+this.ctx.prevPageLastElemOffset),E.call(this,O,!0),this.path=De}if(ee=JSON.parse(JSON.stringify(Le)),this.path=_(ee,this.posX+this.margin[3],-re+K+this.ctx.prevPageLastElemOffset),Z===!1||Oe===0){var se=(Oe>fe||Oe<We)&&b.call(this);se&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nt,_e,null).clip().discardPath()),E.call(this,O,Z),se&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=je,E.call(this,O,Z),this.lineWidth=de;this.path=Le},E=function(O,Z){if((O!=="stroke"||Z||!x.call(this))&&(O==="stroke"||Z||!h.call(this))){for(var B,ee,X=[],ne=this.path,le=0;le<ne.length;le++){var de=ne[le];switch(de.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:de,deltas:[],abs:[]});break;case"lt":var je=X.length;if(ne[le-1]&&!isNaN(ne[le-1].x)&&(B=[de.x-ne[le-1].x,de.y-ne[le-1].y],je>0)){for(;je>=0;je--)if(X[je-1].close!==!0&&X[je-1].begin!==!0){X[je-1].deltas.push(B),X[je-1].abs.push(de);break}}break;case"bct":B=[de.x1-ne[le-1].x,de.y1-ne[le-1].y,de.x2-ne[le-1].x,de.y2-ne[le-1].y,de.x-ne[le-1].x,de.y-ne[le-1].y],X[X.length-1].deltas.push(B);break;case"qct":var me=ne[le-1].x+2/3*(de.x1-ne[le-1].x),Le=ne[le-1].y+2/3*(de.y1-ne[le-1].y),ve=de.x+2/3*(de.x1-de.x),he=de.y+2/3*(de.y1-de.y),V=de.x,Re=de.y;B=[me-ne[le-1].x,Le-ne[le-1].y,ve-ne[le-1].x,he-ne[le-1].y,V-ne[le-1].x,Re-ne[le-1].y],X[X.length-1].deltas.push(B);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(de)}}ee=Z?null:O==="stroke"?"stroke":"fill";for(var xe=!1,Ce=0;Ce<X.length;Ce++)if(X[Ce].arc)for(var fe=X[Ce].abs,We=0;We<fe.length;We++){var Oe=fe[We];Oe.type==="arc"?I.call(this,Oe.x,Oe.y,Oe.radius,Oe.startAngle,Oe.endAngle,Oe.counterclockwise,void 0,Z,!xe):F.call(this,Oe.x,Oe.y),xe=!0}else if(X[Ce].close===!0)this.pdf.internal.out("h"),xe=!1;else if(X[Ce].begin!==!0){var nt=X[Ce].start.x,K=X[Ce].start.y;A.call(this,X[Ce].deltas,nt,K),xe=!0}ee&&T.call(this,ee),Z&&D.call(this)}},$=function(O){var Z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=Z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-B;case"top":return O+Z-B;case"hanging":return O+Z-2*B;case"middle":return O+Z/2-B;default:return O}},U=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(Z,B){this.colorStops.push([Z,B])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(O,Z,B,ee,X,ne,le,de,je){for(var me=H.call(this,B,ee,X,ne),Le=0;Le<me.length;Le++){var ve=me[Le];Le===0&&(je?C.call(this,ve.x1+O,ve.y1+Z):F.call(this,ve.x1+O,ve.y1+Z)),R.call(this,O,Z,ve.x2,ve.y2,ve.x3,ve.y3,ve.x4,ve.y4)}de?D.call(this):T.call(this,le)},T=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},D=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(O,Z){this.pdf.internal.out(r(O)+" "+n(Z)+" m")},P=function(O){var Z;switch(O.align){case"right":case"end":Z="right";break;case"center":Z="center";break;default:Z="left"}var B=this.pdf.getTextDimensions(O.text),ee=$.call(this,O.y),X=U.call(this,ee)-B.h,ne=this.ctx.transform.applyToPoint(new o(O.x,ee)),le=this.ctx.transform.decompose(),de=new c;de=(de=(de=de.multiply(le.translate)).multiply(le.skew)).multiply(le.scale);for(var je,me,Le,ve=this.ctx.transform.applyToRectangle(new l(O.x,ee,B.w,B.h)),he=de.applyToRectangle(new l(O.x,X,B.w,B.h)),V=j.call(this,he),Re=[],xe=0;xe<V.length;xe+=1)Re.indexOf(V[xe])===-1&&Re.push(V[xe]);if(w(Re),this.autoPaging)for(var Ce=Re[0],fe=Re[Re.length-1],We=Ce;We<fe+1;We++){this.pdf.setPage(We);var Oe=We===1?this.posY+this.margin[0]:this.margin[0],nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],K=this.pdf.internal.pageSize.height-this.margin[2],be=K-this.margin[0],_e=this.pdf.internal.pageSize.width-this.margin[1],re=_e-this.margin[3],De=We===1?0:nt+(We-2)*be;if(this.ctx.clip_path.length!==0){var se=this.path;je=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(je,this.posX+this.margin[3],-1*De+Oe),E.call(this,"fill",!0),this.path=se}var Pe=_([JSON.parse(JSON.stringify(he))],this.posX+this.margin[3],-De+Oe+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(me*O.scale),Le=this.lineWidth,this.lineWidth=Le*O.scale);var Ee=this.autoPaging!=="text";if(Ee||Pe.y+Pe.h<=K){if(Ee||Pe.y>=Oe&&Pe.x<=_e){var Ne=Ee?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||_e-Pe.x)[0],Me=_([JSON.parse(JSON.stringify(ve))],this.posX+this.margin[3],-De+Oe+this.ctx.prevPageLastElemOffset)[0],Ve=Ee&&(We>Ce||We<fe)&&b.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],re,be,null).clip().discardPath()),this.pdf.text(Ne,Me.x,Me.y,{angle:O.angle,align:Z,renderingMode:O.renderingMode}),Ve&&this.pdf.restoreGraphicsState()}}else Pe.y<K&&(this.ctx.prevPageLastElemOffset+=K-Pe.y);O.scale>=.01&&(this.pdf.setFontSize(me),this.lineWidth=Le)}else O.scale>=.01&&(me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(me*O.scale),Le=this.lineWidth,this.lineWidth=Le*O.scale),this.pdf.text(O.text,ne.x+this.posX,ne.y+this.posY,{angle:O.angle,align:Z,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(me),this.lineWidth=Le)},F=function(O,Z,B,ee){B=B||0,ee=ee||0,this.pdf.internal.out(r(O+B)+" "+n(Z+ee)+" l")},A=function(O,Z,B){return this.pdf.lines(O,Z,B,null,null)},R=function(O,Z,B,ee,X,ne,le,de){this.pdf.internal.out([t(s(B+O)),t(i(ee+Z)),t(s(X+O)),t(i(ne+Z)),t(s(le+O)),t(i(de+Z)),"c"].join(" "))},H=function(O,Z,B,ee){for(var X=2*Math.PI,ne=Math.PI/2;Z>B;)Z-=X;var le=Math.abs(B-Z);le<X&&ee&&(le=X-le);for(var de=[],je=ee?-1:1,me=Z;le>1e-5;){var Le=me+je*Math.min(le,ne);de.push(W.call(this,O,me,Le)),le-=Math.abs(Le-me),me=Le}return de},W=function(O,Z,B){var ee=(B-Z)/2,X=O*Math.cos(ee),ne=O*Math.sin(ee),le=X,de=-ne,je=le*le+de*de,me=je+le*X+de*ne,Le=4/3*(Math.sqrt(2*je*me)-me)/(le*ne-de*X),ve=le-Le*de,he=de+Le*le,V=ve,Re=-he,xe=ee+Z,Ce=Math.cos(xe),fe=Math.sin(xe);return{x1:O*Math.cos(Z),y1:O*Math.sin(Z),x2:ve*Ce-he*fe,y2:ve*fe+he*Ce,x3:V*Ce-Re*fe,y3:V*fe+Re*Ce,x4:O*Math.cos(B),y4:O*Math.sin(B)}},M=function(O){return 180*O/Math.PI},G=function(O,Z,B,ee,X,ne){var le=O+.5*(B-O),de=Z+.5*(ee-Z),je=X+.5*(B-X),me=ne+.5*(ee-ne),Le=Math.min(O,X,le,je),ve=Math.max(O,X,le,je),he=Math.min(Z,ne,de,me),V=Math.max(Z,ne,de,me);return new l(Le,he,ve-Le,V-he)},ce=function(O,Z,B,ee,X,ne,le,de){var je,me,Le,ve,he,V,Re,xe,Ce,fe,We,Oe,nt,K,be=B-O,_e=ee-Z,re=X-B,De=ne-ee,se=le-X,Pe=de-ne;for(me=0;me<41;me++)Ce=(Re=(Le=O+(je=me/40)*be)+je*((he=B+je*re)-Le))+je*(he+je*(X+je*se-he)-Re),fe=(xe=(ve=Z+je*_e)+je*((V=ee+je*De)-ve))+je*(V+je*(ne+je*Pe-V)-xe),me==0?(We=Ce,Oe=fe,nt=Ce,K=fe):(We=Math.min(We,Ce),Oe=Math.min(Oe,fe),nt=Math.max(nt,Ce),K=Math.max(K,fe));return new l(Math.round(We),Math.round(Oe),Math.round(nt-We),Math.round(K-Oe))},ue=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,Z,B=(O=this.ctx.lineDash,Z=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:Z}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(Et.API),function(e){var t=function(o){var l,c,u,d,m,f,h,x,b,j;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(m=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(f=(m=((m=((m=((m=(m-(j=m%85))/85)-(b=m%85))/85)-(x=m%85))/85)-(h=m%85))/85)%85,c.push(f+33,h+33,x+33,b+33,j+33)):c.push(122);return function(y,_){for(var w=_;w>0;w--)y.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,m,f=String,h="length",x=255,b="charCodeAt",j="slice",y="replace";for(o[j](-2),o=o[j](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),u=[],d=0,m=(o+=l="uuuuu"[j](o[h]%5||5))[h];m>d;d+=5)c=52200625*(o[b](d)-33)+614125*(o[b](d+1)-33)+7225*(o[b](d+2)-33)+85*(o[b](d+3)-33)+(o[b](d+4)-33),u.push(x&c>>24,x&c>>16,x&c>>8,x&c);return function(_,w){for(var S=w;S>0;S--)_.pop()}(u,l[h]),f.fromCharCode.apply(f,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=sv(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=s(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Et.API),function(e){e.loadFile=function(t,r,n){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var m=new XMLHttpRequest,f=0,h=function(x){var b=x.length,j=[],y=String.fromCharCode;for(f=0;f<b;f+=1)j.push(y(255&x.charCodeAt(f)));return j.join("")};if(m.open("GET",c,!u),m.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(m.onload=function(){m.status===200?d(h(this.responseText)):d(void 0)}),m.send(null),u&&m.status===200)return h(m.responseText)}(s,i,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Et.API),function(e){function t(){return(Ot.html2canvas?Promise.resolve(Ot.html2canvas):ao(()=>import("./html2canvas.esm-e0a7d97b.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Ot.DOMPurify?Promise.resolve(Ot.DOMPurify):ao(()=>import("./purify.es-fd086bfc.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=xr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},i=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),m=c.firstChild;m;m=m.nextSibling)u!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||d.appendChild(l(m,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:s("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var x=d[h],b=x.src.find(function(j){return j.format==="truetype"});b&&u.addFont(b.url,x.ref.name,x.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,u.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Et.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,m){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(f){return u.updateProgress(null,d),f}).then(d,m).then(function(f){return u.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),f=u.call(m,l,c);return o.convert(f,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Et.getPageSize=function(l,c,u){if(xr(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var m,f=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+c}var x,b=0,j=0;if(h.hasOwnProperty(f))b=h[f][1]/m,j=h[f][0]/m;else try{b=u[1],j=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",j>b&&(x=j,j=b,b=x);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",b>j&&(x=j,j=b,b=x)}return{width:j,height:b,unit:c,k:m,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(hx):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Et.API),Et.API.addJS=function(e){return Mj=e,this.internal.events.subscribe("postPutResources",function(){s0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(s0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Ij=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Mj+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){s0!==void 0&&Ij!==void 0&&this.internal.out("/Names <</JavaScript "+s0+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var m=r.internal.newObject();d.push(m);var f=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var o={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(Et.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,i,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(m){for(var f,h=256*m.charCodeAt(4)+m.charCodeAt(5),x=m.length,b={width:0,height:0,numcomponents:1},j=4;j<x;j+=2){if(j+=h,t.indexOf(m.charCodeAt(j+1))!==-1){f=256*m.charCodeAt(j+5)+m.charCodeAt(j+6),b={width:256*m.charCodeAt(j+7)+m.charCodeAt(j+8),height:f,numcomponents:m.charCodeAt(j+9)};break}h=256*m.charCodeAt(j+2)+m.charCodeAt(j+3)}return b}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(Et.API),Et.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,i=zq(e,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,u=i.palette,d=i.depth;s=u&&c===1?function(I){for(var T=I.width,D=I.height,C=I.data,P=I.palette,F=I.depth,A=!1,R=[],H=[],W=void 0,M=!1,G=0,ce=0;ce<P.length;ce++){var ue=E4(P[ce],4),O=ue[0],Z=ue[1],B=ue[2],ee=ue[3];R.push(O,Z,B),ee!=null&&(ee===0?(G++,H.length<1&&H.push(ce)):ee<255&&(M=!0))}if(M||G>1){A=!0,H=void 0;var X=T*D;W=new Uint8Array(X);for(var ne=new DataView(C.buffer),le=0;le<X;le++){var de=mx(ne,le,F),je=E4(P[de],4)[3];W[le]=je}}else G===0&&(H=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:A?8:void 0,colorBytes:C,alphaBytes:W,needSMask:A,palette:R,mask:H}}(i):c===2||c===4?function(I){for(var T=I.data,D=I.width,C=I.height,P=I.channels,F=I.depth,A=P===2?"DeviceGray":"DeviceRGB",R=P-1,H=D*C,W=R,M=H*W,G=1*H,ce=Math.ceil(M*F/8),ue=Math.ceil(G*F/8),O=new Uint8Array(ce),Z=new Uint8Array(ue),B=new DataView(T.buffer),ee=new DataView(O.buffer),X=new DataView(Z.buffer),ne=!1,le=0;le<H;le++){for(var de=le*P,je=0;je<W;je++)qj(ee,mx(B,de+je,F),le*W+je,F);var me=mx(B,de+W,F);me<(1<<F)-1&&(ne=!0),qj(X,me,1*le,F)}return{colorSpace:A,colorsPerPixel:R,sMaskBitsPerComponent:ne?F:void 0,colorBytes:O,alphaBytes:Z,needSMask:ne}}(i):function(I){var T=I.data,D=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:D,colorsPerPixel:D==="DeviceGray"?1:3,colorBytes:T instanceof Uint16Array?function(C){for(var P=C.length,F=new Uint8Array(2*P),A=new DataView(F.buffer,F.byteOffset,F.byteLength),R=0;R<P;R++)A.setUint16(2*R,C[R],!1);return F}(T):T,needSMask:!1}}(i);var m,f,h,x=s,b=x.colorSpace,j=x.colorsPerPixel,y=x.sMaskBitsPerComponent,_=x.colorBytes,w=x.alphaBytes,S=x.needSMask,E=x.palette,$=x.mask,U=null;return n!==Et.API.image_compression.NONE&&typeof sv=="function"?(U=function(I){var T;switch(I){case Et.API.image_compression.FAST:T=11;break;case Et.API.image_compression.MEDIUM:T=13;break;case Et.API.image_compression.SLOW:T=14;break;default:T=12}return T}(n),m=this.decode.FLATE_DECODE,f="/Predictor ".concat(U," /Colors ").concat(j," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=Dj(_,Math.ceil(o*j*d/8),j,d,n),S&&(h=Dj(w,Math.ceil(o*y/8),1,y,n))):(m=void 0,f=void 0,e=_,S&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:m,decodeParameters:f,transparency:$,palette:E,sMask:h,predictor:U,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:y,colorSpace:b}}},function(e){e.processGIF89A=function(t,r,n,s){var i=new cV(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new px(100).encode(u,100);return e.processJPEG.call(this,d,r,n,s)},e.processGIF87A=e.processGIF89A}(Et.API),zi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){_r.log("bit decode error:"+r)}},zi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},zi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=i>>4,c=15&i,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},zi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},zi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},zi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=s*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},zi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},zi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},zi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var i=new zi(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new px(100).encode(c,100);return e.processJPEG.call(this,u,r,n,s)}}(Et.API),Wj.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var i=new Wj(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new px(100).encode(c,100);return e.processJPEG.call(this,u,r,n,s)}}(Et.API),Et.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var d=n[u],m=n[u+1],f=n[u+2],h=n[u+3];i[l++]=d,i[l++]=m,i[l++]=f,o[c++]=h}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Et.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},du=Et.API,i0=du.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,m=t.doKerning!==!1,f=0,h=e.length,x=0,b=l[0]||c,j=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?j.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(f=m&&xr(u[n])==="object"&&!isNaN(parseInt(u[n][x],10))?u[n][x]/d:0,j.push((l[n]||b)/c+f)),x=n;return j},Oj=du.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return du.processArabic&&(e=du.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:i0.apply(this,arguments).reduce(function(i,o){return i+o},0)},Rj=function(e,t,r,n){for(var s=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;s.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>n&&(s.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},Fj=function(e,t,r){r||(r={});var n,s,i,o,l,c,u,d=[],m=[d],f=r.textIndent||0,h=0,x=0,b=e.split(" "),j=i0.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?b[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),_=[];b.map(function(S){(S=S.split(/\s*\n/)).length>1?_=_.concat(S.map(function(E,$){return($&&E.length?`
`:"")+E})):_.push(S[0])}),b=_,c=Oj.apply(this,[y,r])}for(i=0,o=b.length;i<o;i++){var w=0;if(n=b[i],c&&n[0]==`
`&&(n=n.substr(1),w=1),f+h+(x=(s=i0.apply(this,[n,r])).reduce(function(S,E){return S+E},0))>t||w){if(x>t){for(l=Rj.apply(this,[n,s,t-(f+h),t]),d.push(l.shift()),d=[l.pop()];l.length;)m.push([l.shift()]);x=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(S,E){return S+E},0)}else d=[n];m.push(d),f=x+c,h=j}else d.push(n),f+=h+x,h=j}return u=c?function(S,E){return(E?y:"")+S.join(" ")}:function(S){return S.join(" ")},m.map(u)},du.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var m=this.internal.getFont(d.fontName,d.fontStyle),f="Unicode";return m.metadata[f]?{widths:m.metadata[f].widths||{0:1},kerning:m.metadata[f].kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(Fj.apply(this,[n[l],o,i]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},i=0;i<16;i++)n[r[i]]=t[i],s[t[i]]=r[i];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=e.__fontmetrics__.compress=function(f){var h,x,b,j,y=["{"];for(var _ in f){if(h=f[_],isNaN(parseInt(_,10))?x="'"+_+"'":(_=parseInt(_,10),x=(x=o(_).slice(2)).slice(0,-1)+s[x.slice(-1)]),typeof h=="number")h<0?(b=o(h).slice(3),j="-"):(b=o(h).slice(2),j=""),b=j+b.slice(0,-1)+s[b.slice(-1)];else{if(xr(h)!=="object")throw new Error("Don't know what to do with value type "+xr(h)+".");b=l(h)}y.push(x+b)}return y.push("}"),y.join("")},c=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,x,b,j,y={},_=1,w=y,S=[],E="",$="",U=f.length-1,I=1;I<U;I+=1)(j=f[I])=="'"?h?(b=h.join(""),h=void 0):h=[]:h?h.push(j):j=="{"?(S.push([w,b]),w={},b=void 0):j=="}"?((x=S.pop())[0][x[1]]=w,b=void 0,w=x[0]):j=="-"?_=-1:b===void 0?n.hasOwnProperty(j)?(E+=n[j],b=parseInt(E,16)*_,_=1,E=""):E+=j:n.hasOwnProperty(j)?($+=n[j],w[b]=parseInt($,16)*_,_=1,b=void 0,$=""):$+=j;return y},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},m={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var h=f.font,x=m.Unicode[h.postScriptName];x&&(h.metadata.Unicode={},h.metadata.Unicode.widths=x.widths,h.metadata.Unicode.kerning=x.kerning);var b=d.Unicode[h.postScriptName];b&&(h.metadata.Unicode.encoding=b,h.encoding=b.codePages[0])}])}(Et.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(L0(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(Et),Et.API.addSvgAsImage=function(e,t,r,n,s,i,o,l){if(isNaN(t)||isNaN(r))throw _r.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw _r.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return(Ot.canvg?Promise.resolve(Ot.canvg):ao(()=>import("./index.es-d026dc9b.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(d)}).then(function(){m.addImage(c.toDataURL("image/jpeg",1),t,r,n,s,o,l)})},Et.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},Et.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,m=0;function f(x,b){var j,y=!1;for(j=0;j<x.length;j+=1)x[j]===b&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(m=0;m<h;m+=1)r[l[m]].value=r[l[m]].defaultValue,r[l[m]].explicitSet=!1}if(xr(e)==="object"){for(s in e)if(i=e[s],f(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&f(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,b=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?b.push("/"+x+" /"+r[x].value):b.push("/"+x+" "+r[x].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Et.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],m=0,f=i.length;m<f;++m){if(l=o.metadata.characterToGlyph(i.charCodeAt(m)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(m),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(i){var o,l,c,u,d,m,f;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,f=(l=Object.keys(i).sort(function(h,x){return h-x})).length;m<f;m++)o=l[m],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(u=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var m=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",x=0;x<f.length;x++)h+=String.fromCharCode(f[x]);var b=u();d({data:h,addLength1:!0,objectId:b}),c("endobj");var j=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:j}),c("endobj");var y=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+gu(l.fontName)),c("/FontFile2 "+b+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var _=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+gu(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+e.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+j+" 0 R"),c("/BaseFont /"+gu(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+_+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var m=l.metadata.rawData,f="",h=0;h<m.length;h++)f+=String.fromCharCode(m[h]);var x=u();d({data:f,addLength1:!0,objectId:x}),c("endobj");var b=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var j=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+gu(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+gu(l.fontName)+"/FontDescriptor "+j+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,u=i.y,d=i.options||{},m=i.mutex||{},f=m.pdfEscape,h=m.activeFontKey,x=m.fonts,b=h,j="",y=0,_="",w=x[b].encoding;if(x[b].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:m};for(_=l,b=h,Array.isArray(l)&&(_=l[0]),y=0;y<_.length;y+=1)x[b].metadata.hasOwnProperty("cmap")&&(o=x[b].metadata.cmap.unicode.codeMap[_[y].charCodeAt(0)]),o||_[y].charCodeAt(0)<256&&x[b].metadata.hasOwnProperty("Unicode")?j+=_[y]:j+="";var S="";return parseInt(b.slice(1))<14||w==="WinAnsiEncoding"?S=f(j,b).split("").map(function(E){return E.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(j,x[b])),m.isHex=!0,{text:S,x:c,y:u,options:d,mutex:m}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([s(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(s(Object.assign({},c,{text:o[u]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(Et),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Et.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,i,o,l,c,u,d,m=t,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},j=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,w=0;this.__bidiEngine__={};var S=function(C){var P=C.charCodeAt(),F=P>>8,A=b[F];return A!==void 0?m[256*A+(255&P)]:F===252||F===253?"AL":y.test(F)?"L":F===8?"R":"N"},E=function(C){for(var P,F=0;F<C.length;F++){if((P=S(C.charAt(F)))==="L")return!1;if(P==="R")return!0}return!1},$=function(C,P,F,A){var R,H,W,M,G=P[A];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"N":case"AN":break;case"EN":_&&(G="AN");break;case"AL":_=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":A<1||A+1>=P.length||(R=F[A-1])!=="EN"&&R!=="AN"||(H=P[A+1])!=="EN"&&H!=="AN"?G="N":_&&(H="AN"),G=H===R?H:"N";break;case"ES":G=(R=A>0?F[A-1]:"B")==="EN"&&A+1<P.length&&P[A+1]==="EN"?"EN":"N";break;case"ET":if(A>0&&F[A-1]==="EN"){G="EN";break}if(_){G="N";break}for(W=A+1,M=P.length;W<M&&P[W]==="ET";)W++;G=W<M&&P[W]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(M=P.length,W=A+1;W<M&&P[W]==="NSM";)W++;if(W<M){var ce=C[A],ue=ce>=1425&&ce<=2303||ce===64286;if(R=P[W],ue&&(R==="R"||R==="AL")){G="R";break}}}G=A<1||(R=P[A-1])==="B"?"N":F[A-1];break;case"B":_=!1,s=!0,G=w;break;case"S":i=!0,G="N"}return G},U=function(C,P,F){var A=C.split("");return F&&I(A,F,{hiLevel:w}),A.reverse(),P&&P.reverse(),A.join("")},I=function(C,P,F){var A,R,H,W,M,G=-1,ce=C.length,ue=0,O=[],Z=w?h:f,B=[];for(_=!1,s=!1,i=!1,R=0;R<ce;R++)B[R]=S(C[R]);for(H=0;H<ce;H++){if(M=ue,O[H]=$(C,B,O,H),A=240&(ue=Z[M][x[O[H]]]),ue&=15,P[H]=W=Z[ue][5],A>0)if(A===16){for(R=G;R<H;R++)P[R]=1;G=-1}else G=-1;if(Z[ue][6])G===-1&&(G=H);else if(G>-1){for(R=G;R<H;R++)P[R]=W;G=-1}B[H]==="B"&&(P[H]=0),F.hiLevel|=W}i&&function(ee,X,ne){for(var le=0;le<ne;le++)if(ee[le]==="S"){X[le]=w;for(var de=le-1;de>=0&&ee[de]==="WS";de--)X[de]=w}}(B,P,ce)},T=function(C,P,F,A,R){if(!(R.hiLevel<C)){if(C===1&&w===1&&!s)return P.reverse(),void(F&&F.reverse());for(var H,W,M,G,ce=P.length,ue=0;ue<ce;){if(A[ue]>=C){for(M=ue+1;M<ce&&A[M]>=C;)M++;for(G=ue,W=M-1;G<W;G++,W--)H=P[G],P[G]=P[W],P[W]=H,F&&(H=F[G],F[G]=F[W],F[W]=H);ue=M}ue++}}},D=function(C,P,F){var A=C.split(""),R={hiLevel:w};return F||(F=[]),I(A,F,R),function(H,W,M){if(M.hiLevel!==0&&d)for(var G,ce=0;ce<H.length;ce++)W[ce]===1&&(G=j.indexOf(H[ce]))>=0&&(H[ce]=j[G+1])}(A,F,R),T(2,A,P,F,R),T(1,A,P,F,R),A.join("")};return this.__bidiEngine__.doBidiReorder=function(C,P,F){if(function(R,H){if(H)for(var W=0;W<R.length;W++)H[W]=W;l===void 0&&(l=E(R)),u===void 0&&(u=E(R))}(C,P),o||!c||u)if(o&&c&&l^u)w=l?1:0,C=U(C,P,F);else if(!o&&c&&u)w=l?1:0,C=D(C,P,F),C=U(C,P);else if(!o||l||c||u){if(o&&!c&&l^u)C=U(C,P),l?(w=0,C=D(C,P,F)):(w=1,C=D(C,P,F),C=U(C,P));else if(o&&l&&!c&&u)w=1,C=D(C,P,F),C=U(C,P);else if(!o&&!c&&l^u){var A=d;l?(w=1,C=D(C,P,F),w=0,d=!1,C=D(C,P,F),d=A):(w=0,C=D(C,P,F),C=U(C,P),w=1,d=!1,C=D(C,P,F),d=A,C=U(C,P))}}else w=0,C=D(C,P,F);else w=l?1:0,C=D(C,P,F);return C},this.__bidiEngine__.setOptions=function(C){C&&(o=C.isInputVisual,c=C.isOutputVisual,l=C.isInputRtl,u=C.isOutputRtl,d=C.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Et),Et.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Sl(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new NV(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new uV(this.contents),this.head=new hV(this),this.name=new xV(this),this.cmap=new S8(this),this.toUnicode={},this.hhea=new fV(this),this.maxp=new vV(this),this.hmtx=new yV(this),this.post=new pV(this),this.os2=new mV(this),this.loca=new jV(this),this.glyf=new bV(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var sa,Sl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,i,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,i;for(i=[],n=0,s=t.length;n<s;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),uV=function(){var e;function t(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,i,o,l,c,u,d,m,f,h,x,b;for(b in h=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(h)/c),o=Math.floor(m/c),d=16*h-m,(s=new Sl).writeInt(this.scalarType),s.writeShort(h),s.writeShort(m),s.writeShort(o),s.writeShort(d),i=16*h,u=s.pos+i,l=null,x=[],r)for(f=r[b],s.writeString(b),s.writeInt(e(f)),s.writeInt(u),s.writeInt(f.length),x=x.concat(f),b==="head"&&(l=u),u+=f.length;u%4;)x.push(0),u++;return s.write(x),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,i,o;for(r=k8.call(r);r.length%4;)r.push(0);for(i=new Sl(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=i.readUInt32();return 4294967295&s},t}(),dV={}.hasOwnProperty,Ia=function(e,t){for(var r in t)dV.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};sa=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var hV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Sl).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Hj=function(){function e(t,r){var n,s,i,o,l,c,u,d,m,f,h,x,b,j,y,_,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),m=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),f=h/2,t.pos+=6,i=function(){var S,E;for(E=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)E.push(t.readUInt16());return E}(),t.pos+=2,b=function(){var S,E;for(E=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)E.push(t.readUInt16());return E}(),u=function(){var S,E;for(E=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)E.push(t.readUInt16());return E}(),d=function(){var S,E;for(E=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)E.push(t.readUInt16());return E}(),s=(this.length-t.pos+this.offset)/2,l=function(){var S,E;for(E=[],c=S=0;0<=s?S<s:S>s;c=0<=s?++S:--S)E.push(t.readUInt16());return E}(),c=y=0,w=i.length;y<w;c=++y)for(j=i[c],n=_=x=b[c];x<=j?_<=j:_>=j;n=x<=j?++_:--_)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-x)-(f-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=m}return e.encode=function(t,r){var n,s,i,o,l,c,u,d,m,f,h,x,b,j,y,_,w,S,E,$,U,I,T,D,C,P,F,A,R,H,W,M,G,ce,ue,O,Z,B,ee,X,ne,le,de,je,me,Le;switch(A=new Sl,o=Object.keys(t).sort(function(ve,he){return ve-he}),r){case"macroman":for(b=0,j=function(){var ve=[];for(x=0;x<256;++x)ve.push(0);return ve}(),_={0:0},i={},R=0,G=o.length;R<G;R++)_[de=t[s=o[R]]]==null&&(_[de]=++b),i[s]={old:t[s],new:_[t[s]]},j[s]=_[t[s]];return A.writeUInt16(1),A.writeUInt16(0),A.writeUInt32(12),A.writeUInt16(0),A.writeUInt16(262),A.writeUInt16(0),A.write(j),{charMap:i,subtable:A.data,maxGlyphID:b+1};case"unicode":for(P=[],m=[],w=0,_={},n={},y=u=null,H=0,ce=o.length;H<ce;H++)_[E=t[s=o[H]]]==null&&(_[E]=++w),n[s]={old:E,new:_[E]},l=_[E]-s,y!=null&&l===u||(y&&m.push(y),P.push(s),u=l),y=s;for(y&&m.push(y),m.push(65535),P.push(65535),D=2*(T=P.length),I=2*Math.pow(Math.log(T)/Math.LN2,2),f=Math.log(I/2)/Math.LN2,U=2*T-I,c=[],$=[],h=[],x=W=0,ue=P.length;W<ue;x=++W){if(C=P[x],d=m[x],C===65535){c.push(0),$.push(0);break}if(C-(F=n[C].new)>=32768)for(c.push(0),$.push(2*(h.length+T-x)),s=M=C;C<=d?M<=d:M>=d;s=C<=d?++M:--M)h.push(n[s].new);else c.push(F-C),$.push(0)}for(A.writeUInt16(3),A.writeUInt16(1),A.writeUInt32(12),A.writeUInt16(4),A.writeUInt16(16+8*T+2*h.length),A.writeUInt16(0),A.writeUInt16(D),A.writeUInt16(I),A.writeUInt16(f),A.writeUInt16(U),ne=0,O=m.length;ne<O;ne++)s=m[ne],A.writeUInt16(s);for(A.writeUInt16(0),le=0,Z=P.length;le<Z;le++)s=P[le],A.writeUInt16(s);for(je=0,B=c.length;je<B;je++)l=c[je],A.writeUInt16(l);for(me=0,ee=$.length;me<ee;me++)S=$[me],A.writeUInt16(S);for(Le=0,X=h.length;Le<X;Le++)b=h[Le],A.writeUInt16(b);return{charMap:n,subtable:A.data,maxGlyphID:w+1}}},e}(),S8=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new Hj(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=Hj.encode(t,r),(s=new Sl).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),fV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),mV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),pV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),gV=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},xV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,i,o,l,c,u,d,m,f;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=d=0,m=n.length;d<m;i=++d)s=n[i],t.pos=s.offset,u=t.readString(s.length),o=new gV(u,s),c[f=s.nameID]==null&&(c[f]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),vV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),yV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,i,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,m,f;for(f=[],u=0,d=(m=this.metrics).length;u<d;u++)i=m[u],f.push(i.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),k8=[].slice,bV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,i,o,l,c,u,d,m;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new Sl(r.read(s))).readShort(),u=l.readShort(),m=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new _V(l,u,m,c,d):new wV(l,o,u,m,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,i,o,l,c;for(o=[],i=[],l=0,c=r.length;l<c;l++)s=t[r[l]],i.push(o.length),s&&(o=o.concat(s.encode(n)));return i.push(o.length),{table:o,offsets:i}},e}(),wV=function(){function e(t,r,n,s,i,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),_V=function(){function e(t,r,n,s,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Sl(k8.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),jV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ia(e,sa),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<n.length;++o)if(n[o]=s,i<r.length&&r[i]==o){++i,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),NV=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,i,o,l,c;for(s={},o=0,l=t.length;o<l;o++)s[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},e.prototype.encode=function(t,r){var n,s,i,o,l,c,u,d,m,f,h,x,b,j,y;for(s in n=S8.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),h={0:0},y=n.charMap)h[(c=y[s]).old]=c.new;for(x in f=n.maxGlyphID,o)x in h||(h[x]=f++);return d=function(_){var w,S;for(w in S={},_)S[_[w]]=w;return S}(h),m=Object.keys(d).sort(function(_,w){return _-w}),b=function(){var _,w,S;for(S=[],_=0,w=m.length;_<w;_++)l=m[_],S.push(d[l]);return S}(),i=this.font.glyf.encode(o,b,h),u=this.font.loca.encode(i.offsets,b),j={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(j["OS/2"]=this.font.os2.raw()),this.font.directory.encode(j)},e}();Et.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,i,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();const SV=async e=>{const{orderData:t,items:r,invoiceName:n,customerName:s,agentDetails:i,invoiceTemplatePath:o,discountPercentage:l,agentPrefix:c,customerId:u}=e,d=new Et,m=ne=>{let le="";const de=new Uint8Array(ne),je=de.byteLength;for(let me=0;me<je;me++)le+=String.fromCharCode(de[me]);return window.btoa(le)},f=new Date,h=`${f.getFullYear()}${String(f.getMonth()+1).padStart(2,"0")}${String(f.getDate()).padStart(2,"0")}${String(f.getHours()).padStart(2,"0")}${String(f.getMinutes()).padStart(2,"0")}${String(f.getSeconds()).padStart(2,"0")}`,x="https://raw.githubusercontent.com/google/fonts/main/ofl/poppins/Poppins-Regular.ttf",b="https://raw.githubusercontent.com/google/fonts/main/ofl/poppins/Poppins-Bold.ttf",[j,y]=await Promise.all([fetch(x).then(ne=>ne.arrayBuffer()),fetch(b).then(ne=>ne.arrayBuffer())]),_=m(j),w=m(y);d.addFileToVFS("Poppins-Regular.ttf",_),d.addFont("Poppins-Regular.ttf","Poppins","normal"),d.addFileToVFS("Poppins-Bold.ttf",w),d.addFont("Poppins-Bold.ttf","Poppins","bold");const S=d.internal.pageSize.getWidth(),E=d.internal.pageSize.getHeight();let $=null;if(o)try{const{data:ne}=await ge.storage.from("agent-templates").download(o);if(ne){const le=new Image,de=URL.createObjectURL(ne);le.src=de,await new Promise((je,me)=>{le.onload=()=>{const Le=document.createElement("canvas"),ve=Le.getContext("2d"),he=150,V=595,Re=842,xe=he/72,Ce=V*xe,fe=Re*xe;Le.width=Ce,Le.height=fe;const We=Ce/le.width,Oe=fe/le.height,nt=Math.min(We,Oe),K=le.width*nt,be=le.height*nt,_e=(Ce-K)/2,re=(fe-be)/2;ve.fillStyle="white",ve.fillRect(0,0,Le.width,Le.height),ve.imageSmoothingEnabled=!0,ve.imageSmoothingQuality="high",ve.drawImage(le,_e,re,K,be),$=Le.toDataURL("image/jpeg",.95),URL.revokeObjectURL(de),je(null)},le.onerror=()=>me(new Error("Image load failed"))})}}catch(ne){console.error("Error fetching template:",ne)}$&&d.addImage($,"JPEG",0,0,S,E),d.setFontSize(16),d.setFont("Poppins","bold"),d.text(n,S/2,20,{align:"center"}),d.setFontSize(10),d.setFont("Poppins","normal");let U=60;i.name.trim()&&(d.setFont("Poppins","bold"),d.text(i.name,20,U),d.setFont("Poppins","normal"),U+=10),i.address.trim()&&(d.text(i.address,20,U),U+=10),i.business_email.trim()&&(d.text(`Email: ${i.business_email}`,20,U),U+=10),i.contact_number.trim()&&(d.text(`Phone: ${i.contact_number}`,20,U),U+=10),i.website.trim()&&(d.text(`Website: ${i.website}`,20,U),U+=10);const I=d.internal.pageSize.getWidth()-20;d.setFont("Poppins","bold"),d.text("Invoice Details",I,60,{align:"right"}),d.setFont("Poppins","normal"),d.text(`Date: ${new Date(t.created_at).toLocaleDateString()}`,I,80,{align:"right"}),d.text(`Order #: #${t.id.toString().padStart(4,"0")}`,I,90,{align:"right"}),d.text(`Status: ${t.status}`,I,100,{align:"right"}),d.setFont("Poppins","bold"),d.text("Bill To:",20,120),d.setFont("Poppins","normal"),d.text(s,20,130);let T=145;const D={desc:20,qty:90,price:120,total:150},C=55,P=10,F=6;d.setFontSize(9),d.setFont("Poppins","bold"),d.text("Item Description",D.desc,T),d.text("Qty",D.qty+5,T),d.text("Unit Price",D.price,T),d.text("Total",190,T,{align:"right"}),T+=P+2,d.setFont("Poppins","normal"),d.setFontSize(10),r.forEach(ne=>{T>750&&(d.addPage(),$&&d.addImage($,"JPEG",0,0,S,E),T=35,d.setFont("Poppins","bold"),d.text("Item Description",D.desc,T),d.text("Qty",D.qty+5,T),d.text("Unit Price",D.price,T),d.text("Total",195,T,{align:"right"}),T+=P+2,d.setFont("Poppins","normal"));const le=d.splitTextToSize(ne.name,C);let de=T;le.forEach(ve=>{d.text(ve,D.desc,de),de+=F});const je=Math.max(1,le.length),me=Math.max(P,(je-1)*F+P),Le=T+(je-1)*F/2;d.text(ne.quantity.toString(),D.qty+5,Le),d.text(`LKR ${ne.price.toFixed(2)}`,D.price,Le),d.text(`LKR ${(ne.total||ne.quantity*ne.price).toFixed(2)}`,190,Le,{align:"right"}),T+=me+2}),d.setLineWidth(.1),d.line(20,T,190,T),T+=5;const A=r.reduce((ne,le)=>ne+(le.total||le.quantity*le.price),0),R=A*(l/100),H=A-R;let W=T+5;if(d.setFont("Poppins","bold"),d.setFontSize(10),d.text("Subtotal:",120,W),d.text(`LKR ${A.toFixed(2)}`,190,W,{align:"right"}),W+=10,d.setFont("Poppins","normal"),d.setFontSize(9),d.text(`Discount (${l.toFixed(2)}%):`,120,W),d.text(`-LKR ${R.toFixed(2)}`,190,W,{align:"right"}),W+=10,d.setFont("Poppins","bold"),d.setFontSize(10),d.text("Total Amount:",120,W),d.text(`LKR ${H.toFixed(2)}`,190,W,{align:"right"}),W+=15,T=W+20,t.notes){d.setFont("Poppins","normal"),d.setFontSize(9),d.text("Notes:",20,T);const ne=d.splitTextToSize(t.notes,170);let le=T;ne.forEach(de=>{d.text(de,50,le),le+=6}),T=le+10}const M=E-20;d.setFontSize(10),d.setFont("Poppins","normal"),d.text("Thank you for your business!",S/2,M,{align:"center"});const G=d.output("blob"),ce=`invoice_${t.id}${h}.pdf`,ue=`${c}/${u}/${ce}`,{data:O,error:Z}=await ge.storage.from("invoices").upload(ue,G,{contentType:"application/pdf",upsert:!0});if(Z)throw new Error("Failed to upload invoice: "+Z.message);const{data:{publicUrl:B}}=ge.storage.from("invoices").getPublicUrl(ue),ee=`${c}_orders_invoices`,{error:X}=await ge.from(ee).insert({order_id:t.id,name:n,pdf_url:B,status:"generated",discount_percentage:l});if(X)throw new Error("Failed to save invoice record: "+X.message);return G},kV=({isOpen:e,onClose:t,selectedOrderId:r,orders:n,customerName:s,customerId:i,agentPrefix:o,agentId:l,agentDetails:c,invoiceTemplatePath:u,onSuccess:d})=>{var I;const[m,f]=g.useState(null),[h,x]=g.useState(""),[b,j]=g.useState(0),[y,_]=g.useState(!1),[w,S]=g.useState(null);g.useEffect(()=>{if(e&&r){f(r);const T=n.find(D=>D.id===r);T&&x(`Invoice for Order #${T.id.toString().padStart(4,"0")}`),j(0),S(null)}else e&&!r&&(f(null),x(""),j(0),S(null))},[e,r,n]);const E=async()=>{if(!i||!o||!l||!m||!h.trim()){S("Missing required information");return}if(b<0||b>100){S("Discount percentage must be between 0 and 100");return}_(!0),S(null);try{const T=`${o}_orders`,{data:D,error:C}=await ge.from(T).select("id, customer_id, status, notes, created_at").eq("id",m).single();if(C||!D)throw new Error("Failed to fetch order details");const P=`${o}_orders_items`,{data:F,error:A}=await ge.from(P).select("name, quantity, price, total").eq("order_id",m);if(A)throw new Error("Failed to fetch order items: "+A.message);const R=(F||[]).map(H=>({name:H.name,quantity:H.quantity,price:H.price,total:H.total||H.quantity*H.price}));await SV({orderData:D,items:R,invoiceName:h.trim(),customerName:s,agentDetails:c,invoiceTemplatePath:u,discountPercentage:b,agentPrefix:o,customerId:i}),alert("Invoice generated successfully!"),t(),d()}catch(T){S("Failed to generate invoice: "+T.message),console.error("Error generating invoice:",T)}finally{_(!1)}},$=()=>{f(null),x(""),j(0),S(null),t()};if(!e)return null;const U=n.find(T=>T.id===m);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full max-h-[80vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Generate Invoice"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fill in the details to generate an invoice for the selected order."})]}),a.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[w&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:w}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Order"}),a.jsx("select",{value:m||"",onChange:T=>f(parseInt(T.target.value)||null),disabled:r!==void 0,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${r!==void 0?"border-gray-300 bg-gray-100 cursor-not-allowed":"border-gray-300"}`,children:r?U?a.jsxs("option",{value:U.id,children:["Order #",U.id.toString().padStart(4,"0")," - LKR"," ",((I=U.total_amount)==null?void 0:I.toFixed(2))||"0.00"]}):a.jsx("option",{value:"",children:"No order selected"}):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"",children:"Choose an order..."}),n.map(T=>{var D;return a.jsxs("option",{value:T.id,children:["Order #",T.id.toString().padStart(4,"0")," - LKR ",((D=T.total_amount)==null?void 0:D.toFixed(2))||"0.00"]},T.id)})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),a.jsx("input",{type:"text",value:s,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Name"}),a.jsx("input",{type:"text",value:h,onChange:T=>x(T.target.value),placeholder:"e.g., Invoice for Order #0001",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Percentage (%)"}),a.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:b,onChange:T=>j(parseFloat(T.target.value)||0),placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("button",{onClick:E,disabled:y||!h.trim()||!m,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[y?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),a.jsx("span",{children:y?"Generating...":"Generate Invoice"})]})]}),a.jsx("button",{onClick:$,disabled:y,className:"mt-4 w-full px-4 py-2 text-gray-500 hover:text-gray-700 transition-colors disabled:opacity-50 border border-gray-300 rounded-md",children:"Cancel"})]})]})})},CV=({isOpen:e,onClose:t,customerPhone:r,customerName:n,agentPrefix:s,agentId:i})=>{const[o,l]=g.useState("orders"),[c,u]=g.useState([]),[d,m]=g.useState([]),[f,h]=g.useState([]),[x,b]=g.useState(!1),[j,y]=g.useState(null),[_,w]=g.useState(null),[S,E]=g.useState(!1),[$,U]=g.useState(null),[I,T]=g.useState(!1),[D,C]=g.useState(!1),[P,F]=g.useState(!1),[A,R]=g.useState(null),[H,W]=g.useState(!1),[M,G]=g.useState(!1),[ce,ue]=g.useState({name:"",address:"",business_email:"",contact_number:"",website:""}),[O,Z]=g.useState(null),[B,ee]=g.useState(!1),[X,ne]=g.useState(null),[le,de]=g.useState(null);g.useEffect(()=>{e&&r&&s&&je()},[e,r,s]);const je=async()=>{if(!(!r||!s)){b(!0),y(null);try{const be=`${s}_customers`,{data:_e,error:re}=await ge.from(be).select("id").eq("phone",r).single();if(re||!_e){u([]),m([]),h([]),w(null),b(!1);return}const De=_e.id;if(w(_e.id),i)try{const{data:{user:Je}}=await ge.auth.getUser();if(Je){const{data:Xe,error:At}=await ge.from("users").select("name").eq("id",Je.id).single();if(!At&&Xe){const{data:Pt,error:Lt}=await ge.from("agents").select("address, business_email, contact_number, website, invoice_template_path").eq("id",i).single();!Lt&&Pt&&(ue({name:Xe.name||"",address:Pt.address||"",business_email:Pt.business_email||"",contact_number:Pt.contact_number||"",website:Pt.website||""}),Z(Pt.invoice_template_path||null))}}}catch(Je){console.warn("Failed to fetch agent details:",Je)}const se=`${s}_orders`,{data:Pe,error:Ee}=await ge.from(se).select("id, total_amount, status, created_at, shipping_address, notes, customer_id").eq("customer_id",De).order("created_at",{ascending:!1});if(Ee)throw Ee;u((Pe||[]).map(Je=>({...Je,customer_name:n,customer_phone:r})));const Ne=`${s}_orders_invoices`,{data:Me,error:Ve}=await ge.from(Ne).select(`
          id,
          order_id,
          name,
          pdf_url,
          status,
          generated_at,
          order:order_id!inner (
            total_amount
          )
        `).eq("order.customer_id",De).order("generated_at",{ascending:!1});if(Ve)throw Ve;const $e=(Me||[]).map(Je=>{var Xe;return{id:Je.id,order_id:Je.order_id,name:Je.name,pdf_url:Je.pdf_url,total_amount:((Xe=Je.order)==null?void 0:Xe.total_amount)||0,status:Je.status,created_at:Je.generated_at}});m($e);const Ye=`${s}_appointments`,{data:pt,error:it}=await ge.from(Ye).select("id, title, appointment_date, duration_minutes, status, notes, customer_id, created_at").eq("customer_id",De).order("appointment_date",{ascending:!1});if(it)throw it;h((pt||[]).map(Je=>({...Je,customer_name:n,customer_phone:r})))}catch(be){y("Failed to fetch customer data: "+be.message),console.error("Error fetching customer data:",be)}finally{b(!1)}}},me=async be=>{if(_)try{const _e=`${s}_appointments`,{data:re,error:De}=await ge.from(_e).insert({...be,customer_id:_}).select().single();if(De)throw De;return h(se=>[re,...se.map(Pe=>({...Pe,customer_name:n,customer_phone:r}))]),re.id}catch(_e){throw y("Failed to create appointment: "+_e.message),console.error("Error creating appointment:",_e),_e}},Le=async(be,_e)=>{try{const re=`${s}_appointments`,{error:De}=await ge.from(re).update(_e).eq("id",be);if(De)throw De;await je()}catch(re){throw y("Failed to update appointment: "+re.message),console.error("Error updating appointment:",re),re}},ve=async be=>{try{const _e=`${s}_appointments`,{error:re}=await ge.from(_e).delete().eq("id",be);if(re)throw re;await je()}catch(_e){throw y("Failed to delete appointment: "+_e.message),console.error("Error deleting appointment:",_e),_e}},he=be=>{U(be),T(!0)},V=be=>{U(be),C(!0)},Re=(be,_e)=>{ne(be),ee(!0)},xe=async be=>{if(window.confirm(`Are you sure you want to delete Order #${be}? This action cannot be undone.`))try{if(!s)throw new Error("Missing agent prefix");const _e=`${s}_orders`,{error:re}=await ge.from(_e).delete().eq("id",be);if(re)throw re;await je()}catch(_e){alert("Failed to delete order: "+_e.message)}},Ce=be=>{R(be),W(!0)},fe=be=>{R(be),G(!0)},We=async be=>{if(window.confirm("Are you sure you want to delete this appointment? This action cannot be undone."))try{await ve(be)}catch(_e){alert("Failed to delete appointment: "+_e.message)}},Oe=async be=>{if(!r||!i){y("Missing customer or agent information");return}try{const{data:{user:_e}}=await ge.auth.getUser();if(!_e)throw new Error("User not authenticated");const re={user_id:_e.id,customer_phone:r,invoice_url:be.pdf_url,invoice_name:be.name,order_number:be.order_id.toString(),total_amount:be.total_amount.toString(),customer_name:n},{data:De,error:se}=await ge.functions.invoke("send-invoice-template",{body:re});if(se)throw se;if(De&&De.success)alert("Invoice sent successfully via WhatsApp!");else throw new Error("Failed to send invoice")}catch(_e){y("Failed to send invoice: "+_e.message),console.error("Error sending invoice:",_e)}},nt=async be=>{if(window.confirm(`Are you sure you want to delete invoice "${be.name}"? This action cannot be undone.`)){if(!s){y("Missing agent prefix");return}try{b(!0);const _e=be.pdf_url.split("/invoices/");if(_e.length<2)throw new Error("Invalid invoice URL");const re=_e[1],De=`${s}_orders_invoices`,{error:se}=await ge.storage.from("invoices").remove([re]);se&&console.warn("Storage delete error:",se);const{error:Pe}=await ge.from(De).delete().eq("id",be.id);if(Pe)throw Pe;await je(),alert("Invoice deleted successfully!")}catch(_e){y("Failed to delete invoice: "+_e.message),console.error("Error deleting invoice:",_e)}finally{b(!1)}}},K=async be=>{if(!s){y("Missing agent prefix");return}de(be.id);try{const _e=`${s}_orders_invoices`,{error:re}=await ge.from(_e).update({status:"paid",updated_at:new Date().toISOString()}).eq("id",be.id);if(re)throw new Error("Failed to update invoice status: "+re.message);alert("Marked invoice as paid"),await je()}catch(_e){y("Failed to mark as paid: "+_e.message),console.error("Mark paid error:",_e)}finally{de(null)}};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[95vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"sticky top-0 bg-white/95 backdrop-blur-sm border-b border-gray-100 px-6 py-4 flex flex-col gap-4",children:[a.jsxs("div",{className:"flex items-center justify-between w-full",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?`${n}'s Records`:"Customer Records"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex bg-gray-50 rounded-lg p-1 space-x-1 flex-shrink-0",children:[a.jsxs("button",{onClick:()=>l("orders"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all flex items-center ${o==="orders"?"bg-white shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["Orders",a.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full ml-2",children:c.length})]}),a.jsxs("button",{onClick:()=>l("invoices"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all flex items-center ${o==="invoices"?"bg-white shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["Invoices",a.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full ml-2",children:d.length})]}),a.jsxs("button",{onClick:()=>l("appointments"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all flex items-center ${o==="appointments"?"bg-white shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["Appointments",a.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full ml-2",children:f.length})]})]}),a.jsxs("div",{className:"flex space-x-2 ml-4 flex-shrink-0",children:[o==="orders"&&a.jsx("button",{onClick:()=>E(!0),disabled:!_||x,className:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",title:"Create Order",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),o==="invoices"&&a.jsx("button",{onClick:()=>{ne(null),ee(!0)},disabled:!_||x||c.length===0,className:"p-2 bg-purple-600 text-white rounded-full hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",title:"Generate Invoice",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),o==="appointments"&&a.jsx("button",{onClick:()=>F(!0),disabled:!_||x,className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",title:"Create Appointment",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:x?a.jsx("div",{className:"flex justify-center items-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):j?a.jsx("div",{className:"text-center py-8 text-red-600",children:j}):a.jsxs(a.Fragment,{children:[o==="orders"&&a.jsx(wB,{orders:c,customerId:_,loading:x,agentPrefix:s,agentId:i,customerName:n,customerPhone:r,onViewOrder:he,onEditOrder:V,onGenerateInvoice:Re,onDeleteOrder:xe,onRefresh:je}),o==="invoices"&&a.jsx(_B,{invoices:d,agentPrefix:s,customerPhone:r,agentId:i,customerName:n,updatingId:le,onRefresh:je,onSendInvoice:Oe,onDeleteInvoice:nt,onMarkPaid:K}),o==="appointments"&&a.jsx(jB,{appointments:f,loading:x,onViewAppointment:Ce,onEditAppointment:fe,onDeleteAppointment:We})]})})]}),S&&_&&a.jsx(cb,{customer:{id:_,name:n,phone:r},agentPrefix:s||"",agentId:i,onClose:()=>E(!1),onSuccess:je}),I&&$&&a.jsx(fC,{order:$,onClose:()=>{T(!1),U(null)},agentPrefix:s||null,agentId:i||null}),D&&$&&a.jsx(mC,{order:$,onClose:()=>{C(!1),U(null)},onSuccess:je,agentPrefix:s||null,agentId:i||null}),P&&_&&a.jsx(pC,{customer:{id:_,name:n,phone:r},createAppointment:me,onClose:()=>F(!1),onSuccess:je}),H&&A&&a.jsx(gC,{appointment:A,onClose:()=>{W(!1),R(null)}}),M&&A&&a.jsx(xC,{appointment:A,updateAppointment:Le,onClose:()=>{G(!1),R(null)},onSuccess:je}),B&&_&&a.jsx(kV,{isOpen:B,onClose:()=>{ee(!1),ne(null)},selectedOrderId:X??void 0,orders:c,customerName:n,customerId:_,agentPrefix:s,agentId:i,agentDetails:ce,invoiceTemplatePath:O,onSuccess:je})]})}):null},EV=({isOpen:e,onClose:t,customerPhone:r,customerName:n,agentPrefix:s,agentId:i,onStageUpdate:o})=>{const[l,c]=g.useState(!1),[u,d]=g.useState(null),[m,f]=g.useState(null),[h,x]=g.useState(null),[b,j]=g.useState(null),[y,_]=g.useState(null),[w,S]=g.useState(null),[E,$]=g.useState(null),[U,I]=g.useState(null),[T,D]=g.useState(!1),C=["New Lead","Contacted","Not Responding","Follow-up Needed"],P=["Interested","Quotation Sent","Asked for More Info"],F=["Payment Pending","Paid","Order Confirmed"],A=(W,M)=>{W==="lead_stage"?(S(M),M==="New Lead"&&($(null),I(null))):W==="interest_stage"?($(M||null),M||I(null)):W==="conversion_stage"&&I(M||null)};g.useEffect(()=>{e&&r&&s&&i&&R()},[e,r,s,i]);const R=async()=>{if(!(!r||!s||!i)){c(!0),d(null);try{const W=`${s}_customers`,{data:M,error:G}=await ge.from(W).select("id, lead_stage, interest_stage, conversion_stage").eq("phone",r).eq("agent_id",i).single();if(G||!M){d("Customer not found"),c(!1);return}const ce=M.id;f(ce),x(M.lead_stage||"New Lead"),j(M.interest_stage||null),_(M.conversion_stage||null),S(M.lead_stage||"New Lead"),$(M.interest_stage||null),I(M.conversion_stage||null)}catch(W){d("Failed to fetch customer data: "+W.message),console.error("Error fetching customer data:",W)}finally{c(!1)}}},H=async()=>{if(!(!m||!s||!w||!i)){D(!0),d(null);try{const W=`${s}_customers`,{error:M}=await ge.from(W).update({lead_stage:w,interest_stage:E||null,conversion_stage:U||null}).eq("id",m).eq("agent_id",i);if(M)throw M;x(w),j(E),_(U),o&&o({lead_stage:w,interest_stage:E,conversion_stage:U}),t()}catch(W){d("Failed to update stages: "+W.message),console.error("Error updating stages:",W)}finally{D(!1)}}};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?`${n}'s Lead Stage`:"Lead Stage"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsx("div",{className:"p-6 space-y-6",children:l?a.jsx("div",{className:"flex justify-center items-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u?a.jsx("div",{className:"text-center py-8 text-red-600",children:u}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Current Progress"}),a.jsx("div",{className:"space-y-1",children:y?a.jsxs("span",{className:"text-sm font-medium text-green-600",children:[" ",y]}):b?a.jsxs("span",{className:"text-sm font-medium text-yellow-600",children:[" ",b]}):a.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[" ",h||"New Lead"]})})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Customer Progress Stages"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Stage "}),a.jsx("select",{value:w||"",onChange:W=>A("lead_stage",W.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l||T,children:C.map(W=>a.jsx("option",{value:W,children:W},W))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Interest Stage "}),a.jsxs("select",{value:E||"",onChange:W=>A("interest_stage",W.target.value),disabled:w==="New Lead"||l||T,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",children:"Select Interest Stage"}),P.map(W=>a.jsx("option",{value:W,children:W},W))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Conversion Stage "}),a.jsxs("select",{value:U||"",onChange:W=>A("conversion_stage",W.target.value),disabled:!E||l||T,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",children:"Select Conversion Stage"}),F.map(W=>a.jsx("option",{value:W,children:W},W))]})]})]})]}),a.jsx("button",{onClick:H,disabled:!w||T||l,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:T?"Updating...":"Update Stages"})]})})]})}):null};function AV(e){if(typeof e!="string"||!e.trim().startsWith("{"))return null;try{const t=JSON.parse(e);if(t.is_template)return t}catch(t){console.error("Failed to parse template JSON:",t)}return null}function LV(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function PV(e,t,r){const n=e.components.find(i=>i.type.toLowerCase()==="header");if(!n)return null;const s=t||"none";if(s!=="none"&&r)return a.jsxs("div",{className:"mb-3",children:[s==="image"&&a.jsx("img",{src:r,alt:"Template header",className:"max-w-full h-auto rounded-lg shadow-sm max-h-64 object-cover"}),s==="video"&&a.jsx("video",{src:r,controls:!0,className:"max-w-full h-auto rounded-lg shadow-sm max-h-64"}),s==="document"&&a.jsxs("div",{className:"border rounded-lg p-3 flex items-center space-x-3 bg-gray-50",children:[a.jsx("div",{className:"p-2 rounded-full bg-gray-200",children:a.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Template Header Document"}),a.jsx("p",{className:"text-xs text-gray-500",children:"View attached"})]})]})]});if(n.text){let i=n.text;return e.dynamic_data.header_params&&n.parameters&&e.dynamic_data.header_params.forEach((o,l)=>{var d,m;const c=`{{${l+1}}}`;let u="";o!=null&&o.text?u=o.text:(d=o==null?void 0:o.currency)!=null&&d.fallback_value?u=o.currency.fallback_value:(m=o==null?void 0:o.date_time)!=null&&m.fallback_value&&(u=o.date_time.fallback_value),i=i.replace(new RegExp(LV(c),"g"),u)}),a.jsx("div",{className:"mb-3",children:a.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:i})})}return null}function TV(e){return a.jsx("div",{className:"mb-3",children:a.jsx("p",{className:"text-sm leading-relaxed break-words whitespace-pre-line",children:e.rendered_body})})}function IV(e){const t=e.components.find(n=>n.type.toLowerCase()==="footer");if(!t||!t.text)return null;let r=t.text;return a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsx("p",{className:"text-xs text-gray-500 italic",children:r})})}function MV(e){const t=e.components.find(r=>r.type.toLowerCase()==="buttons");return!(t!=null&&t.buttons)||t.buttons.length===0?null:a.jsx("div",{className:"mt-4 space-y-2",children:t.buttons.map((r,n)=>{const s=r.text||`Button ${n+1}`;return a.jsx("button",{className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg text-sm hover:bg-blue-600 transition-colors disabled:opacity-50",disabled:!0,title:"Template button (historical)",children:s},n)})})}const OV=({selectedConversation:e,newMessage:t,sending:r,sendError:n,onMessageChange:s,onSendMessage:i,onKeyPress:o,onFileSelect:l,uploading:c,hasPendingMedia:u,pendingMedia:d,onClearPendingMedia:m,messagesContainerRef:f,onOpenTemplateModal:h,onOpenContactDetails:x,onSelectProduct:b,onUpdateConversation:j,agentPrefix:y,agentId:_,businessType:w})=>{const S=e?!e.lastUserMessageTime||(()=>{const ve=new Date(e.lastUserMessageTime);return(Date.now()-ve.getTime())/(1e3*60*60)>24})():!1,[E,$]=g.useState(!1),[U,I]=g.useState(!1),[T,D]=g.useState(!1),[C,P]=g.useState(!1),[F,A]=g.useState(!1),[R,H]=g.useState(""),W=w==="product",M=w==="service",G=e?(()=>{const{conversionStage:ve,interestStage:he,leadStage:V}=e;return ve?{stage:ve,color:"green",className:"bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-medium whitespace-nowrap"}:he?{stage:he,color:"yellow",className:"bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full text-xs font-medium whitespace-nowrap"}:V?{stage:V,color:"blue",className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium whitespace-nowrap"}:null})():null,ce=G?`p-2 bg-${G.color}-100 text-${G.color}-700 hover:bg-${G.color}-200 hover:text-${G.color}-900 rounded-lg transition-all duration-200 flex items-center shadow-sm hover:shadow-md`:"p-2 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:text-blue-900 rounded-lg transition-all duration-200 flex items-center shadow-sm hover:shadow-md",ue=ve=>{e&&j&&j({...e,leadStage:ve.lead_stage,interestStage:ve.interest_stage,conversionStage:ve.conversion_stage})},O=ve=>{b&&b(ve),I(!1)},Z=async ve=>{if(_&&(e!=null&&e.customerPhone)&&y)try{const he=`${y}_customers`,{data:V}=await ge.from(he).select("id, name, language").eq("phone",e.customerPhone).eq("agent_id",_).single(),{data:Re}=await ge.from("agents").select("user_id").eq("id",_).single();if(Re!=null&&Re.user_id){const{data:xe}=await ge.from("whatsapp_configuration").select("webhook_url, phone_number_id").eq("user_id",Re.user_id).single();if(xe!=null&&xe.webhook_url&&V){const Ce=`Send me details about ${ve.service_name}`;await fetch(xe.webhook_url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"service_selected",data:{id:Date.now(),customer_id:V.id,message:Ce,direction:"outbound",timestamp:new Date().toISOString(),is_read:!0,media_type:"none",media_url:null,caption:null,customer_phone:e.customerPhone,customer_name:V.name||e.customerName,customer_language:V.language||"english",agent_prefix:y,agent_user_id:Re.user_id,phone_number_id:xe.phone_number_id,service_name:ve.service_name,agent_id:_}})}),H(`Service "${ve.service_name}" selected successfully!. Message sent to customer.`)}}}catch(he){console.error("Failed to trigger service webhook:",he)}D(!1)},B=st.useRef(null),ee=st.useRef(null),X=st.useRef(null),ne=st.useRef(null),le=st.useRef(null),de=st.useRef(null),je=st.useRef(null),me=g.useMemo(()=>{var V;if(!(e!=null&&e.messages))return[];const ve=[];let he=null;return e.messages.forEach(Re=>{var fe;const xe=Re.media_type&&Re.media_type!=="none"&&Re.media_url,Ce=Re.sender==="agent"&&xe&&!(Re.text||"").trim();Ce&&he&&he.sender==="agent"&&he.media_type===Re.media_type?he.groupMedia.push({url:Re.media_url,type:Re.media_type,caption:Re.caption}):(he&&(he.isGroup=(((fe=he.groupMedia)==null?void 0:fe.length)||0)>1,ve.push(he)),Ce?he={...Re,groupMedia:[{url:Re.media_url,type:Re.media_type,caption:Re.caption}],isGroup:!1}:(he=null,ve.push({...Re,isGroup:!1})))}),he&&(he.isGroup=(((V=he.groupMedia)==null?void 0:V.length)||0)>1,ve.push(he)),ve},[e==null?void 0:e.messages]);g.useEffect(()=>{const ve=je.current;ve&&(ve.style.height="auto",ve.style.height=Math.min(ve.scrollHeight,128)+"px")},[t]),g.useEffect(()=>{if(!E)return;const ve=he=>{le.current&&!le.current.contains(he.target)&&de.current&&!de.current.contains(he.target)&&$(!1)};return document.addEventListener("mousedown",ve),()=>{document.removeEventListener("mousedown",ve)}},[E]);const Le=ve=>{ve.preventDefault();let he=ve.clipboardData.getData("text/plain");he=he.replace(/\r\n/g,`
`).replace(/\r/g,`
`);let V=!1;const Re=ve.clipboardData.getData("text/html");if(Re){V=!0;try{let K=function(Ee){let Ne="";if(Ee.nodeType===Node.TEXT_NODE)return(Ee.textContent||"").trim();if(Ee.nodeType===Node.ELEMENT_NODE){const Me=Ee,Ve=Me.tagName.toLowerCase();let $e="";if(["ul","ol"].includes(Ve)){const Ye=[],pt=Me.querySelectorAll("li"),it=Ve==="ol";return pt.forEach((Je,Xe)=>{const Pt=K(Je).trim();if(Pt){let Lt=it?`${Xe+1}. `:" ";const St=Pt.replace(/^(|\-|\*|\d+\.)\s*/i,"").trim();Ye.push(Lt+St)}}),Ye.join(`
`)+`

`}else return["li"].includes(Ve)?($e=Array.from(Me.childNodes).map(K).join(" ").trim(),$e):["p","h1","h2","h3","h4","h5","h6","div","blockquote","pre"].includes(Ve)?($e=Array.from(Me.childNodes).map(K).join(" ").trim(),$e?$e+`

`:""):Ve==="br"?`
`:($e=Array.from(Me.childNodes).map(K).filter(pt=>pt).join(" "),$e)}return Ne};const re=new DOMParser().parseFromString(Re,"text/html").body;he=K(re).replace(/\n{3,}/g,`

`).trim();const se=re.querySelectorAll("ul, ol"),Pe=re.querySelectorAll("li");se.length>0}catch(K){console.error("Failed to parse HTML clipboard:",K),V=!1}}if(!V){const K=he.split(`
`).map(be=>be.trim()).filter(be=>be);if(K.length>1&&!K.some(_e=>/^[\d+\.\s*\-\*]/.test(_e))){const _e=K.every(se=>/^[A-Z]/.test(se)),re=K.every(se=>se.length<100&&!se.includes(".")||se.split(".").length<3);_e&&re&&(he=K.map(se=>" "+se).join(`
`))}}he=he.trim();const xe=ve.currentTarget,Ce=xe.selectionStart||0,fe=xe.selectionEnd||0,We=t.substring(0,Ce),Oe=t.substring(fe),nt=We+he+Oe;s({target:{value:nt}}),setTimeout(()=>{xe.selectionStart=xe.selectionEnd=Ce+he.length,xe.focus()},0)};return a.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden relative",children:[!e&&a.jsx("div",{className:"flex flex-col justify-start bg-gradient-to-br from-gray-50 to-gray-100 h-full pt-12",children:a.jsxs("div",{className:"text-center p-12 max-w-lg mx-auto",children:[a.jsx("div",{className:"w-24 h-24 bg-white rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-xl border border-gray-200",children:a.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),a.jsx("h3",{className:"text-3xl font-bold text-gray-900 mb-3",children:"No conversation selected"}),a.jsx("p",{className:"text-gray-600 text-xl leading-relaxed mb-6",children:"Choose a conversation from the left sidebar to start chatting with your customers"}),a.jsx("div",{className:"text-sm text-gray-500",children:a.jsx("p",{children:" Messages will appear here once you select a conversation"})})]})}),e&&a.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm flex-shrink-0",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4 cursor-pointer hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors flex-1",onClick:x,children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center shadow-md flex-shrink-0",children:a.jsx("span",{className:"text-white font-bold text-sm",children:e.customerName.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 truncate",children:e.customerName}),e?e.lastUserMessageTime?(()=>{const ve=new Date(e.lastUserMessageTime),V=(Date.now()-ve.getTime())/(1e3*60*60)>24;return a.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${V?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:V?"Template Required":"Free Messaging"})})():a.jsx("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Out of free messages"}):a.jsx("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Free Messaging"})]})}),a.jsx("p",{className:"text-sm text-gray-500 truncate",children:e.customerPhone})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[G&&a.jsx("span",{className:`text-xs font-medium ${G.className}`,children:G.stage}),a.jsx("button",{onClick:()=>A(!0),className:ce,title:"View Lead Stage",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),a.jsx("button",{onClick:()=>P(!0),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-gray-100 rounded-lg transition-colors flex items-center shadow-sm",title:"View Orders",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]})]})}),e&&a.jsx("div",{className:"flex-1 flex flex-col bg-gradient-to-b from-gray-50 to-white overflow-hidden pt-4",children:e.messages.length===0?a.jsx("div",{className:"flex items-center justify-center flex-1",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No messages yet"}),a.jsx("p",{className:"text-gray-500",children:"Start the conversation by sending a message"})]})}):a.jsx("div",{className:"flex-1 overflow-y-auto space-y-6 pb-4 pl-4 custom-scrollbar",ref:f,children:me.map(ve=>{const he=ve.isGroup||!1,V=ve,Re=he?`group-${V.id}`:V.id;return a.jsx("div",{className:`flex mt-4 mb-4 last:mb-20 ${V.sender==="customer"?"justify-start":"justify-end"} animate-in slide-in-from-${V.sender==="customer"?"left":"right"} fade-in duration-300`,children:a.jsxs("div",{className:`max-w-[80%] px-4 py-4 rounded-2xl shadow-md transform transition-all duration-200 mx-2 ${V.sender==="customer"?"bg-white text-gray-900 rounded-br-lg border border-gray-200":"bg-gradient-to-r from-green-50 to-green-100 text-gray-900 rounded-bl-lg border border-green-200"}`,children:[a.jsx("div",{className:"space-y-3 flex-1",children:(()=>{const xe=AV(V.text||"");return xe&&V.sender==="agent"?a.jsxs("div",{className:"space-y-3",children:[PV(xe,V.media_type||"none",V.media_url??null),TV(xe),IV(xe),MV(xe)]}):he&&V.groupMedia&&V.groupMedia.length>1&&V.media_type==="image"?a.jsxs("div",{className:"mb-2",children:[a.jsx("div",{className:`grid ${V.groupMedia.length===2?"grid-cols-2":"grid-cols-2 md:grid-cols-3"} gap-2`,children:V.groupMedia.map((Ce,fe)=>a.jsx("div",{className:"relative",children:a.jsx("img",{src:Ce.url,alt:Ce.caption||`Shared image ${fe+1}`,className:"w-full h-48 object-cover rounded-lg shadow-sm cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(Ce.url,"_blank")})},fe))}),V.caption&&(V.caption||"").trim()&&a.jsx("p",{className:"text-xs text-gray-500 mt-2 italic",children:V.caption})]}):a.jsxs(a.Fragment,{children:[V.media_type&&V.media_type!=="none"&&V.media_url&&a.jsxs("div",{className:"mb-2",children:[V.media_type==="image"&&a.jsx("div",{className:"relative",children:a.jsx("img",{src:V.media_url,alt:V.caption||"Shared image",className:"max-w-full h-auto rounded-lg shadow-sm max-h-96 object-contain cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>V.media_url&&window.open(V.media_url,"_blank")})}),V.media_type==="video"&&a.jsx("div",{className:"relative",children:a.jsx("video",{src:V.media_url,controls:!0,className:"max-w-full h-auto rounded-lg shadow-sm max-h-96",preload:"metadata",children:"Your browser does not support the video tag."})}),V.media_type==="audio"&&a.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:a.jsx("audio",{src:V.media_url,controls:!0,className:"w-full max-w-sm",preload:"metadata",children:"Your browser does not support the audio tag."})}),V.media_type==="document"&&a.jsxs("div",{className:`border rounded-lg p-3 flex items-center space-x-3 ${V.sender==="customer","border-gray-300 bg-gray-50"}`,children:[a.jsx("div",{className:`p-2 rounded-full ${V.sender==="customer","bg-gray-200"}`,children:a.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"Document"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Click to view"})]}),a.jsx("button",{onClick:()=>V.media_url&&window.open(V.media_url,"_blank"),className:`p-2 rounded-full transition-colors ${V.sender==="customer","hover:bg-gray-200 text-gray-600"}`,children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]}),V.media_type==="sticker"&&a.jsx("div",{className:"relative",children:a.jsx("img",{src:V.media_url,alt:"Sticker",className:"w-32 h-32 object-contain cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>V.media_url&&window.open(V.media_url,"_blank")})})]}),V.text&&(V.text||"").trim()&&!V.text.startsWith("[")&&!V.text.startsWith("Media file")&&a.jsx("p",{className:"text-sm leading-relaxed break-words whitespace-pre-line",children:V.text})]})})()}),a.jsx("div",{className:`mt-2 pt-1 flex ${V.sender==="customer"?"justify-start":"justify-end"}`,children:a.jsx("span",{className:"text-xs text-gray-500 select-none",children:V.timestamp})})]})},Re)})})}),e&&a.jsxs("div",{className:"bg-white border-t border-gray-200 px-6 py-4 shadow-lg flex-shrink-0",children:[d.length>0&&a.jsxs("div",{className:"mb-4 p-4 border border-gray-300 rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Media Preview (",d.length," items)"]}),a.jsx("button",{onClick:m,className:"text-gray-400 hover:text-red-500 transition-colors",title:"Remove media",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:d.map((ve,he)=>a.jsxs("div",{className:"relative w-20 h-20 flex-shrink-0",children:[ve.media_type==="image"&&a.jsx("img",{src:ve.url,alt:`Preview ${he+1}`,className:"w-full h-full object-cover rounded-lg border border-gray-200"}),(ve.media_type==="video"||ve.media_type==="audio"||ve.media_type==="document")&&a.jsxs("div",{className:"w-full h-full rounded-lg border border-gray-200 flex items-center justify-center bg-gray-100",children:[ve.media_type==="video"&&a.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),ve.media_type==="audio"&&a.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v10a1 1 0 01-.617.921L6 16a1 1 0 01-1.414-1.414l3.536-3.536A1 1 0 019 11V5a1 1 0 01.383-.924z",clipRule:"evenodd"})}),ve.media_type==="document"&&a.jsx("svg",{className:"w-8 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})]})]},he))}),a.jsx("div",{className:"text-xs text-gray-600",children:" Add a caption below - it will apply to all media"})]}),a.jsxs("div",{className:"flex items-end space-x-3",children:[W&&a.jsx("button",{onClick:()=>I(!0),disabled:r||c||S,className:`p-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md ${S?"bg-gray-100 text-gray-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:S?"Template required":"Select Product",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),M&&a.jsx("button",{onClick:()=>{H(""),D(!0)},disabled:r||c||S,className:`p-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md ${S?"bg-gray-100 text-gray-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:S?"Template required":"Select Service",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2zm-4 6v4m0 0V15m4 4h-4m4-4H9"})})}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{ref:le,onClick:()=>$(ve=>!ve),disabled:r||c||S,className:`p-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md ${u?"bg-green-500 text-white hover:bg-green-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:u?"Media attached - click to add more":S?"Template required":"Attach media",children:c?a.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):u?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),E&&a.jsx("div",{ref:de,className:"absolute bottom-full left-0 mb-2 z-50 bg-white rounded-xl shadow-2xl border border-gray-200 w-48",children:a.jsxs("div",{className:"py-1",children:[a.jsxs("button",{onClick:()=>{var ve;(ve=B.current)==null||ve.click()},className:"flex items-center space-x-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 w-full text-left transition-colors",children:[a.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("span",{children:"Images"})]}),a.jsxs("button",{onClick:()=>{var ve;(ve=ee.current)==null||ve.click()},className:"flex items-center space-x-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 w-full text-left transition-colors",children:[a.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),a.jsx("span",{children:"Videos"})]}),a.jsxs("button",{onClick:()=>{var ve;(ve=X.current)==null||ve.click()},className:"flex items-center space-x-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 w-full text-left transition-colors",children:[a.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7V5z"})}),a.jsx("span",{children:"Audio"})]}),a.jsxs("button",{onClick:()=>{var ve;(ve=ne.current)==null||ve.click()},className:"flex items-center space-x-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 w-full text-left transition-colors",children:[a.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("span",{children:"Documents"})]})]})}),a.jsx("input",{ref:B,type:"file",accept:"image/*",multiple:!0,onChange:ve=>{const he=Array.from(ve.target.files||[]);he.length>0&&l(he),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("input",{ref:ee,type:"file",accept:"video/*",onChange:ve=>{var V;const he=(V=ve.target.files)==null?void 0:V[0];he&&l([he]),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("input",{ref:X,type:"file",accept:"audio/*",onChange:ve=>{var V;const he=(V=ve.target.files)==null?void 0:V[0];he&&l([he]),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("input",{ref:ne,type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt",onChange:ve=>{var V;const he=(V=ve.target.files)==null?void 0:V[0];he&&l([he]),ve.target.value="",$(!1)},className:"hidden"})]}),a.jsx("input",{ref:B,type:"file",accept:"image/*",multiple:!0,onChange:ve=>{const he=Array.from(ve.target.files||[]);he.length>0&&l(he),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("input",{ref:X,type:"file",accept:"audio/*",onChange:ve=>{var V;const he=(V=ve.target.files)==null?void 0:V[0];he&&l([he]),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("input",{ref:ee,type:"file",accept:"video/*",onChange:ve=>{var V;const he=(V=ve.target.files)==null?void 0:V[0];he&&l([he]),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("input",{ref:ne,type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt",onChange:ve=>{var V;const he=(V=ve.target.files)==null?void 0:V[0];he&&l([he]),ve.target.value="",$(!1)},className:"hidden"}),a.jsx("textarea",{ref:je,rows:1,value:t,onChange:s,onKeyDown:o,onPaste:Le,placeholder:S?"Template required to message":"Type your message...",className:`flex-1 px-5 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-gray-50 resize-none placeholder-gray-500 min-h-[44px] max-h-32 overflow-y-auto whitespace-pre-wrap ${S?"bg-gray-100 cursor-not-allowed":""}`,disabled:r||c||S}),a.jsx("button",{onClick:i,disabled:!t.trim()&&!u||r||c||S,className:"p-4 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-2xl hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:r?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),S&&h&&a.jsx("button",{onClick:h,className:"mt-2 px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors w-full",children:"Send Template Message"}),W&&a.jsx(yB,{isOpen:U,onClose:()=>I(!1),onSelectProduct:O,agentPrefix:y,agentId:_}),M&&a.jsx(bB,{isOpen:T,onClose:()=>D(!1),onSelectService:Z}),a.jsx(EV,{isOpen:F,onClose:()=>A(!1),customerPhone:(e==null?void 0:e.customerPhone)||null,customerName:(e==null?void 0:e.customerName)||"",agentPrefix:y||null,agentId:_||null,onStageUpdate:ue}),a.jsx(CV,{isOpen:C,onClose:()=>P(!1),customerPhone:(e==null?void 0:e.customerPhone)||null,customerName:(e==null?void 0:e.customerName)||"",agentPrefix:y||null,agentId:_||null}),R&&a.jsx("p",{className:"text-xs text-green-600 mt-3 px-1",children:R}),n&&a.jsx("p",{className:"text-xs text-red-500 mt-3 px-1",children:n})]})]})},RV=({conversation:e,onClose:t,agentPrefix:r,agentId:n,onUpdateConversation:s})=>{if(!e)return null;const[i,o]=g.useState(!1),[l,c]=g.useState(e.customerName),[u,d]=g.useState(e.customerPhone),[m,f]=g.useState(e.aiEnabled||!1),[h,x]=g.useState(!1),[b,j]=g.useState(null),[y,_]=g.useState(!1);g.useEffect(()=>{const I=setTimeout(()=>_(!0),10);return()=>clearTimeout(I)},[]);const w=()=>{_(!1),setTimeout(t,700)},S=e.lastUserMessageTime?new Date(e.lastUserMessageTime).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}):"Never",E=async()=>{if(!r||!n){j("Agent information not available");return}if(l.trim()===""||u.trim()===""){j("Name and phone are required");return}x(!0),j(null);try{const I=`${r}_customers`,{error:T}=await ge.from(I).update({name:l.trim(),phone:u.trim()}).eq("id",e.customerId).eq("agent_id",n);if(T)throw T;s({...e,customerName:l.trim(),customerPhone:u.trim()}),o(!1)}catch(I){j(`Failed to update contact: ${I.message}`)}finally{x(!1)}},$=()=>{c(e.customerName),d(e.customerPhone),o(!1),j(null)},U=async()=>{if(!r||!n){j("Agent information not available");return}x(!0),j(null);try{const I=`${r}_customers`,{error:T}=await ge.from(I).update({ai_enabled:!m}).eq("id",e.customerId).eq("agent_id",n);if(T)throw T;s({...e,aiEnabled:!m}),f(!m)}catch(I){j(`Failed to update AI setting: ${I.message}`)}finally{x(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-700",style:{opacity:y?1:0},onClick:w}),a.jsxs("div",{className:`fixed right-0 top-0 h-full w-96 bg-gradient-to-b from-gray-50 to-white shadow-2xl z-50 border-l border-gray-200 transition-all duration-700 ease-out ${y?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:[a.jsxs("div",{className:"sticky top-0 bg-white/80 backdrop-blur-sm flex items-center p-4 border-b border-gray-200 z-10",children:[a.jsx("button",{onClick:w,className:"p-2 rounded-full hover:bg-gray-100 transition-colors mr-3",children:a.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),a.jsx("h2",{className:"text-xl font-bold text-gray-900 flex-1",children:"Contact info"}),!i&&a.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 rounded-lg transition-colors",children:"Edit"})]}),a.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto h-[calc(100%-80px)]",children:[b&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:b}),a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[a.jsxs("div",{className:"relative w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-lg ring-2 ring-white/50",children:[a.jsx("span",{className:"text-white font-bold text-xl drop-shadow-md",children:l.charAt(0).toUpperCase()}),a.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-2 border-white flex items-center justify-center",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[i?a.jsx("input",{type:"text",value:l,onChange:I=>c(I.target.value),className:"w-full text-2xl font-bold text-gray-900 border-0 border-b border-gray-300 focus:border-blue-500 focus:outline-none bg-transparent",placeholder:"Enter name"}):a.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e.customerName}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),i?a.jsx("input",{type:"tel",value:u,onChange:I=>d(I.target.value),className:"text-sm text-gray-600 border-0 border-b border-gray-300 focus:border-blue-500 focus:outline-none bg-transparent",placeholder:"Enter phone number"}):a.jsx("p",{className:"text-sm text-gray-600 truncate",children:e.customerPhone})]})]})]})}),i&&a.jsxs("div",{className:"flex space-x-3 pt-2",children:[a.jsx("button",{onClick:E,disabled:h,className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:h?a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Saving..."})]}):"Save"}),a.jsx("button",{onClick:$,disabled:h,className:"px-4 py-2.5 bg-gray-200 text-gray-700 rounded-xl font-medium hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all duration-200",children:"Cancel"})]}),a.jsx("div",{className:"border-t border-gray-200 pt-4"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-green-100 rounded-full mx-auto mb-2",children:a.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.messages.length}),a.jsx("p",{className:"text-sm text-gray-500",children:"Messages"})]}),a.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-full mx-auto mb-2",children:a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S}),a.jsx("p",{className:"text-sm text-gray-500",children:"Last seen"})]})]}),a.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"AI Agent"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Enable AI assistance for this contact"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"sr-only peer",checked:m,onChange:U,disabled:h}),a.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),e.unreadCount>0&&a.jsx("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-xl",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-xl font-bold text-orange-600",children:e.unreadCount})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Unread messages"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Tap to mark as read"})]})]})})]})]})]})},FV=({template:e,mediaPreviews:t,loadMediaPreview:r})=>a.jsxs("div",{className:"mt-2 border border-gray-200 rounded-lg p-4 max-w-md bg-gray-50 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b border-gray-100",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Your template"}),a.jsx("span",{className:"text-xs text-gray-500",children:"Template"})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:a.jsxs("div",{className:"bg-white rounded-2xl mb-3 border border-gray-200",children:[(()=>{var s,i,o,l,c,u;const n=e.components.find(d=>d.type.toLowerCase()==="header");if(n!=null&&n.format&&["IMAGE","VIDEO","DOCUMENT"].includes(n.format)){let d=((i=(s=e.mediaUrls)==null?void 0:s.header)==null?void 0:i.url)||t[e.id]||"",m=((l=(o=e.mediaUrls)==null?void 0:o.header)==null?void 0:l.handle)||"";if(!m){const f=(u=(c=n.example)==null?void 0:c.header_handle)==null?void 0:u[0];typeof f=="string"?m=f:typeof f=="object"&&(m=f.handle||f.id||"")}return!d&&m&&(r(e.id,m,n.format),d=t[e.id]||""),d?n.format==="IMAGE"?a.jsx("img",{src:d,alt:"Header media",className:"w-full h-auto object-contain",onError:f=>{f.currentTarget.style.display="none"}},"header-img"):n.format==="VIDEO"?a.jsx("video",{src:d,className:"w-full h-auto object-contain",muted:!0},"header-video"):a.jsx("div",{className:"w-full h-32 bg-gray-200 rounded flex items-center justify-center border border-gray-300",children:a.jsx("span",{className:"text-sm text-gray-500",children:"Document Header"})},"header-doc"):m?a.jsx("div",{className:"p-3 flex items-center justify-center border border-gray-300 bg-gray-100 rounded",children:a.jsxs("span",{className:"text-sm text-gray-500",children:[n.format," Header (loading media...)"]})}):a.jsx("div",{className:"p-3 flex items-center justify-center border border-gray-300 bg-gray-100 rounded",children:a.jsxs("span",{className:"text-sm text-gray-500",children:[n.format," Header (no media)"]})})}else if((n==null?void 0:n.format)==="LOCATION")return a.jsx("div",{className:"w-full h-32 bg-blue-100 rounded flex items-center justify-center",children:a.jsx("span",{className:"text-sm text-blue-600",children:" Location"})});return null})(),a.jsxs("div",{className:"p-2",children:[e.components.some(n=>n.type.toLowerCase()==="header"&&n.format==="TEXT"&&n.text)&&a.jsx("p",{className:"text-sm text-gray-800 font-medium mb-2 leading-relaxed whitespace-pre-wrap text-left",children:e.components.filter(n=>n.type.toLowerCase()==="header"&&n.format==="TEXT").map(n=>{var s;return((s=n.text)==null?void 0:s.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,"[Variable]"))||""}).join(`
`)}),a.jsx("p",{className:"text-sm text-gray-800 leading-relaxed whitespace-pre-wrap mb-1 text-left",children:e.components.filter(n=>n.type.toLowerCase()==="body").map(n=>{var s;return((s=n.text)==null?void 0:s.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,"[Variable]"))||"Enter body text..."}).join(`
`)}),e.components.some(n=>n.type.toLowerCase()==="footer")&&a.jsx("div",{className:"mb-1 text-xs text-gray-600 italic text-left",children:e.components.filter(n=>n.type.toLowerCase()==="footer").map(n=>{var s;return((s=n.text)==null?void 0:s.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,"[Variable]"))||""}).join(`
`)}),a.jsx("p",{className:"text-xs text-gray-400 text-right mb-2",children:"13:40"}),e.components.some(n=>n.type.toLowerCase()==="buttons"&&n.buttons&&n.buttons.length>0)&&a.jsx("div",{className:"border-t border-gray-200 mb-2"}),e.components.some(n=>n.type.toLowerCase()==="buttons"&&n.buttons&&n.buttons.length>0)&&a.jsx("div",{className:"space-y-1 mb-3",children:e.components.filter(n=>n.type.toLowerCase()==="buttons").flatMap(n=>(n.buttons||[]).map((s,i)=>{var l;const o={type:s.type,text:((l=s.text)==null?void 0:l.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,"[Variable]"))||s.text||""};return a.jsxs("div",{className:"w-full flex items-center justify-center gap-2 py-2 text-blue-500 text-sm font-medium hover:text-blue-600 border-t border-gray-200 first:border-t-0",children:[o.type==="PHONE_NUMBER"&&a.jsx(dC,{className:"h-4 w-4"}),o.type==="URL"&&a.jsx(iC,{className:"h-4 w-4"}),o.type==="QUICK_REPLY"&&a.jsx(oC,{className:"h-4 w-4"}),a.jsx("span",{children:o.text||`Button ${i+1}`})]},i)}))})]})]})})]}),C8=({isOpen:e,onClose:t,template:r,mediaPreviews:n,loadMediaPreview:s})=>!e||!r?null:a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{className:"text-xl font-semibold",children:["Template Preview: ",r.name]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(xp,{className:"h-6 w-6"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsx(FV,{template:r,mediaPreviews:n,loadMediaPreview:s})})]})}),Wo=(e,t,r)=>{const n=(e||"").trim();if(n)try{return JSON.parse(n),"[TEMPLATE]"}catch{return n}return t&&t!=="none"?r||`[${t.toUpperCase()}]`:"No message content"},DV=()=>{var Fl,Dl,di,oa;const[e]=BT(),t=ra(),[r,n]=g.useState([]),[s,i]=g.useState(""),[o,l]=g.useState(!0),[c,u]=g.useState(null),[d,m]=g.useState(null),[f,h]=g.useState(null),[x,b]=g.useState(null),[j,y]=g.useState(null),[_,w]=g.useState(!1),[S,E]=g.useState(null),[$,U]=g.useState(null),[I,T]=g.useState(!1),[D,C]=g.useState(Date.now()),P=g.useRef(null),[F,A]=g.useState([]),[R,H]=g.useState(!1),[W,M]=g.useState(null),[G,ce]=g.useState([]),[ue,O]=g.useState(null),[Z,B]=g.useState([]),[ee,X]=g.useState({}),[ne,le]=g.useState(!1),[de,je]=g.useState(!1),[me,Le]=g.useState(null),[ve,he]=g.useState(!1),[V,Re]=g.useState(null),[xe,Ce]=g.useState({}),[fe,We]=g.useState(null),[Oe,nt]=g.useState(""),[K,be]=g.useState(!1),[_e,re]=g.useState([]),[De,se]=g.useState(""),[Pe,Ee]=g.useState(!1),[Ne,Me]=g.useState({name:"",phone:""}),[Ve,$e]=g.useState("+94"),[Ye,pt]=g.useState({}),it=async we=>{if(!fe||!Pr){E("No conversation selected");return}if(Pr.lastUserMessageTime){const He=new Date(Pr.lastUserMessageTime);if((Date.now()-He.getTime())/(1e3*60*60)>24){M("Template required after 24h window"),H(!0);return}}w(!0),E(null);try{const{data:{user:He}}=await ge.auth.getUser();if(!He)throw new Error("Not authenticated");const Fe=Pr.customerPhone.replace(/[\s+]/g,"");await Jn();try{const{data:ot}=await ge.from("whatsapp_configuration").select("webhook_url, phone_number_id").eq("user_id",He.id).eq("is_active",!0).single();if(ot!=null&&ot.webhook_url){const et=`I want full details of ${we.name} and sku is ${we.id} without images.`,rt={event:"message_received",data:{id:`product-select-${Date.now()}`,customer_id:Pr.customerId,message:et,direction:"inbound",timestamp:new Date().toISOString(),is_read:!1,media_type:"none",media_url:null,caption:null,customer_phone:Fe,customer_name:Pr.customerName,agent_prefix:f,agent_user_id:He.id,phone_number_id:ot.phone_number_id||null}},ht=await fetch(ot.webhook_url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});if(!ht.ok){const at=await ht.text()}}}catch{}const{data:lt,error:ft}=await ge.functions.invoke("send-product-images",{body:{user_id:He.id,agent_prefix:f,product_id:parseInt(we.id),customer_phone:Fe}});(ft||!(lt!=null&&lt.success))&&E(`Failed to send product images: ${(ft==null?void 0:ft.message)||(lt==null?void 0:lt.message)}`)}catch(He){E(`Failed to send product: ${He.message}`)}finally{w(!1)}},[Je,Xe]=g.useState(!1),[At,Pt]=g.useState(!1),Lt=async()=>{if(!f||!d)return;const we=`${f}_templates`,{data:He,error:Fe}=await ge.from(we).select("*").eq("agent_id",d).eq("is_active",!0).neq("name","invoice_template");Fe?M("Failed to load templates"):(ce(He||[]),M(null))},St=async we=>{var He,Fe,lt;if(ue){je(!0),M(null);try{const{data:{session:ft}}=await ge.auth.getSession();if(!(ft!=null&&ft.access_token))throw new Error("Not authenticated");const ot=new FormData;ot.append("file",we),ot.append("caption","");const{data:et,error:rt}=await ge.functions.invoke("upload-media",{body:ot,headers:{Authorization:`Bearer ${ft.access_token}`}});let ht;if(rt){let ut=rt.body;if(typeof ut=="string")try{const Mt=JSON.parse(ut);ht=Mt.error||Mt.message||ut}catch{ht=ut}else typeof ut=="object"&&ut!==null?ht=ut.error||ut.message||rt.message:ht=rt.message||"Failed to upload media"}else ht=(et==null?void 0:et.error)||"Failed to upload media";if(rt||!(et!=null&&et.success))throw new Error(ht);const at=(He=et.media)==null?void 0:He[0];if(!at)throw new Error("No media in response");const wt=(Fe=ue.body.components)==null?void 0:Fe.find(ut=>ut.type==="HEADER"),Bt=((lt=wt==null?void 0:wt.format)==null?void 0:lt.toLowerCase())||"image";Le({id:at.media_id,type:Bt,url:at.media_download_url})}catch(ft){M(`Failed to upload media: ${ft.message}`)}finally{je(!1)}}},dt=we=>{const He=we.match(/\{\{(\d+)\}\}/g);return He?He.map(lt=>parseInt(lt.slice(2,-1))).filter((lt,ft,ot)=>ot.indexOf(lt)===ft).sort((lt,ft)=>lt-ft):[]},fr=we=>{var Fe;O(we);const He=dt(((Fe=we.body.components.find(lt=>lt.type==="BODY"))==null?void 0:Fe.text)||"");B(Array(He.length).fill("")),X({})},Ft=(we,He)=>{const Fe=[...Z];Fe[we]=He,B(Fe),X(lt=>({...lt,[we]:He}))},bn=async()=>{var He;if(!fe||!Pr||!ue){M("Please select a template and fill all parameters");return}let we=[...Z];if(ue.name==="welcome_template")we=[j||"Our Business"];else if(Z.some(Fe=>!Fe.trim())){M("Please fill all parameters");return}if(ne&&!me){M("Please upload media for the template header");return}(He=ue.body.components.find(Fe=>Fe.type==="BODY"))!=null&&He.text.replace(/\{\{(\d+)\}\}/g,(Fe,lt)=>{const ft=parseInt(lt)-1;return Z[ft]||`[${lt}]`})||ue.name,w(!0),M(null);try{const{data:{user:Fe}}=await ge.auth.getUser();if(!Fe)throw new Error("Not authenticated");const lt=Pr.customerPhone.replace(/[\s+]/g,""),ft={user_id:Fe.id,customer_phone:lt,type:"template",template_name:ue.name,template_params:we.map(rt=>({type:"text",text:rt})),header_params:ue.name==="welcome_template"?[{type:"text",text:j||"Our Business"}]:[],category:"utility"};me&&(ft.media_header={type:me.type,id:me.id});const{data:ot,error:et}=await ge.functions.invoke("send-whatsapp-message",{body:ft});if(et||!(ot!=null&&ot.success)){const rt=(ot==null?void 0:ot.error)||(et==null?void 0:et.message)||"Failed to send template";if(rt.includes("Insufficient credits"))M("Insufficient credits for template message. Please add credits in Settings.");else throw new Error(rt)}else H(!1),O(null),B([]),X({}),Le(null),le(!1),E("Template sent successfully. 0.01 credits deducted."),await Jn()}catch(Fe){Fe.message.includes("Insufficient credits")||M(`Failed to send template: ${Fe.message}`)}finally{w(!1),U(null)}};g.useEffect(()=>{R&&Lt()},[R,f,d]),g.useEffect(()=>{Pt(navigator.platform.toUpperCase().indexOf("MAC")>=0)},[]);const[wn,Nt]=g.useState([]),[Wt,Yr]=g.useState([]),er=g.useRef(null),cr=g.useRef(null),ar=we=>{i(we.target.value)},Sr=g.useMemo(()=>{const we=s.toLowerCase().trim();return we?r.filter(He=>He.customerName.toLowerCase().includes(we)||He.customerPhone.includes(we)||He.lastMessage.toLowerCase().includes(we)):r},[r,s]),It=()=>{be(!0)},nr=g.useCallback(async()=>{if(!(!f||!d))try{const we=`${f}_customers`,{data:He,error:Fe}=await ge.from(we).select("id, name, phone, last_user_message_time, ai_enabled").eq("agent_id",d);if(Fe)return;re(He||[])}catch{}},[f,d]);g.useEffect(()=>{f&&d&&nr()},[nr]);const zr=we=>{se(we.target.value)},ur=_e.filter(we=>we.name.toLowerCase().includes(De.toLowerCase())||we.phone.includes(De)),sn=async we=>{if(we.preventDefault(),!f||!d||!Ne.name.trim()||!Ne.phone.trim())return;const He=`${Ve}${Ne.phone}`.replace("+","");Ee(!0);try{const Fe=`${f}_customers`,{data:lt,error:ft}=await ge.from(Fe).insert({name:Ne.name.trim(),phone:He,agent_id:d,ai_enabled:!1}).select().single();if(ft)return;re(ot=>[lt,...ot]),Me({name:"",phone:""}),$e("+94"),Ee(!1),mn(lt.id,lt.name,He,lt.last_user_message_time)}catch{Ee(!1)}},mn=(we,He,Fe,lt)=>{const ft={id:we,customerId:we,customerName:He,customerPhone:Fe,lastUserMessageTime:lt||null,aiEnabled:!1,lastMessage:"New conversation started",lastMessageTime:new Date().toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}),unreadCount:0,messages:[]};n(ot=>ot.find(ht=>ht.customerId===we)?ot.map(at=>at.customerId===we?{...ft,rawLastTimestamp:Date.now()}:at):[{...ft,rawLastTimestamp:Date.now()},...ot]),We(we),be(!1)},$n=we=>{const He=r.find(Fe=>Fe.customerId===we.id);He?We(He.id):mn(we.id,we.name,we.phone,we.last_user_message_time),be(!1)},Zr=we=>{Me({...Ne,[we.target.name]:we.target.value})},hs=we=>{const He=we.target.value.replace(/\D/g,"");Me({...Ne,[we.target.name]:He})},fs=we=>{we.target.name==="name"?Zr(we):we.target.name==="phone"&&hs(we)},Ii=we=>{$e(we),!Ne.phone.startsWith(we.replace("+",""))&&Me({...Ne,phone:""})},Pr=g.useMemo(()=>r.find(we=>we.id===fe)||null,[r,fe]);g.useEffect(()=>{A([])},[fe]);const ms=g.useCallback(async(we=!1)=>{var He;try{we&&(l(!0),u(null));const{data:{user:Fe},error:lt}=await ge.auth.getUser();if(lt||!Fe){u("User not authenticated"),we&&l(!1);return}const{data:ft,error:ot}=await ge.from("agents").select(`
            id,
            agent_prefix,
            business_type,
            users!agents_user_id_fkey (
              name
            )
          `).eq("user_id",Fe.id).single();if(ot||!ft){u("Agent not found"),we&&l(!1);return}const et=ft.id,rt=ft.agent_prefix,ht=ft.business_type,at=((He=ft.users)==null?void 0:He.name)||null;if(m(et),h(rt),b(ht),y(at),!rt){u("Agent prefix not found"),we&&l(!1);return}const wt=`${rt}_customers`,{data:Bt,error:ut}=await ge.from(wt).select("id, name, phone, last_user_message_time, ai_enabled, lead_stage, interest_stage, conversion_stage, created_at").eq("agent_id",et);if(Nt((Bt==null?void 0:Bt.map(Fr=>Fr.id))||[]),ut){u("Failed to fetch assigned customers"),we&&l(!1);return}if(!Bt||Bt.length===0){n([]),we&&l(!1);return}const Mt=Bt.map(Fr=>Fr.id),qr=`${rt}_messages`,{data:Bn,error:Oi}=await ge.from(qr).select("id, customer_id, message, direction, timestamp, is_read, media_type, media_url, caption").in("customer_id",Mt).order("timestamp",{ascending:!1});if(Oi){u("Failed to fetch messages"),we&&l(!1);return}const qs={};Bt.forEach(Fr=>{const Yt={id:Fr.id,name:Fr.name,phone:Fr.phone,last_user_message_time:Fr.last_user_message_time,aiEnabled:Fr.ai_enabled||!1,leadStage:Fr.lead_stage||null,interestStage:Fr.interest_stage||null,conversionStage:Fr.conversion_stage||null,created_at:Fr.created_at},bt=(Bn==null?void 0:Bn.filter(Dr=>Dr.customer_id===Yt.id))||[];bt.sort((Dr,la)=>new Date(Dr.timestamp).getTime()-new Date(la.timestamp).getTime());const ps=bt.map(Dr=>({id:Dr.id,text:(()=>{const la=Dr.message||"";if(la.trim()&&Dr.direction==="outbound")try{if(JSON.parse(la).is_template)return la}catch{}return Wo(la,Dr.media_type,Dr.caption)})(),sender:Dr.direction==="inbound"?"customer":"agent",timestamp:new Date(Dr.timestamp).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}),rawTimestamp:new Date(Dr.timestamp).getTime(),isRead:Dr.is_read??Dr.direction==="outbound",media_type:Dr.media_type||"none",media_url:Dr.media_url||null,caption:Dr.caption||null})),hi=ps.filter(Dr=>Dr.sender==="customer"&&!Dr.isRead).length,As=bt[bt.length-1],Ad=As?Wo(As.message,As.media_type,As.caption):"No messages yet",Ri=As?new Date(As.timestamp).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}):new Date(Yt.created_at).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}),Fi=As?new Date(As.timestamp).getTime():new Date(Yt.created_at).getTime();qs[Yt.id]={id:Yt.id,customerId:Yt.id,customerName:Yt.name,customerPhone:Yt.phone,lastUserMessageTime:Yt.last_user_message_time||null,aiEnabled:Yt.aiEnabled||!1,leadStage:Yt.leadStage,interestStage:Yt.interestStage,conversionStage:Yt.conversionStage,lastMessage:Ad,lastMessageTime:Ri,rawLastTimestamp:Fi,unreadCount:hi,messages:ps}});const So=Object.values(qs);n(Fr=>So.map(ps=>{const hi=Fr.find(As=>As.id===ps.id);return hi&&fe===ps.id&&hi.unreadCount===0?{...ps,unreadCount:0}:ps}).sort((ps,hi)=>hi.rawLastTimestamp-ps.rawLastTimestamp))}catch{u("Failed to load conversations")}finally{we&&l(!1)}},[f,fe]),Jn=g.useCallback(async()=>{if(!fe||!f||!d)return;const we=`${f}_customers`,He=`${f}_messages`,{data:Fe,error:lt}=await ge.from(we).select("id, name, phone, last_user_message_time, ai_enabled, lead_stage, interest_stage, conversion_stage").eq("id",fe).single();if(lt||!Fe)return;const{data:ft,error:ot}=await ge.from(He).select("*").eq("customer_id",fe).order("timestamp",{ascending:!0});if(ot)return;const et=ft.map(Mt=>({id:Mt.id,text:(()=>{const qr=Mt.message||"";if(qr.trim()&&Mt.direction==="outbound")try{if(JSON.parse(qr).is_template)return qr}catch{}return Wo(qr,Mt.media_type,Mt.caption)})(),sender:Mt.direction==="inbound"?"customer":"agent",timestamp:new Date(Mt.timestamp).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}),rawTimestamp:new Date(Mt.timestamp).getTime(),isRead:Mt.is_read??Mt.direction==="outbound",media_type:Mt.media_type||"none",media_url:Mt.media_url||null,caption:Mt.caption||null})),rt=et.filter(Mt=>Mt.sender==="customer"&&!Mt.isRead).length,ht=et[et.length-1],at=ht?Wo(ht.text,ht.media_type||null,ht.caption||null):"No messages yet",wt=ht?ht.timestamp:new Date().toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}),Bt=ht?ht.rawTimestamp:Date.now(),ut={id:Fe.id,customerId:Fe.id,customerName:Fe.name,customerPhone:Fe.phone,lastUserMessageTime:Fe.last_user_message_time||null,aiEnabled:Fe.ai_enabled||!1,leadStage:Fe.lead_stage||null,interestStage:Fe.interest_stage||null,conversionStage:Fe.conversion_stage||null,lastMessage:at,lastMessageTime:wt,rawLastTimestamp:Bt??Date.now(),unreadCount:rt,messages:et};n(Mt=>Mt.map(qr=>qr.id===fe?ut:qr))},[fe,f,d,Wo]);g.useEffect(()=>{ms(!0)},[]),g.useEffect(()=>{if(!f||!d)return;const we=`${f}_customers`,He=`${f}_messages`;let Fe=!0;const lt=ge.channel(`messages-${d}`).on("postgres_changes",{event:"INSERT",schema:"public",table:He,filter:wn.length>0?`customer_id=in.(${wn.join(",")})`:"*"},async ot=>{if(!Fe)return;const et=ot.new;let rt={id:et.id,text:(()=>{const at=et.message||"";if(at.trim()&&et.direction==="outbound")try{if(JSON.parse(at).is_template)return at}catch{}return Wo(at,et.media_type,et.caption)})(),sender:et.direction==="inbound"?"customer":"agent",timestamp:new Date(et.timestamp).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}),rawTimestamp:new Date(et.timestamp).getTime(),isRead:et.is_read??et.direction==="outbound",media_type:et.media_type||"none",media_url:et.media_url||null,caption:et.caption||null};if(et.direction==="inbound"&&fe===et.customer_id){const{error:at}=await ge.from(He).update({is_read:!0}).eq("id",et.id);at||(rt.isRead=!0)}if(r.find(at=>at.customerId===et.customer_id))n(at=>{const wt=at.findIndex(Yt=>Yt.customerId===et.customer_id);if(wt===-1)return at;const Bt=at[wt];let ut=[...Bt.messages];rt.rawTimestamp=new Date(et.timestamp).getTime();let Mt=-1;for(let Yt=ut.length-1;Yt>=0;Yt--){const bt=ut[Yt];if(typeof bt.id=="string"&&(bt.id.startsWith("temp-")||bt.id.startsWith("temp-template-"))&&bt.sender===rt.sender&&bt.text===rt.text){Mt=Yt;break}}Mt!==-1?ut[Mt]=rt:ut.push(rt),ut.sort((Yt,bt)=>{const ps=Yt.rawTimestamp||new Date(Yt.timestamp).getTime(),hi=bt.rawTimestamp||new Date(bt.timestamp).getTime();return ps-hi});const qr=ut.filter(Yt=>Yt.sender==="customer"&&!Yt.isRead).length,Bn=ut[ut.length-1],Oi=Wo(et.message,et.media_type,et.caption),qs={...Bt,messages:ut,lastMessage:Oi,lastMessageTime:Bn.timestamp,rawLastTimestamp:new Date(et.timestamp).getTime(),unreadCount:qr},So=[...at];return So[wt]=qs,So.sort((Yt,bt)=>bt.rawLastTimestamp-Yt.rawLastTimestamp)});else{const{data:at,error:wt}=await ge.from(we).select("id, name, phone, last_user_message_time, lead_stage, interest_stage, conversion_stage").eq("id",et.customer_id).single();if(wt||!at)return;const Bt={id:at.id,customerId:at.id,customerName:at.name,customerPhone:at.phone,lastUserMessageTime:at.last_user_message_time||null,leadStage:null,lastMessage:Wo(et.message,et.media_type,et.caption),lastMessageTime:rt.timestamp,rawLastTimestamp:new Date(et.timestamp).getTime(),unreadCount:rt.isRead?0:1,messages:[rt]};n(ut=>[Bt,...ut].sort((qr,Bn)=>Bn.rawLastTimestamp-qr.rawLastTimestamp))}C(Date.now())}).on("postgres_changes",{event:"UPDATE",schema:"public",table:He,filter:"is_read=eq.true"},ot=>{const et=ot.new;n(rt=>{const ht=rt.map(at=>{if(at.customerId===et.customer_id){const wt=at.messages.map(ut=>ut.id===et.id?{...ut,isRead:!0}:ut),Bt=wt.filter(ut=>ut.sender==="customer"&&!ut.isRead).length;return{...at,messages:wt,unreadCount:Bt}}return at});return C(Date.now()),ht})}).subscribe(ot=>{ot==="SUBSCRIBED"||(ot==="CLOSED"||ot==="CHANNEL_ERROR")&&setTimeout(()=>{lt.subscribe()},3e3)}),ft=ge.channel(`customers-${d}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:we,filter:`agent_id=eq.${d}`},async ot=>{const et=ot.new;if(et.last_user_message_time){const rt=new Date(et.last_user_message_time);(Date.now()-rt.getTime())/(1e3*60*60)>24&&await ms(!1)}}).subscribe(ot=>{(ot==="CLOSED"||ot==="CHANNEL_ERROR")&&setTimeout(()=>{ft.subscribe()},3e3)});return Yr([lt,ft]),()=>{Fe=!1,ge.removeChannel(lt),ge.removeChannel(ft),Yr([])}},[f,d]),g.useEffect(()=>{const we=()=>{er.current&&(er.current.style.height=`${window.innerHeight-80}px`)};return we(),window.addEventListener("resize",we),()=>{window.removeEventListener("resize",we)}},[]);const Mi=g.useCallback(async we=>{const He=we.unreadCount,Fe=we.customerId;if(We(we.id),n(lt=>lt.map(ft=>ft.id===we.id?{...ft,unreadCount:0}:ft)),f&&d)try{const lt=`${f}_messages`,{error:ft}=await ge.from(lt).update({is_read:!0}).eq("customer_id",we.customerId).eq("direction","inbound").eq("is_read",!1);!ft&&He>0&&window.dispatchEvent(new CustomEvent("unread-messages-read",{detail:{customerId:Fe,count:He}}))}catch{}},[f,d]);g.useEffect(()=>{const we=e.get("customerId");if(we&&r.length>0){const He=Number(we),Fe=r.find(lt=>lt.customerId===He);Fe&&Fe.id!==fe&&(Mi(Fe),t("/agent/conversations"))}},[e,r,fe,Mi,t]);const ia=g.useCallback(()=>{if(cr.current){const we=cr.current;we.scrollTop=we.scrollHeight}},[]);g.useEffect(()=>{if(fe!==null&&Pr){const we=setTimeout(ia,150);return()=>clearTimeout(we)}},[fe,Pr==null?void 0:Pr.messages.length,ia]),g.useEffect(()=>{if(!fe||!f||!d){P.current&&(clearInterval(P.current),P.current=null);return}const we=1e4,He=1e3,Fe=()=>{Date.now()-D>we&&Jn()};return P.current=setInterval(Fe,He),Fe(),()=>{P.current&&(clearInterval(P.current),P.current=null)}},[fe,f,d,D,Jn]),g.useEffect(()=>{if(!f||!d)return;const we=setInterval(()=>{ms(!1)},3e3);return()=>clearInterval(we)},[f,d,ms]);const _o=(we,He=800,Fe=800)=>new Promise((lt,ft)=>{const ot=new Image,et=new FileReader;et.onload=rt=>{var ht;ot.src=(ht=rt.target)==null?void 0:ht.result},et.onerror=ft,et.readAsDataURL(we),ot.onload=()=>{const rt=document.createElement("canvas"),ht=rt.getContext("2d");let{width:at,height:wt}=ot;at>wt?at>He&&(wt=wt*He/at,at=He):wt>Fe&&(at=at*Fe/wt,wt=Fe),rt.width=at,rt.height=wt,ht.drawImage(ot,0,0,at,wt),rt.toBlob(Bt=>{if(Bt){const ut=new File([Bt],we.name,{type:we.type});lt(ut)}else ft(new Error("Failed to resize image"))},we.type,.8)},ot.onerror=ft}),Oa=async we=>{var ft;if(!fe||!Pr){E("No conversation selected");return}if(we.length===0)return;const He={"image/jpeg":5*1024*1024,"image/png":5*1024*1024,"image/webp":500*1024,"text/plain":100*1024*1024,"application/pdf":100*1024*1024,"application/msword":100*1024*1024,"application/vnd.openxmlformats-officedocument.wordprocessingml.document":100*1024*1024,"application/vnd.ms-excel":100*1024*1024,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":100*1024*1024,"application/vnd.ms-powerpoint":100*1024*1024,"application/vnd.openxmlformats-officedocument.presentationml.presentation":100*1024*1024,"audio/aac":16*1024*1024,"audio/amr":16*1024*1024,"audio/mpeg":16*1024*1024,"audio/mp4":16*1024*1024,"audio/ogg":16*1024*1024,"video/3gpp":16*1024*1024,"video/mp4":16*1024*1024},Fe=[],lt=[];if(we.forEach(ot=>{const et=He[ot.type];if(et===void 0)Fe.push(`Unsupported file type: ${ot.name} (${ot.type})`);else if(ot.size>et){const rt=(et/1048576).toFixed(1);Fe.push(`File too large: ${ot.name} (${(ot.size/(1024*1024)).toFixed(1)}MB) exceeds ${rt}MB limit for ${ot.type}`)}else lt.push(ot)}),Fe.length>0){E(Fe.join(`
`));return}if(lt.length===0){E("No valid files to upload");return}T(!0),E(null);try{const ot=await Promise.all(lt.map(async ut=>ut.type.startsWith("image/")?await _o(ut):ut)),{data:{session:et}}=await ge.auth.getSession();if(!(et!=null&&et.access_token))throw new Error("Not authenticated");const rt=new FormData;ot.forEach(ut=>rt.append("file",ut));const{data:ht,error:at}=await ge.functions.invoke("upload-media",{body:rt,headers:{Authorization:`Bearer ${et.access_token}`}});let wt;if(at){let ut=at.body;if(typeof ut=="string")try{const Mt=JSON.parse(ut);wt=Mt.error||Mt.message||ut}catch{wt=ut}else typeof ut=="object"&&ut!==null?wt=ut.error||ut.message||at.message:wt=at.message||"Failed to upload media"}else wt=(ht==null?void 0:ht.error)||"Failed to upload media";if(at||!(ht!=null&&ht.success))throw new Error(wt);const Bt=ht.media||[];if(Bt.length===0)throw new Error("No media uploaded");if(((ft=ht.errors)==null?void 0:ft.length)>0){const ut=ht.errors.map(Mt=>Mt.error).join("; ");throw new Error(`Some uploads failed: ${ut}`)}A(Bt.map(ut=>({id:ut.media_id,url:ut.media_download_url,media_type:ut.media_type,filename:ut.filename}))),E(null)}catch(ot){E(`Failed to upload media: ${ot.message}`)}finally{T(!1)}},In=async()=>{if(Oe.trim()==="Make this in properway and send again with images"){if(!fe){E("No conversation selected");return}const we=Ye[fe];if(!we){E("No recent product found to re-send with full details");return}const He=r.find(Fe=>Fe.id===fe);if(!He){E("Conversation not found");return}if(He.lastUserMessageTime){const Fe=new Date(He.lastUserMessageTime);if((Date.now()-Fe.getTime())/(1e3*60*60)>24){M("Template required after 24h window"),H(!0);return}}w(!0),E(null),nt("");try{const{data:{user:Fe}}=await ge.auth.getUser();if(!Fe)throw new Error("Not authenticated");const lt=He.customerPhone.replace(/[\s+]/g,"");let ft=`*${we.name}*

`;we.description&&(ft+=`${we.description}

`),we.price&&(ft+=`Price: $${we.price.toFixed(2)}
`),ft+="Interested? Reply with your order!";const ot={user_id:Fe.id,customer_phone:lt,message:ft,type:"text",category:"utility"},{data:et,error:rt}=await ge.functions.invoke("send-whatsapp-message",{body:ot});if(rt||!(et!=null&&et.success))throw new Error((et==null?void 0:et.error)||(rt==null?void 0:rt.message)||"Failed to send full product details");if(we.images&&we.images.length>0)for(const ht of we.images){const at={...ot,type:"image",media_url:ht,caption:"Product image"};await ge.functions.invoke("send-whatsapp-message",{body:at})}await Jn()}catch(Fe){E(`Failed to re-send full product: ${Fe.message}`)}finally{w(!1)}return}if(F.length>0){const we=r.find(rt=>rt.id===fe);if(!we){E("Conversation not found");return}if(we.lastUserMessageTime){const rt=new Date(we.lastUserMessageTime);if((Date.now()-rt.getTime())/(1e3*60*60)>24){M("Template required for media after 24h window"),H(!0);return}}const He=we.customerPhone,Fe=Oe.trim(),lt=F[0].media_type,ft=Date.now(),ot=F.map((rt,ht)=>({id:`temp-${ft+ht}`,text:Fe||`[${lt.toUpperCase()}]`,sender:"agent",timestamp:new Date(ft+ht*100).toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}),rawTimestamp:ft+ht*100,isRead:!0,media_type:rt.media_type,media_url:rt.url,caption:Fe||null}));n(rt=>rt.map(ht=>ht.id===fe?{...ht,messages:[...ht.messages,...ot],lastMessage:Fe||`[${F.length} ${lt}s]`,lastMessageTime:"Just now",rawLastTimestamp:ft}:ht));const et=ot.map(rt=>rt.id);U(et.map(rt=>String(rt))),w(!0),E(null);try{const{data:{user:rt}}=await ge.auth.getUser();if(!rt)throw new Error("User not authenticated");const ht=He.replace(/[\s+]/g,""),at={user_id:rt.id,customer_phone:ht,type:lt,category:"utility",caption:Fe,media_ids:F.map(ut=>ut.id)},{data:wt,error:Bt}=await ge.functions.invoke("send-whatsapp-message",{body:at});if(Bt||!(wt!=null&&wt.success)){const ut=(wt==null?void 0:wt.error)||(Bt==null?void 0:Bt.message)||"Failed to send media";if(ut.includes("Template required after 24h window")){if(f&&d){const Mt=`${f}_templates`,{data:qr,error:Bn}=await ge.from(Mt).select("*").eq("agent_id",d).eq("is_active",!0).eq("category","utility").neq("name","invoice_template");Bn||ce(qr||[])}M(ut),H(!0)}else throw new Error(ut)}n(ut=>ut.map(Mt=>Mt.id===fe?{...Mt,messages:Mt.messages.filter(qr=>!et.includes(String(qr.id)))}:Mt)),await ms(!1)}catch(rt){E(`Failed to send media: ${rt.message}`),n(ht=>ht.map(at=>at.id===fe?{...at,messages:at.messages.filter(wt=>!et.includes(String(wt.id)))}:at))}finally{w(!1),U(null),A([]),nt("")}return}if(Oe.trim()&&fe!==null&&!_){const we=r.find(rt=>rt.id===fe);if(!we){E("Conversation not found");return}if(we.lastUserMessageTime){const rt=new Date(we.lastUserMessageTime);if((Date.now()-rt.getTime())/(1e3*60*60)>24){const at="Template required after 24h window";if(f&&d){const wt=`${f}_templates`,{data:Bt,error:ut}=await ge.from(wt).select("*").eq("agent_id",d).eq("is_active",!0).eq("category","utility").neq("name","invoice_template");ut||ce(Bt||[])}M(at),H(!0);return}}const He=Oe.trim(),Fe=we.customerPhone,lt=`temp-${Date.now()}`,ft={id:lt,text:He,sender:"agent",timestamp:new Date().toLocaleString([],{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}),rawTimestamp:Date.now(),isRead:!0};n(rt=>rt.map(ht=>ht.id===fe?{...ht,messages:[...ht.messages,ft],lastMessage:He,lastMessageTime:"Just now"}:ht));const ot=[String(lt)];U(ot),nt(""),w(!0),E(null);let et=null;try{const{data:{user:rt}}=await ge.auth.getUser();if(!rt)throw new Error("User not authenticated");const ht=Fe.replace(/[\s+]/g,""),{data:at,error:wt}=await ge.functions.invoke("send-whatsapp-message",{body:{user_id:rt.id,customer_phone:ht,message:He,type:"text",category:"utility"}});if(wt||!(at!=null&&at.success)){const Bt=(at==null?void 0:at.error)||(wt==null?void 0:wt.message)||"Failed to send message";if(Bt.includes("Template required after 24h window")){if(f&&d){const ut=`${f}_templates`,{data:Mt,error:qr}=await ge.from(ut).select("*").eq("agent_id",d).eq("is_active",!0).eq("category","utility");qr||ce(Mt||[])}M(Bt),H(!0)}else throw new Error(Bt)}et=at,n(Bt=>Bt.map(ut=>ut.id===fe?{...ut,messages:ut.messages.filter(Mt=>!ot.includes(String(Mt.id)))}:ut))}catch(rt){E(`Failed to send message: ${rt.message}`),n(ht=>ht.map(at=>at.id===fe?{...at,messages:at.messages.filter(wt=>!ot.includes(String(wt.id)))}:at))}finally{w(!1),U(null)}}},aa=r.reduce((we,He)=>we+He.unreadCount,0);r.length;const jo=Sr.length;g.useEffect(()=>{R&&Lt()},[R,f,d]);const Ra=we=>{const He=At?we.metaKey:we.ctrlKey;if(we.key==="Enter"&&!He)we.preventDefault(),In();else if(we.key==="Enter"&&He){we.preventDefault();const Fe=we.target,lt=Fe.selectionStart||0,ft=Fe.selectionEnd||0,ot=Oe,et=ot.substring(0,lt)+`
`+ot.substring(ft);nt(et),setTimeout(()=>{Fe.selectionStart=Fe.selectionEnd=lt+1,Fe.focus()},0)}},Hc=()=>{A([]),E(null)},Rl=()=>{H(!1),M(null),O(null),B([]),X({}),Le(null),le(!1)},Gc=we=>{var Fe,lt;const He={id:we.name,name:we.name,language:we.language||"en",category:we.category||"utility",components:((Fe=we.body)==null?void 0:Fe.components)||[],body:we.body,mediaUrls:((lt=we.body)==null?void 0:lt.media_urls)||{},status:we.status||"APPROVED",created_time:we.created_at};Re(He),he(!0)},No=async we=>{try{const{data:{session:He}}=await ge.auth.getSession();if(!(He!=null&&He.user))return"";const{data:Fe}=await ge.from("whatsapp_configuration").select("business_account_id, phone_number_id, api_key").eq("user_id",He.user.id).single();if(!Fe)return"";if(we.startsWith("http"))return we;const{api_key:lt,phone_number_id:ft}=Fe,ot=new URL(`https://graph.facebook.com/v20.0/${ft}/media/${we}`);ot.searchParams.append("access_token",lt);const et=await fetch(ot.toString(),{method:"GET"});return et.ok&&(await et.json()).url||""}catch{return""}},Ed=async(we,He,Fe)=>{if(xe[we])return;const lt=await No(He);lt&&Ce(ft=>({...ft,[we]:lt}))},Jr=we=>{nt(we.target.value)};return a.jsxs("div",{className:"flex bg-gray-50 overflow-hidden",ref:er,style:{position:"relative"},children:[a.jsx(vB,{conversations:r,filteredConversations:Sr,searchConversations:s,selectedConversationId:fe,totalUnread:aa,displayedConversations:jo,onSearchChange:ar,onSelectConversation:Mi,onNewConversation:It}),a.jsx(OV,{selectedConversation:Pr,newMessage:Oe,sending:_,sendError:S,onMessageChange:Jr,onSendMessage:In,onKeyPress:Ra,onFileSelect:Oa,uploading:I,hasPendingMedia:F.length>0,pendingMedia:F,onClearPendingMedia:Hc,messagesContainerRef:cr,onOpenTemplateModal:()=>H(!0),onOpenContactDetails:()=>Xe(!0),onSelectProduct:it,onUpdateConversation:we=>{n(He=>He.map(Fe=>Fe.id===we.id?we:Fe))},agentPrefix:f,agentId:d,businessType:x}),K&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"New Conversation"}),a.jsx("button",{onClick:()=>be(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search existing customer"}),a.jsx("input",{type:"text",placeholder:"Search by name or phone...",value:De,onChange:zr,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),ur.length>0&&a.jsxs("div",{className:"mb-6 max-h-48 overflow-y-auto",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Existing Customers"}),a.jsx("div",{className:"space-y-2",children:ur.map(we=>a.jsxs("button",{onClick:()=>$n(we),className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx("div",{className:"font-medium text-gray-900",children:we.name}),a.jsx("div",{className:"text-sm text-gray-600",children:we.phone})]},we.id))})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Or create new customer"}),a.jsxs("form",{onSubmit:sn,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),a.jsx("input",{type:"text",name:"name",placeholder:"Enter customer name",value:Ne.name,onChange:fs,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("select",{value:Ve,onChange:we=>Ii(we.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 w-32",children:[a.jsx("option",{value:"+1",children:" +1"}),a.jsx("option",{value:"+44",children:" +44"}),a.jsx("option",{value:"+91",children:" +91"}),a.jsx("option",{value:"+94",children:" +94"}),a.jsx("option",{value:"+971",children:" +971"}),a.jsx("option",{value:"+966",children:" +966"}),a.jsx("option",{value:"+92",children:" +92"}),a.jsx("option",{value:"+880",children:" +880"}),a.jsx("option",{value:"+98",children:" +98"}),a.jsx("option",{value:"+20",children:" +20"})]}),a.jsx("input",{type:"tel",name:"phone",placeholder:"Phone Number",value:Ne.phone,onChange:fs,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Full number will be: ",Ve," ",Ne.phone]})]}),a.jsx("button",{type:"submit",disabled:Pe,className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:Pe?"Creating...":"Create Customer & Start Chat"})]})]})]})]})}),R&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Template Required"}),a.jsx("button",{onClick:Rl,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"The 24-hour messaging window has expired. Please select an approved template to continue the conversation."}),a.jsxs("div",{className:"space-y-3 mb-6",children:[W&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:W}),G.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{children:"No templates available yet"}),a.jsx("p",{className:"text-xs",children:"Templates will appear here once configured"})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Template"}),G.map(we=>a.jsx("div",{className:`p-3 border rounded-lg transition-colors ${(ue==null?void 0:ue.name)===we.name?"border-green-500 bg-green-50":"border-gray-200 hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("button",{onClick:()=>fr(we),className:"text-left",children:a.jsx("div",{className:"font-medium text-gray-900",children:we.name.replace(/_/g," ").toUpperCase()})}),a.jsx("button",{onClick:()=>Gc(we),className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded",title:"View template",children:a.jsx(uC,{className:"h-4 w-4"})})]})},we.name))]}),ue&&a.jsxs("div",{className:"space-y-3 mt-4 pt-4 border-t",children:[ne&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Media Header (Required)"}),a.jsx("input",{type:"file",accept:((Dl=(Fl=ue.body.components)==null?void 0:Fl.find(we=>we.type==="HEADER"))==null?void 0:Dl.format.toLowerCase())==="image"?"image/*":((oa=(di=ue.body.components)==null?void 0:di.find(we=>we.type==="HEADER"))==null?void 0:oa.format.toLowerCase())==="video"?"video/*":"*",onChange:we=>{var Fe;const He=(Fe=we.target.files)==null?void 0:Fe[0];He&&St(He)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"}),de&&a.jsx("p",{className:"text-sm text-gray-600",children:"Uploading media..."}),me&&a.jsxs("p",{className:"text-sm text-green-600",children:["Media uploaded: ",me.type.toUpperCase()]})]}),ue.name==="welcome_template"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Name"}),a.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",children:j||"Your Name"}),a.jsx("p",{className:"text-xs text-gray-500",children:"This will automatically use your name as the business name."})]}):Z.length>0?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parameters"}),Z.map((we,He)=>a.jsx("input",{type:"text",placeholder:`Parameter ${He+1}`,value:ee[He]||"",onChange:Fe=>Ft(He,Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},He))]}):null]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{onClick:Rl,className:"px-4 py-2 text-gray-600 hover:text-gray-800 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:bn,disabled:!ue||ue.name!=="welcome_template"&&Z.some(we=>!we.trim())||ne&&!me,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:_?"Sending...":"Send Template"})]})]})]})}),Je&&Pr&&a.jsx(RV,{conversation:Pr,onClose:()=>Xe(!1),agentPrefix:f,agentId:d,onUpdateConversation:we=>{n(He=>He.map(Fe=>Fe.id===we.id?we:Fe))}}),ve&&a.jsx(C8,{isOpen:ve,onClose:()=>he(!1),template:V,mediaPreviews:xe,loadMediaPreview:Ed})]})},gx=["New Lead","Contacted","Not Responding","Follow-up Needed"],xx=["Interested","Quotation Sent","Asked for More Info"],vx=["Payment Pending","Paid","Order Confirmed"],$V=()=>{ra();const[e,t]=g.useState(null),[r,n]=g.useState(null),[s,i]=g.useState([]),[o,l]=g.useState(!0),[c,u]=g.useState(null),[d,m]=g.useState(""),[f,h]=g.useState("newest"),[x,b]=g.useState("all"),[j,y]=g.useState(""),[_,w]=g.useState(!1),[S,E]=g.useState(null),[$,U]=g.useState(null),[I,T]=g.useState({name:"",phone:"",lead_stage:"New Lead",interest_stage:"",conversion_stage:""}),[D,C]=g.useState("+94"),[P,F]=g.useState({name:"",phone:"",lead_stage:"New Lead",interest_stage:"",conversion_stage:""}),[A,R]=g.useState("+94"),[H,W]=g.useState(!1),[M,G]=g.useState([]),[ce,ue]=g.useState(null),[O,Z]=g.useState({totalCustomers:0,newThisMonth:0,totalOrders:0,activeCountries:0,trendPercentage:0}),B={hidden:{opacity:0,y:20},visible:se=>({opacity:1,y:0,transition:{duration:.6,delay:se*.15,ease:[.25,.46,.45,.94]}})},ee={hidden:{opacity:0,y:10},visible:se=>({opacity:1,y:0,transition:{duration:.4,delay:se*.05,ease:"easeOut"}})},X={hidden:{opacity:0,scale:.95,y:20},visible:{opacity:1,scale:1,y:0,transition:{duration:.2,ease:"easeOut"}},exit:{opacity:0,scale:.95,y:20,transition:{duration:.15}}},ne={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1,delayChildren:.2}}},le=se=>{T({...I,[se.target.name]:se.target.value})},de=se=>{const Pe=se.target.value.replace(/\D/g,"");T({...I,[se.target.name]:Pe})},je=se=>{se.target.name==="name"?le(se):se.target.name==="phone"&&de(se)},me=(se,Pe)=>{T(Ee=>({...Ee,[se]:Pe})),se==="lead_stage"&&Pe==="New Lead"&&T(Ee=>({...Ee,interest_stage:"",conversion_stage:""})),se==="interest_stage"&&!Pe&&T(Ee=>({...Ee,conversion_stage:""}))},Le=se=>{C(se),!I.phone.startsWith(se.replace("+",""))&&T({...I,phone:""})},ve=se=>{if(!se)return"+1";const Pe=se.replace(/\D/g,"");return Pe.startsWith("1")?"+1":Pe.startsWith("44")?"+44":Pe.startsWith("91")?"+91":Pe.startsWith("94")?"+94":Pe.startsWith("971")?"+971":Pe.startsWith("966")?"+966":Pe.startsWith("92")?"+92":Pe.startsWith("880")?"+880":Pe.startsWith("98")?"+98":Pe.startsWith("20")?"+20":"+1"},he=se=>({"+1":"","+44":"","+91":"","+94":"","+971":"","+966":"","+92":"","+880":"","+98":"","+20":""})[se]||"",V=(se,Pe)=>{const Ee=se.replace(/\D/g,""),Ne=Pe.replace("+","");return Ee.startsWith(Ne)?Ee.substring(Ne.length):Ee},Re=se=>{F({...P,[se.target.name]:se.target.value})},xe=se=>{const Pe=se.target.value.replace(/\D/g,"");F({...P,[se.target.name]:Pe})},Ce=se=>{se.target.name==="name"?Re(se):se.target.name==="phone"&&xe(se)},fe=se=>{R(se),!P.phone.startsWith(se.replace("+",""))&&F({...P,phone:""})},We=(se,Pe)=>{F(Ee=>({...Ee,[se]:Pe})),se==="lead_stage"&&Pe==="New Lead"&&F(Ee=>({...Ee,interest_stage:"",conversion_stage:""})),se==="interest_stage"&&!Pe&&F(Ee=>({...Ee,conversion_stage:""}))},Oe=async()=>{if(!e||!r||!P.name.trim()||!P.phone.trim())return;const se=`${A}${P.phone}`.replace("+","");try{const Pe=`${e}_customers`,{error:Ee}=await ge.from(Pe).insert({agent_id:r,name:P.name.trim(),phone:se,lead_stage:P.lead_stage||"New Lead",interest_stage:P.interest_stage||null,conversion_stage:P.conversion_stage||null});if(Ee)throw Ee;W(!1),F({name:"",phone:"",lead_stage:"New Lead",interest_stage:"",conversion_stage:""}),R("+94"),K(),u(null)}catch(Pe){console.error("Create customer error:",Pe),u("Failed to create customer")}},nt=async()=>{if(!$||!e||!r||!I.name.trim()||!I.phone.trim())return;const se=`${D}${I.phone}`.replace("+","");try{const Pe=`${e}_customers`,{error:Ee}=await ge.from(Pe).update({name:I.name.trim(),phone:se,lead_stage:I.lead_stage||"New Lead",interest_stage:I.interest_stage||null,conversion_stage:I.conversion_stage||null}).eq("id",$.id).eq("agent_id",r);if(Ee)throw Ee;U(null),T({name:"",phone:"",lead_stage:"New Lead",interest_stage:"",conversion_stage:""}),C("+94"),K()}catch(Pe){console.error("Update error:",Pe),u("Failed to update customer")}},K=async()=>{try{l(!0),u(null);const{data:{user:se},error:Pe}=await ge.auth.getUser();if(Pe||!se){u("User not authenticated"),l(!1);return}const{data:Ee,error:Ne}=await ge.from("agents").select("id, agent_prefix").eq("user_id",se.id).single();if(Ne||!Ee){u("Agent not found"),console.error("Agent fetch error:",Ne),l(!1);return}const Me=Ee.id,Ve=Ee.agent_prefix;if(n(Me),t(Ve),!Ve){u("Agent prefix not found"),l(!1);return}const $e=`${Ve}_customers`,{data:Ye,error:pt}=await ge.from($e).select("id, name, phone, created_at, profile_image_url, lead_stage, interest_stage, conversion_stage").eq("agent_id",Me).order("created_at",{ascending:!1}),it=await Promise.all((Ye||[]).map(async Wt=>{const Yr=`${Ve}_orders`,{count:er,error:cr}=await ge.from(Yr).select("*",{count:"exact",head:!0}).eq("customer_id",Wt.id);return cr?(console.error("Order count error:",cr),{...Wt,order_count:0,profile_image_url:Wt.profile_image_url}):{...Wt,order_count:er||0,profile_image_url:Wt.profile_image_url}})),Je=it.length,Xe=it.reduce((Wt,Yr)=>Wt+(Yr.order_count||0),0),At=new Date,Pt=new Date(At.getFullYear(),At.getMonth(),1),Lt=new Date(At.getFullYear(),At.getMonth()-1,1),St=new Date(At.getFullYear(),At.getMonth(),0),dt=it.filter(Wt=>new Date(Wt.created_at)>=Pt).length,fr=it.filter(Wt=>{const Yr=new Date(Wt.created_at);return Yr>=Lt&&Yr<=St}).length;let Ft=0;if(fr>0){const Wt=(dt-fr)/fr*100;Ft=Math.round(Wt*10)/10}else dt>0&&(Ft=100);const wn=new Set(it.map(Wt=>ve(Wt.phone))).size;Z({totalCustomers:Je,newThisMonth:dt,totalOrders:Xe,activeCountries:wn,trendPercentage:Ft});const Nt=it.map(Wt=>({phone:Wt.phone,url:Wt.profile_image_url||void 0,loading:!1,error:!Wt.profile_image_url}));if(G(Nt),pt){u("Failed to fetch customers"),console.error("Customers fetch error:",pt),l(!1);return}i(it),t(Ve),n(Me),ue(se.id)}catch(se){u("Failed to load customers"),console.error("Fetch error:",se)}finally{l(!1)}};g.useEffect(()=>{K()},[]),g.useEffect(()=>{if(!e||!r)return;const se=`${e}_customers`,Pe=ge.channel("realtime-customers").on("postgres_changes",{event:"*",schema:"public",table:se,filter:`agent_id=eq.${r}`},()=>{K()}).subscribe(Ee=>{Ee==="CHANNEL_ERROR"&&console.error("Subscription error")});return()=>{ge.removeChannel(Pe)}},[e,r]);const be=async se=>{const Pe=M.find(Ee=>Ee.phone===se);if(!(Pe&&(Pe.url||Pe.error))){G(Ee=>Ee.map(Ne=>Ne.phone===se?{...Ne,loading:!0,error:!1}:Ne));try{const{data:{session:Ee}}=await ge.auth.getSession(),Ne=Ee==null?void 0:Ee.access_token,Me=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/get-whatsapp-profile-pic",{method:"POST",headers:{"Content-Type":"application/json",...Ne&&{Authorization:`Bearer ${Ne}`}},body:JSON.stringify({phone:se,user_id:ce})});if(!Me.ok){const $e=await Me.text();throw new Error(`HTTP ${Me.status}: ${$e}`)}const Ve=await Me.json();Ve.success&&Ve.profile_image_url?G($e=>$e.map(Ye=>Ye.phone===se?{...Ye,url:Ve.profile_image_url,loading:!1}:Ye)):G($e=>$e.map(Ye=>Ye.phone===se?{...Ye,error:!0,loading:!1}:Ye))}catch{G(Ne=>Ne.map(Me=>Me.phone===se?{...Me,error:!0,loading:!1}:Me))}}};g.useEffect(()=>{s.length>0&&ce&&s.slice(0,5).forEach(Pe=>{be(Pe.phone)})},[s,ce]);const _e=s.filter(se=>{const Pe=se.name.toLowerCase().includes(d.toLowerCase())||se.phone.includes(d);let Ee=!0;return x!=="all"&&(x==="lead"?(Ee=!se.conversion_stage&&!se.interest_stage,j&&(Ee=Ee&&se.lead_stage===j)):x==="interest"?(Ee=!se.conversion_stage&&!!se.interest_stage,j&&(Ee=Ee&&se.interest_stage===j)):x==="conversion"&&(Ee=!!se.conversion_stage,j&&(Ee=Ee&&se.conversion_stage===j))),Pe&&Ee}),re=[..._e].sort((se,Pe)=>{switch(f){case"newest":return new Date(Pe.created_at).getTime()-new Date(se.created_at).getTime();case"oldest":return new Date(se.created_at).getTime()-new Date(Pe.created_at).getTime();case"orders":return(Pe.order_count||0)-(se.order_count||0);default:return 0}});_e.length;const De=()=>{K(),w(!1),E(null)};return o?a.jsx(Qe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(Qe.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"rounded-full h-12 w-12 border-b-2 border-green-600"})})}):a.jsxs(Qe.div,{variants:ne,initial:"hidden",animate:"visible",className:"p-6",children:[a.jsx(z1,{children:H&&a.jsx(Qe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs(Qe.div,{variants:X,initial:"hidden",animate:"visible",exit:"exit",className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Customer"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("input",{type:"text",name:"name",value:P.name,onChange:Ce,placeholder:"Customer Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("select",{value:A,onChange:se=>fe(se.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 w-32",children:[a.jsx("option",{value:"+1",children:" +1"}),a.jsx("option",{value:"+44",children:" +44"}),a.jsx("option",{value:"+91",children:" +91"}),a.jsx("option",{value:"+94",children:" +94"}),a.jsx("option",{value:"+971",children:" +971"}),a.jsx("option",{value:"+966",children:" +966"}),a.jsx("option",{value:"+92",children:" +92"}),a.jsx("option",{value:"+880",children:" +880"}),a.jsx("option",{value:"+98",children:" +98"}),a.jsx("option",{value:"+20",children:" +20"})]}),a.jsx("input",{type:"tel",name:"phone",value:P.phone,onChange:Ce,placeholder:"Phone Number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Full number will be: ",A," ",P.phone]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Customer Progress Stages"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Stage "}),a.jsx("select",{value:P.lead_stage,onChange:se=>We("lead_stage",se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm",children:gx.map(se=>a.jsx("option",{value:se,children:se},se))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Interest Stage "}),a.jsxs("select",{value:P.interest_stage,onChange:se=>We("interest_stage",se.target.value),disabled:P.lead_stage==="New Lead",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",children:"Select Interest Stage"}),xx.map(se=>a.jsx("option",{value:se,children:se},se))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Conversion Stage "}),a.jsxs("select",{value:P.conversion_stage,onChange:se=>We("conversion_stage",se.target.value),disabled:!P.interest_stage,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",children:"Select Conversion Stage"}),vx.map(se=>a.jsx("option",{value:se,children:se},se))]})]})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[a.jsx("button",{onClick:()=>{W(!1),F({name:"",phone:"",lead_stage:"New Lead",interest_stage:"",conversion_stage:""}),R("+94")},className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),a.jsx("button",{onClick:Oe,disabled:!P.name.trim()||!P.phone.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Customer"})]})]})})}),a.jsx(z1,{children:$&&a.jsx(Qe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs(Qe.div,{variants:X,initial:"hidden",animate:"visible",exit:"exit",className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Edit Customer"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("input",{type:"text",name:"name",value:I.name||$.name,onChange:je,placeholder:"Customer Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("select",{value:D,onChange:se=>Le(se.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-32",children:[a.jsx("option",{value:"+1",children:" +1"}),a.jsx("option",{value:"+44",children:" +44"}),a.jsx("option",{value:"+91",children:" +91"}),a.jsx("option",{value:"+94",children:" +94"}),a.jsx("option",{value:"+971",children:" +971"}),a.jsx("option",{value:"+966",children:" +966"}),a.jsx("option",{value:"+92",children:" +92"}),a.jsx("option",{value:"+880",children:" +880"}),a.jsx("option",{value:"+98",children:" +98"}),a.jsx("option",{value:"+20",children:" +20"})]}),a.jsx("input",{type:"tel",name:"phone",value:I.phone,onChange:je,placeholder:"Phone Number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Full number will be: ",D," ",I.phone]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Customer Progress Stages"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Stage "}),a.jsx("select",{value:I.lead_stage,onChange:se=>me("lead_stage",se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:gx.map(se=>a.jsx("option",{value:se,children:se},se))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Interest Stage "}),a.jsxs("select",{value:I.interest_stage,onChange:se=>me("interest_stage",se.target.value),disabled:I.lead_stage==="New Lead",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",children:"Select Interest Stage"}),xx.map(se=>a.jsx("option",{value:se,children:se},se))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Conversion Stage "}),a.jsxs("select",{value:I.conversion_stage,onChange:se=>me("conversion_stage",se.target.value),disabled:!I.interest_stage,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[a.jsx("option",{value:"",children:"Select Conversion Stage"}),vx.map(se=>a.jsx("option",{value:se,children:se},se))]})]})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[a.jsx("button",{onClick:()=>{U(null),T({name:"",phone:"",lead_stage:"New Lead",interest_stage:"",conversion_stage:""}),C("+94")},className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),a.jsx("button",{onClick:nt,disabled:!I.name.trim()||!I.phone.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Update"})]})]})})}),a.jsx(z1,{children:_&&S&&e&&r&&a.jsx(cb,{customer:S,agentPrefix:e,agentId:r,onClose:()=>w(!1),onSuccess:De},"order-modal")}),a.jsx("div",{className:"mb-6"}),a.jsxs(Qe.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.15}}},children:[a.jsx(Qe.div,{variants:B,custom:0,className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:a.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-4a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Customers"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O.totalCustomers.toLocaleString()})]})]})}),a.jsx(Qe.div,{variants:B,custom:1,className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:a.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"New This Month"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O.newThisMonth})]})]}),a.jsx("div",{className:`text-sm font-medium ${O.trendPercentage>=0?"text-green-600":"text-red-600"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("svg",{className:`w-4 h-4 ${O.trendPercentage>=0?"text-green-600":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:O.trendPercentage>=0?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})}),a.jsxs("span",{children:[Math.abs(O.trendPercentage),"% vs last month"]})]})})]})}),a.jsx(Qe.div,{variants:B,custom:2,className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:a.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 1.5M7 13l-1.5-1.5M16 13l-1.5-1.5M16 13l1.5 1.5M16 13l1.5-1.5m-1.5 1.5L19 8m-7 0h7"})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O.totalOrders.toLocaleString()})]})]})}),a.jsx(Qe.div,{variants:B,custom:3,className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-indigo-100 rounded-full",children:a.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Countries"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O.activeCountries})]})]})})]}),c&&a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6",children:["Error: ",c]}),a.jsxs(Qe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{type:"text",placeholder:"Search customers by name or phone...",value:d,onChange:se=>m(se.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{value:x,onChange:se=>{b(se.target.value),y("")},className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm",children:[a.jsx("option",{value:"all",children:"All Progress"}),a.jsx("option",{value:"lead",children:"Lead Stage"}),a.jsx("option",{value:"interest",children:"Interest Stage"}),a.jsx("option",{value:"conversion",children:"Conversion Stage"})]}),x!=="all"&&a.jsxs("select",{value:j,onChange:se=>y(se.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm",children:[a.jsxs("option",{value:"",children:["All"," ",x==="lead"?"Leads":x==="interest"?"Interests":"Conversions"]}),(x==="lead"?gx:x==="interest"?xx:vx).map(se=>a.jsx("option",{value:se,children:se},se))]}),a.jsxs("select",{value:f,onChange:se=>h(se.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm",children:[a.jsx("option",{value:"newest",children:"Sort by: Newest"}),a.jsx("option",{value:"oldest",children:"Sort by: Oldest"}),a.jsx("option",{value:"orders",children:"Sort by: Orders"})]}),a.jsxs("button",{onClick:()=>W(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),a.jsx("span",{children:"Add Customer"})]})]})]}),a.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.8},className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:re.length===0?a.jsxs(Qe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.9},className:"text-center py-12 bg-gray-50",children:[a.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:1},className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),a.jsx(Qe.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:1.1},className:"text-lg font-medium text-gray-900 mb-2",children:d?"No customers found":"No customers yet"}),a.jsx(Qe.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:1.2},className:"text-gray-500 mb-6",children:d?`No customers match "${d}"`:"Get started by adding your first customer to the CRM."}),a.jsxs(Qe.button,{whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:1.3},onClick:()=>W(!0),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 flex items-center space-x-2 mx-auto",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),a.jsx("span",{children:"Add your first customer"})]})]}):a.jsx(Qe.div,{initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.08,delayChildren:1}}},className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Orders"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx(Qe.tbody,{className:"bg-white divide-y divide-gray-200",variants:{visible:{transition:{staggerChildren:.05}}},children:re.map((se,Pe)=>a.jsxs(Qe.tr,{variants:ee,custom:Pe,className:"hover:bg-gray-50 transition-colors duration-150",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full overflow-hidden relative shadow-sm",children:(()=>{const Ee=M.find(Me=>Me.phone===se.phone),Ne=(Ee==null?void 0:Ee.url)&&!(Ee!=null&&Ee.error);return Ee!=null&&Ee.loading?a.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-600"})}):Ne?a.jsx("img",{src:Ee.url,alt:`${se.name}'s profile`,className:"h-10 w-10 object-cover",onError:Me=>{G(Ve=>Ve.map($e=>$e.phone===se.phone?{...$e,error:!0}:$e)),Me.currentTarget.style.display="none",Me.currentTarget.parentElement.innerHTML=`
                                      <div class="h-10 w-10 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center">
                                        <span class="text-white font-semibold text-sm">
                                          ${se.name.charAt(0).toUpperCase()}
                                        </span>
                                      </div>
                                    `}}):a.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>be(se.phone),children:a.jsx("span",{className:"text-white font-semibold text-sm",children:se.name.charAt(0).toUpperCase()})})})()}),a.jsx("div",{className:"ml-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:se.name})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2 text-xs",children:he(ve(se.phone))}),a.jsx("span",{children:se.phone})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:se.order_count||0}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:se.conversion_stage?a.jsxs("span",{className:"font-medium text-green-600",children:[" ",se.conversion_stage]}):se.interest_stage?a.jsxs("span",{className:"font-medium text-yellow-600",children:[" ",se.interest_stage]}):a.jsxs("span",{className:"font-medium text-blue-600",children:[" ",se.lead_stage||"New Lead"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(se.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{className:"p-2 text-green-600 hover:text-green-900 hover:bg-green-100 rounded-lg transition-colors",title:"Open conversation",onClick:()=>window.open(`${window.location.origin}/agent/conversations?customerId=${se.id}`,"_blank"),children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),a.jsx("button",{className:"p-2 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-100 rounded-lg transition-colors",title:"Edit customer",onClick:()=>{const Ee=ve(se.phone),Ne=V(se.phone,Ee);U(se),T({name:se.name,phone:Ne,lead_stage:se.lead_stage||"New Lead",interest_stage:se.interest_stage||"",conversion_stage:se.conversion_stage||""}),C(Ee)},children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),a.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-900 hover:bg-blue-100 rounded-lg transition-colors",title:"Create new order",onClick:()=>{E(se),w(!0)},disabled:!e||!r,children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 1.5M7 13l-1.5-1.5M16 13l-1.5-1.5M16 13l1.5 1.5M16 13l1.5-1.5m-1.5 1.5L19 8m-7 0h7"})})})]})})]},se.id))})]})})})]})},E8=typeof document<"u"?st.useLayoutEffect:()=>{};var yx;const BV=(yx=st.useInsertionEffect)!==null&&yx!==void 0?yx:E8;function UV(e){const t=g.useRef(null);return BV(()=>{t.current=e},[e]),g.useCallback((...r)=>{const n=t.current;return n==null?void 0:n(...r)},[])}const Ml=e=>{var t;return(t=e==null?void 0:e.ownerDocument)!==null&&t!==void 0?t:document},_c=e=>e&&"window"in e&&e.window===e?e:Ml(e).defaultView||window;function zV(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&typeof e.nodeType=="number"}function qV(e){return zV(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e}let VV=!1;function _b(){return VV}function A8(e,t){if(!_b())return t&&e?e.contains(t):!1;if(!e||!t)return!1;let r=t;for(;r!==null;){if(r===e)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:qV(r)?r=r.host:r=r.parentNode}return!1}const vv=(e=document)=>{var t;if(!_b())return e.activeElement;let r=e.activeElement;for(;r&&"shadowRoot"in r&&(!((t=r.shadowRoot)===null||t===void 0)&&t.activeElement);)r=r.shadowRoot.activeElement;return r};function L8(e){return _b()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function WV(e){var t;if(typeof window>"u"||window.navigator==null)return!1;let r=(t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands;return Array.isArray(r)&&r.some(n=>e.test(n.brand))||e.test(window.navigator.userAgent)}function HV(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function P8(e){let t=null;return()=>(t==null&&(t=e()),t)}const GV=P8(function(){return HV(/^Mac/i)}),KV=P8(function(){return WV(/Android/i)});function T8(){let e=g.useRef(new Map),t=g.useCallback((s,i,o,l)=>{let c=l!=null&&l.once?(...u)=>{e.current.delete(o),o(...u)}:o;e.current.set(o,{type:i,eventTarget:s,fn:c,options:l}),s.addEventListener(i,c,l)},[]),r=g.useCallback((s,i,o,l)=>{var c;let u=((c=e.current.get(o))===null||c===void 0?void 0:c.fn)||o;s.removeEventListener(i,u,l),e.current.delete(o)},[]),n=g.useCallback(()=>{e.current.forEach((s,i)=>{r(s.eventTarget,s.type,i,s.options)})},[r]);return g.useEffect(()=>n,[n]),{addGlobalListener:t,removeGlobalListener:r,removeAllGlobalListeners:n}}function YV(e){return e.pointerType===""&&e.isTrusted?!0:KV()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function I8(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function ZV(e,t){Object.defineProperty(e,"target",{value:t}),Object.defineProperty(e,"currentTarget",{value:t})}function M8(e){let t=g.useRef({isFocused:!1,observer:null});E8(()=>{const n=t.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let r=UV(n=>{e==null||e(n)});return g.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;let s=n.target,i=o=>{if(t.current.isFocused=!1,s.disabled){let l=I8(o);r(l)}t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};s.addEventListener("focusout",i,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&s.disabled){var o;(o=t.current.observer)===null||o===void 0||o.disconnect();let l=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:l})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:l}))}}),t.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[r])}let JV=!1,Hf=null,yv=new Set,qh=new Map,Oc=!1,bv=!1;const XV={Tab:!0,Escape:!0};function jb(e,t){for(let r of yv)r(e,t)}function QV(e){return!(e.metaKey||!GV()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function Np(e){Oc=!0,QV(e)&&(Hf="keyboard",jb("keyboard",e))}function Gu(e){Hf="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(Oc=!0,jb("pointer",e))}function O8(e){YV(e)&&(Oc=!0,Hf="virtual")}function R8(e){e.target===window||e.target===document||JV||!e.isTrusted||(!Oc&&!bv&&(Hf="virtual",jb("virtual",e)),Oc=!1,bv=!1)}function F8(){Oc=!1,bv=!0}function wv(e){if(typeof window>"u"||typeof document>"u"||qh.get(_c(e)))return;const t=_c(e),r=Ml(e);let n=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){Oc=!0,n.apply(this,arguments)},r.addEventListener("keydown",Np,!0),r.addEventListener("keyup",Np,!0),r.addEventListener("click",O8,!0),t.addEventListener("focus",R8,!0),t.addEventListener("blur",F8,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",Gu,!0),r.addEventListener("pointermove",Gu,!0),r.addEventListener("pointerup",Gu,!0)),t.addEventListener("beforeunload",()=>{D8(e)},{once:!0}),qh.set(t,{focus:n})}const D8=(e,t)=>{const r=_c(e),n=Ml(e);t&&n.removeEventListener("DOMContentLoaded",t),qh.has(r)&&(r.HTMLElement.prototype.focus=qh.get(r).focus,n.removeEventListener("keydown",Np,!0),n.removeEventListener("keyup",Np,!0),n.removeEventListener("click",O8,!0),r.removeEventListener("focus",R8,!0),r.removeEventListener("blur",F8,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",Gu,!0),n.removeEventListener("pointermove",Gu,!0),n.removeEventListener("pointerup",Gu,!0)),qh.delete(r))};function eW(e){const t=Ml(e);let r;return t.readyState!=="loading"?wv(e):(r=()=>{wv(e)},t.addEventListener("DOMContentLoaded",r)),()=>D8(e,r)}typeof document<"u"&&eW();function $8(){return Hf!=="pointer"}const tW=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function rW(e,t,r){let n=Ml(r==null?void 0:r.target);const s=typeof window<"u"?_c(r==null?void 0:r.target).HTMLInputElement:HTMLInputElement,i=typeof window<"u"?_c(r==null?void 0:r.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?_c(r==null?void 0:r.target).HTMLElement:HTMLElement,l=typeof window<"u"?_c(r==null?void 0:r.target).KeyboardEvent:KeyboardEvent;return e=e||n.activeElement instanceof s&&!tW.has(n.activeElement.type)||n.activeElement instanceof i||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(e&&t==="keyboard"&&r instanceof l&&!XV[r.key])}function nW(e,t,r){wv(),g.useEffect(()=>{let n=(s,i)=>{rW(!!(r!=null&&r.isTextInput),s,i)&&e($8())};return yv.add(n),()=>{yv.delete(n)}},t)}function sW(e){let{isDisabled:t,onFocus:r,onBlur:n,onFocusChange:s}=e;const i=g.useCallback(c=>{if(c.target===c.currentTarget)return n&&n(c),s&&s(!1),!0},[n,s]),o=M8(i),l=g.useCallback(c=>{const u=Ml(c.target),d=u?vv(u):vv();c.target===c.currentTarget&&d===L8(c.nativeEvent)&&(r&&r(c),s&&s(!0),o(c))},[s,r,o]);return{focusProps:{onFocus:!t&&(r||s||n)?l:void 0,onBlur:!t&&(n||s)?i:void 0}}}function iW(e){let{isDisabled:t,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:s}=e,i=g.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:l}=T8(),c=g.useCallback(m=>{m.currentTarget.contains(m.target)&&i.current.isFocusWithin&&!m.currentTarget.contains(m.relatedTarget)&&(i.current.isFocusWithin=!1,l(),r&&r(m),s&&s(!1))},[r,s,i,l]),u=M8(c),d=g.useCallback(m=>{if(!m.currentTarget.contains(m.target))return;const f=Ml(m.target),h=vv(f);if(!i.current.isFocusWithin&&h===L8(m.nativeEvent)){n&&n(m),s&&s(!0),i.current.isFocusWithin=!0,u(m);let x=m.currentTarget;o(f,"focus",b=>{if(i.current.isFocusWithin&&!A8(x,b.target)){let j=new f.defaultView.FocusEvent("blur",{relatedTarget:b.target});ZV(j,x);let y=I8(j);c(y)}},{capture:!0})}},[n,s,u,o,c]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:d,onBlur:c}}}let _v=!1,a0=0;function aW(){_v=!0,setTimeout(()=>{_v=!1},50)}function Gj(e){e.pointerType==="touch"&&aW()}function oW(){if(!(typeof document>"u"))return a0===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",Gj),a0++,()=>{a0--,!(a0>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",Gj)}}function Nb(e){let{onHoverStart:t,onHoverChange:r,onHoverEnd:n,isDisabled:s}=e,[i,o]=g.useState(!1),l=g.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;g.useEffect(oW,[]);let{addGlobalListener:c,removeAllGlobalListeners:u}=T8(),{hoverProps:d,triggerHoverEnd:m}=g.useMemo(()=>{let f=(b,j)=>{if(l.pointerType=j,s||j==="touch"||l.isHovered||!b.currentTarget.contains(b.target))return;l.isHovered=!0;let y=b.currentTarget;l.target=y,c(Ml(b.target),"pointerover",_=>{l.isHovered&&l.target&&!A8(l.target,_.target)&&h(_,_.pointerType)},{capture:!0}),t&&t({type:"hoverstart",target:y,pointerType:j}),r&&r(!0),o(!0)},h=(b,j)=>{let y=l.target;l.pointerType="",l.target=null,!(j==="touch"||!l.isHovered||!y)&&(l.isHovered=!1,u(),n&&n({type:"hoverend",target:y,pointerType:j}),r&&r(!1),o(!1))},x={};return typeof PointerEvent<"u"&&(x.onPointerEnter=b=>{_v&&b.pointerType==="mouse"||f(b,b.pointerType)},x.onPointerLeave=b=>{!s&&b.currentTarget.contains(b.target)&&h(b,b.pointerType)}),{hoverProps:x,triggerHoverEnd:h}},[t,r,n,s,l,c,u]);return g.useEffect(()=>{s&&m({currentTarget:l.target},l.pointerType)},[s]),{hoverProps:d,isHovered:i}}function Sb(e={}){let{autoFocus:t=!1,isTextInput:r,within:n}=e,s=g.useRef({isFocused:!1,isFocusVisible:t||$8()}),[i,o]=g.useState(!1),[l,c]=g.useState(()=>s.current.isFocused&&s.current.isFocusVisible),u=g.useCallback(()=>c(s.current.isFocused&&s.current.isFocusVisible),[]),d=g.useCallback(h=>{s.current.isFocused=h,o(h),u()},[u]);nW(h=>{s.current.isFocusVisible=h,u()},[],{isTextInput:r});let{focusProps:m}=sW({isDisabled:n,onFocusChange:d}),{focusWithinProps:f}=iW({isDisabled:!n,onFocusWithinChange:d});return{isFocused:i,isFocusVisible:l,focusProps:n?f:m}}var lW=Object.defineProperty,cW=(e,t,r)=>t in e?lW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bx=(e,t,r)=>(cW(e,typeof t!="symbol"?t+"":t,r),r);let uW=class{constructor(){bx(this,"current",this.detect()),bx(this,"handoffState","pending"),bx(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},uo=new uW;function Wc(e){var t,r;return uo.isServer?null:e?"ownerDocument"in e?e.ownerDocument:"current"in e?(r=(t=e.current)==null?void 0:t.ownerDocument)!=null?r:document:null:document}function fg(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function Cs(){let e=[],t={addEventListener(r,n,s,i){return r.addEventListener(n,s,i),t.add(()=>r.removeEventListener(n,s,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return t.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return fg(()=>{n.current&&r[0]()}),t.add(()=>{n.current=!1})},style(r,n,s){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:s}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=Cs();return r(n),this.add(()=>n.dispose())},add(r){return e.includes(r)||e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let s of e.splice(n,1))s()}},dispose(){for(let r of e.splice(0))r()}};return t}function wo(){let[e]=g.useState(Cs);return g.useEffect(()=>()=>e.dispose(),[e]),e}let ir=(e,t)=>{uo.isServer?g.useEffect(e,t):g.useLayoutEffect(e,t)};function Ol(e){let t=g.useRef(e);return ir(()=>{t.current=e},[e]),t}let mt=function(e){let t=Ol(e);return st.useCallback((...r)=>t.current(...r),[t])};function dW(e){let t=e.width/2,r=e.height/2;return{top:e.clientY-r,right:e.clientX+t,bottom:e.clientY+r,left:e.clientX-t}}function hW(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function B8({disabled:e=!1}={}){let t=g.useRef(null),[r,n]=g.useState(!1),s=wo(),i=mt(()=>{t.current=null,n(!1),s.dispose()}),o=mt(l=>{if(s.dispose(),t.current===null){t.current=l.currentTarget,n(!0);{let c=Wc(l.currentTarget);s.addEventListener(c,"pointerup",i,!1),s.addEventListener(c,"pointermove",u=>{if(t.current){let d=dW(u);n(hW(d,t.current.getBoundingClientRect()))}},!1),s.addEventListener(c,"pointercancel",i,!1)}}});return{pressed:r,pressProps:e?{}:{onPointerDown:o,onPointerUp:i,onClick:i}}}function Es(e){return g.useMemo(()=>e,Object.values(e))}let fW=g.createContext(void 0);function kb(){return g.useContext(fW)}function jv(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}function Zn(e,t,...r){if(e in t){let s=t[e];return typeof s=="function"?s(...r):s}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Zn),n}var kl=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(kl||{}),al=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(al||{});function Rr(){let e=pW();return g.useCallback(t=>mW({mergeRefs:e,...t}),[e])}function mW({ourProps:e,theirProps:t,slot:r,defaultTag:n,features:s,visible:i=!0,name:o,mergeRefs:l}){l=l??gW;let c=U8(t,e);if(i)return o0(c,r,n,o,l);let u=s??0;if(u&2){let{static:d=!1,...m}=c;if(d)return o0(m,r,n,o,l)}if(u&1){let{unmount:d=!0,...m}=c;return Zn(d?0:1,{0(){return null},1(){return o0({...m,hidden:!0,style:{display:"none"}},r,n,o,l)}})}return o0(c,r,n,o,l)}function o0(e,t={},r,n,s){let{as:i=r,children:o,refName:l="ref",...c}=wx(e,["unmount","static"]),u=e.ref!==void 0?{[l]:e.ref}:{},d=typeof o=="function"?o(t):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let m={};if(t){let f=!1,h=[];for(let[x,b]of Object.entries(t))typeof b=="boolean"&&(f=!0),b===!0&&h.push(x.replace(/([A-Z])/g,j=>`-${j.toLowerCase()}`));if(f){m["data-headlessui-state"]=h.join(" ");for(let x of h)m[`data-${x}`]=""}}if(Vh(i)&&(Object.keys(Jo(c)).length>0||Object.keys(Jo(m)).length>0))if(!g.isValidElement(d)||Array.isArray(d)&&d.length>1||vW(d)){if(Object.keys(Jo(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Jo(c)).concat(Object.keys(Jo(m))).map(f=>`  - ${f}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(f=>`  - ${f}`).join(`
`)].join(`
`))}else{let f=d.props,h=f==null?void 0:f.className,x=typeof h=="function"?(...y)=>jv(h(...y),c.className):jv(h,c.className),b=x?{className:x}:{},j=U8(d.props,Jo(wx(c,["ref"])));for(let y in m)y in j&&delete m[y];return g.cloneElement(d,Object.assign({},j,m,u,{ref:s(xW(d),u.ref)},b))}return g.createElement(i,Object.assign({},wx(c,["ref"]),!Vh(i)&&u,!Vh(i)&&m),d)}function pW(){let e=g.useRef([]),t=g.useCallback(r=>{for(let n of e.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return e.current=r,t}}function gW(...e){return e.every(t=>t==null)?void 0:t=>{for(let r of e)r!=null&&(typeof r=="function"?r(t):r.current=t)}}function U8(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):t[s]=n[s];if(t.disabled||t["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[s=>{var i;return(i=s==null?void 0:s.preventDefault)==null?void 0:i.call(s)}]);for(let n in r)Object.assign(t,{[n](s,...i){let o=r[n];for(let l of o){if((s instanceof Event||(s==null?void 0:s.nativeEvent)instanceof Event)&&s.defaultPrevented)return;l(s,...i)}}});return t}function Gf(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):t[s]=n[s];for(let n in r)Object.assign(t,{[n](...s){let i=r[n];for(let o of i)o==null||o(...s)}});return t}function Nr(e){var t;return Object.assign(g.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Jo(e){let t=Object.assign({},e);for(let r in t)t[r]===void 0&&delete t[r];return t}function wx(e,t=[]){let r=Object.assign({},e);for(let n of t)n in r&&delete r[n];return r}function xW(e){return st.version.split(".")[0]>="19"?e.props.ref:e.ref}function Vh(e){return e===g.Fragment||e===Symbol.for("react.fragment")}function vW(e){return Vh(e.type)}function yW(e,t,r){let[n,s]=g.useState(r),i=e!==void 0,o=g.useRef(i),l=g.useRef(!1),c=g.useRef(!1);return i&&!o.current&&!l.current?(l.current=!0,o.current=i,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!i&&o.current&&!c.current&&(c.current=!0,o.current=i,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[i?e:n,mt(u=>(i||Fn.flushSync(()=>s(u)),t==null?void 0:t(u)))]}function bW(e){let[t]=g.useState(e);return t}function z8(e={},t=null,r=[]){for(let[n,s]of Object.entries(e))V8(r,q8(t,n),s);return r}function q8(e,t){return e?e+"["+t+"]":t}function V8(e,t,r){if(Array.isArray(r))for(let[n,s]of r.entries())V8(e,q8(t,n.toString()),s);else r instanceof Date?e.push([t,r.toISOString()]):typeof r=="boolean"?e.push([t,r?"1":"0"]):typeof r=="string"?e.push([t,r]):typeof r=="number"?e.push([t,`${r}`]):r==null?e.push([t,""]):z8(r,t,e)}let wW="span";var cd=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(cd||{});function _W(e,t){var r;let{features:n=1,...s}=e,i={ref:t,"aria-hidden":(n&2)===2?!0:(r=s["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return Rr()({ourProps:i,theirProps:s,slot:{},defaultTag:wW,name:"Hidden"})}let jf=Nr(_W),jW=g.createContext(null);function NW({children:e}){let t=g.useContext(jW);if(!t)return st.createElement(st.Fragment,null,e);let{target:r}=t;return r?Fn.createPortal(st.createElement(st.Fragment,null,e),r):null}function SW({data:e,form:t,disabled:r,onReset:n,overrides:s}){let[i,o]=g.useState(null),l=wo();return g.useEffect(()=>{if(n&&i)return l.addEventListener(i,"reset",n)},[i,t,n]),st.createElement(NW,null,st.createElement(kW,{setForm:o,formId:t}),z8(e).map(([c,u])=>st.createElement(jf,{features:cd.Hidden,...Jo({key:c,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:t,disabled:r,name:c,value:u,...s})})))}function kW({setForm:e,formId:t}){return g.useEffect(()=>{if(t){let r=document.getElementById(t);r&&e(r)}},[e,t]),t?null:st.createElement(jf,{features:cd.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:r=>{if(!r)return;let n=r.closest("form");n&&e(n)}})}let CW=g.createContext(void 0);function W8(){return g.useContext(CW)}function H8(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function ho(e){return H8(e)&&"tagName"in e}function Us(e){return ho(e)&&"accessKey"in e}function ja(e){return ho(e)&&"tabIndex"in e}function EW(e){return ho(e)&&"style"in e}function AW(e){return Us(e)&&e.nodeName==="IFRAME"}function Sp(e){return Us(e)&&e.nodeName==="INPUT"}function Kj(e){return Us(e)&&e.nodeName==="LABEL"}function LW(e){return Us(e)&&e.nodeName==="FIELDSET"}function G8(e){return Us(e)&&e.nodeName==="LEGEND"}function PW(e){return ho(e)?e.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}function K8(e){let t=e.parentElement,r=null;for(;t&&!LW(t);)G8(t)&&(r=t),t=t.parentElement;let n=(t==null?void 0:t.getAttribute("disabled"))==="";return n&&TW(r)?!1:n}function TW(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(G8(t))return!1;t=t.previousElementSibling}return!0}let Y8=Symbol();function IW(e,t=!0){return Object.assign(e,{[Y8]:t})}function Tn(...e){let t=g.useRef(e);g.useEffect(()=>{t.current=e},[e]);let r=mt(n=>{for(let s of t.current)s!=null&&(typeof s=="function"?s(n):s.current=n)});return e.every(n=>n==null||(n==null?void 0:n[Y8]))?void 0:r}let mg=g.createContext(null);mg.displayName="DescriptionContext";function Z8(){let e=g.useContext(mg);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,Z8),t}return e}function MW(){var e,t;return(t=(e=g.useContext(mg))==null?void 0:e.value)!=null?t:void 0}function J8(){let[e,t]=g.useState([]);return[e.length>0?e.join(" "):void 0,g.useMemo(()=>function(r){let n=mt(i=>(t(o=>[...o,i]),()=>t(o=>{let l=o.slice(),c=l.indexOf(i);return c!==-1&&l.splice(c,1),l}))),s=g.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props,value:r.value}),[n,r.slot,r.name,r.props,r.value]);return st.createElement(mg.Provider,{value:s},r.children)},[t])]}let OW="p";function RW(e,t){let r=g.useId(),n=kb(),{id:s=`headlessui-description-${r}`,...i}=e,o=Z8(),l=Tn(t);ir(()=>o.register(s),[s,o.register]);let c=Es({...o.slot,disabled:n||!1}),u={ref:l,...o.props,id:s};return Rr()({ourProps:u,theirProps:i,slot:c,defaultTag:OW,name:o.name||"Description"})}let FW=Nr(RW),DW=Object.assign(FW,{});var sr=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(sr||{});let pg=g.createContext(null);pg.displayName="LabelContext";function Cb(){let e=g.useContext(pg);if(e===null){let t=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,Cb),t}return e}function gg(e){var t,r,n;let s=(r=(t=g.useContext(pg))==null?void 0:t.value)!=null?r:void 0;return((n=e==null?void 0:e.length)!=null?n:0)>0?[s,...e].filter(Boolean).join(" "):s}function Eb({inherit:e=!1}={}){let t=gg(),[r,n]=g.useState([]),s=e?[t,...r].filter(Boolean):r;return[s.length>0?s.join(" "):void 0,g.useMemo(()=>function(i){let o=mt(c=>(n(u=>[...u,c]),()=>n(u=>{let d=u.slice(),m=d.indexOf(c);return m!==-1&&d.splice(m,1),d}))),l=g.useMemo(()=>({register:o,slot:i.slot,name:i.name,props:i.props,value:i.value}),[o,i.slot,i.name,i.props,i.value]);return st.createElement(pg.Provider,{value:l},i.children)},[n])]}let $W="label";function BW(e,t){var r;let n=g.useId(),s=Cb(),i=W8(),o=kb(),{id:l=`headlessui-label-${n}`,htmlFor:c=i??((r=s.props)==null?void 0:r.htmlFor),passive:u=!1,...d}=e,m=Tn(t);ir(()=>s.register(l),[l,s.register]);let f=mt(b=>{let j=b.currentTarget;if(!(b.target!==b.currentTarget&&PW(b.target))&&(Kj(j)&&b.preventDefault(),s.props&&"onClick"in s.props&&typeof s.props.onClick=="function"&&s.props.onClick(b),Kj(j))){let y=document.getElementById(j.htmlFor);if(y){let _=y.getAttribute("disabled");if(_==="true"||_==="")return;let w=y.getAttribute("aria-disabled");if(w==="true"||w==="")return;(Sp(y)&&(y.type==="file"||y.type==="radio"||y.type==="checkbox")||y.role==="radio"||y.role==="checkbox"||y.role==="switch")&&y.click(),y.focus({preventScroll:!0})}}}),h=Es({...s.slot,disabled:o||!1}),x={ref:m,...s.props,id:l,htmlFor:c,onClick:f};return u&&("onClick"in x&&(delete x.htmlFor,delete x.onClick),"onClick"in d&&delete d.onClick),Rr()({ourProps:x,theirProps:d,slot:h,defaultTag:c?$W:"div",name:s.name||"Label"})}let UW=Nr(BW),zW=Object.assign(UW,{}),qW=g.createContext(()=>{});function VW({value:e,children:t}){return st.createElement(qW.Provider,{value:e},t)}function hu(e,t,r){let n=r.initialDeps??[],s;function i(){var o,l,c,u;let d;r.key&&((o=r.debug)!=null&&o.call(r))&&(d=Date.now());const m=e();if(!(m.length!==n.length||m.some((x,b)=>n[b]!==x)))return s;n=m;let h;if(r.key&&((l=r.debug)!=null&&l.call(r))&&(h=Date.now()),s=t(...m),r.key&&((c=r.debug)!=null&&c.call(r))){const x=Math.round((Date.now()-d)*100)/100,b=Math.round((Date.now()-h)*100)/100,j=b/16,y=(_,w)=>{for(_=String(_);_.length<w;)_=" "+_;return _};console.info(`%c ${y(b,5)} /${y(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*j,120))}deg 100% 31%);`,r==null?void 0:r.key)}return(u=r==null?void 0:r.onChange)==null||u.call(r,s),s}return i.updateDeps=o=>{n=o},i}function Yj(e,t){if(e===void 0)throw new Error(`Unexpected undefined${t?`: ${t}`:""}`);return e}const WW=(e,t)=>Math.abs(e-t)<1.01,HW=(e,t,r)=>{let n;return function(...s){e.clearTimeout(n),n=e.setTimeout(()=>t.apply(this,s),r)}},Zj=e=>{const{offsetWidth:t,offsetHeight:r}=e;return{width:t,height:r}},GW=e=>e,KW=e=>{const t=Math.max(e.startIndex-e.overscan,0),r=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let s=t;s<=r;s++)n.push(s);return n},YW=(e,t)=>{const r=e.scrollElement;if(!r)return;const n=e.targetWindow;if(!n)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(Zj(r)),!n.ResizeObserver)return()=>{};const i=new n.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const u=c.borderBoxSize[0];if(u){s({width:u.inlineSize,height:u.blockSize});return}}s(Zj(r))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(r,{box:"border-box"}),()=>{i.unobserve(r)}},Jj={passive:!0},Xj=typeof window>"u"?!0:"onscrollend"in window,ZW=(e,t)=>{const r=e.scrollElement;if(!r)return;const n=e.targetWindow;if(!n)return;let s=0;const i=e.options.useScrollendEvent&&Xj?()=>{}:HW(n,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=d=>()=>{const{horizontal:m,isRtl:f}=e.options;s=m?r.scrollLeft*(f&&-1||1):r.scrollTop,i(),t(s,d)},l=o(!0),c=o(!1);c(),r.addEventListener("scroll",l,Jj);const u=e.options.useScrollendEvent&&Xj;return u&&r.addEventListener("scrollend",c,Jj),()=>{r.removeEventListener("scroll",l),u&&r.removeEventListener("scrollend",c)}},JW=(e,t,r)=>{if(t!=null&&t.borderBoxSize){const n=t.borderBoxSize[0];if(n)return Math.round(n[r.options.horizontal?"inlineSize":"blockSize"])}return e[r.options.horizontal?"offsetWidth":"offsetHeight"]},XW=(e,{adjustments:t=0,behavior:r},n)=>{var s,i;const o=e+t;(i=(s=n.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[n.options.horizontal?"left":"top"]:o,behavior:r})};class QW{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let r=null;const n=()=>r||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:r=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=n())==null||s.disconnect(),r=null},observe:s=>{var i;return(i=n())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=n())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=r=>{Object.entries(r).forEach(([n,s])=>{typeof s>"u"&&delete r[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:GW,rangeExtractor:KW,onChange:()=>{},measureElement:JW,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...r}},this.notify=r=>{var n,s;(s=(n=this.options).onChange)==null||s.call(n,this,r)},this.maybeNotify=hu(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),r=>{this.notify(r)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var r;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((r=this.scrollElement)==null?void 0:r.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(r,n)=>{const s=new Map,i=new Map;for(let o=n-1;o>=0;o--){const l=r[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=hu(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(r,n,s,i,o)=>(this.pendingMeasuredCacheIndexes=[],{count:r,paddingStart:n,scrollMargin:s,getItemKey:i,enabled:o}),{key:!1}),this.getMeasurements=hu(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:r,paddingStart:n,scrollMargin:s,getItemKey:i,enabled:o},l)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const u=this.measurementsCache.slice(0,c);for(let d=c;d<r;d++){const m=i(d),f=this.options.lanes===1?u[d-1]:this.getFurthestMeasurement(u,d),h=f?f.end+this.options.gap:n+s,x=l.get(m),b=typeof x=="number"?x:this.options.estimateSize(d),j=h+b,y=f?f.lane:d%this.options.lanes;u[d]={index:d,start:h,size:b,end:j,key:m,lane:y}}return this.measurementsCache=u,u},{key:!1,debug:()=>this.options.debug}),this.calculateRange=hu(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(r,n,s,i)=>this.range=r.length>0&&n>0?eH({measurements:r,outerSize:n,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=hu(()=>{let r=null,n=null;const s=this.calculateRange();return s&&(r=s.startIndex,n=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,r,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,r,n]},(r,n,s,i,o)=>i===null||o===null?[]:r({startIndex:i,endIndex:o,overscan:n,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=r=>{const n=this.options.indexAttribute,s=r.getAttribute(n);return s?parseInt(s,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(r,n)=>{const s=this.indexFromElement(r),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==r&&(l&&this.observer.unobserve(l),this.observer.observe(r),this.elementsCache.set(o,r)),r.isConnected&&this.resizeItem(s,this.options.measureElement(r,n,this))},this.resizeItem=(r,n)=>{const s=this.measurementsCache[r];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=n-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,n)),this.notify(!1))},this.measureElement=r=>{if(!r){this.elementsCache.forEach((n,s)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(s))});return}this._measureElement(r,void 0)},this.getVirtualItems=hu(()=>[this.getVirtualIndexes(),this.getMeasurements()],(r,n)=>{const s=[];for(let i=0,o=r.length;i<o;i++){const l=r[i],c=n[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=r=>{const n=this.getMeasurements();if(n.length!==0)return Yj(n[X8(0,n.length-1,s=>Yj(n[s]).start,r)])},this.getOffsetForAlignment=(r,n,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();n==="auto"&&(n=r>=o+i?"end":"start"),n==="center"?r+=(s-i)/2:n==="end"&&(r-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,r),0)},this.getOffsetForIndex=(r,n="auto")=>{r=Math.max(0,Math.min(r,this.options.count-1));const s=this.measurementsCache[r];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(n==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)n="end";else if(s.start<=o+this.options.scrollPaddingStart)n="start";else return[o,n];const l=n==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,n,s.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(r,{align:n="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(r,n),{adjustments:void 0,behavior:s})},this.scrollToIndex=(r,{align:n="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r=Math.max(0,Math.min(r,this.options.count-1));let i=0;const o=10,l=u=>{if(!this.targetWindow)return;const d=this.getOffsetForIndex(r,u);if(!d){console.warn("Failed to get offset for index:",r);return}const[m,f]=d;this._scrollToOffset(m,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const h=this.getScrollOffset(),x=this.getOffsetForIndex(r,f);if(!x){console.warn("Failed to get offset for index:",r);return}WW(x[0],h)||c(f)})},c=u=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(u)):console.warn(`Failed to scroll to index ${r} after ${o} attempts.`))};l(n)},this.scrollBy=(r,{behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+r,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var r;const n=this.getMeasurements();let s;if(n.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((r=n[n.length-1])==null?void 0:r.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=n.length-1;for(;o>=0&&i.some(l=>l===null);){const l=n[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(r,{adjustments:n,behavior:s})=>{this.options.scrollToFn(r,{behavior:s,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const X8=(e,t,r,n)=>{for(;e<=t;){const s=(e+t)/2|0,i=r(s);if(i<n)e=s+1;else if(i>n)t=s-1;else return s}return e>0?e-1:0};function eH({measurements:e,outerSize:t,scrollOffset:r,lanes:n}){const s=e.length-1,i=c=>e[c].start;if(e.length<=n)return{startIndex:0,endIndex:s};let o=X8(0,s,i,r),l=o;if(n===1)for(;l<s&&e[l].end<r+t;)l++;else if(n>1){const c=Array(n).fill(0);for(;l<s&&c.some(d=>d<r+t);){const d=e[l];c[d.lane]=d.end,l++}const u=Array(n).fill(r+t);for(;o>=0&&u.some(d=>d>=r);){const d=e[o];u[d.lane]=d.start,o--}o=Math.max(0,o-o%n),l=Math.min(s,l+(n-1-l%n))}return{startIndex:o,endIndex:l}}const Qj=typeof document<"u"?g.useLayoutEffect:g.useEffect;function tH(e){const t=g.useReducer(()=>({}),{})[1],r={...e,onChange:(s,i)=>{var o;i?Fn.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[n]=g.useState(()=>new QW(r));return n.setOptions(r),Qj(()=>n._didMount(),[]),Qj(()=>n._willUpdate()),n}function rH(e){return tH({observeElementRect:YW,observeElementOffset:ZW,scrollToFn:XW,...e})}function nH(e,t){return e!==null&&t!==null&&typeof e=="object"&&typeof t=="object"&&"id"in e&&"id"in t?e.id===t.id:e===t}function sH(e=nH){return g.useCallback((t,r)=>{if(typeof e=="string"){let n=e;return(t==null?void 0:t[n])===(r==null?void 0:r[n])}return e(t,r)},[e])}function e3(e){if(e===null)return{width:0,height:0};let{width:t,height:r}=e.getBoundingClientRect();return{width:t,height:r}}function Nv(e,t,r=!1){let[n,s]=g.useState(()=>e3(t));return ir(()=>{if(!t||!e)return;let i=Cs();return i.requestAnimationFrame(function o(){i.requestAnimationFrame(o),s(l=>{let c=e3(t);return c.width===l.width&&c.height===l.height?l:c})}),()=>{i.dispose()}},[t,e]),r?{width:`${n.width}px`,height:`${n.height}px`}:n}let Q8=class extends Map{constructor(t){super(),this.factory=t}get(t){let r=super.get(t);return r===void 0&&(r=this.factory(t),this.set(t,r)),r}};var iH=Object.defineProperty,aH=(e,t,r)=>t in e?iH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oH=(e,t,r)=>(aH(e,typeof t!="symbol"?t+"":t,r),r),eE=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},yi=(e,t,r)=>(eE(e,t,"read from private field"),r?r.call(e):t.get(e)),_x=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},t3=(e,t,r,n)=>(eE(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ga,bh,wh;let Ab=class{constructor(t){_x(this,ga,{}),_x(this,bh,new Q8(()=>new Set)),_x(this,wh,new Set),oH(this,"disposables",Cs()),t3(this,ga,t),uo.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return yi(this,ga)}subscribe(t,r){if(uo.isServer)return()=>{};let n={selector:t,callback:r,current:t(yi(this,ga))};return yi(this,wh).add(n),this.disposables.add(()=>{yi(this,wh).delete(n)})}on(t,r){return uo.isServer?()=>{}:(yi(this,bh).get(t).add(r),this.disposables.add(()=>{yi(this,bh).get(t).delete(r)}))}send(t){let r=this.reduce(yi(this,ga),t);if(r!==yi(this,ga)){t3(this,ga,r);for(let n of yi(this,wh)){let s=n.selector(yi(this,ga));tE(n.current,s)||(n.current=s,n.callback(s))}for(let n of yi(this,bh).get(t.type))n(yi(this,ga),t)}}};ga=new WeakMap,bh=new WeakMap,wh=new WeakMap;function tE(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:Array.isArray(e)&&Array.isArray(t)?e.length!==t.length?!1:jx(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size!==t.size?!1:jx(e.entries(),t.entries()):r3(e)&&r3(t)?jx(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()):!1}function jx(e,t){do{let r=e.next(),n=t.next();if(r.done&&n.done)return!0;if(r.done||n.done||!Object.is(r.value,n.value))return!1}while(!0)}function r3(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let t=Object.getPrototypeOf(e);return t===null||Object.getPrototypeOf(t)===null}function n3(e){let[t,r]=e(),n=Cs();return(...s)=>{t(...s),n.dispose(),n.microTask(r)}}var lH=Object.defineProperty,cH=(e,t,r)=>t in e?lH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,s3=(e,t,r)=>(cH(e,typeof t!="symbol"?t+"":t,r),r),Lb=(e=>(e[e.Push=0]="Push",e[e.Pop=1]="Pop",e))(Lb||{});let uH={0(e,t){let r=t.id,n=e.stack,s=e.stack.indexOf(r);if(s!==-1){let i=e.stack.slice();return i.splice(s,1),i.push(r),n=i,{...e,stack:n}}return{...e,stack:[...e.stack,r]}},1(e,t){let r=t.id,n=e.stack.indexOf(r);if(n===-1)return e;let s=e.stack.slice();return s.splice(n,1),{...e,stack:s}}},dH=class rE extends Ab{constructor(){super(...arguments),s3(this,"actions",{push:t=>this.send({type:0,id:t}),pop:t=>this.send({type:1,id:t})}),s3(this,"selectors",{isTop:(t,r)=>t.stack[t.stack.length-1]===r,inStack:(t,r)=>t.stack.includes(r)})}static new(){return new rE({stack:[]})}reduce(t,r){return Zn(r.type,uH,t,r)}};const _d=new Q8(()=>dH.new());var nE={exports:{}},sE={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kf=g;function hH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fH=typeof Object.is=="function"?Object.is:hH,mH=Kf.useSyncExternalStore,pH=Kf.useRef,gH=Kf.useEffect,xH=Kf.useMemo,vH=Kf.useDebugValue;sE.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=pH(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=xH(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&o.hasValue){var x=o.value;if(s(x,h))return m=x}return m=h}if(x=m,fH(d,h))return x;var b=n(h);return s!==void 0&&s(x,b)?(d=h,x):(d=h,m=b)}var u=!1,d,m,f=r===void 0?null:r;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,r,n,s]);var l=mH(e,i[0],i[1]);return gH(function(){o.hasValue=!0,o.value=l},[l]),vH(l),l};nE.exports=sE;var yH=nE.exports;function hr(e,t,r=tE){return yH.useSyncExternalStoreWithSelector(mt(n=>e.subscribe(bH,n)),mt(()=>e.state),mt(()=>e.state),mt(t),r)}function bH(e){return e}function Yf(e,t){let r=g.useId(),n=_d.get(t),[s,i]=hr(n,g.useCallback(o=>[n.selectors.isTop(o,r),n.selectors.inStack(o,r)],[n,r]));return ir(()=>{if(e)return n.actions.push(r),()=>n.actions.pop(r)},[n,e,r]),e?i?s:!0:!1}let Sv=new Map,Wh=new Map;function i3(e){var t;let r=(t=Wh.get(e))!=null?t:0;return Wh.set(e,r+1),r!==0?()=>a3(e):(Sv.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0,()=>a3(e))}function a3(e){var t;let r=(t=Wh.get(e))!=null?t:1;if(r===1?Wh.delete(e):Wh.set(e,r-1),r!==1)return;let n=Sv.get(e);n&&(n["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",n["aria-hidden"]),e.inert=n.inert,Sv.delete(e))}function Pb(e,{allowed:t,disallowed:r}={}){let n=Yf(e,"inert-others");ir(()=>{var s,i;if(!n)return;let o=Cs();for(let c of(s=r==null?void 0:r())!=null?s:[])c&&o.add(i3(c));let l=(i=t==null?void 0:t())!=null?i:[];for(let c of l){if(!c)continue;let u=Wc(c);if(!u)continue;let d=c.parentElement;for(;d&&d!==u.body;){for(let m of d.children)l.some(f=>m.contains(f))||o.add(i3(m));d=d.parentElement}}return o.dispose},[n,t,r])}function Tb(e,t,r){let n=Ol(s=>{let i=s.getBoundingClientRect();i.x===0&&i.y===0&&i.width===0&&i.height===0&&r()});g.useEffect(()=>{if(!e)return;let s=t===null?null:Us(t)?t:t.current;if(!s)return;let i=Cs();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>n.current(s));o.observe(s),i.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>n.current(s));o.observe(s),i.add(()=>o.disconnect())}return()=>i.dispose()},[t,n,e])}let kp=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),wH=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Ki=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(Ki||{}),kv=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(kv||{}),_H=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(_H||{});function iE(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(kp)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function jH(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(wH)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Ib=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Ib||{});function Mb(e,t=0){var r;return e===((r=Wc(e))==null?void 0:r.body)?!1:Zn(t,{0(){return e.matches(kp)},1(){let n=e;for(;n!==null;){if(n.matches(kp))return!0;n=n.parentElement}return!1}})}function aE(e){let t=Wc(e);Cs().nextFrame(()=>{t&&ja(t.activeElement)&&!Mb(t.activeElement,0)&&Aa(e)})}var NH=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(NH||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Aa(e){e==null||e.focus({preventScroll:!0})}let SH=["textarea","input"].join(",");function kH(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,SH))!=null?r:!1}function Ob(e,t=r=>r){return e.slice().sort((r,n)=>{let s=t(r),i=t(n);if(s===null||i===null)return 0;let o=s.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function CH(e,t){return Ku(iE(),t,{relativeTo:e})}function Ku(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:s=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,o=Array.isArray(e)?r?Ob(e):e:t&64?jH(e):iE(e);s.length>0&&o.length>1&&(o=o.filter(h=>!s.some(x=>x!=null&&"current"in x?(x==null?void 0:x.current)===h:x===h))),n=n??i.activeElement;let l=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,o.indexOf(n))-1;if(t&4)return Math.max(0,o.indexOf(n))+1;if(t&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=t&32?{preventScroll:!0}:{},d=0,m=o.length,f;do{if(d>=m||d+m<=0)return 0;let h=c+d;if(t&16)h=(h+m)%m;else{if(h<0)return 3;if(h>=m)return 1}f=o[h],f==null||f.focus(u),d+=l}while(f!==i.activeElement);return t&6&&kH(f)&&f.select(),2}function oE(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function EH(){return/Android/gi.test(window.navigator.userAgent)}function Cv(){return oE()||EH()}function Mu(e,t,r,n){let s=Ol(r);g.useEffect(()=>{if(!e)return;function i(o){s.current(o)}return document.addEventListener(t,i,n),()=>document.removeEventListener(t,i,n)},[e,t,n])}function lE(e,t,r,n){let s=Ol(r);g.useEffect(()=>{if(!e)return;function i(o){s.current(o)}return window.addEventListener(t,i,n),()=>window.removeEventListener(t,i,n)},[e,t,n])}const o3=30;function Rb(e,t,r){let n=Ol(r),s=g.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let d=function m(f){return typeof f=="function"?m(f()):Array.isArray(f)||f instanceof Set?f:[f]}(t);for(let m of d)if(m!==null&&(m.contains(u)||l.composed&&l.composedPath().includes(m)))return;return!Mb(u,Ib.Loose)&&u.tabIndex!==-1&&l.preventDefault(),n.current(l,u)},[n,t]),i=g.useRef(null);Mu(e,"pointerdown",l=>{var c,u;Cv()||(i.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),Mu(e,"pointerup",l=>{if(Cv()||!i.current)return;let c=i.current;return i.current=null,s(l,()=>c)},!0);let o=g.useRef({x:0,y:0});Mu(e,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),Mu(e,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=o3||Math.abs(c.y-o.current.y)>=o3))return s(l,()=>ja(l.target)?l.target:null)},!0),lE(e,"blur",l=>s(l,()=>AW(window.document.activeElement)?window.document.activeElement:null),!0)}function yo(...e){return g.useMemo(()=>Wc(...e),[...e])}var AH=(e=>(e[e.Ignore=0]="Ignore",e[e.Select=1]="Select",e[e.Close=2]="Close",e))(AH||{});const Qa={Ignore:{kind:0},Select:e=>({kind:1,target:e}),Close:{kind:2}},LH=200,l3=5;function cE(e,{trigger:t,action:r,close:n,select:s}){let i=g.useRef(null),o=g.useRef(null),l=g.useRef(null);Mu(e&&t!==null,"pointerdown",c=>{H8(c==null?void 0:c.target)&&t!=null&&t.contains(c.target)&&(o.current=c.x,l.current=c.y,i.current=c.timeStamp)}),Mu(e&&t!==null,"pointerup",c=>{var u,d;let m=i.current;if(m===null||(i.current=null,!ja(c.target))||Math.abs(c.x-((u=o.current)!=null?u:c.x))<l3&&Math.abs(c.y-((d=l.current)!=null?d:c.y))<l3)return;let f=r(c);switch(f.kind){case 0:return;case 1:{c.timeStamp-m>LH&&(s(f.target),n());break}case 2:{n();break}}},{capture:!0})}function Fb(e,t,r,n){let s=Ol(r);g.useEffect(()=>{e=e??window;function i(o){s.current(o)}return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i,n)},[e,t,n])}function uE(e){let t=g.useRef({value:"",selectionStart:null,selectionEnd:null});return Fb(e,"blur",r=>{let n=r.target;Sp(n)&&(t.current={value:n.value,selectionStart:n.selectionStart,selectionEnd:n.selectionEnd})}),mt(()=>{if(document.activeElement!==e&&Sp(e)&&e.isConnected){if(e.focus({preventScroll:!0}),e.value!==t.current.value)e.setSelectionRange(e.value.length,e.value.length);else{let{selectionStart:r,selectionEnd:n}=t.current;r!==null&&n!==null&&e.setSelectionRange(r,n)}t.current={value:"",selectionStart:null,selectionEnd:null}}})}function dE(e,t){return g.useMemo(()=>{var r;if(e.type)return e.type;let n=(r=e.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||(t==null?void 0:t.tagName)==="BUTTON"&&!t.hasAttribute("type"))return"button"},[e.type,e.as,t])}function PH(e){return g.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}function TH(e,t){let r=e(),n=new Set;return{getSnapshot(){return r},subscribe(s){return n.add(s),()=>n.delete(s)},dispatch(s,...i){let o=t[s].call(r,...i);o&&(r=o,n.forEach(l=>l()))}}}function IH(){let e;return{before({doc:t}){var r;let n=t.documentElement,s=(r=t.defaultView)!=null?r:window;e=Math.max(0,s.innerWidth-n.clientWidth)},after({doc:t,d:r}){let n=t.documentElement,s=Math.max(0,n.clientWidth-n.offsetWidth),i=Math.max(0,e-s);r.style(n,"paddingRight",`${i}px`)}}}function MH(){return oE()?{before({doc:e,d:t,meta:r}){function n(s){return r.containers.flatMap(i=>i()).some(i=>i.contains(s))}t.microTask(()=>{var s;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let l=Cs();l.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>l.dispose()))}let i=(s=window.scrollY)!=null?s:window.pageYOffset,o=null;t.addEventListener(e,"click",l=>{if(ja(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),d=e.querySelector(u);ja(d)&&!n(d)&&(o=d)}catch{}},!0),t.addEventListener(e,"touchstart",l=>{if(ja(l.target)&&EW(l.target))if(n(l.target)){let c=l.target;for(;c.parentElement&&n(c.parentElement);)c=c.parentElement;t.style(c,"overscrollBehavior","contain")}else t.style(l.target,"touchAction","none")}),t.addEventListener(e,"touchmove",l=>{if(ja(l.target)){if(Sp(l.target))return;if(n(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),t.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;i!==c&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function OH(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function RH(e){let t={};for(let r of e)Object.assign(t,r(t));return t}let jc=TH(()=>new Map,{PUSH(e,t){var r;let n=(r=this.get(e))!=null?r:{doc:e,count:0,d:Cs(),meta:new Set};return n.count++,n.meta.add(t),this.set(e,n),this},POP(e,t){let r=this.get(e);return r&&(r.count--,r.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:r}){let n={doc:e,d:t,meta:RH(r)},s=[MH(),IH(),OH()];s.forEach(({before:i})=>i==null?void 0:i(n)),s.forEach(({after:i})=>i==null?void 0:i(n))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});jc.subscribe(()=>{let e=jc.getSnapshot(),t=new Map;for(let[r]of e)t.set(r,r.documentElement.style.overflow);for(let r of e.values()){let n=t.get(r.doc)==="hidden",s=r.count!==0;(s&&!n||!s&&n)&&jc.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&jc.dispatch("TEARDOWN",r)}});function FH(e,t,r=()=>({containers:[]})){let n=PH(jc),s=t?n.get(t):void 0,i=s?s.count>0:!1;return ir(()=>{if(!(!t||!e))return jc.dispatch("PUSH",t,r),()=>jc.dispatch("POP",t,r)},[e,t]),i}function Db(e,t,r=()=>[document.body]){let n=Yf(e,"scroll-lock");FH(n,t,s=>{var i;return{containers:[...(i=s.containers)!=null?i:[],r]}})}function c3(e){return[e.screenX,e.screenY]}function hE(){let e=g.useRef([-1,-1]);return{wasMoved(t){let r=c3(t);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(t){e.current=c3(t)}}}function DH(e=0){let[t,r]=g.useState(e),n=g.useCallback(c=>r(c),[]),s=g.useCallback(c=>r(u=>u|c),[]),i=g.useCallback(c=>(t&c)===c,[t]),o=g.useCallback(c=>r(u=>u&~c),[]),l=g.useCallback(c=>r(u=>u^c),[]);return{flags:t,setFlag:n,addFlag:s,hasFlag:i,removeFlag:o,toggleFlag:l}}var u3,d3;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((u3=process==null?void 0:process.env)==null?void 0:u3.NODE_ENV)==="test"&&typeof((d3=Element==null?void 0:Element.prototype)==null?void 0:d3.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var $H=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))($H||{});function $b(e){let t={};for(let r in e)e[r]===!0&&(t[`data-${r}`]="");return t}function Bb(e,t,r,n){let[s,i]=g.useState(r),{hasFlag:o,addFlag:l,removeFlag:c}=DH(e&&s?3:0),u=g.useRef(!1),d=g.useRef(!1),m=wo();return ir(()=>{var f;if(e){if(r&&i(!0),!t){r&&l(3);return}return(f=n==null?void 0:n.start)==null||f.call(n,r),BH(t,{inFlight:u,prepare(){d.current?d.current=!1:d.current=u.current,u.current=!0,!d.current&&(r?(l(3),c(4)):(l(4),c(2)))},run(){d.current?r?(c(3),l(4)):(c(4),l(3)):r?c(1):l(1)},done(){var h;d.current&&typeof t.getAnimations=="function"&&t.getAnimations().length>0||(u.current=!1,c(7),r||i(!1),(h=n==null?void 0:n.end)==null||h.call(n,r))}})}},[e,r,t,m]),e?[s,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function BH(e,{prepare:t,run:r,done:n,inFlight:s}){let i=Cs();return zH(e,{prepare:t,inFlight:s}),i.nextFrame(()=>{r(),i.requestAnimationFrame(()=>{i.add(UH(e,n))})}),i.dispose}function UH(e,t){var r,n;let s=Cs();if(!e)return s.dispose;let i=!1;s.add(()=>{i=!0});let o=(n=(r=e.getAnimations)==null?void 0:r.call(e).filter(l=>l instanceof CSSTransition))!=null?n:[];return o.length===0?(t(),s.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{i||t()}),s.dispose)}function zH(e,{inFlight:t,prepare:r}){if(t!=null&&t.current){r();return}let n=e.style.transition;e.style.transition="none",r(),e.offsetHeight,e.style.transition=n}function fE(e,{container:t,accept:r,walk:n}){let s=g.useRef(r),i=g.useRef(n);g.useEffect(()=>{s.current=r,i.current=n},[r,n]),ir(()=>{if(!t||!e)return;let o=Wc(t);if(!o)return;let l=s.current,c=i.current,u=Object.assign(m=>l(m),{acceptNode:l}),d=o.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,u,!1);for(;d.nextNode();)c(d.currentNode)},[t,e,s,i])}function Nf(e,t){let r=g.useRef([]),n=mt(e);g.useEffect(()=>{let s=[...r.current];for(let[i,o]of t.entries())if(r.current[i]!==o){let l=n(t,s);return r.current=t,l}},[n,...t])}function xg(){return typeof window<"u"}function jd(e){return mE(e)?(e.nodeName||"").toLowerCase():"#document"}function ai(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ma(e){var t;return(t=(mE(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function mE(e){return xg()?e instanceof Node||e instanceof ai(e).Node:!1}function js(e){return xg()?e instanceof Element||e instanceof ai(e).Element:!1}function Ta(e){return xg()?e instanceof HTMLElement||e instanceof ai(e).HTMLElement:!1}function h3(e){return!xg()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ai(e).ShadowRoot}const qH=new Set(["inline","contents"]);function Zf(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=Qi(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!qH.has(s)}const VH=new Set(["table","td","th"]);function WH(e){return VH.has(jd(e))}const HH=[":popover-open",":modal"];function vg(e){return HH.some(t=>{try{return e.matches(t)}catch{return!1}})}const GH=["transform","translate","scale","rotate","perspective"],KH=["transform","translate","scale","rotate","perspective","filter"],YH=["paint","layout","strict","content"];function Ub(e){const t=zb(),r=js(e)?Qi(e):e;return GH.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||KH.some(n=>(r.willChange||"").includes(n))||YH.some(n=>(r.contain||"").includes(n))}function ZH(e){let t=Cl(e);for(;Ta(t)&&!ud(t);){if(Ub(t))return t;if(vg(t))return null;t=Cl(t)}return null}function zb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const JH=new Set(["html","body","#document"]);function ud(e){return JH.has(jd(e))}function Qi(e){return ai(e).getComputedStyle(e)}function yg(e){return js(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Cl(e){if(jd(e)==="html")return e;const t=e.assignedSlot||e.parentNode||h3(e)&&e.host||Ma(e);return h3(t)?t.host:t}function pE(e){const t=Cl(e);return ud(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ta(t)&&Zf(t)?t:pE(t)}function Sf(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=pE(e),i=s===((n=e.ownerDocument)==null?void 0:n.body),o=ai(s);if(i){const l=Ev(o);return t.concat(o,o.visualViewport||[],Zf(s)?s:[],l&&r?Sf(l):[])}return t.concat(s,Sf(s,[],r))}function Ev(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function XH(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:r,version:n}=t;return r+"/"+n}).join(" "):navigator.userAgent}const Rc=Math.min,us=Math.max,kf=Math.round,l0=Math.floor,La=e=>({x:e,y:e}),QH={left:"right",right:"left",bottom:"top",top:"bottom"},eG={start:"end",end:"start"};function f3(e,t,r){return us(e,Rc(t,r))}function Nd(e,t){return typeof e=="function"?e(t):e}function El(e){return e.split("-")[0]}function Jf(e){return e.split("-")[1]}function gE(e){return e==="x"?"y":"x"}function xE(e){return e==="y"?"height":"width"}const tG=new Set(["top","bottom"]);function no(e){return tG.has(El(e))?"y":"x"}function vE(e){return gE(no(e))}function rG(e,t,r){r===void 0&&(r=!1);const n=Jf(e),s=vE(e),i=xE(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=Cp(o)),[o,Cp(o)]}function nG(e){const t=Cp(e);return[Av(e),t,Av(t)]}function Av(e){return e.replace(/start|end/g,t=>eG[t])}const m3=["left","right"],p3=["right","left"],sG=["top","bottom"],iG=["bottom","top"];function aG(e,t,r){switch(e){case"top":case"bottom":return r?t?p3:m3:t?m3:p3;case"left":case"right":return t?sG:iG;default:return[]}}function oG(e,t,r,n){const s=Jf(e);let i=aG(El(e),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),t&&(i=i.concat(i.map(Av)))),i}function Cp(e){return e.replace(/left|right|bottom|top/g,t=>QH[t])}function lG(e){return{top:0,right:0,bottom:0,left:0,...e}}function cG(e){return typeof e!="number"?lG(e):{top:e,right:e,bottom:e,left:e}}function Ep(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function g3(e,t,r){let{reference:n,floating:s}=e;const i=no(t),o=vE(t),l=xE(o),c=El(t),u=i==="y",d=n.x+n.width/2-s.width/2,m=n.y+n.height/2-s.height/2,f=n[l]/2-s[l]/2;let h;switch(c){case"top":h={x:d,y:n.y-s.height};break;case"bottom":h={x:d,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:m};break;case"left":h={x:n.x-s.width,y:m};break;default:h={x:n.x,y:n.y}}switch(Jf(t)){case"start":h[o]-=f*(r&&u?-1:1);break;case"end":h[o]+=f*(r&&u?-1:1);break}return h}const uG=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:m}=g3(u,n,c),f=n,h={},x=0;for(let b=0;b<l.length;b++){const{name:j,fn:y}=l[b],{x:_,y:w,data:S,reset:E}=await y({x:d,y:m,initialPlacement:n,placement:f,strategy:s,middlewareData:h,rects:u,platform:o,elements:{reference:e,floating:t}});d=_??d,m=w??m,h={...h,[j]:{...h[j],...S}},E&&x<=50&&(x++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(u=E.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):E.rects),{x:d,y:m}=g3(u,f,c)),b=-1)}return{x:d,y:m,placement:f,strategy:s,middlewareData:h}};async function bg(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:m="floating",altBoundary:f=!1,padding:h=0}=Nd(t,e),x=cG(h),j=l[f?m==="floating"?"reference":"floating":m],y=Ep(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(j)))==null||r?j:j.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),_=m==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),S=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},E=Ep(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:w,strategy:c}):_);return{top:(y.top-E.top+x.top)/S.y,bottom:(E.bottom-y.bottom+x.bottom)/S.y,left:(y.left-E.left+x.left)/S.x,right:(E.right-y.right+x.right)/S.x}}const dG=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:m=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:b=!0,...j}=Nd(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=El(s),_=no(l),w=El(l)===l,S=await(c.isRTL==null?void 0:c.isRTL(u.floating)),E=f||(w||!b?[Cp(l)]:nG(l)),$=x!=="none";!f&&$&&E.push(...oG(l,b,x,S));const U=[l,...E],I=await bg(t,j),T=[];let D=((n=i.flip)==null?void 0:n.overflows)||[];if(d&&T.push(I[y]),m){const A=rG(s,o,S);T.push(I[A[0]],I[A[1]])}if(D=[...D,{placement:s,overflows:T}],!T.every(A=>A<=0)){var C,P;const A=(((C=i.flip)==null?void 0:C.index)||0)+1,R=U[A];if(R&&(!(m==="alignment"?_!==no(R):!1)||D.every(M=>no(M.placement)===_?M.overflows[0]>0:!0)))return{data:{index:A,overflows:D},reset:{placement:R}};let H=(P=D.filter(W=>W.overflows[0]<=0).sort((W,M)=>W.overflows[1]-M.overflows[1])[0])==null?void 0:P.placement;if(!H)switch(h){case"bestFit":{var F;const W=(F=D.filter(M=>{if($){const G=no(M.placement);return G===_||G==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(G=>G>0).reduce((G,ce)=>G+ce,0)]).sort((M,G)=>M[1]-G[1])[0])==null?void 0:F[0];W&&(H=W);break}case"initialPlacement":H=l;break}if(s!==H)return{reset:{placement:H}}}return{}}}},hG=new Set(["left","top"]);async function fG(e,t){const{placement:r,platform:n,elements:s}=e,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=El(r),l=Jf(r),c=no(r)==="y",u=hG.has(o)?-1:1,d=i&&c?-1:1,m=Nd(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:x}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof x=="number"&&(h=l==="end"?x*-1:x),c?{x:h*d,y:f*u}:{x:f*u,y:h*d}}const mG=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:i,placement:o,middlewareData:l}=t,c=await fG(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},pG=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:j=>{let{x:y,y:_}=j;return{x:y,y:_}}},...c}=Nd(e,t),u={x:r,y:n},d=await bg(t,c),m=no(El(s)),f=gE(m);let h=u[f],x=u[m];if(i){const j=f==="y"?"top":"left",y=f==="y"?"bottom":"right",_=h+d[j],w=h-d[y];h=f3(_,h,w)}if(o){const j=m==="y"?"top":"left",y=m==="y"?"bottom":"right",_=x+d[j],w=x-d[y];x=f3(_,x,w)}const b=l.fn({...t,[f]:h,[m]:x});return{...b,data:{x:b.x-r,y:b.y-n,enabled:{[f]:i,[m]:o}}}}}},gG=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...u}=Nd(e,t),d=await bg(t,u),m=El(s),f=Jf(s),h=no(s)==="y",{width:x,height:b}=i.floating;let j,y;m==="top"||m==="bottom"?(j=m,y=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(y=m,j=f==="end"?"top":"bottom");const _=b-d.top-d.bottom,w=x-d.left-d.right,S=Rc(b-d[j],_),E=Rc(x-d[y],w),$=!t.middlewareData.shift;let U=S,I=E;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(I=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(U=_),$&&!f){const D=us(d.left,0),C=us(d.right,0),P=us(d.top,0),F=us(d.bottom,0);h?I=x-2*(D!==0||C!==0?D+C:us(d.left,d.right)):U=b-2*(P!==0||F!==0?P+F:us(d.top,d.bottom))}await c({...t,availableWidth:I,availableHeight:U});const T=await o.getDimensions(l.floating);return x!==T.width||b!==T.height?{reset:{rects:!0}}:{}}}};function yE(e){const t=Qi(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Ta(e),i=s?e.offsetWidth:r,o=s?e.offsetHeight:n,l=kf(r)!==i||kf(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function qb(e){return js(e)?e:e.contextElement}function Yu(e){const t=qb(e);if(!Ta(t))return La(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:i}=yE(t);let o=(i?kf(r.width):r.width)/n,l=(i?kf(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const xG=La(0);function bE(e){const t=ai(e);return!zb()||!t.visualViewport?xG:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function vG(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==ai(e)?!1:t}function Fc(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),i=qb(e);let o=La(1);t&&(n?js(n)&&(o=Yu(n)):o=Yu(e));const l=vG(i,r,n)?bE(i):La(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,m=s.height/o.y;if(i){const f=ai(i),h=n&&js(n)?ai(n):n;let x=f,b=Ev(x);for(;b&&n&&h!==x;){const j=Yu(b),y=b.getBoundingClientRect(),_=Qi(b),w=y.left+(b.clientLeft+parseFloat(_.paddingLeft))*j.x,S=y.top+(b.clientTop+parseFloat(_.paddingTop))*j.y;c*=j.x,u*=j.y,d*=j.x,m*=j.y,c+=w,u+=S,x=ai(b),b=Ev(x)}}return Ep({width:d,height:m,x:c,y:u})}function wg(e,t){const r=yg(e).scrollLeft;return t?t.left+r:Fc(Ma(e)).left+r}function wE(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-wg(e,r),s=r.top+t.scrollTop;return{x:n,y:s}}function yG(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const i=s==="fixed",o=Ma(n),l=t?vg(t.floating):!1;if(n===o||l&&i)return r;let c={scrollLeft:0,scrollTop:0},u=La(1);const d=La(0),m=Ta(n);if((m||!m&&!i)&&((jd(n)!=="body"||Zf(o))&&(c=yg(n)),Ta(n))){const h=Fc(n);u=Yu(n),d.x=h.x+n.clientLeft,d.y=h.y+n.clientTop}const f=o&&!m&&!i?wE(o,c):La(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:r.y*u.y-c.scrollTop*u.y+d.y+f.y}}function bG(e){return Array.from(e.getClientRects())}function wG(e){const t=Ma(e),r=yg(e),n=e.ownerDocument.body,s=us(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=us(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+wg(e);const l=-r.scrollTop;return Qi(n).direction==="rtl"&&(o+=us(t.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:l}}const x3=25;function _G(e,t){const r=ai(e),n=Ma(e),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const d=zb();(!d||d&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}const u=wg(n);if(u<=0){const d=n.ownerDocument,m=d.body,f=getComputedStyle(m),h=d.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,x=Math.abs(n.clientWidth-m.clientWidth-h);x<=x3&&(i-=x)}else u<=x3&&(i+=u);return{width:i,height:o,x:l,y:c}}const jG=new Set(["absolute","fixed"]);function NG(e,t){const r=Fc(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,i=Ta(e)?Yu(e):La(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=s*i.x,u=n*i.y;return{width:o,height:l,x:c,y:u}}function v3(e,t,r){let n;if(t==="viewport")n=_G(e,r);else if(t==="document")n=wG(Ma(e));else if(js(t))n=NG(t,r);else{const s=bE(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Ep(n)}function _E(e,t){const r=Cl(e);return r===t||!js(r)||ud(r)?!1:Qi(r).position==="fixed"||_E(r,t)}function SG(e,t){const r=t.get(e);if(r)return r;let n=Sf(e,[],!1).filter(l=>js(l)&&jd(l)!=="body"),s=null;const i=Qi(e).position==="fixed";let o=i?Cl(e):e;for(;js(o)&&!ud(o);){const l=Qi(o),c=Ub(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&jG.has(s.position)||Zf(o)&&!c&&_E(e,o))?n=n.filter(d=>d!==o):s=l,o=Cl(o)}return t.set(e,n),n}function kG(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?vg(t)?[]:SG(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,d)=>{const m=v3(t,d,s);return u.top=us(m.top,u.top),u.right=Rc(m.right,u.right),u.bottom=Rc(m.bottom,u.bottom),u.left=us(m.left,u.left),u},v3(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function CG(e){const{width:t,height:r}=yE(e);return{width:t,height:r}}function EG(e,t,r){const n=Ta(t),s=Ma(t),i=r==="fixed",o=Fc(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=La(0);function u(){c.x=wg(s)}if(n||!n&&!i)if((jd(t)!=="body"||Zf(s))&&(l=yg(t)),n){const h=Fc(t,!0,i,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else s&&u();i&&!n&&s&&u();const d=s&&!n&&!i?wE(s,l):La(0),m=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:m,y:f,width:o.width,height:o.height}}function Nx(e){return Qi(e).position==="static"}function y3(e,t){if(!Ta(e)||Qi(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Ma(e)===r&&(r=r.ownerDocument.body),r}function jE(e,t){const r=ai(e);if(vg(e))return r;if(!Ta(e)){let s=Cl(e);for(;s&&!ud(s);){if(js(s)&&!Nx(s))return s;s=Cl(s)}return r}let n=y3(e,t);for(;n&&WH(n)&&Nx(n);)n=y3(n,t);return n&&ud(n)&&Nx(n)&&!Ub(n)?r:n||ZH(e)||r}const AG=async function(e){const t=this.getOffsetParent||jE,r=this.getDimensions,n=await r(e.floating);return{reference:EG(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function LG(e){return Qi(e).direction==="rtl"}const PG={convertOffsetParentRelativeRectToViewportRelativeRect:yG,getDocumentElement:Ma,getClippingRect:kG,getOffsetParent:jE,getElementRects:AG,getClientRects:bG,getDimensions:CG,getScale:Yu,isElement:js,isRTL:LG};function NE(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function TG(e,t){let r=null,n;const s=Ma(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=e.getBoundingClientRect(),{left:d,top:m,width:f,height:h}=u;if(l||t(),!f||!h)return;const x=l0(m),b=l0(s.clientWidth-(d+f)),j=l0(s.clientHeight-(m+h)),y=l0(d),w={rootMargin:-x+"px "+-b+"px "+-j+"px "+-y+"px",threshold:us(0,Rc(1,c))||1};let S=!0;function E($){const U=$[0].intersectionRatio;if(U!==c){if(!S)return o();U?o(!1,U):n=setTimeout(()=>{o(!1,1e-7)},1e3)}U===1&&!NE(u,e.getBoundingClientRect())&&o(),S=!1}try{r=new IntersectionObserver(E,{...w,root:s.ownerDocument})}catch{r=new IntersectionObserver(E,w)}r.observe(e)}return o(!0),i}function IG(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=qb(e),d=s||i?[...u?Sf(u):[],...Sf(t)]:[];d.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const m=u&&l?TG(u,r):null;let f=-1,h=null;o&&(h=new ResizeObserver(y=>{let[_]=y;_&&_.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),r()}),u&&!c&&h.observe(u),h.observe(t));let x,b=c?Fc(e):null;c&&j();function j(){const y=Fc(e);b&&!NE(b,y)&&r(),b=y,x=requestAnimationFrame(j)}return r(),()=>{var y;d.forEach(_=>{s&&_.removeEventListener("scroll",r),i&&_.removeEventListener("resize",r)}),m==null||m(),(y=h)==null||y.disconnect(),h=null,c&&cancelAnimationFrame(x)}}const Sx=bg,MG=mG,OG=pG,RG=dG,FG=gG,DG=(e,t,r)=>{const n=new Map,s={platform:PG,...r},i={...s.platform,_c:n};return uG(e,t,{...s,platform:i})};var $G=typeof document<"u",BG=function(){},O0=$G?g.useLayoutEffect:BG;function Ap(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Ap(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&e.$$typeof)&&!Ap(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function SE(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function b3(e,t){const r=SE(e);return Math.round(t*r)/r}function kx(e){const t=g.useRef(e);return O0(()=>{t.current=e}),t}function UG(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,m]=g.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=g.useState(n);Ap(f,n)||h(n);const[x,b]=g.useState(null),[j,y]=g.useState(null),_=g.useCallback(M=>{M!==$.current&&($.current=M,b(M))},[]),w=g.useCallback(M=>{M!==U.current&&(U.current=M,y(M))},[]),S=i||x,E=o||j,$=g.useRef(null),U=g.useRef(null),I=g.useRef(d),T=c!=null,D=kx(c),C=kx(s),P=kx(u),F=g.useCallback(()=>{if(!$.current||!U.current)return;const M={placement:t,strategy:r,middleware:f};C.current&&(M.platform=C.current),DG($.current,U.current,M).then(G=>{const ce={...G,isPositioned:P.current!==!1};A.current&&!Ap(I.current,ce)&&(I.current=ce,Fn.flushSync(()=>{m(ce)}))})},[f,t,r,C,P]);O0(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,m(M=>({...M,isPositioned:!1})))},[u]);const A=g.useRef(!1);O0(()=>(A.current=!0,()=>{A.current=!1}),[]),O0(()=>{if(S&&($.current=S),E&&(U.current=E),S&&E){if(D.current)return D.current(S,E,F);F()}},[S,E,F,D,T]);const R=g.useMemo(()=>({reference:$,floating:U,setReference:_,setFloating:w}),[_,w]),H=g.useMemo(()=>({reference:S,floating:E}),[S,E]),W=g.useMemo(()=>{const M={position:r,left:0,top:0};if(!H.floating)return M;const G=b3(H.floating,d.x),ce=b3(H.floating,d.y);return l?{...M,transform:"translate("+G+"px, "+ce+"px)",...SE(H.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:G,top:ce}},[r,l,H.floating,d.x,d.y]);return g.useMemo(()=>({...d,update:F,refs:R,elements:H,floatingStyles:W}),[d,F,R,H,W])}const kE=(e,t)=>({...MG(e),options:[e,t]}),zG=(e,t)=>({...OG(e),options:[e,t]}),qG=(e,t)=>({...RG(e),options:[e,t]}),VG=(e,t)=>({...FG(e),options:[e,t]}),CE={...Ix},WG=CE.useInsertionEffect,HG=WG||(e=>e());function EE(e){const t=g.useRef(()=>{});return HG(()=>{t.current=e}),g.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}var Lv=typeof document<"u"?g.useLayoutEffect:g.useEffect;let w3=!1,GG=0;const _3=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+GG++;function KG(){const[e,t]=g.useState(()=>w3?_3():void 0);return Lv(()=>{e==null&&t(_3())},[]),g.useEffect(()=>{w3=!0},[]),e}const YG=CE.useId,ZG=YG||KG;function JG(){const e=new Map;return{emit(t,r){var n;(n=e.get(t))==null||n.forEach(s=>s(r))},on(t,r){e.set(t,[...e.get(t)||[],r])},off(t,r){var n;e.set(t,((n=e.get(t))==null?void 0:n.filter(s=>s!==r))||[])}}}const XG=g.createContext(null),QG=g.createContext(null),eK=()=>{var e;return((e=g.useContext(XG))==null?void 0:e.id)||null},tK=()=>g.useContext(QG),rK="data-floating-ui-focusable";function nK(e){const{open:t=!1,onOpenChange:r,elements:n}=e,s=ZG(),i=g.useRef({}),[o]=g.useState(()=>JG()),l=eK()!=null,[c,u]=g.useState(n.reference),d=EE((h,x,b)=>{i.current.openEvent=h?x:void 0,o.emit("openchange",{open:h,event:x,reason:b,nested:l}),r==null||r(h,x,b)}),m=g.useMemo(()=>({setPositionReference:u}),[]),f=g.useMemo(()=>({reference:c||n.reference||null,floating:n.floating||null,domReference:n.reference}),[c,n.reference,n.floating]);return g.useMemo(()=>({dataRef:i,open:t,onOpenChange:d,elements:f,events:o,floatingId:s,refs:m}),[t,d,f,o,s,m])}function sK(e){e===void 0&&(e={});const{nodeId:t}=e,r=nK({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||r,s=n.elements,[i,o]=g.useState(null),[l,c]=g.useState(null),d=(s==null?void 0:s.domReference)||i,m=g.useRef(null),f=tK();Lv(()=>{d&&(m.current=d)},[d]);const h=UG({...e,elements:{...s,...l&&{reference:l}}}),x=g.useCallback(w=>{const S=js(w)?{getBoundingClientRect:()=>w.getBoundingClientRect(),contextElement:w}:w;c(S),h.refs.setReference(S)},[h.refs]),b=g.useCallback(w=>{(js(w)||w===null)&&(m.current=w,o(w)),(js(h.refs.reference.current)||h.refs.reference.current===null||w!==null&&!js(w))&&h.refs.setReference(w)},[h.refs]),j=g.useMemo(()=>({...h.refs,setReference:b,setPositionReference:x,domReference:m}),[h.refs,b,x]),y=g.useMemo(()=>({...h.elements,domReference:d}),[h.elements,d]),_=g.useMemo(()=>({...h,...n,refs:j,elements:y,nodeId:t}),[h,j,y,t,n]);return Lv(()=>{n.dataRef.current.floatingContext=_;const w=f==null?void 0:f.nodesRef.current.find(S=>S.id===t);w&&(w.context=_)}),g.useMemo(()=>({...h,context:_,refs:j,elements:y}),[h,j,y,_])}const j3="active",N3="selected";function Cx(e,t,r){const n=new Map,s=r==="item";let i=e;if(s&&e){const{[j3]:o,[N3]:l,...c}=e;i=c}return{...r==="floating"&&{tabIndex:-1,[rK]:""},...i,...t.map(o=>{const l=o?o[r]:null;return typeof l=="function"?e?l(e):null:l}).concat(e).reduce((o,l)=>(l&&Object.entries(l).forEach(c=>{let[u,d]=c;if(!(s&&[j3,N3].includes(u)))if(u.indexOf("on")===0){if(n.has(u)||n.set(u,[]),typeof d=="function"){var m;(m=n.get(u))==null||m.push(d),o[u]=function(){for(var f,h=arguments.length,x=new Array(h),b=0;b<h;b++)x[b]=arguments[b];return(f=n.get(u))==null?void 0:f.map(j=>j(...x)).find(j=>j!==void 0)}}}else o[u]=d}),o),{})}}function iK(e){e===void 0&&(e=[]);const t=e.map(l=>l==null?void 0:l.reference),r=e.map(l=>l==null?void 0:l.floating),n=e.map(l=>l==null?void 0:l.item),s=g.useCallback(l=>Cx(l,e,"reference"),t),i=g.useCallback(l=>Cx(l,e,"floating"),r),o=g.useCallback(l=>Cx(l,e,"item"),n);return g.useMemo(()=>({getReferenceProps:s,getFloatingProps:i,getItemProps:o}),[s,i,o])}function S3(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const aK=e=>({name:"inner",options:e,async fn(t){const{listRef:r,overflowRef:n,onFallbackChange:s,offset:i=0,index:o=0,minItemsVisible:l=4,referenceOverflowThreshold:c=0,scrollRef:u,...d}=Nd(e,t),{rects:m,elements:{floating:f}}=t,h=r.current[o],x=(u==null?void 0:u.current)||f,b=f.clientTop||x.clientTop,j=f.clientTop!==0,y=x.clientTop!==0,_=f===x;if(!h)return{};const w={...t,...await kE(-h.offsetTop-f.clientTop-m.reference.height/2-h.offsetHeight/2-i).fn(t)},S=await Sx(S3(w,x.scrollHeight+b+f.clientTop),d),E=await Sx(w,{...d,elementContext:"reference"}),$=us(0,S.top),U=w.y+$,D=(x.scrollHeight>x.clientHeight?C=>C:kf)(us(0,x.scrollHeight+(j&&_||y?b*2:0)-$-us(0,S.bottom)));if(x.style.maxHeight=D+"px",x.scrollTop=$,s){const C=x.offsetHeight<h.offsetHeight*Rc(l,r.current.length)-1||E.top>=-c||E.bottom>=-c;Fn.flushSync(()=>s(C))}return n&&(n.current=await Sx(S3({...w,y:U},x.offsetHeight+b+f.clientTop),d)),{y:U}}});function oK(e,t){const{open:r,elements:n}=e,{enabled:s=!0,overflowRef:i,scrollRef:o,onChange:l}=t,c=EE(l),u=g.useRef(!1),d=g.useRef(null),m=g.useRef(null);g.useEffect(()=>{if(!s)return;function h(b){if(b.ctrlKey||!x||i.current==null)return;const j=b.deltaY,y=i.current.top>=-.5,_=i.current.bottom>=-.5,w=x.scrollHeight-x.clientHeight,S=j<0?-1:1,E=j<0?"max":"min";x.scrollHeight<=x.clientHeight||(!y&&j>0||!_&&j<0?(b.preventDefault(),Fn.flushSync(()=>{c($=>$+Math[E](j,w*S))})):/firefox/i.test(XH())&&(x.scrollTop+=j))}const x=(o==null?void 0:o.current)||n.floating;if(r&&x)return x.addEventListener("wheel",h),requestAnimationFrame(()=>{d.current=x.scrollTop,i.current!=null&&(m.current={...i.current})}),()=>{d.current=null,m.current=null,x.removeEventListener("wheel",h)}},[s,r,n.floating,i,o,c]);const f=g.useMemo(()=>({onKeyDown(){u.current=!0},onWheel(){u.current=!1},onPointerMove(){u.current=!1},onScroll(){const h=(o==null?void 0:o.current)||n.floating;if(!(!i.current||!h||!u.current)){if(d.current!==null){const x=h.scrollTop-d.current;(i.current.bottom<-.5&&x<-1||i.current.top<-.5&&x>1)&&Fn.flushSync(()=>c(b=>b+x))}requestAnimationFrame(()=>{d.current=h.scrollTop})}}}),[n.floating,c,i,o]);return g.useMemo(()=>s?{floating:f}:{},[s,f])}let Sd=g.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});Sd.displayName="FloatingContext";let Vb=g.createContext(null);Vb.displayName="PlacementContext";function AE(e){return g.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function LE(){return g.useContext(Sd).setReference}function lK(){return g.useContext(Sd).getReferenceProps}function PE(){let{getFloatingProps:e,slot:t}=g.useContext(Sd);return g.useCallback((...r)=>Object.assign({},e(...r),{"data-anchor":t.anchor}),[e,t])}function TE(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let t=g.useContext(Vb),r=g.useMemo(()=>e,[JSON.stringify(e,(s,i)=>{var o;return(o=i==null?void 0:i.outerHTML)!=null?o:i})]);ir(()=>{t==null||t(r??null)},[t,r]);let n=g.useContext(Sd);return g.useMemo(()=>[n.setFloating,e?n.styles:{}],[n.setFloating,e,n.styles])}let k3=4;function IE({children:e,enabled:t=!0}){let[r,n]=g.useState(null),[s,i]=g.useState(0),o=g.useRef(null),[l,c]=g.useState(null);cK(l);let u=t&&r!==null&&l!==null,{to:d="bottom",gap:m=0,offset:f=0,padding:h=0,inner:x}=uK(r,l),[b,j="center"]=d.split(" ");ir(()=>{u&&i(0)},[u]);let{refs:y,floatingStyles:_,context:w}=sK({open:u,placement:b==="selection"?j==="center"?"bottom":`bottom-${j}`:j==="center"?`${b}`:`${b}-${j}`,strategy:"absolute",transform:!1,middleware:[kE({mainAxis:b==="selection"?0:m,crossAxis:f}),zG({padding:h}),b!=="selection"&&qG({padding:h}),b==="selection"&&x?aK({...x,padding:h,overflowRef:o,offset:s,minItemsVisible:k3,referenceOverflowThreshold:h,onFallbackChange(C){var P,F;if(!C)return;let A=w.elements.floating;if(!A)return;let R=parseFloat(getComputedStyle(A).scrollPaddingBottom)||0,H=Math.min(k3,A.childElementCount),W=0,M=0;for(let G of(F=(P=w.elements.floating)==null?void 0:P.childNodes)!=null?F:[])if(Us(G)){let ce=G.offsetTop,ue=ce+G.clientHeight+R,O=A.scrollTop,Z=O+A.clientHeight;if(ce>=O&&ue<=Z)H--;else{M=Math.max(0,Math.min(ue,Z)-Math.max(ce,O)),W=G.clientHeight;break}}H>=1&&i(G=>{let ce=W*H-M+R;return G>=ce?G:ce})}}):null,VG({padding:h,apply({availableWidth:C,availableHeight:P,elements:F}){Object.assign(F.floating.style,{overflow:"auto",maxWidth:`${C}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${P}px)`})}})].filter(Boolean),whileElementsMounted:IG}),[S=b,E=j]=w.placement.split("-");b==="selection"&&(S="selection");let $=g.useMemo(()=>({anchor:[S,E].filter(Boolean).join(" ")}),[S,E]),U=oK(w,{overflowRef:o,onChange:i}),{getReferenceProps:I,getFloatingProps:T}=iK([U]),D=mt(C=>{c(C),y.setFloating(C)});return g.createElement(Vb.Provider,{value:n},g.createElement(Sd.Provider,{value:{setFloating:D,setReference:y.setReference,styles:_,getReferenceProps:I,getFloatingProps:T,slot:$}},e))}function cK(e){ir(()=>{if(!e)return;let t=new MutationObserver(()=>{let r=window.getComputedStyle(e).maxHeight,n=parseFloat(r);if(isNaN(n))return;let s=parseInt(r);isNaN(s)||n!==s&&(e.style.maxHeight=`${Math.ceil(n)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}function uK(e,t){var r,n,s;let i=Ex((r=e==null?void 0:e.gap)!=null?r:"var(--anchor-gap, 0)",t),o=Ex((n=e==null?void 0:e.offset)!=null?n:"var(--anchor-offset, 0)",t),l=Ex((s=e==null?void 0:e.padding)!=null?s:"var(--anchor-padding, 0)",t);return{...e,gap:i,offset:o,padding:l}}function Ex(e,t,r=void 0){let n=wo(),s=mt((c,u)=>{if(c==null)return[r,null];if(typeof c=="number")return[c,null];if(typeof c=="string"){if(!u)return[r,null];let d=C3(c,u);return[d,m=>{let f=ME(c);{let h=f.map(x=>window.getComputedStyle(u).getPropertyValue(x));n.requestAnimationFrame(function x(){n.nextFrame(x);let b=!1;for(let[y,_]of f.entries()){let w=window.getComputedStyle(u).getPropertyValue(_);if(h[y]!==w){h[y]=w,b=!0;break}}if(!b)return;let j=C3(c,u);d!==j&&(m(j),d=j)})}return n.dispose}]}return[r,null]}),i=g.useMemo(()=>s(e,t)[0],[e,t]),[o=i,l]=g.useState();return ir(()=>{let[c,u]=s(e,t);if(l(c),!!u)return u(l)},[e,t]),o}function ME(e){let t=/var\((.*)\)/.exec(e);if(t){let r=t[1].indexOf(",");if(r===-1)return[t[1]];let n=t[1].slice(0,r).trim(),s=t[1].slice(r+1).trim();return s?[n,...ME(s)]:[n]}return[]}function C3(e,t){let r=document.createElement("div");t.appendChild(r),r.style.setProperty("margin-top","0px","important"),r.style.setProperty("margin-top",e,"important");let n=parseFloat(window.getComputedStyle(r).marginTop)||0;return t.removeChild(r),n}function dK({children:e,freeze:t}){let r=Pv(t,e);return st.createElement(st.Fragment,null,r)}function Pv(e,t){let[r,n]=g.useState(t);return!e&&r!==t&&n(t),e?r:t}let _g=g.createContext(null);_g.displayName="OpenClosedContext";var Pn=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Pn||{});function kd(){return g.useContext(_g)}function Wb({value:e,children:t}){return st.createElement(_g.Provider,{value:e},t)}function hK({children:e}){return st.createElement(_g.Provider,{value:null},e)}function fK(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let wa=[];fK(()=>{function e(t){if(!ja(t.target)||t.target===document.body||wa[0]===t.target)return;let r=t.target;r=r.closest(kp),wa.unshift(r??t.target),wa=wa.filter(n=>n!=null&&n.isConnected),wa.splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function mK(e){throw new Error("Unexpected object: "+e)}var Gt=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Gt||{});function Ou(e,t){let r=t.resolveItems();if(r.length<=0)return null;let n=t.resolveActiveIndex(),s=n??-1;switch(e.focus){case 0:{for(let i=0;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 1:{s===-1&&(s=r.length);for(let i=s-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 2:{for(let i=s+1;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 3:{for(let i=r.length-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 4:{for(let i=0;i<r.length;++i)if(t.resolveId(r[i],i,r)===e.id)return i;return n}case 5:return null;default:mK(e)}}var jg=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(jg||{});function Ng(e){let t=mt(e),r=g.useRef(!1);g.useEffect(()=>(r.current=!1,()=>{r.current=!0,fg(()=>{r.current&&t()})}),[t])}let OE=g.createContext(!1);function pK(){return g.useContext(OE)}function E3(e){return st.createElement(OE.Provider,{value:e.force},e.children)}function gK(e){let t=pK(),r=g.useContext(FE),[n,s]=g.useState(()=>{var i;if(!t&&r!==null)return(i=r.current)!=null?i:null;if(uo.isServer)return null;let o=e==null?void 0:e.getElementById("headlessui-portal-root");if(o)return o;if(e===null)return null;let l=e.createElement("div");return l.setAttribute("id","headlessui-portal-root"),e.body.appendChild(l)});return g.useEffect(()=>{n!==null&&(e!=null&&e.body.contains(n)||e==null||e.body.appendChild(n))},[n,e]),g.useEffect(()=>{t||r!==null&&s(r.current)},[r,s,t]),n}let RE=g.Fragment,xK=Nr(function(e,t){let{ownerDocument:r=null,...n}=e,s=g.useRef(null),i=Tn(IW(f=>{s.current=f}),t),o=yo(s),l=r??o,c=gK(l),u=g.useContext(Tv),d=wo(),m=Rr();return Ng(()=>{var f;c&&c.childNodes.length<=0&&((f=c.parentElement)==null||f.removeChild(c))}),c?Fn.createPortal(st.createElement("div",{"data-headlessui-portal":"",ref:f=>{d.dispose(),u&&f&&d.add(u.register(f))}},m({ourProps:{ref:i},theirProps:n,slot:{},defaultTag:RE,name:"Portal"})),c):null});function vK(e,t){let r=Tn(t),{enabled:n=!0,ownerDocument:s,...i}=e,o=Rr();return n?st.createElement(xK,{...i,ownerDocument:s,ref:r}):o({ourProps:{ref:r},theirProps:i,slot:{},defaultTag:RE,name:"Portal"})}let yK=g.Fragment,FE=g.createContext(null);function bK(e,t){let{target:r,...n}=e,s={ref:Tn(t)},i=Rr();return st.createElement(FE.Provider,{value:r},i({ourProps:s,theirProps:n,defaultTag:yK,name:"Popover.Group"}))}let Tv=g.createContext(null);function wK(){let e=g.useContext(Tv),t=g.useRef([]),r=mt(i=>(t.current.push(i),e&&e.register(i),()=>n(i))),n=mt(i=>{let o=t.current.indexOf(i);o!==-1&&t.current.splice(o,1),e&&e.unregister(i)}),s=g.useMemo(()=>({register:r,unregister:n,portals:t}),[r,n,t]);return[t,g.useMemo(()=>function({children:i}){return st.createElement(Tv.Provider,{value:s},i)},[s])]}let _K=Nr(vK),DE=Nr(bK),Hb=Object.assign(_K,{Group:DE});const so={Idle:{kind:"Idle"},Tracked:e=>({kind:"Tracked",position:e}),Moved:{kind:"Moved"}};function Gb(e){let t=e.getBoundingClientRect();return`${t.x},${t.y}`}function $E(e,t,r){let n=Cs();if(t.kind==="Tracked"){let s=function(){i!==Gb(e)&&(n.dispose(),r())},{position:i}=t,o=new ResizeObserver(s);o.observe(e),n.add(()=>o.disconnect()),n.addEventListener(window,"scroll",s,{passive:!0}),n.addEventListener(window,"resize",s)}return()=>n.dispose()}var jK=Object.defineProperty,NK=(e,t,r)=>t in e?jK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,A3=(e,t,r)=>(NK(e,typeof t!="symbol"?t+"":t,r),r),Jt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Jt||{}),ti=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(ti||{}),Pa=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(Pa||{}),BE=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.SetTyping=3]="SetTyping",e[e.RegisterOption=4]="RegisterOption",e[e.UnregisterOption=5]="UnregisterOption",e[e.DefaultToFirstOption=6]="DefaultToFirstOption",e[e.SetActivationTrigger=7]="SetActivationTrigger",e[e.UpdateVirtualConfiguration=8]="UpdateVirtualConfiguration",e[e.SetInputElement=9]="SetInputElement",e[e.SetButtonElement=10]="SetButtonElement",e[e.SetOptionsElement=11]="SetOptionsElement",e[e.MarkInputAsMoved=12]="MarkInputAsMoved",e))(BE||{});function Ax(e,t=r=>r){let r=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=t(e.options.slice()),s=n.length>0&&n[0].dataRef.current.order!==null?n.sort((o,l)=>o.dataRef.current.order-l.dataRef.current.order):Ob(n,o=>o.dataRef.current.domRef.current),i=r?s.indexOf(r):null;return i===-1&&(i=null),{options:s,activeOptionIndex:i}}let SK={1(e){var t;if((t=e.dataRef.current)!=null&&t.disabled||e.comboboxState===1)return e;let r=e.inputElement?so.Tracked(Gb(e.inputElement)):e.inputPositionState;return{...e,activeOptionIndex:null,comboboxState:1,isTyping:!1,activationTrigger:2,inputPositionState:r,__demoMode:!1}},0(e){var t,r;if((t=e.dataRef.current)!=null&&t.disabled||e.comboboxState===0)return e;if((r=e.dataRef.current)!=null&&r.value){let n=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(n!==-1)return{...e,activeOptionIndex:n,comboboxState:0,__demoMode:!1,inputPositionState:so.Idle}}return{...e,comboboxState:0,inputPositionState:so.Idle,__demoMode:!1}},3(e,t){return e.isTyping===t.isTyping?e:{...e,isTyping:t.isTyping}},2(e,t){var r,n,s,i;if((r=e.dataRef.current)!=null&&r.disabled||e.optionsElement&&!((n=e.dataRef.current)!=null&&n.optionsPropsRef.current.static)&&e.comboboxState===1)return e;if(e.virtual){let{options:u,disabled:d}=e.virtual,m=t.focus===Gt.Specific?t.idx:Ou(t,{resolveItems:()=>u,resolveActiveIndex:()=>{var h,x;return(x=(h=e.activeOptionIndex)!=null?h:u.findIndex(b=>!d(b)))!=null?x:null},resolveDisabled:d,resolveId(){throw new Error("Function not implemented.")}}),f=(s=t.trigger)!=null?s:2;return e.activeOptionIndex===m&&e.activationTrigger===f?e:{...e,activeOptionIndex:m,activationTrigger:f,isTyping:!1,__demoMode:!1}}let o=Ax(e);if(o.activeOptionIndex===null){let u=o.options.findIndex(d=>!d.dataRef.current.disabled);u!==-1&&(o.activeOptionIndex=u)}let l=t.focus===Gt.Specific?t.idx:Ou(t,{resolveItems:()=>o.options,resolveActiveIndex:()=>o.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled}),c=(i=t.trigger)!=null?i:2;return e.activeOptionIndex===l&&e.activationTrigger===c?e:{...e,...o,isTyping:!1,activeOptionIndex:l,activationTrigger:c,__demoMode:!1}},4:(e,t)=>{var r,n,s,i;if((r=e.dataRef.current)!=null&&r.virtual)return{...e,options:[...e.options,t.payload]};let o=t.payload,l=Ax(e,u=>(u.push(o),u));e.activeOptionIndex===null&&(s=(n=e.dataRef.current).isSelected)!=null&&s.call(n,t.payload.dataRef.current.value)&&(l.activeOptionIndex=l.options.indexOf(o));let c={...e,...l,activationTrigger:2};return(i=e.dataRef.current)!=null&&i.__demoMode&&e.dataRef.current.value===void 0&&(c.activeOptionIndex=0),c},5:(e,t)=>{var r;if((r=e.dataRef.current)!=null&&r.virtual)return{...e,options:e.options.filter(s=>s.id!==t.id)};let n=Ax(e,s=>{let i=s.findIndex(o=>o.id===t.id);return i!==-1&&s.splice(i,1),s});return{...e,...n,activationTrigger:2}},6:(e,t)=>e.defaultToFirstOption===t.value?e:{...e,defaultToFirstOption:t.value},7:(e,t)=>e.activationTrigger===t.trigger?e:{...e,activationTrigger:t.trigger},8:(e,t)=>{var r,n;if(e.virtual===null)return{...e,virtual:{options:t.options,disabled:(r=t.disabled)!=null?r:()=>!1}};if(e.virtual.options===t.options&&e.virtual.disabled===t.disabled)return e;let s=e.activeOptionIndex;if(e.activeOptionIndex!==null){let i=t.options.indexOf(e.virtual.options[e.activeOptionIndex]);i!==-1?s=i:s=null}return{...e,activeOptionIndex:s,virtual:{options:t.options,disabled:(n=t.disabled)!=null?n:()=>!1}}},9:(e,t)=>e.inputElement===t.element?e:{...e,inputElement:t.element},10:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},11:(e,t)=>e.optionsElement===t.element?e:{...e,optionsElement:t.element},12(e){return e.inputPositionState.kind!=="Tracked"?e:{...e,inputPositionState:so.Moved}}},kK=class UE extends Ab{constructor(t){super(t),A3(this,"actions",{onChange:r=>{let{onChange:n,compare:s,mode:i,value:o}=this.state.dataRef.current;return Zn(i,{0:()=>n==null?void 0:n(r),1:()=>{let l=o.slice(),c=l.findIndex(u=>s(u,r));return c===-1?l.push(r):l.splice(c,1),n==null?void 0:n(l)}})},registerOption:(r,n)=>(this.send({type:4,payload:{id:r,dataRef:n}}),()=>{this.state.activeOptionIndex===this.state.dataRef.current.calculateIndex(n.current.value)&&this.send({type:6,value:!0}),this.send({type:5,id:r})}),goToOption:(r,n)=>(this.send({type:6,value:!1}),this.send({type:2,...r,trigger:n})),setIsTyping:r=>{this.send({type:3,isTyping:r})},closeCombobox:()=>{var r,n;this.send({type:1}),this.send({type:6,value:!1}),(n=(r=this.state.dataRef.current).onClose)==null||n.call(r)},openCombobox:()=>{this.send({type:0}),this.send({type:6,value:!0})},setActivationTrigger:r=>{this.send({type:7,trigger:r})},selectActiveOption:()=>{let r=this.selectors.activeOptionIndex(this.state);if(r!==null){if(this.actions.setIsTyping(!1),this.state.virtual)this.actions.onChange(this.state.virtual.options[r]);else{let{dataRef:n}=this.state.options[r];this.actions.onChange(n.current.value)}this.actions.goToOption({focus:Gt.Specific,idx:r})}},setInputElement:r=>{this.send({type:9,element:r})},setButtonElement:r=>{this.send({type:10,element:r})},setOptionsElement:r=>{this.send({type:11,element:r})}}),A3(this,"selectors",{activeDescendantId:r=>{var n,s;let i=this.selectors.activeOptionIndex(r);if(i!==null)return r.virtual?(s=r.options.find(o=>!o.dataRef.current.disabled&&r.dataRef.current.compare(o.dataRef.current.value,r.virtual.options[i])))==null?void 0:s.id:(n=r.options[i])==null?void 0:n.id},activeOptionIndex:r=>{if(r.defaultToFirstOption&&r.activeOptionIndex===null&&(r.virtual?r.virtual.options.length>0:r.options.length>0)){if(r.virtual){let{options:s,disabled:i}=r.virtual,o=s.findIndex(l=>{var c;return!((c=i==null?void 0:i(l))!=null&&c)});if(o!==-1)return o}let n=r.options.findIndex(s=>!s.dataRef.current.disabled);if(n!==-1)return n}return r.activeOptionIndex},activeOption:r=>{var n,s;let i=this.selectors.activeOptionIndex(r);return i===null?null:r.virtual?r.virtual.options[i??0]:(s=(n=r.options[i])==null?void 0:n.dataRef.current.value)!=null?s:null},isActive:(r,n,s)=>{var i;let o=this.selectors.activeOptionIndex(r);return o===null?!1:r.virtual?o===r.dataRef.current.calculateIndex(n):((i=r.options[o])==null?void 0:i.id)===s},shouldScrollIntoView:(r,n,s)=>!(r.virtual||r.__demoMode||r.comboboxState!==0||r.activationTrigger===0||!this.selectors.isActive(r,n,s)),didInputMove(r){return r.inputPositionState.kind==="Moved"}});{let r=this.state.id,n=_d.get(null);this.disposables.add(n.on(Lb.Push,s=>{!n.selectors.isTop(s,r)&&this.state.comboboxState===0&&this.actions.closeCombobox()})),this.on(0,()=>n.actions.push(r)),this.on(1,()=>n.actions.pop(r))}this.disposables.group(r=>{this.on(1,n=>{n.inputElement&&(r.dispose(),r.add($E(n.inputElement,n.inputPositionState,()=>{this.send({type:12})})))})})}static new({id:t,virtual:r=null,__demoMode:n=!1}){var s;return new UE({id:t,dataRef:{current:{}},comboboxState:n?0:1,isTyping:!1,options:[],virtual:r?{options:r.options,disabled:(s=r.disabled)!=null?s:()=>!1}:null,activeOptionIndex:null,activationTrigger:2,inputElement:null,buttonElement:null,optionsElement:null,__demoMode:n,inputPositionState:so.Idle})}reduce(t,r){return Zn(r.type,SK,t,r)}};const zE=g.createContext(null);function Xf(e){let t=g.useContext(zE);if(t===null){let r=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,qE),r}return t}function qE({id:e,virtual:t=null,__demoMode:r=!1}){let n=g.useMemo(()=>kK.new({id:e,virtual:t,__demoMode:r}),[]);return Ng(()=>n.dispose()),n}let Cf=g.createContext(null);Cf.displayName="ComboboxDataContext";function Cd(e){let t=g.useContext(Cf);if(t===null){let r=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Cd),r}return t}let VE=g.createContext(null);function CK(e){let t=Xf("VirtualProvider"),r=Cd("VirtualProvider"),{options:n}=r.virtual,s=hr(t,h=>h.optionsElement),[i,o]=g.useMemo(()=>{let h=s;if(!h)return[0,0];let x=window.getComputedStyle(h);return[parseFloat(x.paddingBlockStart||x.paddingTop),parseFloat(x.paddingBlockEnd||x.paddingBottom)]},[s]),l=rH({enabled:n.length!==0,scrollPaddingStart:i,scrollPaddingEnd:o,count:n.length,estimateSize(){return 40},getScrollElement(){return t.state.optionsElement},overscan:12}),[c,u]=g.useState(0);ir(()=>{u(h=>h+1)},[n]);let d=l.getVirtualItems(),m=hr(t,h=>h.activationTrigger===Pa.Pointer),f=hr(t,t.selectors.activeOptionIndex);return d.length===0?null:st.createElement(VE.Provider,{value:l},st.createElement("div",{style:{position:"relative",width:"100%",height:`${l.getTotalSize()}px`},ref:h=>{h&&(m||f!==null&&n.length>f&&l.scrollToIndex(f))}},d.map(h=>{var x;return st.createElement(g.Fragment,{key:h.key},st.cloneElement((x=e.children)==null?void 0:x.call(e,{...e.slot,option:n[h.index]}),{key:`${c}-${h.key}`,"data-index":h.index,"aria-setsize":n.length,"aria-posinset":h.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${h.start}px)`,overflowAnchor:"none"}}))})))}let EK=g.Fragment;function AK(e,t){let r=g.useId(),n=kb(),{value:s,defaultValue:i,onChange:o,form:l,name:c,by:u,invalid:d=!1,disabled:m=n||!1,onClose:f,__demoMode:h=!1,multiple:x=!1,immediate:b=!1,virtual:j=null,nullable:y,..._}=e,w=bW(i),[S=x?[]:void 0,E]=yW(s,o,w),$=qE({id:r,virtual:j,__demoMode:h}),U=g.useRef({static:!1,hold:!1}),I=sH(u),T=mt(le=>j?u===null?j.options.indexOf(le):j.options.findIndex(de=>I(de,le)):$.state.options.findIndex(de=>I(de.dataRef.current.value,le))),D=g.useCallback(le=>Zn(F.mode,{[ti.Multi]:()=>S.some(de=>I(de,le)),[ti.Single]:()=>I(S,le)}),[S]),C=hr($,le=>le.virtual),P=mt(()=>f==null?void 0:f()),F=g.useMemo(()=>({__demoMode:h,immediate:b,optionsPropsRef:U,value:S,defaultValue:w,disabled:m,invalid:d,mode:x?ti.Multi:ti.Single,virtual:j?C:null,onChange:E,isSelected:D,calculateIndex:T,compare:I,onClose:P}),[h,b,U,S,w,m,d,x,j,C,E,D,T,I,P]);ir(()=>{var le;j&&$.send({type:BE.UpdateVirtualConfiguration,options:j.options,disabled:(le=j.disabled)!=null?le:null})},[j,j==null?void 0:j.options,j==null?void 0:j.disabled]),ir(()=>{$.state.dataRef.current=F},[F]);let[A,R,H,W]=hr($,le=>[le.comboboxState,le.buttonElement,le.inputElement,le.optionsElement]),M=_d.get(null),G=hr(M,g.useCallback(le=>M.selectors.isTop(le,r),[M,r]));Rb(G,[R,H,W],()=>$.actions.closeCombobox());let ce=hr($,$.selectors.activeOptionIndex),ue=hr($,$.selectors.activeOption),O=Es({open:A===Jt.Open,disabled:m,invalid:d,activeIndex:ce,activeOption:ue,value:S}),[Z,B]=Eb(),ee=t===null?{}:{ref:t},X=g.useCallback(()=>{if(w!==void 0)return E==null?void 0:E(w)},[E,w]),ne=Rr();return st.createElement(B,{value:Z,props:{htmlFor:H==null?void 0:H.id},slot:{open:A===Jt.Open,disabled:m}},st.createElement(IE,null,st.createElement(Cf.Provider,{value:F},st.createElement(zE.Provider,{value:$},st.createElement(Wb,{value:Zn(A,{[Jt.Open]:Pn.Open,[Jt.Closed]:Pn.Closed})},c!=null&&st.createElement(SW,{disabled:m,data:S!=null?{[c]:S}:{},form:l,onReset:X}),ne({ourProps:ee,theirProps:_,slot:O,defaultTag:EK,name:"Combobox"}))))))}let LK="input";function PK(e,t){var r,n;let s=Xf("Combobox.Input"),i=Cd("Combobox.Input"),o=g.useId(),l=W8(),{id:c=l||`headlessui-combobox-input-${o}`,onChange:u,displayValue:d,disabled:m=i.disabled||!1,autoFocus:f=!1,type:h="text",...x}=e,[b]=hr(s,B=>[B.inputElement]),j=g.useRef(null),y=Tn(j,t,LE(),s.actions.setInputElement),_=yo(b),[w,S]=hr(s,B=>[B.comboboxState,B.isTyping]),E=wo(),$=mt(()=>{s.actions.onChange(null),s.state.optionsElement&&(s.state.optionsElement.scrollTop=0),s.actions.goToOption({focus:Gt.Nothing})}),U=g.useMemo(()=>{var B;return typeof d=="function"&&i.value!==void 0?(B=d(i.value))!=null?B:"":typeof i.value=="string"?i.value:""},[i.value,d]);Nf(([B,ee],[X,ne])=>{if(s.state.isTyping)return;let le=j.current;le&&((ne===Jt.Open&&ee===Jt.Closed||B!==X)&&(le.value=B),requestAnimationFrame(()=>{if(s.state.isTyping||!le||(_==null?void 0:_.activeElement)!==le)return;let{selectionStart:de,selectionEnd:je}=le;Math.abs((je??0)-(de??0))===0&&de===0&&le.setSelectionRange(le.value.length,le.value.length)}))},[U,w,_,S]),Nf(([B],[ee])=>{if(B===Jt.Open&&ee===Jt.Closed){if(s.state.isTyping)return;let X=j.current;if(!X)return;let ne=X.value,{selectionStart:le,selectionEnd:de,selectionDirection:je}=X;X.value="",X.value=ne,je!==null?X.setSelectionRange(le,de,je):X.setSelectionRange(le,de)}},[w]);let I=g.useRef(!1),T=mt(()=>{I.current=!0}),D=mt(()=>{E.nextFrame(()=>{I.current=!1})}),C=mt(B=>{switch(s.actions.setIsTyping(!0),B.key){case sr.Enter:if(s.state.comboboxState!==Jt.Open||I.current)return;if(B.preventDefault(),B.stopPropagation(),s.selectors.activeOptionIndex(s.state)===null){s.actions.closeCombobox();return}s.actions.selectActiveOption(),i.mode===ti.Single&&s.actions.closeCombobox();break;case sr.ArrowDown:return B.preventDefault(),B.stopPropagation(),Zn(s.state.comboboxState,{[Jt.Open]:()=>s.actions.goToOption({focus:Gt.Next}),[Jt.Closed]:()=>s.actions.openCombobox()});case sr.ArrowUp:return B.preventDefault(),B.stopPropagation(),Zn(s.state.comboboxState,{[Jt.Open]:()=>s.actions.goToOption({focus:Gt.Previous}),[Jt.Closed]:()=>{Fn.flushSync(()=>s.actions.openCombobox()),i.value||s.actions.goToOption({focus:Gt.Last})}});case sr.Home:if(B.shiftKey)break;return B.preventDefault(),B.stopPropagation(),s.actions.goToOption({focus:Gt.First});case sr.PageUp:return B.preventDefault(),B.stopPropagation(),s.actions.goToOption({focus:Gt.First});case sr.End:if(B.shiftKey)break;return B.preventDefault(),B.stopPropagation(),s.actions.goToOption({focus:Gt.Last});case sr.PageDown:return B.preventDefault(),B.stopPropagation(),s.actions.goToOption({focus:Gt.Last});case sr.Escape:return s.state.comboboxState!==Jt.Open?void 0:(B.preventDefault(),s.state.optionsElement&&!i.optionsPropsRef.current.static&&B.stopPropagation(),i.mode===ti.Single&&i.value===null&&$(),s.actions.closeCombobox());case sr.Tab:if(s.actions.setIsTyping(!1),s.state.comboboxState!==Jt.Open)return;i.mode===ti.Single&&s.state.activationTrigger!==Pa.Focus&&s.actions.selectActiveOption(),s.actions.closeCombobox();break}}),P=mt(B=>{u==null||u(B),i.mode===ti.Single&&B.target.value===""&&$(),s.actions.openCombobox()}),F=mt(B=>{var ee,X,ne;let le=(ee=B.relatedTarget)!=null?ee:wa.find(de=>de!==B.currentTarget);if(!((X=s.state.optionsElement)!=null&&X.contains(le))&&!((ne=s.state.buttonElement)!=null&&ne.contains(le))&&s.state.comboboxState===Jt.Open)return B.preventDefault(),i.mode===ti.Single&&i.value===null&&$(),s.actions.closeCombobox()}),A=mt(B=>{var ee,X,ne;let le=(ee=B.relatedTarget)!=null?ee:wa.find(de=>de!==B.currentTarget);(X=s.state.buttonElement)!=null&&X.contains(le)||(ne=s.state.optionsElement)!=null&&ne.contains(le)||i.disabled||i.immediate&&s.state.comboboxState!==Jt.Open&&E.microTask(()=>{Fn.flushSync(()=>s.actions.openCombobox()),s.actions.setActivationTrigger(Pa.Focus)})}),R=gg(),H=MW(),{isFocused:W,focusProps:M}=Sb({autoFocus:f}),{isHovered:G,hoverProps:ce}=Nb({isDisabled:m}),ue=hr(s,B=>B.optionsElement),O=Es({open:w===Jt.Open,disabled:m,invalid:i.invalid,hover:G,focus:W,autofocus:f}),Z=Gf({ref:y,id:c,role:"combobox",type:h,"aria-controls":ue==null?void 0:ue.id,"aria-expanded":w===Jt.Open,"aria-activedescendant":hr(s,s.selectors.activeDescendantId),"aria-labelledby":R,"aria-describedby":H,"aria-autocomplete":"list",defaultValue:(n=(r=e.defaultValue)!=null?r:i.defaultValue!==void 0?d==null?void 0:d(i.defaultValue):null)!=null?n:i.defaultValue,disabled:m||void 0,autoFocus:f,onCompositionStart:T,onCompositionEnd:D,onKeyDown:C,onChange:P,onFocus:A,onBlur:F},M,ce);return Rr()({ourProps:Z,theirProps:x,slot:O,defaultTag:LK,name:"Combobox.Input"})}let TK="button";function IK(e,t){let r=Xf("Combobox.Button"),n=Cd("Combobox.Button"),[s,i]=g.useState(null),o=Tn(t,i,r.actions.setButtonElement),l=g.useId(),{id:c=`headlessui-combobox-button-${l}`,disabled:u=n.disabled||!1,autoFocus:d=!1,...m}=e,[f,h,x]=hr(r,P=>[P.comboboxState,P.inputElement,P.optionsElement]),b=uE(h),j=f===Jt.Open;cE(j,{trigger:s,action:g.useCallback(P=>{if(s!=null&&s.contains(P.target)||h!=null&&h.contains(P.target))return Qa.Ignore;let F=P.target.closest('[role="option"]:not([data-disabled])');return Us(F)?Qa.Select(F):x!=null&&x.contains(P.target)?Qa.Ignore:Qa.Close},[s,h,x]),close:r.actions.closeCombobox,select:r.actions.selectActiveOption});let y=mt(P=>{switch(P.key){case sr.Space:case sr.Enter:P.preventDefault(),P.stopPropagation(),r.state.comboboxState===Jt.Closed&&Fn.flushSync(()=>r.actions.openCombobox()),b();return;case sr.ArrowDown:P.preventDefault(),P.stopPropagation(),r.state.comboboxState===Jt.Closed&&(Fn.flushSync(()=>r.actions.openCombobox()),r.state.dataRef.current.value||r.actions.goToOption({focus:Gt.First})),b();return;case sr.ArrowUp:P.preventDefault(),P.stopPropagation(),r.state.comboboxState===Jt.Closed&&(Fn.flushSync(()=>r.actions.openCombobox()),r.state.dataRef.current.value||r.actions.goToOption({focus:Gt.Last})),b();return;case sr.Escape:if(r.state.comboboxState!==Jt.Open)return;P.preventDefault(),r.state.optionsElement&&!n.optionsPropsRef.current.static&&P.stopPropagation(),Fn.flushSync(()=>r.actions.closeCombobox()),b();return;default:return}}),_=mt(P=>{P.preventDefault(),!K8(P.currentTarget)&&(P.button===jg.Left&&(r.state.comboboxState===Jt.Open?r.actions.closeCombobox():r.actions.openCombobox()),b())}),w=gg([c]),{isFocusVisible:S,focusProps:E}=Sb({autoFocus:d}),{isHovered:$,hoverProps:U}=Nb({isDisabled:u}),{pressed:I,pressProps:T}=B8({disabled:u}),D=Es({open:f===Jt.Open,active:I||f===Jt.Open,disabled:u,invalid:n.invalid,value:n.value,hover:$,focus:S}),C=Gf({ref:o,id:c,type:dE(e,s),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":x==null?void 0:x.id,"aria-expanded":f===Jt.Open,"aria-labelledby":w,disabled:u||void 0,autoFocus:d,onPointerDown:_,onKeyDown:y},E,U,T);return Rr()({ourProps:C,theirProps:m,slot:D,defaultTag:TK,name:"Combobox.Button"})}let MK="div",OK=kl.RenderStrategy|kl.Static;function RK(e,t){var r,n,s;let i=g.useId(),{id:o=`headlessui-combobox-options-${i}`,hold:l=!1,anchor:c,portal:u=!1,modal:d=!0,transition:m=!1,...f}=e,h=Xf("Combobox.Options"),x=Cd("Combobox.Options"),b=AE(c);b&&(u=!0);let[j,y]=TE(b),[_,w]=g.useState(null),S=PE(),E=Tn(t,b?j:null,h.actions.setOptionsElement,w),[$,U,I,T,D]=hr(h,me=>[me.comboboxState,me.inputElement,me.buttonElement,me.optionsElement,me.activationTrigger]),C=yo(U||I),P=yo(T),F=kd(),[A,R]=Bb(m,_,F!==null?(F&Pn.Open)===Pn.Open:$===Jt.Open);Tb(A,U,h.actions.closeCombobox);let H=x.__demoMode?!1:d&&$===Jt.Open;Db(H,P);let W=x.__demoMode?!1:d&&$===Jt.Open;Pb(W,{allowed:g.useCallback(()=>[U,I,T],[U,I,T])});let M=hr(h,h.selectors.didInputMove)?!1:A;ir(()=>{var me;x.optionsPropsRef.current.static=(me=e.static)!=null?me:!1},[x.optionsPropsRef,e.static]),ir(()=>{x.optionsPropsRef.current.hold=l},[x.optionsPropsRef,l]),fE($===Jt.Open,{container:T,accept(me){return me.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:me.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(me){me.setAttribute("role","none")}});let G=gg([I==null?void 0:I.id]),ce=Es({open:$===Jt.Open,option:void 0}),ue=mt(()=>{h.actions.setActivationTrigger(Pa.Pointer)}),O=mt(me=>{me.preventDefault(),h.actions.setActivationTrigger(Pa.Pointer)}),Z=Gf(b?S():{},{"aria-labelledby":G,role:"listbox","aria-multiselectable":x.mode===ti.Multi?!0:void 0,id:o,ref:E,style:{...f.style,...y,"--input-width":Nv(A,U,!0).width,"--button-width":Nv(A,I,!0).width},onWheel:D===Pa.Pointer?void 0:ue,onMouseDown:O,...$b(R)}),B=A&&$===Jt.Closed&&!e.static,ee=Pv(B,(r=x.virtual)==null?void 0:r.options),X=Pv(B,x.value),ne=g.useCallback(me=>x.compare(X,me),[x.compare,X]),le=g.useMemo(()=>{if(!x.virtual)return x;if(ee===void 0)throw new Error("Missing `options` in virtual mode");return ee!==x.virtual.options?{...x,virtual:{...x.virtual,options:ee}}:x},[x,ee,(n=x.virtual)==null?void 0:n.options]);x.virtual&&Object.assign(f,{children:st.createElement(Cf.Provider,{value:le},st.createElement(CK,{slot:ce},f.children))});let de=Rr(),je=g.useMemo(()=>x.mode===ti.Multi?x:{...x,isSelected:ne},[x,ne]);return st.createElement(Hb,{enabled:u?e.static||A:!1,ownerDocument:C},st.createElement(Cf.Provider,{value:je},de({ourProps:Z,theirProps:{...f,children:st.createElement(dK,{freeze:B},typeof f.children=="function"?(s=f.children)==null?void 0:s.call(f,ce):f.children)},slot:ce,defaultTag:MK,features:OK,visible:M,name:"Combobox.Options"})))}let FK="div";function DK(e,t){var r,n,s;let i=Cd("Combobox.Option"),o=Xf("Combobox.Option"),l=g.useId(),{id:c=`headlessui-combobox-option-${l}`,value:u,disabled:d=(s=(n=(r=i.virtual)==null?void 0:r.disabled)==null?void 0:n.call(r,u))!=null?s:!1,order:m=null,...f}=e,[h]=hr(o,R=>[R.inputElement]),x=uE(h),b=hr(o,g.useCallback(R=>o.selectors.isActive(R,u,c),[u,c])),j=i.isSelected(u),y=g.useRef(null),_=Ol({disabled:d,value:u,domRef:y,order:m}),w=g.useContext(VE),S=Tn(t,y,w?w.measureElement:null),E=mt(()=>{o.actions.setIsTyping(!1),o.actions.onChange(u)});ir(()=>o.actions.registerOption(c,_),[_,c]);let $=hr(o,g.useCallback(R=>o.selectors.shouldScrollIntoView(R,u,c),[u,c]));ir(()=>{if($)return Cs().requestAnimationFrame(()=>{var R,H;(H=(R=y.current)==null?void 0:R.scrollIntoView)==null||H.call(R,{block:"nearest"})})},[$,y]);let U=mt(R=>{R.preventDefault(),R.button===jg.Left&&(d||(E(),Cv()||requestAnimationFrame(()=>x()),i.mode===ti.Single&&o.actions.closeCombobox()))}),I=mt(()=>{if(d)return o.actions.goToOption({focus:Gt.Nothing});let R=i.calculateIndex(u);o.actions.goToOption({focus:Gt.Specific,idx:R})}),T=hE(),D=mt(R=>T.update(R)),C=mt(R=>{if(!T.wasMoved(R)||d||b&&o.state.activationTrigger===Pa.Pointer)return;let H=i.calculateIndex(u);o.actions.goToOption({focus:Gt.Specific,idx:H},Pa.Pointer)}),P=mt(R=>{T.wasMoved(R)&&(d||b&&(i.optionsPropsRef.current.hold||o.state.activationTrigger===Pa.Pointer&&o.actions.goToOption({focus:Gt.Nothing})))}),F=Es({active:b,focus:b,selected:j,disabled:d}),A={id:c,ref:S,role:"option",tabIndex:d===!0?void 0:-1,"aria-disabled":d===!0?!0:void 0,"aria-selected":j,disabled:void 0,onMouseDown:U,onFocus:I,onPointerEnter:D,onMouseEnter:D,onPointerMove:C,onMouseMove:C,onPointerLeave:P,onMouseLeave:P};return Rr()({ourProps:A,theirProps:f,slot:F,defaultTag:FK,name:"Combobox.Option"})}let $K=Nr(AK),BK=Nr(IK),UK=Nr(PK),zK=zW,qK=Nr(RK),VK=Nr(DK),Gn=Object.assign($K,{Input:UK,Button:BK,Label:zK,Options:qK,Option:VK});function WK(e,t=typeof document<"u"?document.defaultView:null,r){let n=Yf(e,"escape");Fb(t,"keydown",s=>{n&&(s.defaultPrevented||s.key===sr.Escape&&r(s))})}function HK(){var e;let[t]=g.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[r,n]=g.useState((e=t==null?void 0:t.matches)!=null?e:!1);return ir(()=>{if(!t)return;function s(i){n(i.matches)}return t.addEventListener("change",s),()=>t.removeEventListener("change",s)},[t]),r}function GK({defaultContainers:e=[],portals:t,mainTreeNode:r}={}){let n=yo(r),s=mt(()=>{var i,o;let l=[];for(let c of e)c!==null&&(ho(c)?l.push(c):"current"in c&&ho(c.current)&&l.push(c.current));if(t!=null&&t.current)for(let c of t.current)l.push(c);for(let c of(i=n==null?void 0:n.querySelectorAll("html > *, body > *"))!=null?i:[])c!==document.body&&c!==document.head&&ho(c)&&c.id!=="headlessui-portal-root"&&(r&&(c.contains(r)||c.contains((o=r==null?void 0:r.getRootNode())==null?void 0:o.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:s,contains:mt(i=>s().some(o=>o.contains(i)))}}let WE=g.createContext(null);function L3({children:e,node:t}){let[r,n]=g.useState(null),s=HE(t??r);return st.createElement(WE.Provider,{value:s},e,s===null&&st.createElement(jf,{features:cd.Hidden,ref:i=>{var o,l;if(i){for(let c of(l=(o=Wc(i))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&ho(c)&&c!=null&&c.contains(i)){n(c);break}}}}))}function HE(e=null){var t;return(t=g.useContext(WE))!=null?t:e}function KK(){let e=typeof document>"u";return"useSyncExternalStore"in Ix?(t=>t.useSyncExternalStore)(Ix)(()=>()=>{},()=>!1,()=>!e):!1}function Sg(){let e=KK(),[t,r]=g.useState(uo.isHandoffComplete);return t&&uo.isHandoffComplete===!1&&r(!1),g.useEffect(()=>{t!==!0&&r(!0)},[t]),g.useEffect(()=>uo.handoff(),[]),e?!1:t}function Kb(){let e=g.useRef(!1);return ir(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var _h=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(_h||{});function YK(){let e=g.useRef(0);return lE(!0,"keydown",t=>{t.key==="Tab"&&(e.current=t.shiftKey?1:0)},!0),e}function GE(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let r of e.current)ho(r.current)&&t.add(r.current);return t}let ZK="div";var mc=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(mc||{});function JK(e,t){let r=g.useRef(null),n=Tn(r,t),{initialFocus:s,initialFocusFallback:i,containers:o,features:l=15,...c}=e;Sg()||(l=0);let u=yo(r);tY(l,{ownerDocument:u});let d=rY(l,{ownerDocument:u,container:r,initialFocus:s,initialFocusFallback:i});nY(l,{ownerDocument:u,container:r,containers:o,previousActiveElement:d});let m=YK(),f=mt(_=>{if(!Us(r.current))return;let w=r.current;(S=>S())(()=>{Zn(m.current,{[_h.Forwards]:()=>{Ku(w,Ki.First,{skipElements:[_.relatedTarget,i]})},[_h.Backwards]:()=>{Ku(w,Ki.Last,{skipElements:[_.relatedTarget,i]})}})})}),h=Yf(!!(l&2),"focus-trap#tab-lock"),x=wo(),b=g.useRef(!1),j={ref:n,onKeyDown(_){_.key=="Tab"&&(b.current=!0,x.requestAnimationFrame(()=>{b.current=!1}))},onBlur(_){if(!(l&4))return;let w=GE(o);Us(r.current)&&w.add(r.current);let S=_.relatedTarget;ja(S)&&S.dataset.headlessuiFocusGuard!=="true"&&(KE(w,S)||(b.current?Ku(r.current,Zn(m.current,{[_h.Forwards]:()=>Ki.Next,[_h.Backwards]:()=>Ki.Previous})|Ki.WrapAround,{relativeTo:_.target}):ja(_.target)&&Aa(_.target)))}},y=Rr();return st.createElement(st.Fragment,null,h&&st.createElement(jf,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:f,features:cd.Focusable}),y({ourProps:j,theirProps:c,defaultTag:ZK,name:"FocusTrap"}),h&&st.createElement(jf,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:f,features:cd.Focusable}))}let XK=Nr(JK),QK=Object.assign(XK,{features:mc});function eY(e=!0){let t=g.useRef(wa.slice());return Nf(([r],[n])=>{n===!0&&r===!1&&fg(()=>{t.current.splice(0)}),n===!1&&r===!0&&(t.current=wa.slice())},[e,wa,t]),mt(()=>{var r;return(r=t.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function tY(e,{ownerDocument:t}){let r=!!(e&8),n=eY(r);Nf(()=>{r||(t==null?void 0:t.activeElement)===(t==null?void 0:t.body)&&Aa(n())},[r]),Ng(()=>{r&&Aa(n())})}function rY(e,{ownerDocument:t,container:r,initialFocus:n,initialFocusFallback:s}){let i=g.useRef(null),o=Yf(!!(e&1),"focus-trap#initial-focus"),l=Kb();return Nf(()=>{if(e===0)return;if(!o){s!=null&&s.current&&Aa(s.current);return}let c=r.current;c&&fg(()=>{if(!l.current)return;let u=t==null?void 0:t.activeElement;if(n!=null&&n.current){if((n==null?void 0:n.current)===u){i.current=u;return}}else if(c.contains(u)){i.current=u;return}if(n!=null&&n.current)Aa(n.current);else{if(e&16){if(Ku(c,Ki.First|Ki.AutoFocus)!==kv.Error)return}else if(Ku(c,Ki.First)!==kv.Error)return;if(s!=null&&s.current&&(Aa(s.current),(t==null?void 0:t.activeElement)===s.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}i.current=t==null?void 0:t.activeElement})},[s,o,e]),i}function nY(e,{ownerDocument:t,container:r,containers:n,previousActiveElement:s}){let i=Kb(),o=!!(e&4);Fb(t==null?void 0:t.defaultView,"focus",l=>{if(!o||!i.current)return;let c=GE(n);Us(r.current)&&c.add(r.current);let u=s.current;if(!u)return;let d=l.target;Us(d)?KE(c,d)?(s.current=d,Aa(d)):(l.preventDefault(),l.stopPropagation(),Aa(u)):Aa(s.current)},!0)}function KE(e,t){for(let r of e)if(r.contains(t))return!0;return!1}function YE(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!Vh((t=e.as)!=null?t:JE)||st.Children.count(e.children)===1}let kg=g.createContext(null);kg.displayName="TransitionContext";var sY=(e=>(e.Visible="visible",e.Hidden="hidden",e))(sY||{});function iY(){let e=g.useContext(kg);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function aY(){let e=g.useContext(Cg);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let Cg=g.createContext(null);Cg.displayName="NestingContext";function Eg(e){return"children"in e?Eg(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function ZE(e,t){let r=Ol(e),n=g.useRef([]),s=Kb(),i=wo(),o=mt((h,x=al.Hidden)=>{let b=n.current.findIndex(({el:j})=>j===h);b!==-1&&(Zn(x,{[al.Unmount](){n.current.splice(b,1)},[al.Hidden](){n.current[b].state="hidden"}}),i.microTask(()=>{var j;!Eg(n)&&s.current&&((j=r.current)==null||j.call(r))}))}),l=mt(h=>{let x=n.current.find(({el:b})=>b===h);return x?x.state!=="visible"&&(x.state="visible"):n.current.push({el:h,state:"visible"}),()=>o(h,al.Unmount)}),c=g.useRef([]),u=g.useRef(Promise.resolve()),d=g.useRef({enter:[],leave:[]}),m=mt((h,x,b)=>{c.current.splice(0),t&&(t.chains.current[x]=t.chains.current[x].filter(([j])=>j!==h)),t==null||t.chains.current[x].push([h,new Promise(j=>{c.current.push(j)})]),t==null||t.chains.current[x].push([h,new Promise(j=>{Promise.all(d.current[x].map(([y,_])=>_)).then(()=>j())})]),x==="enter"?u.current=u.current.then(()=>t==null?void 0:t.wait.current).then(()=>b(x)):b(x)}),f=mt((h,x,b)=>{Promise.all(d.current[x].splice(0).map(([j,y])=>y)).then(()=>{var j;(j=c.current.shift())==null||j()}).then(()=>b(x))});return g.useMemo(()=>({children:n,register:l,unregister:o,onStart:m,onStop:f,wait:u,chains:d}),[l,o,n,m,f,d,u])}let JE=g.Fragment,XE=kl.RenderStrategy;function oY(e,t){var r,n;let{transition:s=!0,beforeEnter:i,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:d,enterTo:m,entered:f,leave:h,leaveFrom:x,leaveTo:b,...j}=e,[y,_]=g.useState(null),w=g.useRef(null),S=YE(e),E=Tn(...S?[w,t,_]:t===null?[]:[t]),$=(r=j.unmount)==null||r?al.Unmount:al.Hidden,{show:U,appear:I,initial:T}=iY(),[D,C]=g.useState(U?"visible":"hidden"),P=aY(),{register:F,unregister:A}=P;ir(()=>F(w),[F,w]),ir(()=>{if($===al.Hidden&&w.current){if(U&&D!=="visible"){C("visible");return}return Zn(D,{hidden:()=>A(w),visible:()=>F(w)})}},[D,w,F,A,U,$]);let R=Sg();ir(()=>{if(S&&R&&D==="visible"&&w.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[w,D,R,S]);let H=T&&!I,W=I&&U&&T,M=g.useRef(!1),G=ZE(()=>{M.current||(C("hidden"),A(w))},P),ce=mt(ne=>{M.current=!0;let le=ne?"enter":"leave";G.onStart(w,le,de=>{de==="enter"?i==null||i():de==="leave"&&(l==null||l())})}),ue=mt(ne=>{let le=ne?"enter":"leave";M.current=!1,G.onStop(w,le,de=>{de==="enter"?o==null||o():de==="leave"&&(c==null||c())}),le==="leave"&&!Eg(G)&&(C("hidden"),A(w))});g.useEffect(()=>{S&&s||(ce(U),ue(U))},[U,S,s]);let O=(()=>!(!s||!S||!R||H))(),[,Z]=Bb(O,y,U,{start:ce,end:ue}),B=Jo({ref:E,className:((n=jv(j.className,W&&u,W&&d,Z.enter&&u,Z.enter&&Z.closed&&d,Z.enter&&!Z.closed&&m,Z.leave&&h,Z.leave&&!Z.closed&&x,Z.leave&&Z.closed&&b,!Z.transition&&U&&f))==null?void 0:n.trim())||void 0,...$b(Z)}),ee=0;D==="visible"&&(ee|=Pn.Open),D==="hidden"&&(ee|=Pn.Closed),U&&D==="hidden"&&(ee|=Pn.Opening),!U&&D==="visible"&&(ee|=Pn.Closing);let X=Rr();return st.createElement(Cg.Provider,{value:G},st.createElement(Wb,{value:ee},X({ourProps:B,theirProps:j,defaultTag:JE,features:XE,visible:D==="visible",name:"Transition.Child"})))}function lY(e,t){let{show:r,appear:n=!1,unmount:s=!0,...i}=e,o=g.useRef(null),l=YE(e),c=Tn(...l?[o,t]:t===null?[]:[t]);Sg();let u=kd();if(r===void 0&&u!==null&&(r=(u&Pn.Open)===Pn.Open),r===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,m]=g.useState(r?"visible":"hidden"),f=ZE(()=>{r||m("hidden")}),[h,x]=g.useState(!0),b=g.useRef([r]);ir(()=>{h!==!1&&b.current[b.current.length-1]!==r&&(b.current.push(r),x(!1))},[b,r]);let j=g.useMemo(()=>({show:r,appear:n,initial:h}),[r,n,h]);ir(()=>{r?m("visible"):!Eg(f)&&o.current!==null&&m("hidden")},[r,f]);let y={unmount:s},_=mt(()=>{var E;h&&x(!1),(E=e.beforeEnter)==null||E.call(e)}),w=mt(()=>{var E;h&&x(!1),(E=e.beforeLeave)==null||E.call(e)}),S=Rr();return st.createElement(Cg.Provider,{value:f},st.createElement(kg.Provider,{value:j},S({ourProps:{...y,as:g.Fragment,children:st.createElement(QE,{ref:c,...y,...i,beforeEnter:_,beforeLeave:w})},theirProps:{},defaultTag:g.Fragment,features:XE,visible:d==="visible",name:"Transition"})))}function cY(e,t){let r=g.useContext(kg)!==null,n=kd()!==null;return st.createElement(st.Fragment,null,!r&&n?st.createElement(Iv,{ref:t,...e}):st.createElement(QE,{ref:t,...e}))}let Iv=Nr(lY),QE=Nr(oY),Yb=Nr(cY),bl=Object.assign(Iv,{Child:Yb,Root:Iv});var uY=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(uY||{}),dY=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(dY||{});let hY={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},Zb=g.createContext(null);Zb.displayName="DialogContext";function Ag(e){let t=g.useContext(Zb);if(t===null){let r=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Ag),r}return t}function fY(e,t){return Zn(t.type,hY,e,t)}let P3=Nr(function(e,t){let r=g.useId(),{id:n=`headlessui-dialog-${r}`,open:s,onClose:i,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:d=!1,...m}=e,f=g.useRef(!1);l=function(){return l==="dialog"||l==="alertdialog"?l:(f.current||(f.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let h=kd();s===void 0&&h!==null&&(s=(h&Pn.Open)===Pn.Open);let x=g.useRef(null),b=Tn(x,t),j=yo(x),y=s?0:1,[_,w]=g.useReducer(fY,{titleId:null,descriptionId:null,panelRef:g.createRef()}),S=mt(()=>i(!1)),E=mt(Z=>w({type:0,id:Z})),$=Sg()?y===0:!1,[U,I]=wK(),T={get current(){var Z;return(Z=_.panelRef.current)!=null?Z:x.current}},D=HE(),{resolveContainers:C}=GK({mainTreeNode:D,portals:U,defaultContainers:[T]}),P=h!==null?(h&Pn.Closing)===Pn.Closing:!1;Pb(u||P?!1:$,{allowed:mt(()=>{var Z,B;return[(B=(Z=x.current)==null?void 0:Z.closest("[data-headlessui-portal]"))!=null?B:null]}),disallowed:mt(()=>{var Z;return[(Z=D==null?void 0:D.closest("body > *:not(#headlessui-portal-root)"))!=null?Z:null]})});let F=_d.get(null);ir(()=>{if($)return F.actions.push(n),()=>F.actions.pop(n)},[F,n,$]);let A=hr(F,g.useCallback(Z=>F.selectors.isTop(Z,n),[F,n]));Rb(A,C,Z=>{Z.preventDefault(),S()}),WK(A,j==null?void 0:j.defaultView,Z=>{Z.preventDefault(),Z.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),S()}),Db(u||P?!1:$,j,C),Tb($,x,S);let[R,H]=J8(),W=g.useMemo(()=>[{dialogState:y,close:S,setTitleId:E,unmount:d},_],[y,S,E,d,_]),M=Es({open:y===0}),G={ref:b,id:n,role:l,tabIndex:-1,"aria-modal":u?void 0:y===0?!0:void 0,"aria-labelledby":_.titleId,"aria-describedby":R,unmount:d},ce=!HK(),ue=mc.None;$&&!u&&(ue|=mc.RestoreFocus,ue|=mc.TabLock,c&&(ue|=mc.AutoFocus),ce&&(ue|=mc.InitialFocus));let O=Rr();return st.createElement(hK,null,st.createElement(E3,{force:!0},st.createElement(Hb,null,st.createElement(Zb.Provider,{value:W},st.createElement(DE,{target:x},st.createElement(E3,{force:!1},st.createElement(H,{slot:M},st.createElement(I,null,st.createElement(QK,{initialFocus:o,initialFocusFallback:x,containers:C,features:ue},st.createElement(VW,{value:S},O({ourProps:G,theirProps:m,slot:M,defaultTag:mY,features:pY,visible:y===0,name:"Dialog"})))))))))))}),mY="div",pY=kl.RenderStrategy|kl.Static;function gY(e,t){let{transition:r=!1,open:n,...s}=e,i=kd(),o=e.hasOwnProperty("open")||i!==null,l=e.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!i&&typeof e.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if(typeof e.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return(n!==void 0||r)&&!s.static?st.createElement(L3,null,st.createElement(bl,{show:n,transition:r,unmount:s.unmount},st.createElement(P3,{ref:t,...s}))):st.createElement(L3,null,st.createElement(P3,{ref:t,open:n,...s}))}let xY="div";function vY(e,t){let r=g.useId(),{id:n=`headlessui-dialog-panel-${r}`,transition:s=!1,...i}=e,[{dialogState:o,unmount:l},c]=Ag("Dialog.Panel"),u=Tn(t,c.panelRef),d=Es({open:o===0}),m=mt(j=>{j.stopPropagation()}),f={ref:u,id:n,onClick:m},h=s?Yb:g.Fragment,x=s?{unmount:l}:{},b=Rr();return st.createElement(h,{...x},b({ourProps:f,theirProps:i,slot:d,defaultTag:xY,name:"Dialog.Panel"}))}let yY="div";function bY(e,t){let{transition:r=!1,...n}=e,[{dialogState:s,unmount:i}]=Ag("Dialog.Backdrop"),o=Es({open:s===0}),l={ref:t,"aria-hidden":!0},c=r?Yb:g.Fragment,u=r?{unmount:i}:{},d=Rr();return st.createElement(c,{...u},d({ourProps:l,theirProps:n,slot:o,defaultTag:yY,name:"Dialog.Backdrop"}))}let wY="h2";function _Y(e,t){let r=g.useId(),{id:n=`headlessui-dialog-title-${r}`,...s}=e,[{dialogState:i,setTitleId:o}]=Ag("Dialog.Title"),l=Tn(t);g.useEffect(()=>(o(n),()=>o(null)),[n,o]);let c=Es({open:i===0}),u={ref:l,id:n};return Rr()({ourProps:u,theirProps:s,slot:c,defaultTag:wY,name:"Dialog.Title"})}let jY=Nr(gY),NY=Nr(vY);Nr(bY);let SY=Nr(_Y),Lx=Object.assign(jY,{Panel:NY,Title:SY,Description:DW}),T3=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function I3(e){var t,r;let n=(t=e.innerText)!=null?t:"",s=e.cloneNode(!0);if(!Us(s))return n;let i=!1;for(let l of s.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))l.remove(),i=!0;let o=i?(r=s.innerText)!=null?r:"":n;return T3.test(o)&&(o=o.replace(T3,"")),o}function kY(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(s=>{let i=document.getElementById(s);if(i){let o=i.getAttribute("aria-label");return typeof o=="string"?o.trim():I3(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return I3(e).trim()}function CY(e){let t=g.useRef(""),r=g.useRef("");return mt(()=>{let n=e.current;if(!n)return"";let s=n.innerText;if(t.current===s)return r.current;let i=kY(n).trim().toLowerCase();return t.current=s,r.current=i,i})}var EY=Object.defineProperty,AY=(e,t,r)=>t in e?EY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M3=(e,t,r)=>(AY(e,typeof t!="symbol"?t+"":t,r),r),ls=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ls||{}),Lp=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Lp||{}),jr=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItems=5]="RegisterItems",e[e.UnregisterItems=6]="UnregisterItems",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e[e.SortItems=9]="SortItems",e[e.MarkButtonAsMoved=10]="MarkButtonAsMoved",e))(jr||{});function O3(e,t=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=Ob(t(e.items.slice()),i=>i.dataRef.current.domRef.current),s=r?n.indexOf(r):null;return s===-1&&(s=null),{items:n,activeItemIndex:s}}let LY={1(e){if(e.menuState===1)return e;let t=e.buttonElement?so.Tracked(Gb(e.buttonElement)):e.buttonPositionState;return{...e,activeItemIndex:null,pendingFocus:{focus:Gt.Nothing},menuState:1,buttonPositionState:t}},0(e,t){return e.menuState===0?e:{...e,__demoMode:!1,pendingFocus:t.focus,menuState:0,buttonPositionState:so.Idle}},2:(e,t)=>{var r,n,s,i,o;if(e.menuState===1)return e;let l={...e,searchQuery:"",activationTrigger:(r=t.trigger)!=null?r:1,__demoMode:!1};if(t.focus===Gt.Nothing)return{...l,activeItemIndex:null};if(t.focus===Gt.Specific)return{...l,activeItemIndex:e.items.findIndex(d=>d.id===t.id)};if(t.focus===Gt.Previous){let d=e.activeItemIndex;if(d!==null){let m=e.items[d].dataRef.current.domRef,f=Ou(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(f!==null){let h=e.items[f].dataRef.current.domRef;if(((n=m.current)==null?void 0:n.previousElementSibling)===h.current||((s=h.current)==null?void 0:s.previousElementSibling)===null)return{...l,activeItemIndex:f}}}}else if(t.focus===Gt.Next){let d=e.activeItemIndex;if(d!==null){let m=e.items[d].dataRef.current.domRef,f=Ou(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(f!==null){let h=e.items[f].dataRef.current.domRef;if(((i=m.current)==null?void 0:i.nextElementSibling)===h.current||((o=h.current)==null?void 0:o.nextElementSibling)===null)return{...l,activeItemIndex:f}}}}let c=O3(e),u=Ou(t,{resolveItems:()=>c.items,resolveActiveIndex:()=>c.activeItemIndex,resolveId:d=>d.id,resolveDisabled:d=>d.dataRef.current.disabled});return{...l,...c,activeItemIndex:u}},3:(e,t)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+t.value.toLowerCase(),s=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(o=>{var l;return((l=o.dataRef.current.textValue)==null?void 0:l.startsWith(n))&&!o.dataRef.current.disabled}),i=s?e.items.indexOf(s):-1;return i===-1||i===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:i,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let r=e.items.concat(t.items.map(s=>s)),n=e.activeItemIndex;return e.pendingFocus.focus!==Gt.Nothing&&(n=Ou(e.pendingFocus,{resolveItems:()=>r,resolveActiveIndex:()=>e.activeItemIndex,resolveId:s=>s.id,resolveDisabled:s=>s.dataRef.current.disabled})),{...e,items:r,activeItemIndex:n,pendingFocus:{focus:Gt.Nothing},pendingShouldSort:!0}},6:(e,t)=>{let r=e.items,n=[],s=new Set(t.items);for(let[i,o]of r.entries())if(s.has(o.id)&&(n.push(i),s.delete(o.id),s.size===0))break;if(n.length>0){r=r.slice();for(let i of n.reverse())r.splice(i,1)}return{...e,items:r,activationTrigger:1}},7:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},8:(e,t)=>e.itemsElement===t.element?e:{...e,itemsElement:t.element},9:e=>e.pendingShouldSort?{...e,...O3(e),pendingShouldSort:!1}:e,10(e){return e.buttonPositionState.kind!=="Tracked"?e:{...e,buttonPositionState:so.Moved}}};class Jb extends Ab{constructor(t){super(t),M3(this,"actions",{registerItem:n3(()=>{let r=[],n=new Set;return[(s,i)=>{n.has(i)||(n.add(i),r.push({id:s,dataRef:i}))},()=>(n.clear(),this.send({type:5,items:r.splice(0)}))]}),unregisterItem:n3(()=>{let r=[];return[n=>r.push(n),()=>this.send({type:6,items:r.splice(0)})]})}),M3(this,"selectors",{activeDescendantId(r){var n;let s=r.activeItemIndex,i=r.items;return s===null||(n=i[s])==null?void 0:n.id},isActive(r,n){var s;let i=r.activeItemIndex,o=r.items;return i!==null?((s=o[i])==null?void 0:s.id)===n:!1},shouldScrollIntoView(r,n){return r.__demoMode||r.menuState!==0||r.activationTrigger===0?!1:this.isActive(r,n)},didButtonMove(r){return r.buttonPositionState.kind==="Moved"}}),this.on(5,()=>{this.disposables.requestAnimationFrame(()=>{this.send({type:9})})});{let r=this.state.id,n=_d.get(null);this.disposables.add(n.on(Lb.Push,s=>{!n.selectors.isTop(s,r)&&this.state.menuState===0&&this.send({type:1})})),this.on(0,()=>n.actions.push(r)),this.on(1,()=>n.actions.pop(r))}this.disposables.group(r=>{this.on(1,n=>{n.buttonElement&&(r.dispose(),r.add($E(n.buttonElement,n.buttonPositionState,()=>{this.send({type:10})})))})})}static new({id:t,__demoMode:r=!1}){return new Jb({id:t,__demoMode:r,menuState:r?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1,pendingShouldSort:!1,pendingFocus:{focus:Gt.Nothing},buttonPositionState:so.Idle})}reduce(t,r){return Zn(r.type,LY,t,r)}}const eA=g.createContext(null);function Xb(e){let t=g.useContext(eA);if(t===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,tA),r}return t}function tA({id:e,__demoMode:t=!1}){let r=g.useMemo(()=>Jb.new({id:e,__demoMode:t}),[]);return Ng(()=>r.dispose()),r}let PY=g.Fragment;function TY(e,t){let r=g.useId(),{__demoMode:n=!1,...s}=e,i=tA({id:r,__demoMode:n}),[o,l,c]=hr(i,j=>[j.menuState,j.itemsElement,j.buttonElement]),u=Tn(t),d=_d.get(null),m=hr(d,g.useCallback(j=>d.selectors.isTop(j,r),[d,r]));Rb(m,[c,l],(j,y)=>{var _;i.send({type:jr.CloseMenu}),Mb(y,Ib.Loose)||(j.preventDefault(),(_=i.state.buttonElement)==null||_.focus())});let f=mt(()=>{i.send({type:jr.CloseMenu})}),h=Es({open:o===ls.Open,close:f}),x={ref:u},b=Rr();return st.createElement(IE,null,st.createElement(eA.Provider,{value:i},st.createElement(Wb,{value:Zn(o,{[ls.Open]:Pn.Open,[ls.Closed]:Pn.Closed})},b({ourProps:x,theirProps:s,slot:h,defaultTag:PY,name:"Menu"}))))}let IY="button";function MY(e,t){let r=Xb("Menu.Button"),n=g.useId(),{id:s=`headlessui-menu-button-${n}`,disabled:i=!1,autoFocus:o=!1,...l}=e,c=g.useRef(null),u=lK(),d=Tn(t,c,LE(),mt(F=>r.send({type:jr.SetButtonElement,element:F}))),m=mt(F=>{switch(F.key){case sr.Space:case sr.Enter:case sr.ArrowDown:F.preventDefault(),F.stopPropagation(),r.send({type:jr.OpenMenu,focus:{focus:Gt.First}});break;case sr.ArrowUp:F.preventDefault(),F.stopPropagation(),r.send({type:jr.OpenMenu,focus:{focus:Gt.Last}});break}}),f=mt(F=>{switch(F.key){case sr.Space:F.preventDefault();break}}),[h,x,b]=hr(r,F=>[F.menuState,F.buttonElement,F.itemsElement]),j=h===ls.Open;cE(j,{trigger:x,action:g.useCallback(F=>{if(x!=null&&x.contains(F.target))return Qa.Ignore;let A=F.target.closest('[role="menuitem"]:not([data-disabled])');return Us(A)?Qa.Select(A):b!=null&&b.contains(F.target)?Qa.Ignore:Qa.Close},[x,b]),close:g.useCallback(()=>r.send({type:jr.CloseMenu}),[]),select:g.useCallback(F=>F.click(),[])});let y=mt(F=>{var A;if(F.button===jg.Left){if(K8(F.currentTarget))return F.preventDefault();i||(h===ls.Open?(Fn.flushSync(()=>r.send({type:jr.CloseMenu})),(A=c.current)==null||A.focus({preventScroll:!0})):(F.preventDefault(),r.send({type:jr.OpenMenu,focus:{focus:Gt.Nothing},trigger:Lp.Pointer})))}}),_=g.useRef(null),w=mt(F=>{_.current=F.pointerType,F.pointerType==="mouse"&&y(F)}),S=mt(F=>{_.current!=="mouse"&&y(F)}),{isFocusVisible:E,focusProps:$}=Sb({autoFocus:o}),{isHovered:U,hoverProps:I}=Nb({isDisabled:i}),{pressed:T,pressProps:D}=B8({disabled:i}),C=Es({open:h===ls.Open,active:T||h===ls.Open,disabled:i,hover:U,focus:E,autofocus:o}),P=Gf(u(),{ref:d,id:s,type:dE(e,c.current),"aria-haspopup":"menu","aria-controls":b==null?void 0:b.id,"aria-expanded":h===ls.Open,disabled:i||void 0,autoFocus:o,onKeyDown:m,onKeyUp:f,onPointerDown:w,onClick:S},$,I,D);return Rr()({ourProps:P,theirProps:l,slot:C,defaultTag:IY,name:"Menu.Button"})}let OY="div",RY=kl.RenderStrategy|kl.Static;function FY(e,t){let r=g.useId(),{id:n=`headlessui-menu-items-${r}`,anchor:s,portal:i=!1,modal:o=!0,transition:l=!1,...c}=e,u=AE(s),d=Xb("Menu.Items"),[m,f]=TE(u),h=PE(),[x,b]=g.useState(null),j=Tn(t,u?m:null,mt(M=>d.send({type:jr.SetItemsElement,element:M})),b),[y,_]=hr(d,M=>[M.menuState,M.buttonElement]),w=yo(_),S=yo(x);u&&(i=!0);let E=kd(),[$,U]=Bb(l,x,E!==null?(E&Pn.Open)===Pn.Open:y===ls.Open);Tb($,_,()=>{d.send({type:jr.CloseMenu})});let I=hr(d,M=>M.__demoMode),T=I?!1:o&&y===ls.Open;Db(T,S);let D=I?!1:o&&y===ls.Open;Pb(D,{allowed:g.useCallback(()=>[_,x],[_,x])});let C=hr(d,d.selectors.didButtonMove)?!1:$;g.useEffect(()=>{let M=x;M&&y===ls.Open&&M!==(S==null?void 0:S.activeElement)&&M.focus({preventScroll:!0})},[y,x,S]),fE(y===ls.Open,{container:x,accept(M){return M.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:M.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(M){M.setAttribute("role","none")}});let P=wo(),F=mt(M=>{var G,ce,ue;switch(P.dispose(),M.key){case sr.Space:if(d.state.searchQuery!=="")return M.preventDefault(),M.stopPropagation(),d.send({type:jr.Search,value:M.key});case sr.Enter:if(M.preventDefault(),M.stopPropagation(),d.state.activeItemIndex!==null){let{dataRef:O}=d.state.items[d.state.activeItemIndex];(ce=(G=O.current)==null?void 0:G.domRef.current)==null||ce.click()}d.send({type:jr.CloseMenu}),aE(d.state.buttonElement);break;case sr.ArrowDown:return M.preventDefault(),M.stopPropagation(),d.send({type:jr.GoToItem,focus:Gt.Next});case sr.ArrowUp:return M.preventDefault(),M.stopPropagation(),d.send({type:jr.GoToItem,focus:Gt.Previous});case sr.Home:case sr.PageUp:return M.preventDefault(),M.stopPropagation(),d.send({type:jr.GoToItem,focus:Gt.First});case sr.End:case sr.PageDown:return M.preventDefault(),M.stopPropagation(),d.send({type:jr.GoToItem,focus:Gt.Last});case sr.Escape:M.preventDefault(),M.stopPropagation(),Fn.flushSync(()=>d.send({type:jr.CloseMenu})),(ue=d.state.buttonElement)==null||ue.focus({preventScroll:!0});break;case sr.Tab:M.preventDefault(),M.stopPropagation(),Fn.flushSync(()=>d.send({type:jr.CloseMenu})),CH(d.state.buttonElement,M.shiftKey?Ki.Previous:Ki.Next);break;default:M.key.length===1&&(d.send({type:jr.Search,value:M.key}),P.setTimeout(()=>d.send({type:jr.ClearSearch}),350));break}}),A=mt(M=>{switch(M.key){case sr.Space:M.preventDefault();break}}),R=Es({open:y===ls.Open}),H=Gf(u?h():{},{"aria-activedescendant":hr(d,d.selectors.activeDescendantId),"aria-labelledby":hr(d,M=>{var G;return(G=M.buttonElement)==null?void 0:G.id}),id:n,onKeyDown:F,onKeyUp:A,role:"menu",tabIndex:y===ls.Open?0:void 0,ref:j,style:{...c.style,...f,"--button-width":Nv($,_,!0).width},...$b(U)}),W=Rr();return st.createElement(Hb,{enabled:i?e.static||$:!1,ownerDocument:w},W({ourProps:H,theirProps:c,slot:R,defaultTag:OY,features:RY,visible:C,name:"Menu.Items"}))}let DY=g.Fragment;function $Y(e,t){let r=g.useId(),{id:n=`headlessui-menu-item-${r}`,disabled:s=!1,...i}=e,o=Xb("Menu.Item"),l=hr(o,C=>o.selectors.isActive(C,n)),c=g.useRef(null),u=Tn(t,c),d=hr(o,C=>o.selectors.shouldScrollIntoView(C,n));ir(()=>{if(d)return Cs().requestAnimationFrame(()=>{var C,P;(P=(C=c.current)==null?void 0:C.scrollIntoView)==null||P.call(C,{block:"nearest"})})},[d,c]);let m=CY(c),f=g.useRef({disabled:s,domRef:c,get textValue(){return m()}});ir(()=>{f.current.disabled=s},[f,s]),ir(()=>(o.actions.registerItem(n,f),()=>o.actions.unregisterItem(n)),[f,n]);let h=mt(()=>{o.send({type:jr.CloseMenu})}),x=mt(C=>{if(s)return C.preventDefault();o.send({type:jr.CloseMenu}),aE(o.state.buttonElement)}),b=mt(()=>{if(s)return o.send({type:jr.GoToItem,focus:Gt.Nothing});o.send({type:jr.GoToItem,focus:Gt.Specific,id:n})}),j=hE(),y=mt(C=>j.update(C)),_=mt(C=>{j.wasMoved(C)&&(s||l||o.send({type:jr.GoToItem,focus:Gt.Specific,id:n,trigger:Lp.Pointer}))}),w=mt(C=>{j.wasMoved(C)&&(s||l&&o.state.activationTrigger===Lp.Pointer&&o.send({type:jr.GoToItem,focus:Gt.Nothing}))}),[S,E]=Eb(),[$,U]=J8(),I=Es({active:l,focus:l,disabled:s,close:h}),T={id:n,ref:u,role:"menuitem",tabIndex:s===!0?void 0:-1,"aria-disabled":s===!0?!0:void 0,"aria-labelledby":S,"aria-describedby":$,disabled:void 0,onClick:x,onFocus:b,onPointerEnter:y,onMouseEnter:y,onPointerMove:_,onMouseMove:_,onPointerLeave:w,onMouseLeave:w},D=Rr();return st.createElement(E,null,st.createElement(U,null,D({ourProps:T,theirProps:i,slot:I,defaultTag:DY,name:"Menu.Item"})))}let BY="div";function UY(e,t){let[r,n]=Eb(),s=e,i={ref:t,"aria-labelledby":r,role:"group"},o=Rr();return st.createElement(n,null,o({ourProps:i,theirProps:s,slot:{},defaultTag:BY,name:"Menu.Section"}))}let zY="header";function qY(e,t){let r=g.useId(),{id:n=`headlessui-menu-heading-${r}`,...s}=e,i=Cb();ir(()=>i.register(n),[n,i.register]);let o={id:n,ref:t,role:"presentation",...i.props};return Rr()({ourProps:o,theirProps:s,slot:{},defaultTag:zY,name:"Menu.Heading"})}let VY="div";function WY(e,t){let r=e,n={ref:t,role:"separator"};return Rr()({ourProps:n,theirProps:r,slot:{},defaultTag:VY,name:"Menu.Separator"})}let HY=Nr(TY),GY=Nr(MY),KY=Nr(FY),YY=Nr($Y),ZY=Nr(UY),JY=Nr(qY),XY=Nr(WY),yr=Object.assign(HY,{Button:GY,Items:KY,Item:YY,Section:ZY,Heading:JY,Separator:XY});const QY=()=>{var Oe,nt;const e=ra(),t={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1,delayChildren:.2}}},r={hidden:{opacity:0,y:20},visible:K=>({opacity:1,y:0,transition:{duration:.6,delay:K*.15,ease:[.25,.46,.45,.94]}})},n={hidden:{opacity:0,y:10},visible:K=>({opacity:1,y:0,transition:{duration:.4,delay:K*.05,ease:"easeOut"}})},[s,i]=g.useState([]),[o,l]=g.useState(!0),[c,u]=g.useState(null),[d,m]=g.useState(null),[f,h]=g.useState(null),[x,b]=g.useState(""),[j,y]=g.useState(""),[_,w]=g.useState("newest"),[S,E]=g.useState(!1),[$,U]=g.useState(null),[I,T]=g.useState(!1),[D,C]=g.useState(null),[P,F]=g.useState(!1),[A,R]=g.useState(null),[H,W]=g.useState(!1),[M,G]=g.useState({}),[ce,ue]=g.useState(""),[O,Z]=g.useState(null),B=async()=>{try{l(!0),u(null);const{data:{user:K},error:be}=await ge.auth.getUser();if(be||!K){u("User not authenticated"),l(!1);return}const{data:_e,error:re}=await ge.from("agents").select("id, agent_prefix").eq("user_id",K.id).single();if(re||!_e){u("Agent not found"),console.error("Agent fetch error:",re),l(!1);return}const De=_e.id,se=_e.agent_prefix;if(m(De),h(se),!se){u("Agent prefix not found"),l(!1);return}const Pe=`${se}_customers`,{data:Ee,error:Ne}=await ge.from(Pe).select("id, name, phone").eq("agent_id",De);if(Ne){u("Failed to fetch agent customers"),console.error("Customers fetch error:",Ne),l(!1);return}if(G((Ee==null?void 0:Ee.reduce((dt,fr)=>(dt[String(fr.id)]=fr,dt),{}))||{}),!Ee||Ee.length===0){i([]),l(!1);return}const Me=Ee.map(dt=>dt.id),Ve=`${se}_orders`,{data:$e,error:Ye}=await ge.from(Ve).select(`
          id,
          customer_id,
          total_amount,
          status,
          notes,
          shipping_address,
          created_at
        `).in("customer_id",Me).order("created_at",{ascending:!1});if(Ye){u("Failed to fetch orders: "+Ye.message),console.error("Orders fetch error:",Ye),l(!1);return}const pt=($e==null?void 0:$e.map(dt=>dt.id))||[],it=`${se}_orders_items`,{data:Je,error:Xe}=await ge.from(it).select("order_id, name, quantity, price").in("order_id",pt);Xe&&console.warn("Failed to fetch order items:",Xe);const At=new Map;(Je||[]).forEach(dt=>{At.has(dt.order_id)||At.set(dt.order_id,[]),At.get(dt.order_id).push({name:dt.name,quantity:dt.quantity,price:dt.price,total:dt.quantity*dt.price})});const Pt=(Ee==null?void 0:Ee.reduce((dt,fr)=>(dt[String(fr.id)]=fr,dt),{}))||{},Lt=new Map;Object.entries(Pt).forEach(([dt,fr])=>{const Ft=Number(dt);isNaN(Ft)||Lt.set(Ft,fr)});const St=($e||[]).map(dt=>{const fr=dt.total_amount||0,Ft=Number(dt.customer_id),bn=Lt.get(Ft)||{name:"Unknown Customer",phone:""};return{id:dt.id,customer_id:dt.customer_id,customer_name:bn.name,customer_phone:bn.phone,total_amount:fr,status:dt.status||"pending",notes:dt.notes,shipping_address:dt.shipping_address,created_at:dt.created_at,parsed_order_details:{items:At.get(dt.id)||[],total_amount:fr,shipping_address:dt.shipping_address,currency:"LKR",created_via:"manual"},type:"order"}});i(St)}catch(K){u("Failed to load orders"),console.error("Fetch error:",K)}finally{l(!1)}};g.useEffect(()=>{B()},[]);const ee=[{value:"",label:"All"},{value:"pending",label:"Pending"},{value:"processing",label:"Processing"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],X=[{value:"newest",label:"Newest"},{value:"oldest",label:"Oldest"},{value:"amount",label:"Amount (High to Low)"}],ne=K=>K?K.charAt(0).toUpperCase()+K.slice(1).toLowerCase():"",le=K=>{let be="";return K.notes&&(be+=K.notes+" "),be+=K.status,be.toLowerCase()};let de=s.filter(K=>{var re;const be=x===""||K.id.toString().includes(x)||((re=K.customer_name)==null?void 0:re.toLowerCase().includes(x.toLowerCase()))||K.customer_phone&&K.customer_phone.includes(x)||K.status.toLowerCase().includes(x.toLowerCase())||le(K).includes(x.toLowerCase()),_e=j===""||K.status.toLowerCase()===j;return be&&_e});de=[...de].sort((K,be)=>_==="newest"?new Date(be.created_at).getTime()-new Date(K.created_at).getTime():_==="oldest"?new Date(K.created_at).getTime()-new Date(be.created_at).getTime():_==="amount"?(be.total_amount||0)-(K.total_amount||0):0);const je=s.length,me=s.filter(K=>K.status.toLowerCase()==="pending").length,Le=s.filter(K=>K.status.toLowerCase()==="completed"||K.status.toLowerCase()==="delivered").length,ve=s.filter(K=>K.status.toLowerCase()==="completed"||K.status.toLowerCase()==="delivered").reduce((K,be)=>K+(be.total_amount||0),0),he=()=>{B(),E(!1),U(null)},V=()=>{B(),F(!1),R(null)},Re=async(K,be)=>{if(!f){alert("Agent prefix not available");return}Z(K);try{const _e=`${f}_orders`,{error:re}=await ge.from(_e).update({status:be}).eq("id",K);if(re){console.error("Update error:",re),alert(`Failed to update status: ${re.message}`);return}await B()}catch(_e){console.error("Update error:",_e),alert("Failed to update status")}finally{Z(null)}},xe=async K=>{if(!(!f||!confirm("Are you sure you want to delete this order? This action cannot be undone.")))try{const be=`${f}_orders_items`,{error:_e}=await ge.from(be).delete().eq("order_id",K);if(_e)throw new Error(`Failed to delete order items: ${_e.message}`);const re=`${f}_orders`,{error:De}=await ge.from(re).delete().eq("id",K);if(De)throw new Error(`Failed to delete order: ${De.message}`);await B(),alert("Order deleted successfully")}catch(be){console.error("Delete error:",be),alert(`Failed to delete order: ${be.message}`)}},Ce=K=>{R(K),W(!1),F(!0)},fe=()=>{T(!1),C(null)};if(o)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})});const We=K=>{const be=K.toLowerCase();return be==="pending"?"bg-yellow-100 text-yellow-700":be==="processing"?"bg-blue-100 text-blue-800":be==="shipped"?"bg-purple-100 text-purple-800":be==="delivered"||be==="completed"?"bg-green-100 text-green-700":be==="cancelled"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-800"};return a.jsxs(a.Fragment,{children:[S&&$&&f&&d&&a.jsx(mC,{order:$,onClose:()=>{E(!1),U(null)},onSuccess:he,agentPrefix:f,agentId:d}),P&&A&&f&&d&&a.jsx(cb,{customer:A,agentPrefix:f,agentId:d,onClose:()=>{F(!1),R(null)},onSuccess:V}),I&&D&&f&&d&&a.jsx(fC,{order:D,onClose:fe,agentPrefix:f,agentId:d}),a.jsxs(Qe.div,{variants:t,initial:"hidden",animate:"visible",className:"p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx(Qe.div,{variants:r,initial:"hidden",animate:"visible",custom:0,children:a.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:je.toLocaleString()})]}),a.jsxs("div",{className:"flex items-center text-green-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),a.jsx("span",{className:"ml-1 text-sm font-medium",children:"+12.5%"})]})]})})}),a.jsx(Qe.div,{variants:r,initial:"hidden",animate:"visible",custom:1,children:a.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:["LKR ",ve.toLocaleString()]})]}),a.jsxs("div",{className:"flex items-center text-green-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),a.jsx("span",{className:"ml-1 text-sm font-medium",children:"+8.2%"})]})]})})}),a.jsx(Qe.div,{variants:r,initial:"hidden",animate:"visible",custom:2,children:a.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:me})]}),a.jsxs("div",{className:"flex items-center text-amber-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),a.jsx("span",{className:"ml-1 text-sm font-medium",children:"+3.1%"})]})]})})}),a.jsx(Qe.div,{variants:r,initial:"hidden",animate:"visible",custom:3,children:a.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Le})]}),a.jsxs("div",{className:"flex items-center text-green-600",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),a.jsx("span",{className:"ml-1 text-sm font-medium",children:"+15.7%"})]})]})})})]}),c&&a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6 animate-in fade-in-0 duration-300",children:["Error: ",c]}),a.jsx(Qe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"bg-white rounded-xl border border-gray-200 p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[a.jsx(Qe.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.5},className:"flex-1 min-w-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{type:"text",placeholder:"Search orders by ID, customer name, or phone",value:x,onChange:K=>b(K.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),a.jsxs(Qe.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.6},className:"flex flex-wrap gap-2 items-center min-w-max",children:[a.jsx(Qe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2,delay:.7},children:a.jsxs(yr,{as:"div",className:"relative",children:[a.jsxs(yr.Button,{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[((Oe=ee.find(K=>K.value===j))==null?void 0:Oe.label)||"All",a.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:ee.map(K=>a.jsx(yr.Item,{children:({active:be})=>a.jsx("button",{className:`w-full text-left px-4 py-2 text-sm ${be?"bg-gray-100":""} ${j===K.value?"bg-green-50 text-green-700":""}`,onClick:()=>y(K.value),children:K.label})},K.value))})})]})}),a.jsx(Qe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2,delay:.8},children:a.jsxs(yr,{as:"div",className:"relative",children:[a.jsxs(yr.Button,{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[((nt=X.find(K=>K.value===_))==null?void 0:nt.label)||"Newest",a.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:X.map(K=>a.jsx(yr.Item,{children:({active:be})=>a.jsx("button",{className:`w-full text-left px-4 py-2 text-sm ${be?"bg-gray-100":""} ${_===K.value?"bg-green-50 text-green-700":""}`,onClick:()=>w(K.value),children:K.label})},K.value))})})]})}),a.jsxs(Qe.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2,delay:.9},onClick:()=>W(!0),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Order"]})]})]})}),a.jsx(Qe.hr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:1},className:"border-gray-200 mb-6"}),a.jsx(Qe.div,{variants:t,initial:"hidden",animate:"visible",className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-visible",children:s.length===0?a.jsxs(Qe.div,{variants:t,initial:"hidden",animate:"visible",className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders yet!"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Start by creating your first order for a customer."}),a.jsxs("button",{onClick:()=>W(!0),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 animate-in fade-in-0 duration-300",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create Order"]})]}):de.length===0?a.jsxs(Qe.div,{variants:t,initial:"hidden",animate:"visible",className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),a.jsx("p",{className:"text-gray-500",children:x||j?"No orders match your current filters.":"No orders available."})]}):a.jsx(Qe.div,{variants:t,initial:"hidden",animate:"visible",className:"overflow-visible",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:de.map((K,be)=>{var _e;return a.jsxs(Qe.tr,{variants:n,initial:"hidden",animate:"visible",custom:be,className:"hover:bg-gray-50 transition-colors duration-150",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#ORD-",K.id.toString().padStart(4,"0")]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:((_e=K.customer_name)==null?void 0:_e.charAt(0).toUpperCase())||"?"})}),a.jsx("div",{className:"ml-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.customer_name})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(K.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900",children:K.total_amount!==void 0?`LKR ${K.total_amount.toFixed(2)}`:"LKR 0.00"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap relative",children:a.jsxs(yr,{as:"div",className:"relative inline-block text-left",children:[a.jsx(yr.Button,{disabled:O===K.id,className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${We(K.status)} ${O===K.id?"opacity-50 cursor-not-allowed":""}`,children:O===K.id?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-1"}),"Updating..."]}):a.jsxs(a.Fragment,{children:[ne(K.status),a.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"origin-top-left absolute left-0 mt-2 w-48 rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[10000] border border-gray-200 divide-y divide-gray-100",children:ee.filter(re=>re.value!=="").map(re=>a.jsx(yr.Item,{children:({active:De})=>a.jsx("button",{disabled:O===K.id,className:`block w-full text-left px-4 py-2 text-sm ${De?"bg-gray-100 text-gray-900":"text-gray-700"} ${K.status===re.value?"bg-green-50 text-green-700":""} ${O===K.id?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{confirm(`Change order status to ${re.label}?`)&&Re(K.id,re.value)},children:re.label})},re.value))})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{onClick:()=>{C(K),T(!0)},title:"View",className:"text-gray-400 hover:text-green-600 p-1 transition-colors",children:a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),a.jsx("button",{onClick:()=>{U(K),E(!0)},title:"Edit",className:"text-gray-400 hover:text-blue-600 p-1 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.5H3v-3.572L16.732 3.732z"})})}),a.jsx("button",{onClick:()=>{e(`/agent/conversations?customerId=${K.customer_id}`)},title:"New Message",className:"text-gray-400 hover:text-indigo-600 p-1 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),a.jsx("button",{onClick:()=>xe(K.id),title:"Delete Order",className:"text-gray-400 hover:text-red-600 p-1 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},K.id)})})]})})})]}),H&&a.jsxs("div",{className:"fixed inset-0 z-[40] flex items-center justify-center p-4",children:[a.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50",onClick:()=>W(!1)}),a.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-md max-h-[90vh] flex flex-col z-50",children:[a.jsxs("div",{className:"sticky top-0 bg-white p-6 pb-4 border-b border-gray-200 z-20",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Select Customer"}),a.jsx("button",{onClick:()=>W(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx(Gn,{value:A,onChange:Ce,children:a.jsxs("div",{className:"relative",children:[a.jsx(Gn.Input,{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",displayValue:K=>K?K.name:"",onChange:K=>ue(K.target.value),placeholder:"Search customers by name or phone..."}),a.jsx(Gn.Options,{className:"absolute mt-1 max-h-96 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm z-10",children:(()=>{const K=Object.values(M),be=ce===""?K:K.filter(_e=>_e.name.toLowerCase().includes(ce.toLowerCase())||_e.phone&&_e.phone.includes(ce.toLowerCase()));return be.length===0&&Object.keys(M).length>0?a.jsx(Gn.Option,{value:null,className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-900",children:"No customers found."}):Object.keys(M).length===0?a.jsx(Gn.Option,{value:null,className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-900",children:"No customers available. Create some customers first."}):be.map(_e=>a.jsx(Gn.Option,{className:({active:re})=>`relative cursor-default select-none py-2 pl-3 pr-9 ${re?"bg-blue-600 text-white":"text-gray-900"}`,value:_e,children:({selected:re,active:De})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center ${De?"bg-blue-200":""}`,children:a.jsx("span",{className:`text-blue-600 font-medium text-sm ${De?"text-white":""}`,children:_e.name.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:`block truncate ${re?"font-medium":"font-normal"} ${De?"text-white":"text-gray-900"}`,children:_e.name}),a.jsx("span",{className:`text-sm block truncate ${De?"text-blue-100":"text-gray-500"}`,children:_e.phone||"No phone"})]})]}),re?a.jsx("span",{className:`absolute inset-y-0 right-0 flex items-center pr-4 ${De?"text-white":"text-blue-600"}`,children:a.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):null]})},_e.id))})()})]})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6 pt-0"})]})]})]})},eZ=()=>{const{id:e}=KP(),t=ra(),[r,n]=g.useState(null),[s,i]=g.useState(!0),[o,l]=g.useState(null),[c,u]=g.useState(null),[d,m]=g.useState(null),[f,h]=g.useState(!1),[x,b]=g.useState("");g.useEffect(()=>{if(!e){l("Order ID not provided"),i(!1);return}(async()=>{try{i(!0),l(null);const{data:{user:S},error:E}=await ge.auth.getUser();if(E||!S){l("User not authenticated"),i(!1);return}const{data:$,error:U}=await ge.from("agents").select("id, agent_prefix").eq("user_id",S.id).single();if(U||!$){l("Agent not found"),console.error("Agent fetch error:",U),i(!1);return}const I=$.id,T=$.agent_prefix;if(u(I),m(T),!T){l("Agent prefix not found"),i(!1);return}const D=`${T}_orders`,C=`${T}_customers`,{data:P,error:F}=await ge.from(D).select(`
            id,
            customer_id,
            total_amount,
            status,
            notes,
            created_at,
            updated_at,
            shipping_address,
            ${C} (name, phone)
          `).eq("id",Number(e)).single();if(F||!P){l("Order not found"),console.error("Order fetch error:",F),i(!1);return}const A=P[C]||{name:"Unknown Customer",phone:""},R=`${T}_orders_items`,{data:H,error:W}=await ge.from(R).select("name, quantity, price").eq("order_id",Number(e));W&&console.warn("Failed to fetch order items:",W);const M=(H||[]).map(ce=>({name:ce.name,quantity:ce.quantity,price:ce.price,total:ce.quantity*ce.price})),G={id:P.id,customer_id:P.customer_id,customer_name:(A==null?void 0:A.name)||"Unknown Customer",customer_phone:(A==null?void 0:A.phone)||"",order_details:{items:M,total_amount:P.total_amount||0,notes:P.notes||"",shipping_address:P.shipping_address||""},status:P.status,created_at:P.created_at,updated_at:P.updated_at};n(G),b(G.status)}catch(S){l("Failed to load order details"),console.error("Fetch error:",S)}finally{i(!1)}})()},[e]);const j=async()=>{if(!(!e||!c||!d||x===(r==null?void 0:r.status)))try{h(!0);const w=`${d}_orders`,{error:S}=await ge.from(w).update({status:x}).eq("id",Number(e));if(S){l("Failed to update order status"),console.error("Status update error:",S);return}n(E=>E?{...E,status:x}:null),alert("Order status updated successfully")}catch(w){l("Failed to update order status"),console.error("Update error:",w)}finally{h(!1)}},y=()=>{if(!r||!r.customer_phone){alert("Customer phone number not available");return}const w=r.customer_phone.replace(/\D/g,""),S=`Order #${r.id.toString().padStart(4,"0")} Update

Customer: ${r.customer_name}
Status: ${r.status}

Items:
${r.order_details.items.map($=>`${$.name} - Qty: ${$.quantity} x LKR ${$.price.toFixed(2)} = LKR ${$.total.toFixed(2)}`).join(`
`)}

Total: LKR ${r.order_details.total_amount.toFixed(2)}

${r.order_details.notes?`Notes: ${r.order_details.notes}`:""}

Thank you!`,E=`https://wa.me/${w}?text=${encodeURIComponent(S)}`;window.open(E,"_blank")};if(s)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})});if(o||!r)return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6",children:["Error: ",o||"Order not found"]}),a.jsx("button",{onClick:()=>t("/agent/orders"),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Orders"})]});const _=w=>{const S=w.toLowerCase();return S==="pending"?"text-yellow-600 bg-yellow-100":S==="processing"?"text-blue-600 bg-blue-100":S==="shipped"?"text-purple-600 bg-purple-100":S==="delivered"||S==="completed"?"text-green-600 bg-green-100":"text-gray-600 bg-gray-100"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-6 max-w-6xl mx-auto no-print",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:()=>t("/agent/orders"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),a.jsx("span",{children:"Back to Orders"})]}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Order #",r.id.toString().padStart(4,"0")]}),a.jsx("p",{className:"text-gray-600",children:"Order details and customer information"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${_(r.status)}`,children:r.status}),a.jsx("button",{onClick:()=>window.print(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:" Print Receipt"})]})]}),o&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6",children:o}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-1",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Customer Information"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:r.customer_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),a.jsx("p",{className:"text-sm text-gray-900",children:r.customer_phone})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Order Date"}),a.jsx("p",{className:"text-sm text-gray-900",children:new Date(r.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),r.updated_at&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),a.jsx("p",{className:"text-sm text-gray-900",children:new Date(r.updated_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mt-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Update Status"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("select",{value:x,onChange:w=>b(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"processing",children:"Processing"}),a.jsx("option",{value:"shipped",children:"Shipped"}),a.jsx("option",{value:"delivered",children:"Delivered"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]}),a.jsx("button",{onClick:j,disabled:f,className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors mb-3",children:f?"Updating...":"Update Status"}),a.jsx("button",{onClick:y,className:"w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors",children:" Send WhatsApp Update"})]})]})]}),a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["LKR ",r.order_details.total_amount.toFixed(2)]}),a.jsx("p",{className:"text-gray-600",children:"Total Amount"})]}),a.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.order_details.items.length}),a.jsx("p",{className:"text-gray-600",children:"Items"})]}),a.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.order_details.items.reduce((w,S)=>w+S.quantity,0)}),a.jsx("p",{className:"text-gray-600",children:"Total Quantity"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Items"}),r.order_details.items.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No items in this order"}):a.jsxs("div",{className:"space-y-4",children:[r.order_details.items.map((w,S)=>a.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:w.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",w.quantity,"  LKR ",w.price.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-semibold text-gray-900",children:["LKR ",w.total.toFixed(2)]})})]},S)),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["LKR ",r.order_details.total_amount.toFixed(2)]})]})})]})]}),(r.order_details.notes||r.order_details.shipping_address)&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Information"}),r.order_details.notes&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"text-sm font-medium text-gray-500 block mb-1",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded",children:r.order_details.notes})]}),r.order_details.shipping_address&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500 block mb-1",children:"Shipping Address"}),a.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded",children:r.order_details.shipping_address})]})]})]})]})]}),a.jsx("style",{children:`
        @media print {
          body * { visibility: hidden; }
          #print-receipt, #print-receipt * { visibility: visible; }
          #print-receipt { 
            position: absolute; 
            left: 0; 
            top: 0; 
            width: 100%; 
            background: white;
            padding: 20px;
            font-family: Arial, sans-serif;
            font-size: 12pt;
          }
          .no-print { display: none !important; }
          @page { margin: 0.5in; size: A4; }
        }
      `}),a.jsx("div",{id:"print-receipt",className:"hidden print:block",children:a.jsxs("div",{className:"border p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"ORDER RECEIPT"}),a.jsxs("p",{className:"text-lg",children:["Order #",r.id.toString().padStart(4,"0")]}),a.jsxs("p",{className:"text-sm mt-1",children:["Date: ",new Date(r.created_at).toLocaleDateString("en-US")]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Customer Information"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Name:"})," ",r.customer_name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",r.customer_phone]}),r.order_details.shipping_address&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{children:a.jsx("strong",{children:"Shipping Address:"})}),a.jsx("p",{className:"ml-4",children:r.order_details.shipping_address})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Order Items"}),a.jsxs("table",{className:"w-full border-collapse border",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-2 border",children:"Item"}),a.jsx("th",{className:"text-right py-2 border",children:"Qty"}),a.jsx("th",{className:"text-right py-2 border",children:"Price"}),a.jsx("th",{className:"text-right py-2 border",children:"Total"})]})}),a.jsx("tbody",{children:r.order_details.items.map((w,S)=>a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"py-2 border",children:w.name}),a.jsx("td",{className:"text-right py-2 border",children:w.quantity}),a.jsxs("td",{className:"text-right py-2 border",children:["LKR ",w.price.toFixed(2)]}),a.jsxs("td",{className:"text-right py-2 border font-semibold",children:["LKR ",w.total.toFixed(2)]})]},S))}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"border-t font-bold",children:[a.jsx("td",{colSpan:3,className:"text-right py-2 border",children:"TOTAL:"}),a.jsxs("td",{className:"text-right py-2 border",children:["LKR ",r.order_details.total_amount.toFixed(2)]})]})})]})]}),r.order_details.notes&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Notes"}),a.jsx("p",{className:"italic border p-2",children:r.order_details.notes})]}),a.jsxs("div",{className:"text-center mt-6 pt-4 border-t",children:[a.jsxs("p",{className:"text-sm",children:["Status: ",a.jsx("span",{className:"font-semibold",children:r.status.toUpperCase()})]}),a.jsx("p",{className:"text-sm mt-2",children:"Thank you for your business!"})]})]})})]})},tZ=()=>{var Re;const[e,t]=g.useState([]),[r,n]=g.useState([]),[s,i]=g.useState({}),[o,l]=g.useState(!0),[c,u]=g.useState(null),[d,m]=g.useState(null),[f,h]=g.useState(null),[x,b]=g.useState(""),[j,y]=g.useState(null),[_,w]=g.useState(null),[S,E]=g.useState(null),[$,U]=g.useState(null),[I,T]=g.useState({name:"",address:"",business_email:"",contact_number:"",website:""}),[D,C]=g.useState(null),[P,F]=g.useState(null),[A,R]=g.useState(!1),[H,W]=g.useState(null),[M,G]=g.useState(null),[ce,ue]=g.useState(""),[O,Z]=g.useState(0),[B,ee]=g.useState(""),X=async()=>{try{l(!0),u(null);const{data:{user:xe},error:Ce}=await ge.auth.getUser();if(Ce||!xe){u("User not authenticated"),l(!1);return}const{data:fe,error:We}=await ge.from("agents").select("id, agent_prefix, invoice_template_path, address, business_email, contact_number, website").eq("user_id",xe.id).single();if(We||!fe){u("Agent not found"),console.error("Agent fetch error:",We),l(!1);return}const Oe=fe.id,nt=fe.agent_prefix;m(Oe),h(nt),U(fe.invoice_template_path);const{data:K,error:be}=await ge.from("users").select("name").eq("id",xe.id).single();be&&console.warn("Failed to fetch user name:",be),T({name:(K==null?void 0:K.name)||"",address:fe.address||"",business_email:fe.business_email||"",contact_number:fe.contact_number||"",website:fe.website||""}),C(xe.id);const{data:_e}=await ge.from("whatsapp_configuration").select("phone_number_id, api_key").eq("user_id",xe.id).eq("is_active",!0).single();if(F(_e||null),!nt){u("Agent prefix not found"),l(!1);return}const re=`${nt}_customers`,{data:De,error:se}=await ge.from(re).select("id, name").eq("agent_id",Oe).order("name");if(se){u("Failed to fetch customers"),console.error("Customers fetch error:",se),l(!1);return}n(De||[]);const Pe=`${nt}_orders`,{data:Ee,error:Ne}=await ge.from(Pe).select(`
          id,
          customer_id,
          total_amount,
          status,
          notes,
          created_at
        `).in("customer_id",(De||[]).map(Xe=>Xe.id)).order("created_at",{ascending:!1});if(Ne){u("Failed to fetch orders"),console.error("Orders fetch error:",Ne),l(!1);return}const{data:Me,error:Ve}=await ge.from(re).select("id, name").in("id",(Ee==null?void 0:Ee.map(Xe=>Xe.customer_id))||[]);Ve&&console.warn("Customer names fetch warning:",Ve);const $e=new Map;(Me||[]).forEach(Xe=>{$e.set(Xe.id,Xe.name)});const Ye={};(Ee||[]).forEach(Xe=>{const At=Xe.customer_id;Ye[At]||(Ye[At]=[]),Ye[At].push({id:Xe.id,customer_id:Xe.customer_id,customer_name:$e.get(Xe.customer_id)||"Unknown Customer",total_amount:Xe.total_amount||0,status:Xe.status||"pending",notes:Xe.notes,created_at:Xe.created_at,type:"order"})}),i(Ye);const pt=`${nt}_orders_invoices`,{data:it,error:Je}=await ge.from(pt).select("id, name, pdf_url, status, generated_at, order_id").order("generated_at",{ascending:!1});if(Je)console.warn("Failed to fetch invoices:",Je);else{const Xe=(it||[]).map(Lt=>Lt.order_id),{data:At,error:Pt}=await ge.from(Pe).select("id, customer_id").in("id",Xe);if(Pt)console.warn("Failed to fetch order details for invoices:",Pt);else{const Lt=new Map;(At||[]).forEach(Ft=>{Lt.set(Ft.id,Ft.customer_id)});const St=Array.from(Lt.values()),{data:dt,error:fr}=await ge.from(re).select("id, name").in("id",St);if(fr)console.warn("Failed to fetch customer details for invoices:",fr);else{const Ft=new Map;(dt||[]).forEach(er=>{Ft.set(er.id,er.name)});const bn=`${nt}_orders_items`,{data:wn,error:Nt}=await ge.from(bn).select("order_id, total").in("order_id",Xe);Nt&&console.warn("Failed to fetch order items for invoices:",Nt);const Wt=new Map;(wn||[]).forEach(er=>{const cr=er.order_id,ar=er.total||er.quantity*er.price||0;Wt.has(cr)||Wt.set(cr,0),Wt.set(cr,Wt.get(cr)+ar)});const Yr=(it||[]).map(er=>{const cr=er.order_id,ar=Lt.get(cr),Sr=Ft.get(ar)||"Unknown Customer",It=Wt.get(cr)||0,nr=er.discount_percentage||0,zr=It*(nr/100),ur=It-zr;return{...er,customer_id:ar,customer_name:Sr,order_number:`#${cr.toString().padStart(4,"0")}`,total:ur,discount_percentage:nr}});t(Yr)}}}u(null)}catch(xe){u("Failed to load data"),console.error("Fetch error:",xe)}finally{l(!1)}};g.useEffect(()=>{X()},[]);const ne=e.filter(xe=>{var We,Oe;const Ce=j===null||xe.customer_id===j,fe=x===""||((We=xe.customer_name)==null?void 0:We.toLowerCase().includes(x.toLowerCase()))||((Oe=xe.name)==null?void 0:Oe.toLowerCase().includes(x.toLowerCase()))||xe.status.toLowerCase().includes(x.toLowerCase())||xe.order_number.toLowerCase().includes(x.toLowerCase());return Ce&&fe}),le=xe=>xe?xe.charAt(0).toUpperCase()+xe.slice(1).toLowerCase():"",de=xe=>{switch(xe){case"generated":return"bg-blue-100 text-blue-800";case"sent":return"bg-yellow-100 text-yellow-800";case"paid":return"bg-green-100 text-green-800"}},je=xe=>xe.replace(/[^a-z0-9]/gi,"_").toLowerCase(),me=async(xe,Ce)=>{if(!f||!d){u("Agent configuration missing");return}if(!ce.trim()){u("Invoice name is required");return}w(xe.id);try{const{data:fe,error:We}=await ge.from("agents").select("invoice_template_path").eq("id",d).single();We?console.warn("Failed to refetch agent template path:",We):U((fe==null?void 0:fe.invoice_template_path)||null);const Oe=`${f}_orders_items`,{data:nt,error:K}=await ge.from(Oe).select("name, quantity, price, total").eq("order_id",xe.id);if(K)throw new Error("Failed to fetch order items: "+K.message);const be=(nt||[]).map(It=>({name:It.name,quantity:It.quantity,price:It.price,total:It.total||It.quantity*It.price}));let _e=null;if(fe!=null&&fe.invoice_template_path||$){const It=(fe==null?void 0:fe.invoice_template_path)||$;try{const{data:nr,error:zr}=await ge.storage.from("agent-templates").download(It);if(zr)console.warn("Failed to fetch template:",zr);else if(nr){const ur=new Image,sn=URL.createObjectURL(nr);ur.src=sn,await new Promise((mn,$n)=>{ur.onload=()=>{const Zr=document.createElement("canvas"),hs=Zr.getContext("2d"),fs=150,Ii=595,Pr=842,ms=fs/72,Jn=Ii*ms,Mi=Pr*ms;Zr.width=Jn,Zr.height=Mi;const ia=Jn/ur.width,_o=Mi/ur.height,Oa=Math.min(ia,_o),In=ur.width*Oa,aa=ur.height*Oa,jo=(Jn-In)/2,Ra=(Mi-aa)/2;hs.fillStyle="white",hs.fillRect(0,0,Zr.width,Zr.height),hs.imageSmoothingEnabled=!0,hs.imageSmoothingQuality="high",hs.drawImage(ur,jo,Ra,In,aa),_e=Zr.toDataURL("image/jpeg",.95),URL.revokeObjectURL(sn),mn(null)},ur.onerror=()=>{console.error("Failed to load template image"),$n(new Error("Image load failed"))}})}}catch(nr){console.error("Error fetching template:",nr)}}const re=new Et,De=It=>{let nr="";const zr=new Uint8Array(It),ur=zr.byteLength;for(let sn=0;sn<ur;sn++)nr+=String.fromCharCode(zr[sn]);return window.btoa(nr)},se="https://raw.githubusercontent.com/google/fonts/main/ofl/poppins/Poppins-Regular.ttf",Pe="https://raw.githubusercontent.com/google/fonts/main/ofl/poppins/Poppins-Bold.ttf",[Ee,Ne]=await Promise.all([fetch(se).then(It=>It.arrayBuffer()),fetch(Pe).then(It=>It.arrayBuffer())]),Me=De(Ee),Ve=De(Ne);re.addFileToVFS("Poppins-Regular.ttf",Me),re.addFont("Poppins-Regular.ttf","Poppins","normal"),re.addFileToVFS("Poppins-Bold.ttf",Ve),re.addFont("Poppins-Bold.ttf","Poppins","bold");const $e=re.internal.pageSize.getWidth(),Ye=re.internal.pageSize.getHeight();_e&&re.addImage(_e,"JPEG",0,0,$e,Ye),re.setFontSize(16),re.setFont("Poppins","bold"),re.text(ce,$e/2,20,{align:"center"}),re.setFontSize(10),re.setFont("Poppins","normal");let pt=60;I.name.trim()&&(re.setFont("Poppins","bold"),re.text(I.name,20,pt),re.setFont("Poppins","normal"),pt+=10),I.address.trim()&&(re.text(I.address,20,pt),pt+=10),I.business_email.trim()&&(re.text(`Email: ${I.business_email}`,20,pt),pt+=10),I.contact_number.trim()&&(re.text(`Phone: ${I.contact_number}`,20,pt),pt+=10),I.website.trim()&&(re.text(`Website: ${I.website}`,20,pt),pt+=10);const it=re.internal.pageSize.getWidth()-20;re.setFont("Poppins","bold"),re.text("Invoice Details",it,60,{align:"right"}),re.setFont("Poppins","normal"),re.text(`Date: ${new Date(xe.created_at).toLocaleDateString()}`,it,80,{align:"right"}),re.text(`Order #: #${xe.id.toString().padStart(4,"0")}`,it,90,{align:"right"}),re.text(`Status: ${le(xe.status)}`,it,100,{align:"right"}),re.setFont("Poppins","bold"),re.text("Bill To:",20,120),re.setFont("Poppins","normal"),re.text(xe.customer_name||"Unknown Customer",20,130);let Je=145;const Xe={desc:20,qty:90,price:120,total:150},At=55,Pt=10,Lt=6;re.setFontSize(9),re.setFont("Poppins","bold"),re.text("Item Description",Xe.desc,Je),re.text("Qty",Xe.qty+5,Je),re.text("Unit Price",Xe.price,Je),re.text("Total",190,Je,{align:"right"}),Je+=Pt+2,re.setFont("Poppins","normal"),re.setFontSize(10),be.forEach(It=>{Je>750&&(re.addPage(),_e&&re.addImage(_e,"JPEG",0,0,$e,Ye),Je=35,re.setFont("Poppins","bold"),re.text("Item Description",Xe.desc,Je),re.text("Qty",Xe.qty+5,Je),re.text("Unit Price",Xe.price,Je),re.text("Total",195,Je,{align:"right"}),Je+=Pt+2,re.setFont("Poppins","normal"));const nr=re.splitTextToSize(It.name,At);let zr=Je;nr.forEach(($n,Zr)=>{re.text($n,Xe.desc,zr),zr+=Lt});const ur=Math.max(1,nr.length),sn=Math.max(Pt,(ur-1)*Lt+Pt),mn=Je+(ur-1)*Lt/2;re.text(It.quantity.toString(),Xe.qty+5,mn),re.text(`LKR ${It.price.toFixed(2)}`,Xe.price,mn),re.text(`LKR ${(It.total||It.quantity*It.price).toFixed(2)}`,190,mn,{align:"right"}),Je+=sn+2}),re.setLineWidth(.1),re.line(20,Je,190,Je),Je+=5;const St=be.reduce((It,nr)=>It+(nr.total||nr.quantity*nr.price),0),dt=St*(Ce/100),fr=St-dt;let Ft=Je+5;if(re.setFont("Poppins","bold"),re.setFontSize(10),re.text("Subtotal:",120,Ft),re.text(`LKR ${St.toFixed(2)}`,190,Ft,{align:"right"}),Ft+=10,re.setFont("Poppins","normal"),re.setFontSize(9),re.text(`Discount (${Ce.toFixed(2)}%):`,120,Ft),re.text(`-LKR ${dt.toFixed(2)}`,190,Ft,{align:"right"}),Ft+=10,re.setFont("Poppins","bold"),re.setFontSize(10),re.text("Total Amount:",120,Ft),re.text(`LKR ${fr.toFixed(2)}`,190,Ft,{align:"right"}),Ft+=15,Je=Ft+20,xe.notes){re.setFont("Poppins","normal"),re.setFontSize(9),re.text("Notes:",20,Je);const It=re.splitTextToSize(xe.notes,170);let nr=Je;It.forEach(zr=>{re.text(zr,50,nr),nr+=6}),Je=nr+10}const bn=Ye-20;re.setFontSize(10),re.setFont("Poppins","normal"),re.text("Thank you for your business!",$e/2,bn,{align:"center"});const wn=re.output("blob"),Nt=je(ce),Wt=`${f}/${Nt}.pdf`,{data:Yr,error:er}=await ge.storage.from("invoices").upload(Wt,wn,{contentType:"application/pdf",upsert:!0});if(er)throw new Error("Failed to upload invoice: "+er.message);const{data:{publicUrl:cr}}=ge.storage.from("invoices").getPublicUrl(Wt),ar=`${f}_orders_invoices`,{error:Sr}=await ge.from(ar).insert({order_id:xe.id,name:ce,pdf_url:cr,status:"generated",discount_percentage:Ce});if(Sr)throw new Error("Failed to save invoice record: "+Sr.message);await X(),re.save(`${Nt}.pdf`),u(null),R(!1),W(null),G(null),ue(""),Z(0)}catch(fe){u("Failed to generate invoice: "+fe.message),console.error("Invoice generation error:",fe)}finally{w(null)}},Le=async xe=>{if(!P){u("WhatsApp not configured. Please set up WhatsApp in settings.");return}E(xe);try{const{data:{user:Ce}}=await ge.auth.getUser();if(!Ce||!D)throw new Error("User not authenticated");const fe=`${f}_orders_invoices`,We=`${f}_orders`,Oe=`${f}_customers`,nt=`${f}_orders_items`,{data:K,error:be}=await ge.from(fe).select("id, name, pdf_url, order_id, discount_percentage, status").eq("id",xe).single();if(be||!K)throw new Error("Failed to fetch invoice: "+((be==null?void 0:be.message)||"Not found"));const{data:_e,error:re}=await ge.from(We).select("customer_id").eq("id",K.order_id).single();if(re||!_e)throw new Error("Failed to fetch order: "+((re==null?void 0:re.message)||"Not found"));const{data:De,error:se}=await ge.from(Oe).select("id, name, phone, last_user_message_time").eq("id",_e.customer_id).single();if(se||!De)throw new Error("Failed to fetch customer: "+((se==null?void 0:se.message)||"Not found"));const Pe=De.phone;if(!Pe)throw new Error("Customer phone number not found");const Ee=K.order_id,Ne=`#${Ee.toString().padStart(4,"0")}`,{data:Me,error:Ve}=await ge.from(nt).select("total").eq("order_id",Ee);if(Ve)throw new Error("Failed to fetch order items: "+Ve.message);const $e=(Me||[]).reduce((Pt,Lt)=>Pt+(Lt.total||0),0),Ye=K.discount_percentage||0,pt=$e*(1-Ye/100),it=new Date,Je=De.last_user_message_time?new Date(De.last_user_message_time):new Date(0),Xe=(it.getTime()-Je.getTime())/(1e3*60*60),At=await ge.functions.invoke("send-invoice-template",{body:{user_id:D,customer_phone:Pe,invoice_url:K.pdf_url,invoice_name:K.name,order_number:Ne,total_amount:pt.toString(),customer_name:De.name||"Valued Customer"}});if(At.error)throw new Error("Failed to send invoice: "+At.error.message);if(K.status==="generated"){const{error:Pt}=await ge.from(fe).update({status:"sent",updated_at:new Date().toISOString()}).eq("id",xe);if(Pt)throw new Error("Failed to update invoice status: "+Pt.message)}await X(),u(null)}catch(Ce){u("Failed to send invoice: "+Ce.message),console.error("Send invoice error:",Ce)}finally{E(null)}},ve=async xe=>{E(xe);try{const Ce=`${f}_orders_invoices`,{error:fe}=await ge.from(Ce).update({status:"paid",updated_at:new Date().toISOString()}).eq("id",xe);if(fe)throw new Error("Failed to update invoice status: "+fe.message);alert("Marked invoice as paid"),await X(),u(null)}catch(Ce){u("Failed to mark as paid: "+Ce.message),console.error("Mark paid error:",Ce)}finally{E(null)}},he=async xe=>{try{const Ce=await fetch(xe.pdf_url);if(!Ce.ok)throw new Error("Failed to fetch PDF");const fe=await Ce.blob(),We=URL.createObjectURL(fe),Oe=document.createElement("a");Oe.href=We,Oe.download=`${je(xe.name)}.pdf`,document.body.appendChild(Oe),Oe.click(),document.body.removeChild(Oe),URL.revokeObjectURL(We)}catch(Ce){u("Failed to download PDF: "+Ce.message),console.error("Download PDF error:",Ce)}},V=async xe=>{if(confirm(`Delete invoice "${xe.name}"? This will remove the PDF from storage and record from database.`)){if(!f){u("Agent configuration missing");return}E(xe.id);try{const Ce=je(xe.name),fe=`${f}/${Ce}.pdf`,{error:We}=await ge.storage.from("invoices").remove([fe]);if(We)throw new Error("Failed to delete PDF from storage: "+We.message);const Oe=`${f}_orders_invoices`,{error:nt}=await ge.from(Oe).delete().eq("id",xe.id);if(nt)throw new Error("Failed to delete invoice record: "+nt.message);await X(),alert("Invoice deleted successfully"),u(null)}catch(Ce){u("Failed to delete invoice: "+Ce.message),console.error("Delete invoice error:",Ce)}finally{E(null)}}};return o?a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})}):a.jsxs("div",{className:"p-6",children:[c&&a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6",children:["Error: ",c]}),a.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{type:"text",placeholder:"Search invoices by customer, name, status...",value:x,onChange:xe=>b(xe.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-200"})]})}),a.jsxs("div",{className:"flex gap-4 items-center flex-shrink-0",children:[a.jsx("div",{className:"w-64",children:a.jsxs("select",{value:(j==null?void 0:j.toString())||"",onChange:xe=>y(xe.target.value?parseInt(xe.target.value):null),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-200",children:[a.jsx("option",{value:"",children:"All Customers"}),r.map(xe=>a.jsx("option",{value:xe.id,children:xe.name},xe.id))]})}),a.jsx("button",{onClick:()=>R(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:"Create Invoice"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:ne.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:x?"No invoices found":"No invoices yet"}),a.jsx("p",{className:"text-gray-500",children:x?`No invoices match "${x}"`:"Create your first invoice using the button above"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice #"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order #"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ne.map(xe=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:xe.name})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:xe.customer_name})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:xe.order_number}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["LKR ",xe.total.toFixed(2)]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${de(xe.status)}`,children:le(xe.status)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(xe.generated_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex space-x-2 justify-end",children:[a.jsx("button",{onClick:()=>window.open(xe.pdf_url,"_blank"),className:"px-3 py-1 rounded-md text-xs transition-colors bg-blue-600 hover:bg-blue-700 text-white",type:"button",children:"View"}),a.jsx("button",{onClick:()=>he(xe),className:"px-3 py-1 rounded-md text-xs transition-colors bg-green-600 hover:bg-green-700 text-white",type:"button",children:"Download"}),xe.status!=="paid"&&a.jsx("button",{onClick:()=>Le(xe.id),disabled:S===xe.id,className:`px-3 py-1 rounded-md text-xs transition-colors ${S===xe.id?"bg-yellow-400 cursor-not-allowed":"bg-yellow-600 hover:bg-yellow-700 text-white"}`,children:S===xe.id?"Sending...":xe.status==="generated"?"Send":"Resend"}),(xe.status==="generated"||xe.status==="sent")&&a.jsx("button",{onClick:()=>ve(xe.id),disabled:S===xe.id,className:`px-3 py-1 rounded-md text-xs transition-colors ${S===xe.id?"bg-green-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:S===xe.id?"Updating...":"Mark Paid"}),a.jsx("button",{onClick:()=>V(xe),disabled:S===xe.id,className:`px-3 py-1 rounded-md text-xs transition-colors ${S===xe.id?"bg-red-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,children:S===xe.id?"Deleting...":"Delete"})]})})]},xe.id))})]})})}),a.jsxs(Lx,{open:A,onClose:()=>{R(!1),W(null),G(null),ue(""),Z(0),ee("")},className:"relative z-50",children:[a.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),a.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:a.jsxs(Lx.Panel,{className:"max-w-md w-full max-h-[90vh] overflow-y-auto transform rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[a.jsx(Lx.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:"Create Invoice"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Customer"}),a.jsx(Gn,{value:H,onChange:xe=>{W(xe),G(null),ue(xe?`Invoice for ${xe.name}`:"")},children:a.jsxs("div",{className:"relative mt-1",children:[a.jsx(Gn.Input,{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",displayValue:xe=>xe?xe.name:"",onChange:xe=>ee(xe.target.value)}),a.jsx(Gn.Options,{className:"absolute mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm z-50",children:(()=>{const xe=B===""?r:r.filter(Ce=>Ce.name.toLowerCase().includes(B.toLowerCase()));return xe.length===0?a.jsx(Gn.Option,{value:null,className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-900",children:B===""?"No customers available.":"No customers found."}):xe.map(Ce=>a.jsx(Gn.Option,{className:({active:fe})=>`relative cursor-default select-none py-2 pl-3 pr-9 ${fe?"bg-green-600 text-white":"text-gray-900"}`,value:Ce,children:({selected:fe,active:We})=>a.jsxs(a.Fragment,{children:[a.jsx("span",{className:`block truncate ${fe?"font-medium":"font-normal"} ${We?"text-white":"text-gray-900"}`,children:Ce.name}),fe?a.jsx("span",{className:`absolute inset-y-0 right-0 flex items-center pr-4 ${We?"text-white":"text-green-600"}`,children:a.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):null]})},Ce.id))})()})]})})]}),H&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Order for ",H.name]}),a.jsxs("select",{value:(M==null?void 0:M.id)||"",onChange:xe=>{var We;const Ce=parseInt(xe.target.value),fe=(We=s[H.id])==null?void 0:We.find(Oe=>Oe.id===Ce);G(fe||null),ue(fe?`Invoice for Order #${fe.id.toString().padStart(4,"0")} - ${H.name}`:`Invoice for ${H.name}`)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"",children:"Choose an order"}),(Re=s[H.id])==null?void 0:Re.map(xe=>a.jsxs("option",{value:xe.id,children:["Order #",xe.id.toString().padStart(4,"0")," - LKR"," ",xe.total_amount.toFixed(2)," -"," ",le(xe.status)]},xe.id))]})]}),H&&M&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Name"}),a.jsx("input",{type:"text",value:ce,onChange:xe=>ue(xe.target.value),placeholder:"Enter custom invoice name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),H&&M&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Percentage (%)"}),a.jsx("input",{type:"number",value:O,onChange:xe=>Z(parseFloat(xe.target.value)||0),placeholder:"0",min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{R(!1),W(null),G(null),ue(""),Z(0),ee("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancel"}),H&&M&&a.jsx("button",{onClick:()=>me(M,O),disabled:_===M.id||!ce.trim(),className:`px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${_===M.id||!ce.trim()?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:_===M.id?"Generating...":"Generate Invoice"})]})]})]})})]})]})},rZ=({isOpen:e,onClose:t,onSuccess:r,config:n,agentPrefix:s,agentId:i,initialTemplate:o,isEdit:l})=>{const[c,u]=g.useState(null),[d,m]=g.useState(!1),[f,h]=g.useState({name:"",category:"UTILITY",language:"en_US",header:{type:"TEXT",text:"",mediaType:void 0,mediaUrl:"",mediaHandle:""},body:"",footer:"",buttons:[],examples:{}}),x=A=>{var je,me,Le,ve,he,V;const R=A.components||[],H=R.find(Re=>Re.type.toLowerCase()==="header"),W=R.find(Re=>Re.type.toLowerCase()==="body"),M=R.find(Re=>Re.type.toLowerCase()==="footer"),G=R.find(Re=>Re.type.toLowerCase()==="buttons");let ce="TEXT",ue="",O,Z="",B="";if(H)if(H.format==="TEXT"&&H.text)ce="TEXT",ue=H.text;else if(H.format&&["IMAGE","VIDEO","DOCUMENT"].includes(H.format)){ce="MEDIA",O=H.format,(me=(je=A.mediaUrls)==null?void 0:je.header)!=null&&me.url&&(Z=A.mediaUrls.header.url);const Re=(ve=(Le=H.example)==null?void 0:Le.header_handle)==null?void 0:ve[0];typeof Re=="string"?B=Re:typeof Re=="object"&&(Re!=null&&Re.id)?B=Re.id:typeof Re=="object"&&(Re!=null&&Re.handle)?B=Re.handle:(V=(he=A.mediaUrls)==null?void 0:he.header)!=null&&V.handle&&(B=A.mediaUrls.header.handle)}else H.format==="LOCATION"&&(ce="LOCATION");const X=((G==null?void 0:G.buttons)||[]).map(Re=>({type:Re.type,text:Re.text||"",phoneNumber:Re.phone_number,url:Re.url,payload:Re.payload})),ne={},le=(Re,xe,Ce)=>{if(!Re||!Ce||!Ce[xe])return;const fe=[...Re.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].map(K=>({param:K[1],index:K.index})).sort((K,be)=>K.index-be.index),We=Ce[xe];if(!Array.isArray(We))return;let Oe;const nt=We[0];Array.isArray(nt)?Oe=nt:Oe=We,Array.isArray(Oe)&&fe.forEach((K,be)=>{be<Oe.length&&typeof Oe[be]=="string"&&(ne[K.param]=Oe[be])})},de=(Re,xe)=>{const Ce=Re;xe&&xe[Ce]&&Array.isArray(xe[Ce])&&xe[Ce].forEach(fe=>{fe.param_name&&typeof fe.example=="string"&&(ne[fe.param_name]=fe.example)})};return(H==null?void 0:H.format)==="TEXT"&&H.text&&de("header_text_named_params",H.example),W!=null&&W.text&&(le(W.text,"body_text",W.example),de("body_text_named_params",W.example)),{name:A.name,category:A.category,language:A.language,header:{type:ce,text:ue,mediaType:O,mediaUrl:Z,mediaHandle:B},body:(W==null?void 0:W.text)||"",footer:(M==null?void 0:M.text)||"",buttons:X,examples:ne}};g.useEffect(()=>{e&&(h(l&&o?x(o):{name:"",category:"UTILITY",language:"en_US",header:{type:"TEXT",text:"",mediaType:void 0,mediaUrl:"",mediaHandle:""},body:"",footer:"",buttons:[],examples:{}}),u(null))},[e,l,o]),g.useEffect(()=>{const A={header:f.header.type==="TEXT"?f.header.text:"",body:f.body,footer:f.footer};let R=[];Object.entries(A).forEach(([G,ce])=>{if(ce){const ue=[...ce.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].map(O=>({param:O[1],index:O.index,section:G}));R=R.concat(ue)}});const H=new Set,W=R.sort((G,ce)=>G.index-ce.index).filter(G=>H.has(G.param)?!1:(H.add(G.param),!0)).map(G=>G.param),M={};W.forEach(G=>{M[G]=f.examples[G]||""}),h(G=>({...G,examples:M}))},[f.header.type,f.header.text,f.body,f.footer]);const b=A=>{const{name:R,value:H}=A.target;h(R==="body"?W=>({...W,body:H}):W=>({...W,[R]:H}))},j=(A,R)=>{h(H=>({...H,examples:{...H.examples,[A]:R}}))},y=A=>{const H=A.target.value.toLowerCase().replace(/[^a-z\s_]/g,"").replace(/\s+/g,"_");h(W=>({...W,name:H}))},_=A=>{switch(A){case"IMAGE":return"image/*";case"VIDEO":return"video/*";case"DOCUMENT":return".pdf";default:return"*"}},w=A=>{const R=A.split(","),H=R[0].match(/:(.*?);/)[1],W=atob(R[1]);let M=W.length;const G=new Uint8Array(M);for(;M--;)G[M]=W.charCodeAt(M);return new Blob([G],{type:H})},S=async(A,R)=>{const H=R*1024*1024;return A.size<=H?A:new Promise((W,M)=>{const G=new Image,ce=document.createElement("canvas"),ue=ce.getContext("2d");if(!ue){M(new Error("Canvas not supported"));return}G.onload=()=>{var me;let O=G.width,Z=G.height;const B=1280;if(O>B||Z>B){const Le=Math.min(B/O,B/Z);O*=Le,Z*=Le}ce.width=O,ce.height=Z,ue.drawImage(G,0,0,O,Z);let ee=.9;const X=()=>ce.toDataURL("image/jpeg",ee);let ne=X();for(;ne.length*3/4>H&&ee>.1;)ee-=.05,ne=X();if(ee<=.1){M(new Error("Could not compress image sufficiently"));return}const le=w(ne),de=((me=A.name.split(".").pop())==null?void 0:me.toLowerCase())||"jpg",je=new File([le],`compressed.${de}`,{type:le.type});W(je)},G.src=URL.createObjectURL(A),G.onerror=()=>M(new Error("Failed to load image"))})},E=async(A,R)=>{if(!n)throw new Error("WhatsApp configuration not available");const H=new FormData;H.append("file",A),H.append("media_type",R);const{data:W,error:M}=await ge.functions.invoke("upload-media-to-meta",{body:H});if(M)throw new Error(`WhatsApp media upload failed: ${M.message}`);if(!W||!W.media_handle)throw new Error("No media handle received from WhatsApp");const G=W.media_handle;if(typeof G!="string"||G.length===0)throw new Error(`Invalid media handle format: ${G}`);return G},$=async A=>{var G,ce;const R=(G=A.target.files)==null?void 0:G[0];if(!R)return;if(!f.header.mediaType){u("Please select a media type first.");return}if(f.header.mediaType==="DOCUMENT"&&!R.name.toLowerCase().endsWith(".pdf")){u("Documents for WhatsApp templates must be PDF files only (max 100KB).");return}const W={IMAGE:5*1024*1024,VIDEO:16*1024*1024,DOCUMENT:100*1024}[f.header.mediaType];let M=R;if(R.size>W)if(f.header.mediaType==="IMAGE")try{if(M=await S(R,W/(1024*1024)),M.size>W)throw new Error("Compression did not reduce size sufficiently")}catch(ue){const O=ue instanceof Error?ue.message:"Unknown compression error";u(`Image too large (${(R.size/(1024*1024)).toFixed(2)}MB). WhatsApp limit: 5MB. Compression failed: ${O}. Please resize manually.`);return}else{const ue=(W/1048576).toFixed(2);u(`File too large for ${f.header.mediaType.toLowerCase()} (${(R.size/(1024*1024)).toFixed(2)}MB). WhatsApp limit: ${ue}MB. Please resize manually and try again.`);return}m(!0),u(null);try{const ue=((ce=M.name.split(".").pop())==null?void 0:ce.toLowerCase())||"",O=Date.now(),Z=Math.random().toString(36).substring(7),ee=`templates/${`${O}-${Z}.${ue}`}`,{data:X,error:ne}=await ge.storage.from("templates-media").upload(ee,M,{cacheControl:"3600",upsert:!1});if(ne)throw ne;if(!X)throw new Error("Supabase upload failed");const{data:{publicUrl:le}}=ge.storage.from("templates-media").getPublicUrl(ee),de=await E(M,f.header.mediaType);h(je=>({...je,header:{...je.header,mediaUrl:le,mediaHandle:de}}))}catch(ue){u(`Upload failed: ${ue.message}`),console.error("Media upload error:",ue)}finally{m(!1)}},U=async A=>{var G,ce,ue,O,Z,B,ee;if(A.preventDefault(),u(null),!n||!s||!i){u("No WhatsApp configuration or agent found");return}const R=l?(o==null?void 0:o.name)||f.name:f.name.trim();if(!R){u("Template name is required");return}if(!l&&!/^[a-z_]+$/.test(R)){u("Template name must contain only lowercase letters and underscores (e.g., welcome_message)");return}if(!f.body.trim()){u("Body text is required");return}if(f.footer&&f.footer.length>60){u("Footer must be 60 characters or less");return}if(f.buttons.some(X=>!X.text.trim())){u("All buttons must have text");return}if(f.header.type==="MEDIA"&&(!f.header.mediaType||!f.header.mediaHandle.trim())){u("Media header requires type and media upload to WhatsApp");return}if(f.buttons.length>3){u("Maximum 3 buttons allowed");return}const H=[f.header.type==="TEXT"?f.header.text:"",f.body];let W=new Set;if(H.forEach(X=>{X&&[...X.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].forEach(le=>{W.add(le[1])})}),f.footer&&[...f.footer.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].length>0){u("Footer text cannot contain variables ({{param}}). Please remove them.");return}const M=Array.from(W).filter(X=>{var ne;return!((ne=f.examples[X])!=null&&ne.trim())});if(M.length>0){u(`Please provide sample values for all variables ({{${M.join(", ")}}}).`);return}try{const{business_account_id:X,api_key:ne}=n,le=`https://graph.facebook.com/v20.0/${X}/message_templates`,de=[];if(f.header.type==="TEXT"&&f.header.text){const Ce=f.header.text;if(Ce.length>60){u("Text header must be 60 characters or less");return}const fe=[...Ce.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].map(Oe=>({param:Oe[1],index:Oe.index})).sort((Oe,nt)=>Oe.index-nt.index);if(fe.length>1){u("Text header supports only 1 parameter");return}const We={type:"header",format:"TEXT",text:Ce};if(fe.length>0){const Oe=fe.map(nt=>({param_name:nt.param,example:f.examples[nt.param]}));We.example={header_text_named_params:Oe}}de.push(We)}else f.header.type==="MEDIA"&&f.header.mediaType&&f.header.mediaHandle?de.push({type:"header",format:f.header.mediaType,example:{header_handle:[f.header.mediaHandle]}}):f.header.type==="LOCATION"&&de.push({type:"header",format:"LOCATION"});const je=f.body,me=[...je.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].map(Ce=>({param:Ce[1],index:Ce.index})).sort((Ce,fe)=>Ce.index-fe.index),Le={type:"body",text:je};if(me.length>0){const Ce=me.map(fe=>({param_name:fe.param,example:f.examples[fe.param]}));Le.example={body_text_named_params:Ce}}if(de.push(Le),f.footer){const Ce=f.footer.trim();if([...Ce.matchAll(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g)].length>0){u("Footer text cannot contain variables ({{param}}). Please remove them.");return}de.push({type:"footer",text:Ce})}if(f.buttons.length>0){const Ce=f.buttons.map(fe=>({type:fe.type,text:fe.text,...fe.type==="PHONE_NUMBER"&&fe.phoneNumber?{phone_number:fe.phoneNumber}:{},...fe.type==="URL"&&fe.url?{url:fe.url}:{},...fe.type==="QUICK_REPLY"&&fe.payload?{payload:fe.payload}:{}}));de.push({type:"buttons",buttons:Ce})}const ve={name:R,language:f.language,category:f.category,parameter_format:"named",components:de},he=await fetch(le,{method:"POST",headers:{Authorization:`Bearer ${ne}`,"Content-Type":"application/json"},body:JSON.stringify(ve)});if(!he.ok){const Ce=await he.json();console.error("Template submission failed:",Ce);let fe=((G=Ce.error)==null?void 0:G.message)||he.statusText;throw((ce=Ce.error)==null?void 0:ce.code)===131009&&((ue=Ce.error)==null?void 0:ue.error_subcode)===2494102?fe=`Invalid media handle: ${((O=Ce.error)==null?void 0:O.error_user_msg)||"The uploaded media handle is not valid. Please try uploading the media again."}`:((Z=Ce.error)==null?void 0:Z.error_subcode)===2388023||fe.includes("being deleted")?fe="The English language version of this template is being deleted by Meta. New content can't be added until this process completes in about 4 weeks. Consider creating a new template with a different name.":(B=Ce.error)!=null&&B.error_user_msg&&(fe=Ce.error.error_user_msg),new Error(fe)}const V={id:R,name:R,language:f.language,category:f.category,components:de,status:"PENDING",created_time:new Date().toISOString()};f.header.type==="MEDIA"&&f.header.mediaType&&f.header.mediaHandle&&f.header.mediaUrl?V.mediaUrls={header:{handle:f.header.mediaHandle,url:f.header.mediaUrl}}:l&&((ee=o==null?void 0:o.mediaUrls)!=null&&ee.header)&&(V.mediaUrls={header:o.mediaUrls.header}),r(V,l);const Re=`${s}_templates`,xe={name:V.name,language:{code:V.language},components:V.components};if(f.header.type==="MEDIA"&&f.header.mediaType&&f.header.mediaHandle&&f.header.mediaUrl?xe.media_urls={header:{handle:f.header.mediaHandle,url:f.header.mediaUrl}}:l&&(o!=null&&o.mediaUrls)&&(xe.media_urls=o.mediaUrls),l){const{error:Ce}=await ge.from(Re).update({category:f.category.toLowerCase(),language:f.language,body:xe,updated_at:new Date().toISOString()}).eq("agent_id",i).eq("name",R);Ce&&console.error("Cache update error:",Ce)}else{const{error:Ce}=await ge.from(Re).insert({agent_id:i,name:V.name,category:f.category.toLowerCase(),language:V.language,body:xe,is_active:!0,created_at:new Date().toISOString()});Ce&&console.error("Cache insert error:",Ce)}t()}catch(X){u(X.message||"Failed to submit template"),console.error("Submit template error:",X)}};if(!e)return null;const I=/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,T=[...f.header.type==="TEXT"&&f.header.text?[f.header.text]:[],f.body,...f.footer?[f.footer]:[]].join(`
`);let D=[],C=0;T.split(`
`).forEach((A,R)=>{let H=0;[...A.matchAll(I)].forEach(W=>{D.push({param:W[1],index:C+H}),H+=W.index+W[0].length}),C+=A.length});const P=new Set,F=D.sort((A,R)=>A.index-R.index).filter(A=>P.has(A.param)?!1:(P.add(A.param),!0)).map(A=>A.param);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:l?"Edit Template":"Create New Template"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(xp,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsxs("div",{className:"w-3/5 overflow-y-auto pr-4 space-y-4",children:[c&&a.jsx("div",{className:"text-red-500 text-sm mb-4 p-2 bg-red-50 rounded border border-red-200",children:c}),a.jsxs("form",{onSubmit:U,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",name:"name",value:f.name,onChange:l?b:y,required:!l,disabled:l,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:"e.g., welcome_message (lowercase, use _ for spaces)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{name:"category",value:f.category,onChange:b,required:!0,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"UTILITY",children:"Utility"}),a.jsx("option",{value:"MARKETING",children:"Marketing"}),a.jsx("option",{value:"AUTHENTICATION",children:"Authentication"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Language"}),a.jsxs("select",{name:"language",value:f.language,onChange:b,required:!0,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"en_US",children:"English"}),a.jsx("option",{value:"si",children:"Sinhala"}),a.jsx("option",{value:"ta",children:"Tamil"})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Header"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("select",{value:f.header.type,onChange:A=>h(R=>({...R,header:{...R.header,type:A.target.value}})),className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"TEXT",children:"Text"}),a.jsx("option",{value:"MEDIA",children:"Media"}),(f.category==="UTILITY"||f.category==="MARKETING")&&a.jsx("option",{value:"LOCATION",children:"Location"})]}),f.header.type==="TEXT"?a.jsx("textarea",{value:f.header.text,onChange:A=>h(R=>({...R,header:{...R.header,text:A.target.value}})),placeholder:"Header text (optional). Use {{param_name}} for variables.",rows:2,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):f.header.type==="LOCATION"?a.jsx("div",{className:"p-4 bg-blue-50 rounded border border-blue-200",children:a.jsx("p",{className:"text-sm text-blue-700",children:"Location header selected. Location details (latitude, longitude, name, address) will be provided when sending the message via the API."})}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("select",{value:f.header.mediaType||"",onChange:A=>h(R=>({...R,header:{...R.header,mediaType:A.target.value}})),className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select media type"}),a.jsx("option",{value:"IMAGE",children:"Image"}),a.jsx("option",{value:"VIDEO",children:"Video"}),a.jsx("option",{value:"DOCUMENT",children:"Document"})]}),f.header.mediaType&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Upload ",f.header.mediaType.toLowerCase()," ","file to WhatsApp"]}),a.jsx("input",{type:"file",accept:_(f.header.mediaType),onChange:$,disabled:d,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),d&&a.jsx("p",{className:"text-sm text-blue-500 mt-1",children:"Uploading to WhatsApp..."}),f.header.mediaHandle&&!d&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Uploaded to WhatsApp (handle:"," ",f.header.mediaHandle.substring(0,8),"...)"]}),f.header.mediaUrl&&a.jsx("p",{className:"text-sm text-green-500 mt-1",children:"Preview ready"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Body Text"}),a.jsx("textarea",{name:"body",value:f.body,onChange:b,required:!0,rows:4,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Enter the template body text. Use {{param_name}} for variables."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Footer"}),a.jsx("textarea",{value:f.footer,onChange:A=>h(R=>({...R,footer:A.target.value})),placeholder:"Footer text (optional). Use {{param_name}} for variables.",rows:2,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),F.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sample Values for Variables (Header, Body, Footer)"}),a.jsx("div",{className:"space-y-2",children:F.map(A=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-500 self-center",children:`{{${A}}}`}),a.jsx("input",{type:"text",value:f.examples[A]||"",onChange:R=>j(A,R.target.value),placeholder:`Sample for {{${A}}}`,className:"flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]},A))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buttons (max 3)"}),a.jsxs("div",{className:"space-y-3",children:[f.buttons.map((A,R)=>a.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Button ",R+1]}),a.jsx("button",{type:"button",onClick:()=>h(H=>({...H,buttons:H.buttons.filter((W,M)=>M!==R)})),className:"text-red-500 hover:text-red-700 text-sm",children:"Remove"})]}),a.jsxs("select",{value:A.type,onChange:H=>h(W=>({...W,buttons:W.buttons.map((M,G)=>G===R?{...M,type:H.target.value}:M)})),className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 mb-2",children:[a.jsx("option",{value:"PHONE_NUMBER",children:"Call to Action (Phone)"}),a.jsx("option",{value:"URL",children:"URL Button"}),a.jsx("option",{value:"QUICK_REPLY",children:"Quick Reply"})]}),a.jsx("input",{type:"text",value:A.text,onChange:H=>h(W=>({...W,buttons:W.buttons.map((M,G)=>G===R?{...M,text:H.target.value}:M)})),placeholder:"Button text",className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 mb-2",required:!0}),A.type==="PHONE_NUMBER"&&a.jsx("input",{type:"tel",value:A.phoneNumber||"",onChange:H=>h(W=>({...W,buttons:W.buttons.map((M,G)=>G===R?{...M,phoneNumber:H.target.value}:M)})),placeholder:"Phone number (e.g., +1234567890)",className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 mb-2"}),A.type==="URL"&&a.jsx("input",{type:"url",value:A.url||"",onChange:H=>h(W=>({...W,buttons:W.buttons.map((M,G)=>G===R?{...M,url:H.target.value}:M)})),placeholder:"URL (e.g., https://example.com)",className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 mb-2"}),A.type==="QUICK_REPLY"&&a.jsx("input",{type:"text",value:A.payload||"",onChange:H=>h(W=>({...W,buttons:W.buttons.map((M,G)=>G===R?{...M,payload:H.target.value}:M)})),placeholder:"Payload (for quick reply)",className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 mb-2"})]},R)),f.buttons.length<3&&a.jsx("button",{type:"button",onClick:()=>h(A=>({...A,buttons:[...A.buttons,{type:"QUICK_REPLY",text:"",payload:""}]})),className:"w-full p-2 border-2 border-dashed border-gray-300 rounded text-gray-600 hover:border-blue-500 hover:text-blue-600",children:"+ Add Button"}),f.buttons.length>=3&&a.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 buttons allowed."})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2",children:[a.jsx(y$,{className:"h-4 w-4"}),l?"Update":"Create"]})]})]})]}),a.jsxs("div",{className:"w-2/5 pl-4 border-l border-gray-200 overflow-y-auto",children:[a.jsx("h3",{className:"text-lg font-medium mb-4",children:"Live Preview"}),a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsx("div",{className:"max-w-md mx-auto",children:a.jsxs("div",{className:"mt-2 bg-gray-50 border border-gray-200 rounded-lg shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 border-b border-gray-100",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Your template"}),a.jsx("span",{className:"text-xs text-gray-500",children:"Template"})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:a.jsxs("div",{className:"bg-white rounded-2xl mb-3 border border-gray-200",children:[f.header.type==="LOCATION"?a.jsx("div",{className:"w-full h-32 bg-blue-100 rounded-t-2xl flex items-center justify-center",children:a.jsx("span",{className:"text-sm text-blue-600",children:" Location Map"})}):f.header.type==="MEDIA"&&f.header.mediaType&&f.header.mediaUrl?a.jsx(a.Fragment,{children:f.header.mediaType==="IMAGE"?a.jsx("img",{src:f.header.mediaUrl,alt:"Header media",className:"w-full h-auto object-contain rounded-t-2xl",onError:A=>{A.currentTarget.style.display="none"}}):f.header.mediaType==="VIDEO"?a.jsx("video",{src:f.header.mediaUrl,className:"w-full h-auto object-contain rounded-t-2xl",muted:!0,controls:!1}):a.jsx("div",{className:"w-full h-32 bg-gray-200 rounded-t-2xl flex items-center justify-center border-b border-gray-300",children:a.jsxs("span",{className:"text-sm text-gray-500",children:[f.header.mediaType," preview"]})})}):f.header.type==="MEDIA"?a.jsx("div",{className:"p-3 flex items-center justify-center border border-gray-300 bg-gray-100 rounded-t-2xl",children:a.jsx("span",{className:"text-sm text-gray-500",children:"Media header (upload required)"})}):null,a.jsxs("div",{className:"p-3",children:[f.header.type==="TEXT"&&f.header.text&&a.jsx("p",{className:"text-sm text-gray-800 font-medium mb-2 leading-relaxed whitespace-pre-wrap text-left",children:f.header.text.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,(A,R)=>f.examples[R]||"[Variable]")}),a.jsx("p",{className:"text-sm text-gray-800 leading-relaxed whitespace-pre-wrap mb-2 text-left",children:f.body.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,(A,R)=>f.examples[R]||"[Variable]")||"Enter body text..."}),f.footer&&a.jsx("div",{className:"mb-2 text-xs text-gray-600 italic text-left",children:f.footer.replace(/\{\{([a-zA-Z_][a-zA-Z0-9_]*|\d+)\}\}/g,(A,R)=>f.examples[R]||"[Variable]")}),a.jsx("p",{className:"text-xs text-gray-400 text-right mb-3",children:"13:40"}),f.buttons.length>0&&a.jsx("div",{className:"border-t border-gray-200 mb-2"}),f.buttons.length>0&&a.jsx("div",{className:"space-y-1",children:f.buttons.map((A,R)=>a.jsxs("div",{className:"w-full flex items-center justify-center gap-2 py-2 text-blue-500 text-sm font-medium hover:text-blue-600 border-t border-gray-200 first:border-t-0 rounded-b-2xl last:rounded-b-2xl",children:[A.type==="PHONE_NUMBER"&&a.jsx(dC,{className:"h-4 w-4"}),A.type==="URL"&&a.jsx(iC,{className:"h-4 w-4"}),A.type==="QUICK_REPLY"&&a.jsx(oC,{className:"h-4 w-4"}),a.jsx("span",{children:A.text||`Button ${R+1}`})]},R))})]})]})})]})})})]})]})]})})},nZ=()=>{const[e,t]=g.useState([]),[r,n]=g.useState(!0),[s,i]=g.useState(null),[o,l]=g.useState(null),[c,u]=g.useState(null),[d,m]=g.useState(null),[f,h]=g.useState(null),[x,b]=g.useState(!1),[j,y]=g.useState({}),[_,w]=g.useState(!1),[S,E]=g.useState(null);g.useEffect(()=>{(async()=>{const A=await lb();A?(u(A.agent_prefix),A.id&&m(String(A.id))):(i("Agent not found. Please contact admin or log in as an agent."),n(!1))})()},[]),g.useEffect(()=>{c&&$()},[c]);const $=async(F=!1)=>{var A;if(!c){i("Agent not found"),n(!1);return}try{n(!0),i(null);const{data:{session:R}}=await ge.auth.getSession();if(!(R!=null&&R.user)){i("User not authenticated"),n(!1);return}const{data:H,error:W}=await ge.from("whatsapp_configuration").select("business_account_id, phone_number_id, api_key").eq("user_id",R.user.id).single();if(W||!H){i("No WhatsApp configuration found. Please set up WhatsApp first."),n(!1);return}l(H);const M=`${c}_templates`;if(!F){const{data:X,error:ne}=await ge.from(M).select("*").eq("is_active",!0);if(!ne&&X&&X.length>0){const le=X.map(de=>{var me,Le;const je=((me=de.body)==null?void 0:me.media_urls)||{};return{id:de.name,name:de.name,language:de.language,category:de.category,body:de.body,components:((Le=de.body)==null?void 0:Le.components)||[],mediaUrls:je,status:de.status||"APPROVED",created_time:de.created_at}});t(le),n(!1);return}}const{business_account_id:G,api_key:ce}=H,ue=`https://graph.facebook.com/v20.0/${G}/message_templates`,O=await fetch(ue,{method:"GET",headers:{Authorization:`Bearer ${ce}`}});if(!O.ok){const X=await O.json();throw new Error(`Meta API error: ${((A=X.error)==null?void 0:A.message)||O.statusText}`)}const ee=(await O.json()).data.map(X=>({...X,id:X.name,body:{name:X.name,language:{code:X.language},components:X.components}}));if(ee.length===0){t([]),n(!1);return}if(d){if(F){const{error:le}=await ge.from(M).update({is_active:!1}).eq("agent_id",d);le&&console.error("Deactivate templates error:",le)}const X=ee.map(le=>({agent_id:d,name:le.name,category:le.category.toLowerCase(),language:le.language,body:le.body,is_active:!0,updated_at:new Date().toISOString()})),{error:ne}=await ge.from(M).upsert(X,{onConflict:"agent_id,name"});ne&&console.error("Caching upsert error:",ne)}else console.warn("Skipping cache upsert due to missing agentId");t(ee),n(!1)}catch(R){i(R.message||"Failed to fetch templates"),n(!1),console.error("Templates fetch error:",R)}},U=async F=>{var A;if(confirm("Are you sure you want to delete this template? This action is permanent.")){if(!o||!c||!d){i("No WhatsApp configuration or agent found");return}try{const{business_account_id:R,api_key:H}=o,W=`https://graph.facebook.com/v20.0/${R}/message_templates?name=${F}`,M=await fetch(W,{method:"DELETE",headers:{Authorization:`Bearer ${H}`}});if(!M.ok){const ce=await M.json();throw new Error(`Meta API error: ${((A=ce.error)==null?void 0:A.message)||M.statusText}`)}t(ce=>ce.filter(ue=>ue.id!==F));const G=`${c}_templates`;if(d){const{error:ce}=await ge.from(G).delete().eq("agent_id",d).eq("name",F);ce&&console.error("Cache delete error:",ce)}else console.warn("Skipping cache delete due to missing agentId")}catch(R){i(R.message||"Failed to delete template"),console.error("Delete template error:",R)}}},I=F=>{E(F),w(!0)},T=F=>{const A=e.find(R=>R.id===F);A&&(h(A),b(!0))},D=(F,A)=>{t(A?R=>R.map(H=>H.id===(f==null?void 0:f.id)?F:H):R=>[...R,F]),h(null),b(!1)},C=async F=>{if(!o)return"";if(F.startsWith("http"))return F;try{const{api_key:A,phone_number_id:R}=o,H=new URL(`https://graph.facebook.com/v20.0/${R}/media/${F}`);H.searchParams.append("access_token",A);const W=await fetch(H.toString(),{method:"GET"});return W.ok&&(await W.json()).url||""}catch{return""}},P=async(F,A,R)=>{if(j[F])return;const H=await C(A);H&&y(W=>({...W,[F]:H}))};return g.useEffect(()=>{e.length>0&&o&&e.forEach(F=>{var R,H,W,M;const A=F.components.find(G=>G.type.toLowerCase()==="header");if(A!=null&&A.format&&["IMAGE","VIDEO","DOCUMENT"].includes(A.format)&&!((H=(R=F.mediaUrls)==null?void 0:R.header)!=null&&H.url)){let G="";const ce=(M=(W=A.example)==null?void 0:W.header_handle)==null?void 0:M[0];typeof ce=="string"?G=ce:typeof ce=="object"&&(G=ce.handle||ce.id||""),G&&!j[F.id]&&P(F.id,G)}})},[e,o]),r?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),a.jsx("p",{className:"mt-2 text-gray-500",children:"Loading templates..."})]}):s?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("p",{className:"text-red-500 mb-4",children:s}),a.jsx("button",{onClick:()=>$(!0),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]}):a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"WhatsApp Templates"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>$(!0),className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Refresh Templates"}),a.jsxs("button",{onClick:()=>{h(null),b(!0)},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2",children:[a.jsx(hC,{className:"h-4 w-4"}),"Create New"]})]})]}),o?e.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(F=>a.jsx("div",{className:"bg-white p-4 rounded-lg shadow border",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:F.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Category: ",F.category," | Language: ",F.language," | Status: ",F.status]})]}),a.jsxs("div",{className:"flex gap-2 ml-4",children:[a.jsx("button",{onClick:()=>I(F),className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded",title:"View template",children:a.jsx(uC,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>T(F.id),className:"p-2 text-green-500 hover:text-green-700 hover:bg-green-50 rounded",title:"Edit template",children:a.jsx(J$,{className:"h-4 w-4"})}),F.name!=="hello_world"&&a.jsx("button",{onClick:()=>U(F.id),className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded",title:"Delete template",children:a.jsx(aB,{className:"h-4 w-4"})})]})]})},F.id))}):a.jsx("div",{className:"text-center text-gray-500",children:"No templates found. Create some in your Meta WhatsApp Manager and refresh."}):a.jsx("div",{className:"text-center text-gray-500",children:"No WhatsApp configuration found. Please set up WhatsApp in settings."}),a.jsx(rZ,{isOpen:x,onClose:()=>b(!1),onSuccess:D,config:o,agentPrefix:c,agentId:d,initialTemplate:f,isEdit:!!f}),_&&a.jsx(C8,{isOpen:_,onClose:()=>w(!1),template:S,mediaPreviews:j,loadMediaPreview:P})]})},sZ=()=>{const[e,t]=g.useState([]),[r,n]=g.useState([]),[s,i]=g.useState(!0),[o,l]=g.useState(!1),[c,u]=g.useState(null),[d,m]=g.useState(""),[f,h]=g.useState(""),[x,b]=g.useState(!1),[j,y]=g.useState(!1),[_,w]=g.useState(!1),[S,E]=g.useState(null),[$,U]=g.useState(null),[I,T]=g.useState(!1),[D,C]=g.useState({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),[P,F]=g.useState([]),[A,R]=g.useState({name:"",description:"",color:"#000000"}),[H,W]=g.useState({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),[M,G]=g.useState([]),[ce,ue]=g.useState([]),[O,Z]=g.useState([]),B=async()=>{try{i(!0),u(null);const{data:{session:K}}=await ge.auth.getSession();if(!K){u("User not authenticated");return}const be=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"GET",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"}});if(!be.ok)throw new Error(`HTTP ${be.status}: ${be.statusText}`);const _e=await be.json();if(_e.error)throw new Error(_e.error);t(_e.items||[])}catch{u("Failed to load inventory items")}finally{i(!1)}},ee=async()=>{try{l(!0);const{data:{session:K}}=await ge.auth.getSession();if(!K)return;const be=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory?type=categories",{method:"GET",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"}});if(!be.ok)throw new Error(`HTTP ${be.status}: ${be.statusText}`);const _e=await be.json();if(_e.error)throw new Error(_e.error);n(_e.categories||[])}catch{u("Failed to load categories")}finally{l(!1)}};g.useEffect(()=>{B(),ee()},[]),g.useEffect(()=>{(x||S)&&ee()},[x,S]);const X=async()=>{if(D.name.trim())try{const{data:{session:K}}=await ge.auth.getSession();if(!K){u("User not authenticated");return}const{data:be,error:_e}=await ge.from("agents").select("id").eq("user_id",K.user.id).single();if(_e||!be){u("Agent not found");return}if(D.category_id&&!r.find(Ee=>Ee.id.toString()===D.category_id)){u("Invalid category selected");return}const re=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"POST",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({name:D.name.trim(),description:D.description.trim()||null,quantity:D.quantity?parseInt(D.quantity):0,price:D.price?parseFloat(D.price):0,category_id:D.category_id?parseInt(D.category_id):null,sku:D.sku.trim()||null,image_urls:null})}),De=await re.json();if(De.error)throw new Error(De.error);if(!re.ok)throw new Error(De.message||`HTTP ${re.status}`);const se=De.item_id;let Pe=[];if(P.length>0)try{Pe=await xe(be.id.toString(),se.toString(),P,K.access_token)}catch{u("Item created but failed to upload images"),b(!1),B();return}if(Pe.length>0){const Ee=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"PUT",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({id:se,image_urls:Pe})}),Ne=await Ee.json();Ee.ok||u("Item created and images uploaded but failed to link them")}b(!1),C({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),F([]),u(null),B()}catch{u("Failed to create inventory item")}},ne=async()=>{if(A.name.trim())try{const{data:{session:K}}=await ge.auth.getSession();if(!K){u("User not authenticated");return}const be=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"POST",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({type:"category",name:A.name.trim(),description:A.description.trim()||null,color:A.color})}),_e=await be.json();if(_e.error)throw new Error(_e.error);if(!be.ok)throw new Error(_e.message||`HTTP ${be.status}`);y(!1),R({name:"",description:"",color:"#000000"}),u(null),ee()}catch{u("Failed to create category")}},le=async()=>{if(!(!S||!H.name.trim()))try{const{data:{session:K}}=await ge.auth.getSession();if(!K){u("User not authenticated");return}const{data:be,error:_e}=await ge.from("agents").select("id").eq("user_id",K.user.id).single();if(_e||!be){u("Agent not found");return}if(H.category_id&&!r.find(Pe=>Pe.id.toString()===H.category_id)){u("Invalid category selected");return}let re=[];if(M.length>0)try{re=await xe(be.id.toString(),S.id.toString(),M,K.access_token)}catch{u("Failed to upload images");return}const De=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"PUT",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({id:S.id,name:H.name.trim(),description:H.description.trim()||null,quantity:H.quantity?parseInt(H.quantity):0,price:H.price?parseFloat(H.price):0,category_id:H.category_id?parseInt(H.category_id):null,sku:H.sku.trim()||null,image_urls:[...ce,...re],removed_image_urls:O})}),se=await De.json();if(se.error)throw new Error(se.error);if(!De.ok)throw new Error(se.message||`HTTP ${De.status}`);E(null),W({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),G([]),ue([]),Z([]),u(null),B()}catch{u("Failed to update inventory item")}},de=async()=>{if(!(!$||!A.name.trim()))try{const{data:{session:K}}=await ge.auth.getSession();if(!K){u("User not authenticated");return}const be=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory",{method:"PUT",headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({type:"category",id:$.id,name:A.name.trim()||null,description:A.description.trim()||null,color:A.color||null})}),_e=await be.json();if(_e.error)throw new Error(_e.error);if(!be.ok)throw new Error(_e.message||`HTTP ${be.status}`);w(!1),U(null),R({name:"",description:"",color:"#000000"}),u(null),ee()}catch{u("Failed to update category")}},je=async K=>{if(confirm(`Are you sure you want to delete "${K.name}"?`))try{const{data:{session:be}}=await ge.auth.getSession();if(!be){u("User not authenticated");return}const _e=await fetch(`https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory?id=${K.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${be.access_token}`,"Content-Type":"application/json"}}),re=await _e.json();if(re.error)throw new Error(re.error);if(!_e.ok)throw new Error(re.message||`HTTP ${_e.status}`);u(null),B()}catch{u("Failed to delete inventory item")}},me=async K=>{if(confirm(`Are you sure you want to delete "${K.name}"? This cannot be undone if no items are assigned.`))try{const{data:{session:be}}=await ge.auth.getSession();if(!be){u("User not authenticated");return}const _e=await fetch(`https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-inventory?type=category&id=${K.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${be.access_token}`,"Content-Type":"application/json"}}),re=await _e.json();if(re.error)throw new Error(re.error);if(!_e.ok)throw new Error(re.message||`HTTP ${_e.status}`);u(null),ee()}catch{u("Failed to delete category")}},Le=K=>{E(K),W({name:K.name,description:K.description||"",quantity:K.quantity.toString(),price:K.price.toString(),category_id:"",sku:K.sku||""}),G([]),ue(K.image_urls||[]),Z([]);const be=r.find(_e=>_e.name===K.category_name);be&&W(_e=>({..._e,category_id:be.id.toString()}))},ve=K=>{Z(be=>[...be,K]),ue(be=>be.filter(_e=>_e!==K))},he=K=>{U(K),R({name:K.name,description:K.description||"",color:K.color||"#000000"}),w(!0)},V=(K,be=1920,_e=1920)=>new Promise((re,De)=>{const se=new Image,Pe=new FileReader;Pe.onload=Ee=>{var Ne;se.src=(Ne=Ee.target)==null?void 0:Ne.result},Pe.onerror=De,Pe.readAsDataURL(K),se.onload=()=>{const Ee=document.createElement("canvas"),Ne=Ee.getContext("2d");let{width:Me,height:Ve}=se;Me>Ve?Me>be&&(Ve=Math.round(Ve*be/Me),Me=be):Ve>_e&&(Me=Math.round(Me*_e/Ve),Ve=_e),Ee.width=Me,Ee.height=Ve,Ne.drawImage(se,0,0,Me,Ve),Ee.toBlob($e=>{if($e){const Ye=new File([$e],K.name.replace(/\.[^/.]+$/,".jpg"),{type:"image/jpeg"});re(Ye)}else De(new Error("Failed to resize image"))},"image/jpeg",.9)},se.onerror=De}),Re=K=>new Promise((be,_e)=>{const re=new FileReader;re.onload=()=>be(re.result),re.onerror=_e,re.readAsDataURL(K)}),xe=async(K,be,_e,re)=>{if(_e.length===0)return[];const De=await Promise.all(_e.map(async Ee=>{const Ne=await V(Ee,1920,1920),Me=await Re(Ne);return{fileName:Ne.name,fileBase64:Me,fileType:Ne.type}})),Pe=await(await fetch("https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/upload-inventory-images",{method:"POST",headers:{Authorization:`Bearer ${re}`,"Content-Type":"application/json"},body:JSON.stringify({agentId:parseInt(K),productId:parseInt(be),images:De})})).json();if(!Pe.success)throw new Error(Pe.error||"Upload failed");return Pe.urls},Ce=K=>new Intl.NumberFormat("en-LK",{style:"currency",currency:"LKR"}).format(K),fe=e.filter(K=>{var be,_e;return K.name.toLowerCase().includes(d.toLowerCase())||((be=K.sku)==null?void 0:be.toLowerCase().includes(d.toLowerCase()))||((_e=K.category_name)==null?void 0:_e.toLowerCase().includes(d.toLowerCase()))}),We=r.filter(K=>K.name.toLowerCase().includes(f.toLowerCase())),Oe=r.length>0,nt=Oe?null:"No categories yet. Add one to organize your inventory.";return s?a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Inventory"}),a.jsxs("p",{className:"text-gray-600 mt-1",children:[fe.length," items | ",r.length," categories"]})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("button",{onClick:()=>T(!I),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),a.jsxs("span",{children:[I?"Hide":"Show"," Categories"]})]}),a.jsxs("button",{onClick:()=>b(!0),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center space-x-2",disabled:!Oe,children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),a.jsx("span",{children:"Add Item"})]}),a.jsx("button",{onClick:()=>y(!0),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200",children:"Add Category"})]})]}),c&&a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6",children:["Error: ",c]}),I&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Categories"}),a.jsx("input",{type:"text",placeholder:"Search categories...",value:f,onChange:K=>h(K.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 max-w-md"})]}),o?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):We.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No categories"}),a.jsx("p",{className:"text-gray-500",children:"Start by adding your first category"})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Color"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:We.map(K=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.name})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 max-w-xs truncate",children:K.description||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K.item_count}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:K.color}})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(K.created_at).toLocaleDateString()}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsx("button",{onClick:()=>he(K),className:"text-indigo-600 hover:text-indigo-900 mr-3","aria-label":"Edit category",children:"Edit"}),a.jsx("button",{onClick:()=>me(K),className:"text-red-600 hover:text-red-900","aria-label":"Delete category",children:"Delete"})]})]},K.id))})]})})})]}),a.jsx("div",{className:"mb-6",children:a.jsx("input",{type:"text",placeholder:"Search inventory by name, SKU, or category...",value:d,onChange:K=>m(K.target.value),className:"w-full max-w-md px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-200"})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:fe.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:d?"No items found":"No inventory items yet"}),a.jsx("p",{className:"text-gray-500",children:d?`No items match "${d}"`:Oe?"Start adding items to your inventory":nt}),!Oe&&a.jsx("button",{onClick:()=>y(!0),className:"mt-4 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700",children:"Add First Category"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:fe.map(K=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:K.image_urls&&K.image_urls.length>0?a.jsx("img",{className:"h-10 w-10 rounded-lg object-cover",src:K.image_urls[0],alt:K.name}):a.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center",children:a.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M4 4h16v16H4z"})})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.name}),K.description&&a.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:K.description})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K.sku||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K.category_name||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${K.quantity>10?"bg-green-100 text-green-800":K.quantity>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:K.quantity})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:Ce(K.price)}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsx("button",{onClick:()=>Le(K),className:"text-indigo-600 hover:text-indigo-900 transition-colors mr-3","aria-label":"Edit item",children:"Edit"}),a.jsx("button",{onClick:()=>je(K),className:"text-red-600 hover:text-red-900 transition-colors","aria-label":"Delete item",children:"Delete"})]})]},K.id))})]})})}),x&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Add New Item"}),a.jsx("button",{onClick:()=>{b(!1),C({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),F([])},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:K=>{K.preventDefault(),X()},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name"}),a.jsx("input",{type:"text",value:D.name,onChange:K=>C({...D,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Enter item name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:D.description,onChange:K=>C({...D,description:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Enter description (optional)",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),a.jsx("input",{type:"number",value:D.quantity,onChange:K=>C({...D,quantity:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (LKR)"}),a.jsx("input",{type:"number",value:D.price,onChange:K=>C({...D,price:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0.00",min:"0",step:"0.01"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:D.category_id,onChange:K=>C({...D,category_id:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"",children:"No Category"}),r.map(K=>a.jsx("option",{value:K.id,children:K.name},K.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU (optional)"}),a.jsx("input",{type:"text",value:D.sku,onChange:K=>C({...D,sku:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Enter SKU"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Images (optional)"}),a.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:K=>F(Array.from(K.target.files||[])),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none"}),P.length>0&&a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[P.length," image(s) selected"]})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-md font-medium transition-colors flex-1",children:"Create Item"}),a.jsx("button",{type:"button",onClick:()=>{b(!1),C({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),F([])},className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md font-medium transition-colors",children:"Cancel"})]})]})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Add New Category"}),a.jsx("button",{onClick:()=>{y(!1),R({name:"",description:"",color:"#000000"})},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:K=>{K.preventDefault(),ne()},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),a.jsx("input",{type:"text",value:A.name,onChange:K=>R({...A,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter category name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),a.jsx("textarea",{value:A.description,onChange:K=>R({...A,description:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter description",rows:3})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),a.jsx("input",{type:"color",value:A.color,onChange:K=>R({...A,color:K.target.value}),className:"w-full h-10 border border-gray-300 rounded-md cursor-pointer"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-md font-medium transition-colors flex-1",children:"Create Category"}),a.jsx("button",{type:"button",onClick:()=>{y(!1),R({name:"",description:"",color:"#000000"})},className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md font-medium transition-colors",children:"Cancel"})]})]})]})}),S&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Edit Item"}),a.jsx("button",{onClick:()=>{E(null),W({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),G([]),ue([]),Z([])},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:K=>{K.preventDefault(),le()},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name"}),a.jsx("input",{type:"text",value:H.name,onChange:K=>W({...H,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:H.description,onChange:K=>W({...H,description:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),a.jsx("input",{type:"number",value:H.quantity,onChange:K=>W({...H,quantity:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (LKR)"}),a.jsx("input",{type:"number",value:H.price,onChange:K=>W({...H,price:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:H.category_id,onChange:K=>W({...H,category_id:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"No Category"}),r.map(K=>a.jsx("option",{value:K.id,children:K.name},K.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU"}),a.jsx("input",{type:"text",value:H.sku,onChange:K=>W({...H,sku:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Images (optional)"}),a.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:K=>G(Array.from(K.target.files||[])),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none"}),M.length>0&&a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[M.length," new image(s) selected"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ce.map((K,be)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:K,alt:"Current",className:"w-20 h-20 object-cover rounded"}),a.jsx("button",{onClick:()=>ve(K),className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs cursor-pointer border-none hover:bg-red-600",type:"button",children:""})]},be))}),O.length>0&&a.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Removed ",O.length," image(s). They will be deleted on save."]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Click  to remove images"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md font-medium transition-colors flex-1",children:"Update Item"}),a.jsx("button",{type:"button",onClick:()=>{E(null),W({name:"",description:"",quantity:"",price:"",category_id:"",sku:""}),G([]),ue([]),Z([])},className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md font-medium transition-colors",children:"Cancel"})]})]})]})}),_&&$&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Edit Category"}),a.jsx("button",{onClick:()=>{w(!1),U(null),R({name:"",description:"",color:"#000000"})},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:K=>{K.preventDefault(),de()},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),a.jsx("input",{type:"text",value:A.name,onChange:K=>R({...A,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:A.description,onChange:K=>R({...A,description:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),a.jsx("input",{type:"color",value:A.color,onChange:K=>R({...A,color:K.target.value}),className:"w-full h-10 border border-gray-300 rounded-md cursor-pointer"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-md font-medium transition-colors flex-1",children:"Update Category"}),a.jsx("button",{type:"button",onClick:()=>{w(!1),U(null),R({name:"",description:"",color:"#000000"})},className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md font-medium transition-colors",children:"Cancel"})]})]})]})})]})},iZ=()=>{const[e,t]=g.useState([]),[r,n]=g.useState(!0),[s,i]=g.useState(null),l="https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/manage-appointments",c=g.useCallback(async(f={})=>{try{n(!0),i(null);const{data:{session:h}}=await ge.auth.getSession();if(!h)throw new Error("Not authenticated");const x=new URL(l);f.customerId!==void 0&&f.customerId!==null&&x.searchParams.set("customer_id",f.customerId.toString()),f.status&&x.searchParams.set("status",f.status),f.startDate&&x.searchParams.set("start_date",f.startDate),f.endDate&&x.searchParams.set("end_date",f.endDate),f.limit&&x.searchParams.set("limit",f.limit.toString()),f.offset&&x.searchParams.set("offset",f.offset.toString());const b=await fetch(x.toString(),{method:"GET",headers:{Authorization:`Bearer ${h.access_token}`}});if(!b.ok){const y=await b.json().catch(()=>({}));throw new Error(y.error||`HTTP ${b.status}: ${b.statusText}`)}const j=await b.json();if(j.error)throw new Error(j.error);t(j.appointments||[])}catch(h){i(h.message||"Failed to fetch appointments"),console.error("Fetch appointments error:",h),t([])}finally{n(!1)}},[l]);g.useEffect(()=>{c()},[c]);const u=g.useCallback(async f=>{try{i(null);const{data:{session:h}}=await ge.auth.getSession();if(!h)throw new Error("Not authenticated");const x=await fetch(l,{method:"POST",headers:{Authorization:`Bearer ${h.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(f)});if(!x.ok){const j=await x.json().catch(()=>({}));throw new Error(j.error||`HTTP ${x.status}: ${x.statusText}`)}const b=await x.json();if(!b.success)throw new Error(b.message||"Failed to create appointment");return await c(),b.appointment_id}catch(h){throw i(h.message||"Failed to create appointment"),console.error("Create appointment error:",h),h}},[l,c]),d=g.useCallback(async(f,h)=>{try{i(null);const x={id:f,...h},{data:{session:b}}=await ge.auth.getSession();if(!b)throw new Error("Not authenticated");const j=await fetch(l,{method:"PUT",headers:{Authorization:`Bearer ${b.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(x)});if(!j.ok){const _=await j.json().catch(()=>({}));throw new Error(_.error||`HTTP ${j.status}: ${j.statusText}`)}const y=await j.json();if(!y.success)throw new Error(y.message||"Failed to update appointment");await c()}catch(x){throw i(x.message||"Failed to update appointment"),console.error("Update appointment error:",x),x}},[l,c]),m=g.useCallback(async f=>{try{i(null);const{data:{session:h}}=await ge.auth.getSession();if(!h)throw new Error("Not authenticated");const x=await fetch(`${l}?id=${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${h.access_token}`}});if(!x.ok){const j=await x.json().catch(()=>({}));throw new Error(j.error||`HTTP ${x.status}: ${x.statusText}`)}const b=await x.json();if(!b.success)throw new Error(b.message||"Failed to delete appointment");await c()}catch(h){throw i(h.message||"Failed to delete appointment"),console.error("Delete appointment error:",h),h}},[l,c]);return{appointments:e,loading:r,error:s,refetch:c,createAppointment:u,updateAppointment:d,deleteAppointment:m}},Px={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1,delayChildren:.2}}},Tx={hidden:{opacity:0,y:20},visible:e=>({opacity:1,y:0,transition:{duration:.6,delay:e*.15,ease:[.25,.46,.45,.94]}})},aZ={hidden:{opacity:0,y:10},visible:e=>({opacity:1,y:0,transition:{duration:.4,delay:e*.05,ease:"easeOut"}})},oZ={hidden:{y:10,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5,delay:.4}}},lZ={hidden:{x:-10,opacity:0},visible:{x:0,opacity:1,transition:{duration:.3,delay:.6}}},R3={hidden:{scale:.95,opacity:0},visible:{scale:1,opacity:1,transition:{duration:.2,delay:.9}}},F3={hidden:{},visible:{transition:{staggerChildren:.1}}},cZ=()=>{var _e;const{appointments:e,loading:t,error:r,refetch:n,createAppointment:s,updateAppointment:i,deleteAppointment:o}=iZ(),[l,c]=g.useState(null),[u,d]=g.useState(null),[m,f]=g.useState(""),[h,x]=g.useState(""),[b,j]=g.useState(""),[y,_]=g.useState([]),[w,S]=g.useState(!1),[E,$]=g.useState(null),[U,I]=g.useState(!1),[T,D]=g.useState({}),[C,P]=g.useState(""),[F,A]=g.useState(!1),[R,H]=g.useState(null),[W,M]=g.useState(!1),[G,ce]=g.useState(null),[ue,O]=g.useState(!1),[Z,B]=g.useState(null),[ee,X]=g.useState(null),ne=g.useCallback(async()=>{try{const{data:{user:re}}=await ge.auth.getUser();if(!re)return;const{data:De,error:se}=await ge.from("agents").select("id, agent_prefix").eq("user_id",re.id).single();if(se||!De||(c(Number(De.id)),d(De.agent_prefix),!De.agent_prefix))return;const Pe=`${De.agent_prefix}_customers`,{data:Ee,error:Ne}=await ge.from(Pe).select("id, name, phone").eq("agent_id",De.id);if(Ne)return;_(Ee||[]),D((Ee==null?void 0:Ee.reduce((Me,Ve)=>(Me[Ve.id]=Ve,Me),{}))||{})}catch(re){console.error("Error fetching agent info:",re)}},[]),le=g.useCallback(async()=>{var De;const re=h?(De=y.find(se=>se.name===h))==null?void 0:De.id:null;await n({customerId:re,status:b||null,limit:50,offset:0})},[h,b,y,n]),de=re=>{H(re),A(!0)},je=re=>{ce(re),M(!0)},me=async()=>{if(Z)try{await o(Z.id),le()}catch(re){console.error("Delete error:",re)}finally{O(!1),B(null)}},Le=async(re,De)=>{X(re);try{await i(re,{status:De})}catch(se){console.error("Update error:",se),alert("Failed to update status")}finally{X(null)}},ve=()=>{O(!1),B(null)},he=re=>{$(re),I(!1),S(!0)},V=()=>{le(),S(!1),$(null)},Re=()=>{le(),M(!1),ce(null)},xe=()=>{A(!1),H(null)};g.useEffect(()=>{ne()},[ne]),g.useEffect(()=>{u&&le()},[le,u]);const Ce=[{value:"",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],fe=re=>re?re.charAt(0).toUpperCase()+re.slice(1).toLowerCase():"",We=e.length,Oe=e.filter(re=>re.status.toLowerCase()==="pending").length,nt=e.filter(re=>new Date(re.appointment_date)>new Date&&re.status!=="cancelled").length,K=e.filter(re=>{var Ee;const De=m===""||((Ee=re.customer_name)==null?void 0:Ee.toLowerCase().includes(m.toLowerCase()))||re.title.toLowerCase().includes(m.toLowerCase())||re.status.toLowerCase().includes(m.toLowerCase()),se=h===""||re.customer_name===h,Pe=b===""||re.status.toLowerCase()===b;return De&&se&&Pe});if(t)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})});const be=re=>{const De=re.toLowerCase();return De==="pending"?"bg-yellow-100 text-yellow-800":De==="confirmed"?"bg-blue-100 text-blue-800":De==="completed"?"bg-green-100 text-green-800":De==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"};return a.jsxs(a.Fragment,{children:[w&&E&&a.jsx(pC,{customer:E,createAppointment:s,onClose:()=>{S(!1),$(null)},onSuccess:V}),F&&R&&a.jsx(gC,{appointment:R,onClose:xe}),W&&G&&a.jsx(xC,{appointment:G,updateAppointment:i,onClose:()=>{M(!1),ce(null)},onSuccess:Re}),ue&&Z&&a.jsxs("div",{className:"fixed inset-0 z-[40] flex items-center justify-center p-4",children:[a.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50",onClick:ve}),a.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-md p-6 z-50",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Appointment"}),a.jsxs("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete the appointment "',Z.title,'" for'," ",Z.customer_name,"?",a.jsx("br",{}),"This action cannot be undone."]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{onClick:ve,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:me,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Delete"})]})]})]}),a.jsxs(Qe.div,{className:"p-6 flex flex-col flex-1 min-h-0",variants:Px,initial:"hidden",animate:"visible",children:[a.jsxs(Qe.div,{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",variants:F3,initial:"hidden",animate:"visible",children:[a.jsxs(Qe.div,{variants:Tx,custom:0,initial:"hidden",animate:"visible",className:"bg-white p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Appointments"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:We})]}),a.jsxs(Qe.div,{variants:Tx,custom:1,initial:"hidden",animate:"visible",className:"bg-white p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Pending"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600 mt-2",children:Oe})]}),a.jsxs(Qe.div,{variants:Tx,custom:2,initial:"hidden",animate:"visible",className:"bg-white p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Upcoming"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:nt})]})]}),r&&a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6 animate-in fade-in-0 duration-300",children:["Error: ",r]}),a.jsx(Qe.div,{className:"mb-6 bg-white p-4 rounded-xl border border-gray-200",variants:oZ,initial:"hidden",animate:"visible",children:a.jsxs(Qe.div,{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",variants:F3,initial:"hidden",animate:"visible",children:[a.jsx("div",{children:a.jsx("input",{type:"text",placeholder:"Search appointments by customer, title, or status...",value:m,onChange:re=>f(re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})}),a.jsx("div",{children:a.jsxs("select",{value:h,onChange:re=>x(re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Customers"}),y.map((re,De)=>a.jsx("option",{value:re.name,children:re.name},De))]})}),a.jsx(Qe.div,{variants:lZ,initial:"hidden",animate:"visible",children:a.jsxs(yr,{as:"div",className:"relative",children:[a.jsxs(yr.Button,{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white text-left flex justify-between items-center",children:[((_e=Ce.find(re=>re.value===b))==null?void 0:_e.label)||"All Statuses",a.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"absolute right-0 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg z-10 max-h-60 overflow-auto",children:Ce.map(re=>a.jsx(yr.Item,{children:({active:De})=>a.jsx("button",{className:`w-full text-left px-4 py-2 text-sm ${De?"bg-gray-100":""} ${b===re.value?"bg-green-50 text-green-700":""}`,onClick:()=>j(re.value),children:re.label})},re.value))})})]})}),a.jsxs(Qe.div,{variants:R3,initial:"hidden",animate:"visible",className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{x(""),j(""),f("")},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:"Clear Filters",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsxs(Qe.button,{variants:R3,initial:"hidden",animate:"visible",whileHover:{scale:1.05},onClick:()=>I(!0),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create Appointment"]})]})]})}),a.jsx(Qe.div,{className:"flex-1 bg-white rounded-xl shadow-sm border border-gray-200 relative h-full",variants:Px,initial:"hidden",animate:"visible",children:K.length===0?a.jsxs(Qe.div,{className:"text-center py-16 h-full flex flex-col items-center justify-center space-y-6",variants:Px,initial:"hidden",animate:"visible",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-50 to-blue-50 rounded-full flex items-center justify-center mx-auto mb-6 p-4",children:a.jsx("svg",{className:"w-10 h-10 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),a.jsxs("div",{className:"max-w-md space-y-3",children:[a.jsx("h3",{className:"text-2xl font-semibold text-gray-900",children:e.length===0?"No appointments yet":"No matching appointments"}),a.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.length===0?"Get started by scheduling your first appointment with a customer to manage your bookings effectively.":m?`No appointments match "${m}". Try a different search term.`:"No appointments match your current filters. Adjust your criteria or clear all filters to see more results."})]}),e.length===0&&a.jsxs(Qe.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>I(!0),className:"inline-flex items-center px-6 py-3 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Schedule First Appointment"]})]}):a.jsx("div",{className:"h-full flex flex-col",children:a.jsx("div",{className:"overflow-visible flex-1",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0 z-20",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Appointment #"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map((re,De)=>{var se;return a.jsxs(Qe.tr,{variants:aZ,custom:De,initial:"hidden",animate:"visible",className:"hover:bg-gray-50 transition-colors duration-150",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",re.id.toString().padStart(4,"0")]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap relative",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:((se=re.customer_name)==null?void 0:se.charAt(0).toUpperCase())||"?"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:re.customer_name}),a.jsx("div",{className:"text-sm text-gray-500",children:re.customer_phone})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re.title}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(re.appointment_date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[re.duration_minutes," min"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs(yr,{as:"div",className:"relative inline-block text-left",children:[a.jsx(yr.Button,{disabled:ee===re.id,className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${be(re.status)} ${ee===re.id?"opacity-50 cursor-not-allowed":""}`,children:ee===re.id?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-1"}),"Updating..."]}):a.jsxs(a.Fragment,{children:[fe(re.status),a.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"absolute left-0 mt-2 w-48 origin-top-right bg-white divide-y divide-gray-100 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[10000] border border-gray-200",children:Ce.filter(Pe=>Pe.value!=="").map(Pe=>a.jsx(yr.Item,{children:({active:Ee})=>a.jsx("button",{disabled:ee===re.id,className:`${Ee?"bg-gray-100":""} ${re.status===Pe.value?"bg-green-50 text-green-700":""} ${ee===re.id?"opacity-50 cursor-not-allowed":""} block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100`,onClick:()=>{confirm(`Change appointment status to ${Pe.label}?`)&&Le(re.id,Pe.value)},children:Pe.label})},Pe.value))})})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsx("button",{onClick:()=>de(re),className:"text-green-600 hover:text-green-900 mr-3 transition-colors",children:"View"}),a.jsx("button",{onClick:()=>je(re),className:"text-indigo-600 hover:text-indigo-900 mr-3 transition-colors",children:"Edit"}),a.jsx("button",{onClick:()=>{B(re),O(!0)},className:"text-red-600 hover:text-red-900 transition-colors",children:"Delete"})]})]},re.id)})})]})})})}),U&&a.jsxs("div",{className:"fixed inset-0 z-[40] flex items-center justify-center p-4",children:[a.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50",onClick:()=>I(!1)}),a.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-md max-h-[90vh] flex flex-col z-50",children:[a.jsxs("div",{className:"sticky top-0 bg-white p-6 pb-4 border-b border-gray-200 z-20",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Select Customer"}),a.jsx("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx(Gn,{value:E,onChange:he,children:a.jsxs("div",{className:"relative",children:[a.jsx(Gn.Input,{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",displayValue:re=>re?re.name:"",onChange:re=>P(re.target.value),placeholder:"Search customers by name or phone..."}),a.jsx(Gn.Options,{className:"absolute mt-1 max-h-96 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm z-10",children:(()=>{const re=C===""?Object.values(T):Object.values(T).filter(De=>{var se;return De.name.toLowerCase().includes(C.toLowerCase())||((se=De.phone)==null?void 0:se.includes(C.toLowerCase()))});return re.length===0&&Object.keys(T).length>0?a.jsx(Gn.Option,{value:null,className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-900",children:"No customers found."}):Object.keys(T).length===0?a.jsx(Gn.Option,{value:null,className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-900",children:"No customers available. Create some customers first."}):re.map(De=>a.jsx(Gn.Option,{className:({active:se})=>`relative cursor-default select-none py-2 pl-3 pr-9 ${se?"bg-blue-600 text-white":"text-gray-900"}`,value:De,children:({selected:se,active:Pe})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center ${Pe?"bg-blue-200":""}`,children:a.jsx("span",{className:`text-blue-600 font-medium text-sm ${Pe?"text-white":""}`,children:De.name.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:`block truncate ${se?"font-medium":"font-normal"} ${Pe?"text-white":"text-gray-900"}`,children:De.name}),a.jsx("span",{className:`text-sm block truncate ${Pe?"text-blue-100":"text-gray-500"}`,children:De.phone||"No phone"})]})]}),se?a.jsx("span",{className:`absolute inset-y-0 right-0 flex items-center pr-4 ${Pe?"text-white":"text-blue-600"}`,children:a.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):null]})},De.id))})()})]})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6 pt-0"})]})]})]})]})},uZ=()=>{const[e,t]=g.useState({totalCustomers:0,totalOrders:0,totalRevenue:0,pendingOrders:0,completedOrders:0,upcomingAppointments:0,totalAppointments:0,monthlyOrders:[],monthlyRevenue:[],orderStatuses:[]}),[r,n]=g.useState(!0),[s,i]=g.useState(null),l="https://itvaqysqzdmwhucllktz.supabase.co/functions/v1/get-analytics",c=g.useCallback(async()=>{try{n(!0),i(null);const{data:{session:u}}=await ge.auth.getSession();if(!u)throw new Error("Not authenticated");const d=await fetch(l,{method:"GET",headers:{Authorization:`Bearer ${u.access_token}`}});if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f.error||`HTTP ${d.status}: ${d.statusText}`)}const m=await d.json();if(!m.success)throw new Error(m.error||"Failed to fetch analytics");t(m.analytics)}catch(u){i(u.message||"Failed to fetch analytics"),console.error("Fetch analytics error:",u)}finally{n(!1)}},[l]);return g.useEffect(()=>{c()},[c]),{analytics:e,loading:r,error:s,refetch:c}},dZ=()=>a.jsx("div",{className:"flex items-center justify-center min-h-[200px] p-6",children:a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."})]})}),hZ=({profit:e,expense:t})=>{const r=e+t,n=r>0?e/r*100:0,s=100-n;return a.jsxs("div",{className:"relative w-32 h-32 mx-auto",children:[a.jsxs("svg",{viewBox:"0 0 36 36",className:"w-32 h-32",children:[a.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e5e7eb",strokeWidth:"3"}),a.jsx(Qe.path,{d:`M18 2.0845 a 15.9155 15.9155 0 0 1 ${n*.36} 31.831`,fill:"none",stroke:"url(#profitGradient)",strokeWidth:"3",strokeLinecap:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,ease:"easeOut"}}),a.jsx(Qe.path,{d:`M18 2.0845 a 15.9155 15.9155 0 0 1 ${(n+s)*.36} 31.831 a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:"url(#expenseGradient)",strokeWidth:"3",strokeLinecap:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,ease:"easeOut",delay:.5}}),a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:"profitGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[a.jsx("stop",{offset:"0%",style:{stopColor:"#10b981"}}),a.jsx("stop",{offset:"100%",style:{stopColor:"#059669"}})]}),a.jsxs("linearGradient",{id:"expenseGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[a.jsx("stop",{offset:"0%",style:{stopColor:"#ef4444"}}),a.jsx("stop",{offset:"100%",style:{stopColor:"#dc2626"}})]})]})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsxs("span",{className:"text-lg font-bold bg-gradient-to-r from-green-500 to-emerald-600 bg-clip-text text-transparent",children:[n.toFixed(0),"%"]})})]})},fZ=({data:e})=>{const t=Math.max(...e.map(r=>r.revenue),1);return a.jsx("div",{className:"relative h-48 flex items-end justify-around space-x-1 px-2",children:e.map((r,n)=>{const s=r.revenue/t*80;return a.jsxs(Qe.div,{className:"flex flex-col items-center space-y-1 w-8",initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.8,delay:n*.1},children:[a.jsx("div",{className:"bg-gradient-to-t from-blue-400 via-purple-500 to-indigo-600 rounded-lg w-full relative",style:{height:`${s}px`},children:a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs text-white bg-black bg-opacity-50 py-0.5 rounded-b-lg",children:["$",(r.revenue/1e3).toFixed(0),"k"]})}),a.jsx("span",{className:"text-xs text-gray-500 text-center w-8 block",children:r.month.slice(0,3)})]},r.month)})})},mZ=({data:e})=>{const t=Math.max(...e.map(i=>i.count),1),r=100,n=80,s=e.map((i,o)=>{const l=o/(e.length-1)*r,c=n-i.count/t*n;return`${l},${c}`}).join(" ");return a.jsxs("div",{className:"relative h-48 bg-gradient-to-b from-gray-50 to-white rounded-lg p-4",children:[a.jsxs("svg",{viewBox:`0 0 ${r} ${n}`,className:"w-full h-32 mx-auto",children:[a.jsx("polyline",{points:s,fill:"none",stroke:"url(#lineGradient)",strokeWidth:"3",strokeLinecap:"round",className:"animate-draw"}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[a.jsx("stop",{offset:"0%",style:{stopColor:"#3b82f6"}}),a.jsx("stop",{offset:"100%",style:{stopColor:"#8b5cf6"}})]})})]}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-2 text-xs text-gray-500 mt-2",children:e.map(i=>a.jsx("span",{children:i.month.slice(0,3)},i.month))})]})},pZ=({totalUsers:e})=>a.jsxs("div",{className:"relative h-48 flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg",children:[a.jsxs("svg",{viewBox:"0 0 200 100",className:"w-48 h-48",children:[a.jsx("path",{d:"M50 30 Q70 20 90 30 Q100 40 90 50 Q70 60 50 50 Z",fill:"#dbeafe",stroke:"#3b82f6",strokeWidth:"0.5"}),a.jsx("path",{d:"M110 40 Q130 30 150 40 Q160 50 150 60 Q130 70 110 60 Z",fill:"#dbeafe",stroke:"#3b82f6",strokeWidth:"0.5"}),[...Array(8)].map((t,r)=>a.jsx(Qe.circle,{cx:30+Math.random()*160,cy:20+Math.random()*60,r:"1.5",fill:"url(#dotGradient)",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{duration:.5,delay:r*.1},className:"animate-pulse"},r)),a.jsx("defs",{children:a.jsxs("radialGradient",{id:"dotGradient",cx:"50%",cy:"50%",r:"50%",children:[a.jsx("stop",{offset:"0%",style:{stopColor:"#3b82f6"}}),a.jsx("stop",{offset:"100%",style:{stopColor:"transparent"}})]})})]}),a.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-center",children:[a.jsx("p",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:e}),a.jsx("p",{className:"text-sm text-gray-500",children:"Active Users"})]})]}),gZ=()=>{const e=[{name:"Visa",icon:"M13 10V3L4 14h7v7l9-11h-7z",amount:1200,color:"from-blue-400 to-blue-600"},{name:"Mastercard",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z",amount:800,color:"from-red-400 to-red-600"},{name:"PayPal",icon:"M9 8.5h6v1h-6v-1zm0 3h6v1h-6v-1z",amount:500,color:"from-yellow-400 to-yellow-600"},{name:"Stripe",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-5.52 0-10-4.48-10-10S6.48 2 12 2s10 4.48 10 10-4.48 10-10 10z",amount:300,color:"from-purple-400 to-purple-600"}];return a.jsx("div",{className:"space-y-3",children:e.map((t,r)=>a.jsxs(Qe.div,{className:"flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-300",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.1,duration:.5},children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`p-2.5 rounded-full bg-gradient-to-br ${t.color} shadow-lg flex-shrink-0`,children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:t.icon})})}),a.jsx("span",{className:"font-semibold text-gray-900",children:t.name})]}),a.jsxs("span",{className:"font-bold text-lg bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:["$",t.amount.toLocaleString(),"+"]})]},t.name))})},xZ=()=>{const{analytics:e,loading:t,error:r}=uZ();if(t)return a.jsx(dZ,{});if(r)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-red-600",children:["Error loading analytics: ",r]})})});const n={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},s={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};return a.jsx(Qe.div,{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6",variants:n,initial:"hidden",animate:"visible",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs(Qe.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",variants:n,children:[a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Total Customers",value:e.totalCustomers.toString(),percentage:"+12%",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z",color:"from-emerald-400 to-green-600"})}),a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Total Orders",value:e.totalOrders.toString(),percentage:"+8%",icon:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z",color:"from-blue-400 to-blue-600"})}),a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Total Revenue",value:`$${e.totalRevenue.toLocaleString()}`,percentage:"+15%",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"from-purple-400 to-purple-600"})}),a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Pending Orders",value:e.pendingOrders.toString(),percentage:"-2%",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"from-amber-400 to-yellow-600"})}),a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Completed Orders",value:e.completedOrders.toString(),percentage:"+20%",icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",color:"from-emerald-400 to-green-600"})}),a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Upcoming Appointments",value:e.upcomingAppointments.toString(),percentage:"+5%",icon:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",color:"from-indigo-400 to-indigo-600"})}),a.jsx(Qe.div,{variants:s,children:a.jsx(sc,{title:"Total Appointments",value:e.totalAppointments.toString(),percentage:"+10%",icon:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",color:"from-blue-400 to-blue-600"})})]}),a.jsxs(Qe.div,{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",variants:n,initial:"hidden",animate:"visible",children:[a.jsxs(Qe.div,{variants:s,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-shadow duration-300",children:[a.jsx("h3",{className:"text-lg font-semibold bg-gradient-to-r from-green-500 to-emerald-600 bg-clip-text text-transparent mb-4",children:"Sales Overview"}),(()=>{const i=e.totalRevenue*.7,o=e.totalRevenue*.3;return a.jsxs(a.Fragment,{children:[a.jsx(hZ,{profit:i,expense:o}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 w-full",children:[a.jsxs("div",{className:"text-center p-2 bg-green-50 rounded-lg",children:[a.jsxs("p",{className:"text-xl font-bold text-green-600",children:["$",i.toLocaleString(),"+"]}),a.jsx("p",{className:"text-xs text-green-500",children:"Profit"})]}),a.jsxs("div",{className:"text-center p-2 bg-red-50 rounded-lg",children:[a.jsxs("p",{className:"text-xl font-bold text-red-600",children:["$",o.toLocaleString(),"+"]}),a.jsx("p",{className:"text-xs text-red-500",children:"Expense"})]})]})]})})()]}),a.jsxs(Qe.div,{variants:s,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-shadow duration-300",children:[a.jsx("h3",{className:"text-lg font-semibold bg-gradient-to-r from-blue-500 to-purple-600 bg-clip-text text-transparent mb-4",children:"Revenue Updates"}),a.jsx(fZ,{data:e.monthlyRevenue.slice(-6)})," "]}),a.jsxs(Qe.div,{variants:s,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-shadow duration-300",children:[a.jsx("h3",{className:"text-lg font-semibold bg-gradient-to-r from-indigo-500 to-purple-600 bg-clip-text text-transparent mb-4",children:"Yearly Sales"}),a.jsx(mZ,{data:e.monthlyOrders.slice(-12)})," "]})]}),a.jsxs(Qe.div,{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",variants:n,initial:"hidden",animate:"visible",children:[a.jsxs(Qe.div,{variants:s,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-shadow duration-300 order-2 lg:order-1",children:[a.jsx("h3",{className:"text-lg font-semibold bg-gradient-to-r from-blue-500 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Active Users"}),a.jsx(pZ,{totalUsers:e.totalCustomers})]}),a.jsxs(Qe.div,{variants:s,className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-shadow duration-300 order-1 lg:order-2",children:[a.jsx("h3",{className:"text-lg font-semibold bg-gradient-to-r from-purple-500 to-pink-600 bg-clip-text text-transparent mb-4",children:"Payment Gateways"}),a.jsx(gZ,{})]})]}),a.jsxs(Qe.div,{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-shadow duration-300 mt-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},whileHover:{scale:1.02},children:[a.jsx("h3",{className:"text-lg font-semibold bg-gradient-to-r from-purple-500 to-pink-600 bg-clip-text text-transparent mb-4",children:"Order Status Breakdown"}),a.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[a.jsxs("div",{className:"relative w-40 h-40",children:[e.orderStatuses.map((i,o)=>{const l=e.orderStatuses.reduce((m,f)=>m+f.count,0),c=l>0?i.count/l*360:0,d={pending:"from-yellow-400 to-yellow-600",completed:"from-green-400 to-green-600",in_progress:"from-blue-400 to-blue-600",unknown:"from-gray-400 to-gray-600"}[i.status]||"from-gray-400 to-gray-600";return a.jsx(Qe.div,{className:"absolute inset-0 rounded-full",style:{clipPath:`polygon(0 0, ${c}deg 0, 50% 50%)`,background:`linear-gradient(to right, ${d})`,zIndex:o},initial:{rotate:-180},animate:{rotate:c/2},transition:{duration:1.5,delay:o*.2}},i.status)}),a.jsx("div",{className:"w-24 h-24 bg-white rounded-full shadow-lg relative z-10 flex items-center justify-center border-4 border-white",children:a.jsx("span",{className:"text-xl font-bold text-gray-600",children:e.totalOrders})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 w-full",children:e.orderStatuses.map((i,o)=>a.jsxs(Qe.div,{className:"text-center p-3 bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg cursor-pointer hover:bg-gradient-to-br hover:from-purple-50 hover:to-pink-100 transition-all duration-300 flex items-center justify-center space-x-2",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:(o+2)*.1},whileHover:{scale:1.05,y:-2},children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${i.status==="pending"?"bg-yellow-500":i.status==="completed"?"bg-green-500":i.status==="in_progress"?"bg-blue-500":"bg-gray-500"}`}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-gray-900",children:i.count}),a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:i.status})]})]},i.status))})]})]})]})})},sc=({title:e,value:t,percentage:r,icon:n,color:s})=>a.jsxs(Qe.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-lg hover:border-transparent transition-all duration-300 relative overflow-hidden",whileHover:{y:-4,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.3},children:[a.jsx("div",{className:`absolute inset-0 bg-gradient-to-br opacity-5 ${s}`,"aria-hidden":"true"}),a.jsxs("div",{className:"relative flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:`p-3 rounded-full bg-gradient-to-br ${s} shadow-lg flex-shrink-0 border border-white/20 backdrop-blur-sm`,children:a.jsx("svg",{className:"w-6 h-6 text-white drop-shadow-md",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e}),a.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:t})]})]}),r&&a.jsx("span",{className:`text-sm font-semibold px-3 py-1.5 rounded-full shadow-sm ${r.startsWith("+")?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200"} whitespace-nowrap`,children:r})]})]}),vZ=()=>{const[e,t]=g.useState(null),[r,n]=g.useState(null),[s,i]=g.useState(!0),[o,l]=g.useState(!1),[c,u]=g.useState(""),[d,m]=g.useState(!1),[f,h]=g.useState(""),[x,b]=g.useState(!1),[j,y]=g.useState(""),[_,w]=g.useState(!1),[S,E]=g.useState(""),[$,U]=g.useState(!1),[I,T]=g.useState(""),[D,C]=g.useState(!1),[P,F]=g.useState(""),[A,R]=g.useState(""),[H,W]=g.useState(""),[M,G]=g.useState(null),[ce,ue]=g.useState(""),[O,Z]=g.useState(""),[B,ee]=g.useState(""),[X,ne]=g.useState(!1),[le,de]=g.useState(""),[je,me]=g.useState(!1),[Le,ve]=g.useState(null),[he,V]=g.useState(null),[Re,xe]=g.useState(!1),[Ce,fe]=g.useState(null),[We,Oe]=g.useState(null);g.useEffect(()=>{(async()=>{try{i(!0);const{data:{user:Me}}=await ge.auth.getUser();if(!Me){G("User not authenticated");return}t(Me);const{data:Ve,error:$e}=await ge.from("agents").select("id, address, business_email, contact_number, website, invoice_template_path, credits").eq("user_id",Me.id).single();if($e){G("Failed to fetch agent data"),console.error($e);return}const{data:Ye,error:pt}=await ge.from("users").select("name").eq("id",Me.id).single();if(pt){G("Failed to fetch user data"),console.error(pt);return}const{data:it,error:Je}=await ge.from("whatsapp_configuration").select("whatsapp_number").eq("user_id",Me.id).single();Je?(G("Failed to fetch whatsapp configuration"),console.error(Je)):(n({id:Ve.id,name:(Ye==null?void 0:Ye.name)||"Agent",whatsapp_number:(it==null?void 0:it.whatsapp_number)||"",address:Ve.address||"",business_email:Ve.business_email||"",contact_number:Ve.contact_number||"",website:Ve.website||"",invoice_template_path:Ve.invoice_template_path,credits:Ve.credits||0}),u((Ye==null?void 0:Ye.name)||"Agent"),h(Ve.address||""),y(Ve.business_email||""),E(Ve.contact_number||""),T(Ve.website||""),V(Ve.invoice_template_path||null))}catch(Me){G("Failed to load user data"),console.error(Me)}finally{i(!1)}})()},[]),g.useEffect(()=>{(async()=>{if(r!=null&&r.id){if(r.invoice_template_path){V(r.invoice_template_path||null);return}try{const{data:Me}=await ge.storage.from("agent-templates").list(`agents/${r.id}/`,{limit:1,search:"invoice-template"});if(Me&&Me.length>0){const Ve=Me[0],$e=`agents/${r.id}/${Ve.name}`;V($e),await ge.rpc("update_agent_template_path",{p_agent_id:r.id,p_template_path:$e,p_current_user_id:e==null?void 0:e.id})}}catch(Me){console.error("Failed to fetch template:",Me)}}})()},[r==null?void 0:r.id,e==null?void 0:e.id]),g.useEffect(()=>{(async()=>{if(!(r!=null&&r.id))return;const Me=`${r.id}/document.txt`;try{const{data:Ve,error:$e}=await ge.storage.from("knowledge-documents").download(Me);$e&&$e.message.includes("object not found")?Oe(null):Oe(Ve?Me:null)}catch(Ve){console.error("Failed to check document existence:",Ve),Oe(null)}})()},[r==null?void 0:r.id]);const nt=async Ne=>{if(Ne.preventDefault(),W(""),G(null),!r||!e){W("Error: Agent data not loaded");return}if(c.trim().length<2){W("Name must be at least 2 characters");return}try{const{data:Me,error:Ve}=await ge.rpc("update_agent_details",{p_agent_id:r.id,p_user_updates:{name:c.trim()},p_agent_updates:{},p_current_user_id:e.id});Ve?(W(`Error: ${Ve.message}`),console.error(Ve)):Me&&Me.success?(n({...r,name:c.trim()}),W("Name updated successfully!"),l(!1)):W((Me==null?void 0:Me.message)||"Update failed")}catch(Me){W("Failed to update name"),console.error(Me)}},K=async(Ne,Me)=>{if(W(""),G(null),!r||!e){W("Error: Agent data not loaded");return}if(Me.trim().length===0){W("Field cannot be empty");return}if(Ne==="business_email"&&!Me.includes("@")){W("Please enter a valid email");return}if(Ne==="contact_number"&&!/^\+?[\d\s-()]{10,}$/.test(Me)){W("Please enter a valid contact number");return}if(Ne==="website"&&!/^https?:\/\/.+/.test(Me)){W("Please enter a valid website URL starting with http:// or https://");return}const Ve={};Ve[Ne]=Me.trim();try{const{data:$e,error:Ye}=await ge.rpc("update_agent_details",{p_agent_id:r.id,p_user_updates:{},p_agent_updates:Ve,p_current_user_id:e.id});if(Ye)W(`Error: ${Ye.message}`),console.error(Ye);else if($e&&$e.success){n({...r,[Ne]:Me.trim()});const pt=Ne.charAt(0).toUpperCase()+Ne.slice(1).replace("_"," ");W(`${pt} updated successfully!`),Ne==="address"&&m(!1),Ne==="business_email"&&b(!1),Ne==="contact_number"&&w(!1),Ne==="website"&&U(!1)}else W(($e==null?void 0:$e.message)||"Update failed")}catch($e){W(`Failed to update ${Ne}`),console.error($e)}},be=async()=>{if(!r||!e){R("Error: Agent data not loaded");return}const Ne=parseFloat(P);if(isNaN(Ne)||Ne<=0){R("Please enter a valid positive amount");return}try{R("");const{data:Me,error:Ve}=await ge.functions.invoke("add-credits",{body:{agent_id:r.id,amount:Ne}});Ve?(R(`Error: ${Ve.message}`),console.error(Ve)):Me&&Me.message==="Credits added successfully"?(n({...r,credits:Me.credits}),R(`Added ${Ne} credits successfully! New balance: ${Me.credits}`),F(""),C(!1)):R((Me==null?void 0:Me.error)||"Failed to add credits")}catch(Me){R(`Failed to add credits: ${Me.message}`),console.error(Me)}},_e=async Ne=>{if(Ne.preventDefault(),ne(!0),de(""),G(null),O!==B){de("New passwords do not match"),ne(!1);return}if(O.length<8){de("New password must be at least 8 characters"),ne(!1);return}try{const{error:Me}=await ge.auth.updateUser({password:O});Me?(de(`Error: ${Me.message}`),console.error(Me)):(de("Password updated successfully!"),ue(""),Z(""),ee(""))}catch(Me){de("Failed to update password"),console.error(Me)}finally{ne(!1)}},re=async()=>{var $e;if(!Le||!r||!e){W("Error: File or agent data not available");return}const Ne=($e=Le.name.split(".").pop())==null?void 0:$e.toLowerCase();if(!Ne||!["png","jpg","jpeg"].includes(Ne)){W("Please select a valid image file (PNG, JPG, JPEG)");return}const Me=`invoice-template.${Ne}`,Ve=`agents/${r.id}/${Me}`;try{W("");const Ye=new FileReader,it=(await new Promise(Pt=>{Ye.onload=()=>Pt(Ye.result),Ye.readAsDataURL(Le)})).split(",")[1],Je=Le.type,{data:Xe,error:At}=await ge.functions.invoke("upload-invoice-template",{body:{agentId:r.id,fileName:Me,fileBase64:it,fileType:Je}});if(At)throw At;Xe&&Xe.success?(n({...r,invoice_template_path:Ve}),V(Ve),ve(null),me(!1),W("Invoice template uploaded successfully!")):W("Upload failed: "+((Xe==null?void 0:Xe.error)||"Unknown error"))}catch(Ye){W(`Upload failed: ${Ye.message}`),console.error(Ye)}},De=async()=>{if(!(!he||!r||!e))try{const{error:Ne}=await ge.storage.from("agent-templates").remove([he]);if(Ne)throw Ne;const{data:Me,error:Ve}=await ge.rpc("update_agent_template_path",{p_agent_id:r.id,p_template_path:null,p_current_user_id:e.id});Ve?(console.error("Failed to update DB:",Ve),W("Template removed but DB update failed")):Me&&Me.success&&(n({...r,invoice_template_path:void 0}),W("Invoice template removed successfully!")),V(null)}catch(Ne){W(`Removal failed: ${Ne.message}`),console.error(Ne)}},se=async()=>{if(!Ce||!r||!e){W("Error: File or agent data not available");return}const Ne=`${r.id}/document.txt`;try{W("");const Me=new FileReader,$e=(await new Promise(Je=>{Me.onload=()=>Je(Me.result),Me.readAsDataURL(Ce)})).split(",")[1],Ye=Ce.type,{data:pt,error:it}=await ge.functions.invoke("upload-company-overview",{body:{agentId:r.id,fileBase64:$e,fileType:Ye}});if(it)throw it;pt&&pt.success?(Oe(Ne),fe(null),xe(!1),W("Company overview document uploaded successfully!")):W("Upload failed: "+((pt==null?void 0:pt.error)||"Unknown error"))}catch(Me){W(`Upload failed: ${Me.message}`),console.error(Me)}},Pe=async()=>{if(!(!We||!r))try{const{error:Ne}=await ge.storage.from("knowledge-documents").remove([We]);if(Ne)throw Ne;Oe(null),W("Company overview document removed successfully!")}catch(Ne){W(`Removal failed: ${Ne.message}`),console.error(Ne)}},Ee=async()=>{try{const Ne=await fetch("https://itvaqysqzdmwhucllktz.supabase.co/storage/v1/object/public/invoices/IDesign%20Invoice%20Template.png");if(!Ne.ok)throw new Error("Failed to fetch image");const Me=await Ne.blob(),Ve=URL.createObjectURL(Me),$e=document.createElement("a");$e.href=Ve,$e.download="IDesign_Invoice_Template.png",document.body.appendChild($e),$e.click(),document.body.removeChild($e),URL.revokeObjectURL(Ve)}catch(Ne){console.error("Download failed:",Ne);const Me=document.createElement("a");Me.href="https://itvaqysqzdmwhucllktz.supabase.co/storage/v1/object/public/invoices/IDesign%20Invoice%20Template.png",Me.download="IDesign_Invoice_Template.png",document.body.appendChild(Me),Me.click(),document.body.removeChild(Me)}};return s?a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-1",children:"Settings"}),a.jsx("p",{className:"text-gray-600",children:"Configure your account"})]}),a.jsx("div",{className:"bg-white rounded-2xl p-6 px-4 shadow-lg border border-gray-100",children:a.jsx("p",{className:"text-center text-gray-500",children:"Loading..."})})]}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-1",children:"Settings"}),a.jsx("p",{className:"text-gray-600",children:"Manage your account and preferences"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Account Information"}),M&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:M}),e&&r?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),o?a.jsxs("form",{onSubmit:nt,className:"space-y-2",children:[a.jsx("input",{type:"text",value:c,onChange:Ne=>u(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your name",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Save"}),a.jsx("button",{type:"button",onClick:()=>{l(!1),u(r.name),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:r.name}),a.jsx("button",{onClick:()=>{l(!0),W("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("p",{className:"text-lg font-medium text-gray-900",children:e.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Number"}),a.jsx("p",{className:"text-lg font-medium text-gray-900",children:r.whatsapp_number||"Not set"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),d?a.jsxs("form",{onSubmit:Ne=>{Ne.preventDefault(),K("address",f)},className:"space-y-2",children:[a.jsx("input",{type:"text",value:f,onChange:Ne=>h(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your address",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Save"}),a.jsx("button",{type:"button",onClick:()=>{m(!1),h((r==null?void 0:r.address)||""),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:(r==null?void 0:r.address)||"Not set"}),a.jsx("button",{onClick:()=>{m(!0),W("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Email"}),x?a.jsxs("form",{onSubmit:Ne=>{Ne.preventDefault(),K("business_email",j)},className:"space-y-2",children:[a.jsx("input",{type:"email",value:j,onChange:Ne=>y(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter business email",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Save"}),a.jsx("button",{type:"button",onClick:()=>{b(!1),y((r==null?void 0:r.business_email)||""),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:(r==null?void 0:r.business_email)||"Not set"}),a.jsx("button",{onClick:()=>{b(!0),W("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number"}),_?a.jsxs("form",{onSubmit:Ne=>{Ne.preventDefault(),K("contact_number",S)},className:"space-y-2",children:[a.jsx("input",{type:"tel",value:S,onChange:Ne=>E(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter contact number",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Save"}),a.jsx("button",{type:"button",onClick:()=>{w(!1),E((r==null?void 0:r.contact_number)||""),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:(r==null?void 0:r.contact_number)||"Not set"}),a.jsx("button",{onClick:()=>{w(!0),W("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),$?a.jsxs("form",{onSubmit:Ne=>{Ne.preventDefault(),K("website",I)},className:"space-y-2",children:[a.jsx("input",{type:"url",value:I,onChange:Ne=>T(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter website URL (e.g., https://example.com)",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Save"}),a.jsx("button",{type:"button",onClick:()=>{U(!1),T((r==null?void 0:r.website)||""),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:(r==null?void 0:r.website)||"Not set"}),a.jsx("button",{onClick:()=>{U(!0),W("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credits Balance"}),D?a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"number",step:"0.01",min:"0.01",value:P,onChange:Ne=>F(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter amount to add (e.g., 10.00)",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:be,disabled:!P||parseFloat(P)<=0,className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium text-sm",children:"Add Credits"}),a.jsx("button",{type:"button",onClick:()=>{C(!1),F(""),R("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:r!=null&&r.credits?`${r.credits.toFixed(2)} credits`:"0.00 credits"}),a.jsx("button",{onClick:()=>{C(!0),R("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Add Credits"})]}),A&&a.jsx("div",{className:`p-3 rounded-lg mt-2 ${A.includes("successfully")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:A})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Template"}),je?a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"file",accept:".png,.jpg,.jpeg",onChange:Ne=>{var Me;return ve(((Me=Ne.target.files)==null?void 0:Me[0])||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:re,disabled:!Le,className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium text-sm",children:"Upload"}),a.jsx("button",{type:"button",onClick:()=>{me(!1),ve(null),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):he?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Template uploaded"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>me(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Change"}),a.jsx("button",{onClick:De,className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"}),a.jsx("button",{onClick:Ee,className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"Download Margin Guide"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:"No template set"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>me(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Upload Template"}),a.jsx("button",{onClick:Ee,className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"Download Margin Guide"})]})]})]})]}):a.jsx("p",{className:"text-gray-500",children:"Unable to load account information"})]}),H&&a.jsx("div",{className:`p-3 rounded-lg mt-4 ${H.includes("successfully")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:H}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),a.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),a.jsx("input",{type:"password",value:ce,onChange:Ne=>ue(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter current password",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),a.jsx("input",{type:"password",value:O,onChange:Ne=>Z(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter new password (min 8 characters)",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),a.jsx("input",{type:"password",value:B,onChange:Ne=>ee(Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm new password",required:!0})]}),le&&a.jsx("div",{className:`p-3 rounded-lg ${le.includes("successfully")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:le}),a.jsx("button",{type:"submit",disabled:X,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:X?"Updating...":"Update Password"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Company Overview Document"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document"}),Re?a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"file",accept:".txt,.pdf,.doc,.docx",onChange:Ne=>{var Me;return fe(((Me=Ne.target.files)==null?void 0:Me[0])||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:se,disabled:!Ce,className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium text-sm",children:"Upload"}),a.jsx("button",{type:"button",onClick:()=>{xe(!1),fe(null),W("")},className:"flex-1 bg-gray-300 text-gray-700 py-1 px-3 rounded-lg hover:bg-gray-400 transition-colors font-medium text-sm",children:"Cancel"})]})]}):We?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Document uploaded"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>xe(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Change"}),a.jsx("button",{onClick:Pe,className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:"No document set"}),a.jsx("button",{onClick:()=>xe(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Upload Document"})]})]})]})]})},yZ=()=>a.jsx("div",{className:"max-w-7xl mx-auto py-12 px-8 sm:px-10 lg:px-12",children:a.jsx(vZ,{})}),bZ=({onClose:e,onCreate:t,setError:r})=>{const[n,s]=g.useState({service_name:"",description:""}),[i,o]=g.useState([]),[l,c]=g.useState([{package_name:"",price:0,currency:"USD",discount:0,description:""}]),[u,d]=g.useState({}),[m,f]=g.useState(!1),h=()=>{const _={};return n.service_name.trim()||(_.service_name="Service name is required"),l.forEach((w,S)=>{w.package_name.trim()||(_[`package_name_${S}`]=`Package ${S+1} name is required`),w.price<=0&&(_[`price_${S}`]=`Package ${S+1} price must be greater than 0`)}),l.length===0&&(_.packages="At least one package is required"),d(_),Object.keys(_).length===0},x=async _=>{if(_.preventDefault(),!h())return;f(!0);const w=l.map(E=>({...E,is_active:!0}));await t({...n,service_name:n.service_name.trim(),images:i,packages:w})&&(s({service_name:"",description:""}),o([]),c([{package_name:"",price:0,currency:"USD",discount:0,description:""}]),d({}),e()),f(!1)},b=()=>{c([...l,{package_name:"",price:0,currency:"USD",discount:0,description:""}])},j=_=>{l.length>1&&c(l.filter((w,S)=>S!==_))},y=(_,w,S)=>{const E=[...l];E[_]={...E[_],[w]:S},c(E)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Create New Service"}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Name *"}),a.jsx("input",{type:"text",value:n.service_name,onChange:_=>s({...n,service_name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),u.service_name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.service_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:n.description,onChange:_=>s({...n,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",rows:3})]}),a.jsxs("div",{className:"p-4 border rounded-md bg-gray-50",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Images (Optional, max 10)"}),a.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:async _=>{const w=Array.from(_.target.files||[]);if(w.length+i.length>10){r("Maximum 10 images allowed");return}const S=[];for(const E of w){if(!E.type.startsWith("image/")){r("Only image files are allowed");continue}const $=new FileReader;$.onload=U=>{var D;const I=(D=U.target)==null?void 0:D.result,T=I.match(/^data:(.*);base64,(.*)$/);T&&(S.push({fileName:E.name,fileBase64:T[2],fileType:T[1],preview:I}),S.length===w.length&&(o(C=>[...C,...S]),r(null)))},$.readAsDataURL(E)}},className:"w-full mb-2"}),i.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:i.map((_,w)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:_.preview,alt:_.fileName,className:"w-20 h-20 object-cover rounded"}),a.jsx("button",{type:"button",onClick:()=>o(S=>S.filter((E,$)=>$!==w)),className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:""})]},w))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Packages *"}),l.map((_,w)=>a.jsxs("div",{className:"border p-4 rounded-md mb-3 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[a.jsxs("div",{children:[a.jsx("input",{type:"text",placeholder:"Package Name *",value:_.package_name,onChange:S=>y(w,"package_name",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),u[`package_name_${w}`]&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:u[`package_name_${w}`]})]}),a.jsxs("div",{children:[a.jsx("input",{type:"number",placeholder:"Price *",value:_.price,onChange:S=>y(w,"price",parseFloat(S.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"0",step:"0.01",required:!0}),u[`price_${w}`]&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:u[`price_${w}`]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("input",{type:"text",placeholder:"Currency (e.g., USD)",value:_.currency,onChange:S=>y(w,"currency",S.target.value.toUpperCase()),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})}),a.jsx("div",{children:a.jsx("input",{type:"number",placeholder:"Discount % (0-100)",value:_.discount||"",onChange:S=>y(w,"discount",parseFloat(S.target.value)||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"0",max:"100",step:"0.01"})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("textarea",{placeholder:"Package Description",value:_.description||"",onChange:S=>y(w,"description",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",rows:2})})]}),l.length>1&&a.jsx("button",{type:"button",onClick:()=>j(w),className:"text-red-500 text-sm underline hover:text-red-700",children:"Remove Package"})]},w)),u.packages&&a.jsx("p",{className:"text-red-500 text-sm mb-3",children:u.packages}),a.jsx("button",{type:"button",onClick:b,className:"px-4 py-2 bg-green-500 text-white rounded-md text-sm hover:bg-green-600 transition-colors",children:"Add Package"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 bg-gray-300 rounded-md hover:bg-gray-400 text-gray-700 font-medium transition-colors",disabled:m,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium transition-colors disabled:opacity-50",disabled:m,children:m?"Creating...":"Create Service"})]})]})]})})},wZ=({editingService:e,agent:t,onClose:r,onSuccess:n,setError:s})=>{if(!e||!t)return null;const[i,o]=g.useState({service_name:e.service_name,description:e.description||""}),[l,c]=g.useState([...e.packages]),[u]=g.useState(new Set(e.packages.map(D=>D.id))),[d,m]=g.useState(new Set),[f,h]=g.useState([]),[x,b]=g.useState([]),[j,y]=g.useState({}),[_,w]=g.useState(!1),S=()=>{const D={};return i.service_name.trim()||(D.service_name="Service name is required"),l.forEach((C,P)=>{C.package_name.trim()||(D[`package_name_${P}`]=`Package ${P+1} name is required`),C.price<=0&&(D[`price_${P}`]=`Package ${P+1} price must be greater than 0`)}),l.length===0&&(D.packages="At least one package is required"),y(D),Object.keys(D).length===0},E=async D=>{var C,P;if(D.preventDefault(),!!S()){w(!0);try{let F=[];if(f.length>0){const G=await SD(t.id,e.id,f);if(G.error||!((C=G.data)!=null&&C.success)){s(((P=G.error)==null?void 0:P.message)||"Failed to upload images"),w(!1);return}F=G.data.urls}const A={service_name:i.service_name.trim(),description:i.description||null};(F.length>0||x.length>0)&&(A.image_urls={},F.length>0&&(A.image_urls.add=F),x.length>0&&(A.image_urls.remove=x));const{error:R}=await ED("service",e.id,A);if(R){s(R.message||"Failed to update service"),w(!1);return}const H=`${t.agent_prefix}_service_packages`,W=l.filter(G=>!u.has(G.id));if(W.length>0){const{error:G}=await ge.from(H).insert(W.map(ce=>({service_id:e.id,package_name:ce.package_name,price:ce.price,currency:ce.currency,discount:ce.discount||null,description:ce.description||null,is_active:!0})));if(G){s(G.message),w(!1);return}}const M=l.filter(G=>u.has(G.id));for(const G of M){if(!G.id)continue;const{error:ce}=await ge.from(H).update({package_name:G.package_name,price:G.price,currency:G.currency,discount:G.discount||null,description:G.description||null,is_active:!0}).eq("id",G.id);if(ce){s(ce.message),w(!1);return}}if(d.size>0){const{error:G}=await ge.from(H).delete().in("id",Array.from(d));if(G){s(G.message),w(!1);return}}n()}catch{s("Failed to update service")}finally{w(!1)}}},$=()=>{c([...l,{id:"",service_id:e.id,package_name:"",price:0,currency:"USD",discount:void 0,description:"",is_active:!0,created_at:"",updated_at:""}])},U=D=>{const C=l[D];C.id&&u.has(C.id)&&m(P=>new Set([...P,C.id])),c(l.filter((P,F)=>F!==D))},I=(D,C,P)=>{const F=[...l];F[D]={...F[D],[C]:P},c(F)},T=(D,C)=>{o(P=>({...P,[D]:C}))};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Edit Service: ",e.service_name]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:E,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Name *"}),a.jsx("input",{type:"text",value:i.service_name,onChange:D=>T("service_name",D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),j.service_name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:j.service_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:i.description,onChange:D=>T("description",D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),a.jsxs("div",{className:"p-4 border rounded-md bg-gray-50",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Images (Optional, max 10 total)"}),(()=>{var C;const D=((C=e.image_urls)==null?void 0:C.filter(P=>!x.includes(P)))||[];return D.length>0?a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Current Images:"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:D.map((P,F)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:P,alt:`Current image ${F+1}`,className:"w-20 h-20 object-cover rounded"}),a.jsx("button",{type:"button",onClick:()=>{b(A=>[...A,P])},className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""})]},P))})]}):null})(),a.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:async D=>{var A;const C=Array.from(D.target.files||[]),P=(((A=e.image_urls)==null?void 0:A.length)||0)-x.length+f.length;if(C.length+P>10){s("Maximum 10 images total allowed");return}const F=[];for(const R of C){if(!R.type.startsWith("image/")){s("Only image files are allowed");continue}const H=new FileReader;H.onload=W=>{var ce;const M=(ce=W.target)==null?void 0:ce.result,G=M.match(/^data:(.*);base64,(.*)$/);G&&(F.push({fileName:R.name,fileBase64:G[2],fileType:G[1],preview:M}),F.length===C.length&&(h(ue=>[...ue,...F]),s(null)))},H.readAsDataURL(R)}},className:"w-full mb-2"}),f.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"New Images:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:f.map((D,C)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:D.preview,alt:D.fileName,className:"w-20 h-20 object-cover rounded"}),a.jsx("button",{type:"button",onClick:()=>h(P=>P.filter((F,A)=>A!==C)),className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:""})]},C))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Packages *"}),l.map((D,C)=>a.jsxs("div",{className:"border p-4 rounded-md mb-3 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[a.jsxs("div",{children:[a.jsx("input",{type:"text",placeholder:"Package Name *",value:D.package_name,onChange:P=>I(C,"package_name",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),j[`package_name_${C}`]&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:j[`package_name_${C}`]})]}),a.jsxs("div",{children:[a.jsx("input",{type:"number",placeholder:"Price *",value:D.price,onChange:P=>I(C,"price",parseFloat(P.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01",required:!0}),j[`price_${C}`]&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:j[`price_${C}`]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("input",{type:"text",placeholder:"Currency (e.g., USD)",value:D.currency,onChange:P=>I(C,"currency",P.target.value.toUpperCase()),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),a.jsx("div",{children:a.jsx("input",{type:"number",placeholder:"Discount % (0-100)",value:D.discount||"",onChange:P=>I(C,"discount",parseFloat(P.target.value)||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.01"})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("textarea",{placeholder:"Package Description",value:D.description||"",onChange:P=>I(C,"description",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:2})})]}),a.jsx("button",{type:"button",onClick:()=>U(C),className:"text-red-500 text-sm underline hover:text-red-700",children:"Remove Package"})]},D.id||C)),j.packages&&a.jsx("p",{className:"text-red-500 text-sm mb-3",children:j.packages}),a.jsx("button",{type:"button",onClick:$,className:"px-4 py-2 bg-green-500 text-white rounded-md text-sm hover:bg-green-600 transition-colors",children:"Add Package"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:r,className:"px-6 py-2 bg-gray-300 rounded-md hover:bg-gray-400 text-gray-700 font-medium transition-colors",disabled:_,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium transition-colors disabled:opacity-50",disabled:_,children:_?"Updating...":"Update Service"})]})]})]})})},_Z=({deletingServiceId:e,services:t,onClose:r,onDelete:n})=>{if(!e||!t.length)return null;const s=t.find(o=>o.id===e);if(!s)return null;const i=()=>{e&&n(e)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-red-600 mb-4",children:"Delete Service"}),a.jsxs("p",{className:"mb-4",children:['Are you sure you want to delete the service "',a.jsx("strong",{children:s.service_name}),'"?']}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"This will permanently delete the service and all its packages. This action cannot be undone."}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:r,className:"px-6 py-2 bg-gray-300 rounded-md hover:bg-gray-400 text-gray-700 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{type:"button",onClick:i,className:"px-6 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium transition-colors",children:"Permanent Delete"})]})]})})},jZ=({service:e,onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Service Details"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",children:""})]}),a.jsx("div",{className:"mb-4",children:a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.service_name})}),e.description&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:e.description})]}),e.image_urls&&e.image_urls.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e.image_urls.map((r,n)=>a.jsx("img",{src:r,alt:`${e.service_name} image ${n+1}`,className:"w-full h-32 object-cover rounded-lg"},n))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Packages"}),a.jsx("div",{className:"space-y-3",children:e.packages.length>0?e.packages.map(r=>a.jsxs("div",{className:"border border-gray-200 rounded-md p-4 bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:r.package_name}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[r.currency," ",r.price.toFixed(2)]}),r.discount&&r.discount>0&&a.jsxs("p",{className:"text-xs text-green-600",children:["(",r.discount,"% discount)"]})]})]}),r.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-2 whitespace-pre-wrap",children:r.description})]},r.id)):a.jsx("p",{className:"text-gray-500 italic",children:"No packages available."})})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-300 rounded-md hover:bg-gray-400 text-gray-700 font-medium transition-colors",children:"Close"})})]})}),D3=[{value:"created_at",label:"Sort by Date"},{value:"price",label:"Sort by Price"}],$3=[{value:"desc",label:"Descending"},{value:"asc",label:"Ascending"}],NZ=()=>{var T,D;const[e,t]=g.useState([]),[r,n]=g.useState(!0),[s,i]=g.useState(null),[o,l]=g.useState(!1),[c,u]=g.useState(null),[d,m]=g.useState(!1),[f,h]=g.useState(null),[x,b]=g.useState(null),[j,y]=g.useState(null),[_,w]=g.useState({service_name:"",package_name:"",sort_by:"created_at",sort_order:"desc"});g.useEffect(()=>{S()},[_]),g.useEffect(()=>{lb().then(y)},[]);const S=async()=>{await ge.auth.getSession(),n(!0),i(null);const{data:C,error:P}=await CD(_);P?i(P):t(C||[]),n(!1)},E=async C=>{const{data:P,error:F}=await kD(C);return F?(i(F.message||"Failed to create service"),!1):(l(!1),S(),i(null),!0)},$=async C=>{const{data:P,error:F}=await AD(C);F?i(F.message||"Failed to permanently delete service"):(m(!1),h(null),S(),i(null))},U=C=>{h(C),m(!0)};if(r)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})});if(s)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6 text-center",children:["Error: ",s]})});const I=e.filter(C=>C.service_name.toLowerCase().includes(_.service_name.toLowerCase())||C.packages.some(P=>P.package_name.toLowerCase().includes(_.package_name.toLowerCase())));return a.jsxs("div",{className:"p-6",children:[a.jsx(Qe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25,delay:.2},className:"bg-white rounded-xl border border-gray-200 p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[a.jsx(Qe.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{duration:.15,delay:.25},className:"flex-1 min-w-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{type:"text",placeholder:"Search services or packages...",value:`${_.service_name} ${_.package_name}`.trim()||"",onChange:C=>{const P=C.target.value;w({..._,service_name:P,package_name:P})},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),a.jsxs(Qe.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.15,delay:.3},className:"flex flex-wrap gap-2 items-center min-w-max",children:[a.jsx(Qe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.1,delay:.35},children:a.jsxs(yr,{as:"div",className:"relative",children:[a.jsxs(yr.Button,{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[((T=D3.find(C=>C.value===_.sort_by))==null?void 0:T.label)||"Sort by Date",a.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:D3.map(C=>a.jsx(yr.Item,{children:({active:P})=>a.jsx("button",{className:`w-full text-left px-4 py-2 text-sm ${P?"bg-gray-100":""} ${_.sort_by===C.value?"bg-green-50 text-green-700":""}`,onClick:()=>w({..._,sort_by:C.value}),children:C.label})},C.value))})})]})}),a.jsx(Qe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.1,delay:.4},children:a.jsxs(yr,{as:"div",className:"relative",children:[a.jsxs(yr.Button,{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[((D=$3.find(C=>C.value===_.sort_order))==null?void 0:D.label)||"Descending",a.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx(bl,{enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:a.jsx(yr.Items,{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:$3.map(C=>a.jsx(yr.Item,{children:({active:P})=>a.jsx("button",{className:`w-full text-left px-4 py-2 text-sm ${P?"bg-gray-100":""} ${_.sort_order===C.value?"bg-green-50 text-green-700":""}`,onClick:()=>w({..._,sort_order:C.value}),children:C.label})},C.value))})})]})}),a.jsxs(Qe.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.1,delay:.45},onClick:()=>l(!0),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Service"]})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:I.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:_.service_name||_.package_name?"No services found":"No services yet"}),a.jsx("p",{className:"text-gray-500",children:_.service_name||_.package_name?"No services match your search":"Start by adding your first service"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-6",children:I.map(C=>a.jsxs("div",{className:"w-full border border-gray-200 rounded-lg shadow-sm p-4 bg-white hover:shadow-md transition-shadow duration-150",children:[a.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[a.jsx("div",{className:"flex-shrink-0",children:C.image_urls&&C.image_urls.length>0?a.jsx("img",{className:"h-12 w-12 rounded-lg object-cover",src:C.image_urls[0],alt:C.service_name}):a.jsx("div",{className:"h-12 w-12 rounded-lg bg-gray-200 flex items-center justify-center",children:a.jsxs("svg",{className:"h-5 w-5 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M10 9a3 3 0 100-6 3 3 0 000 6z"}),a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})]})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-base font-medium text-gray-900 mb-1",children:C.service_name}),C.description&&a.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:C.description})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h4",{className:"text-xs font-medium text-gray-900 mb-1.5 uppercase tracking-wide",children:"Packages"}),a.jsxs("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:[C.packages.map(P=>a.jsxs("div",{className:"flex justify-between items-start bg-gray-50 p-2 rounded",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:P.package_name}),P.description&&a.jsx("p",{className:"text-xs text-gray-500 truncate",children:P.description})]}),a.jsxs("div",{className:"text-right ml-2 flex-shrink-0",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[P.currency," ",P.price.toFixed(2)]}),P.discount&&P.discount>0&&a.jsxs("p",{className:"text-xs text-green-600",children:["(",P.discount,"% off)"]})]})]},P.id)),C.packages.length===0&&a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No packages"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-2 pt-1",children:[a.jsx("button",{onClick:()=>b(C),className:"text-blue-600 hover:text-blue-900 text-xs font-medium transition-colors",children:"View"}),a.jsx("button",{onClick:()=>u(C),className:"text-indigo-600 hover:text-indigo-900 text-xs font-medium transition-colors",children:"Edit"}),a.jsx("button",{onClick:()=>U(C.id),className:"text-red-600 hover:text-red-900 text-xs font-medium transition-colors",children:"Delete"})]})]},C.id))})}),o&&a.jsx(bZ,{onClose:()=>l(!1),onCreate:E,setError:i}),c&&j&&a.jsx(wZ,{editingService:c,agent:j,onClose:()=>u(null),onSuccess:()=>{u(null),S(),i(null)},setError:i}),d&&a.jsx(_Z,{deletingServiceId:f,services:e,onClose:()=>{m(!1),h(null)},onDelete:$}),x&&a.jsx(jZ,{service:x,onClose:()=>b(null)})]})},SZ=()=>a.jsx(oS,{children:a.jsxs(vn,{path:"/",element:a.jsx(gB,{}),children:[a.jsx(vn,{index:!0,element:a.jsx(_4,{})}),a.jsx(vn,{path:"dashboard",element:a.jsx(_4,{})}),a.jsx(vn,{path:"conversations",element:a.jsx(DV,{})}),a.jsx(vn,{path:"customers",element:a.jsx($V,{})}),a.jsx(vn,{path:"orders",element:a.jsx(QY,{})}),a.jsx(vn,{path:"orders/:id",element:a.jsx(eZ,{})}),a.jsx(vn,{path:"appointments",element:a.jsx(cZ,{})}),a.jsx(vn,{path:"inventory",element:a.jsx(sZ,{})}),a.jsx(vn,{path:"invoices",element:a.jsx(tZ,{})}),a.jsx(vn,{path:"templates",element:a.jsx(nZ,{})}),a.jsx(vn,{path:"services",element:a.jsx(NZ,{})}),a.jsx(vn,{path:"analytics",element:a.jsx(xZ,{})}),a.jsx(vn,{path:"settings",element:a.jsx(yZ,{})})]})}),kZ=({children:e})=>{const[t,r]=g.useState(null),[n,s]=g.useState(!0);return g.useEffect(()=>{(async()=>{try{const{data:{user:l}}=await ge.auth.getUser();r(!!l)}catch(l){console.error("AgentAuthGuard: Auth check failed:",l),r(!1)}finally{s(!1)}})();const{data:{subscription:o}}=ge.auth.onAuthStateChange((l,c)=>{r(!!(c!=null&&c.user))});return()=>{o.unsubscribe()}},[]),n?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})}):t?a.jsx(a.Fragment,{children:e}):a.jsx(lT,{to:"/login",replace:!0})};const CZ="https://itvaqysqzdmwhucllktz.supabase.co",EZ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0dmFxeXNxemRtd2h1Y2xsa3R6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1ODI1MDAsImV4cCI6MjA3MzE1ODUwMH0.5uYF5Xm1Og-QkgdQdT_BrejxlIFMm1xYrPn7pXqtEpQ",AZ=Ff(CZ,EZ);window.supabase=AZ;Mx.createRoot(document.getElementById("root")).render(a.jsx(OT,{children:a.jsxs(oS,{children:[a.jsx(vn,{path:"/",element:a.jsx(sM,{})}),a.jsx(vn,{path:"/login",element:a.jsx(aM,{})}),a.jsx(vn,{path:"/admin/dashboard",element:a.jsx(zD,{})}),a.jsx(vn,{path:"/agent/*",element:a.jsx(kZ,{children:a.jsx(SZ,{})})}),a.jsx(vn,{path:"*",element:a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"404 - Page Not Found"}),a.jsx("a",{href:"/",className:"text-indigo-600 hover:text-indigo-500",children:"Go back to Home"})]})})})]})}));export{xr as _,Ci as c,zA as g};
